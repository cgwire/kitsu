{"version":3,"file":"EditEpisodeModal-8e3af3e3.js","sources":["../../src/components/modals/EditEpisodeModal.vue"],"sourcesContent":["<template>\n<div :class=\"{\n  'modal': true,\n  'is-active': active\n}\">\n  <div class=\"modal-background\" @click=\"$emit('cancel')\" ></div>\n\n  <div class=\"modal-content\">\n    <div class=\"box\">\n\n      <h1 class=\"title\" v-if=\"episodeToEdit && this.episodeToEdit.id\">\n        {{ $t(\"episodes.edit_title\") }} {{ episodeToEdit.name }}\n      </h1>\n      <h1 class=\"title\" v-else>\n        {{ $t(\"episodes.new_episode\") }}\n      </h1>\n\n      <form v-on:submit.prevent>\n        <text-field\n          ref=\"nameField\"\n          :label=\"$t('episodes.fields.name')\"\n          v-model=\"form.name\"\n          @enter=\"runConfirmation\"\n          v-focus\n        />\n        <textarea-field\n          ref=\"descriptionField\"\n          :label=\"$t('episodes.fields.description')\"\n          @keyup.ctrl.enter=\"runConfirmation\"\n          @keyup.meta.enter=\"runConfirmation\"\n          v-model=\"form.description\"\n        />\n\n        <div\n          :key=\"descriptor.id\"\n          v-for=\"descriptor in episodeMetadataDescriptors\"\n        >\n          <combobox\n            v-if=\"descriptor.choices.length > 0\"\n            :label=\"descriptor.name\"\n            :options=\"getDescriptorChoicesOptions(descriptor)\"\n            v-model=\"form.data[descriptor.field_name]\"\n          />\n          <text-field\n            :label=\"descriptor.name\"\n            @enter=\"runConfirmation\"\n            v-model=\"form.data[descriptor.field_name]\"\n            v-else\n          />\n        </div>\n      </form>\n\n      <modal-footer\n        :error-text=\"$t('episodes.edit_error')\"\n        :is-loading=\"isLoading\"\n        :is-error=\"isError\"\n        @confirm=\"runConfirmation\"\n        @cancel=\"$emit('cancel')\"\n      />\n    </div>\n  </div>\n</div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nimport { modalMixin } from '@/components/modals/base_modal'\nimport ModalFooter from '@/components/modals/ModalFooter'\nimport TextField from '@/components/widgets/TextField'\nimport TextareaField from '@/components/widgets/TextareaField'\n\nexport default {\n  name: 'edit-episode-modal',\n  mixins: [modalMixin],\n  components: {\n    ModalFooter,\n    TextField,\n    TextareaField\n  },\n\n  props: {\n    active: {\n      type: Boolean,\n      default: false\n    },\n    isError: {\n      type: Boolean,\n      default: false\n    },\n    isLoading: {\n      type: Boolean,\n      default: false\n    },\n    episodeToEdit: {\n      type: Object,\n      default: () => {}\n    }\n  },\n\n  data () {\n    if (this.episodeToEdit && this.episodeToEdit.id) {\n      return {\n        form: {\n          id: this.episodeToEdit.id,\n          name: this.episodeToEdit.name,\n          description: this.episodeToEdit.description,\n          production_id: this.episodeToEdit.project_id,\n          data: this.episodeToEdit.data || {}\n        },\n        episodeSuccessText: ''\n      }\n    } else {\n      return {\n        form: {\n          id: '',\n          name: '',\n          description: '',\n          fps: '',\n          data: {}\n        },\n        episodeSuccessText: ''\n      }\n    }\n  },\n\n  computed: {\n    ...mapGetters([\n      'currentProduction',\n      'episodeMetadataDescriptors'\n    ])\n  },\n\n  methods: {\n    ...mapActions([\n    ]),\n\n    getDescriptorChoicesOptions (descriptor) {\n      const values = descriptor.choices.map(c => ({ label: c, value: c }))\n      return [{ label: '', value: '' }, ...values]\n    },\n\n    runConfirmation () {\n      this.$emit('confirm', this.form)\n    },\n\n    isEditing () {\n      return this.episodeToEdit && this.episodeToEdit.id\n    },\n\n    resetForm () {\n      this.episodeSuccessText = ''\n      if (!this.isEditing()) {\n        this.form.id = null\n        this.form.name = ''\n        this.form.description = ''\n        this.form.data = {}\n      } else {\n        this.form = {\n          id: this.episodeToEdit.id,\n          name: this.episodeToEdit.name,\n          description: this.episodeToEdit.description,\n          data: this.episodeToEdit.data || {}\n        }\n      }\n    }\n  },\n\n  mounted () {\n    this.resetForm()\n  },\n\n  watch: {\n    active () {\n      if (this.active) {\n        this.resetForm()\n      }\n    },\n\n    episodeToEdit () {\n      this.resetForm()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.modal-content .box p.text {\n  margin-bottom: 1em;\n}\n.is-danger {\n  color: #ff3860;\n  font-style: italic;\n}\n\n.info-message {\n  margin-top: 1em;\n}\n</style>\n"],"names":["_sfc_main","modalMixin","ModalFooter","TextField","TextareaField","mapGetters","mapActions","descriptor","values","c"],"mappings":"sHAuEA,MAAAA,EAAA,CACA,KAAA,qBACA,OAAA,CAAAC,CAAA,EACA,WAAA,CACA,YAAAC,EACA,UAAAC,EACA,cAAAC,CACA,EAEA,MAAA,CACA,OAAA,CACA,KAAA,QACA,QAAA,EACA,EACA,QAAA,CACA,KAAA,QACA,QAAA,EACA,EACA,UAAA,CACA,KAAA,QACA,QAAA,EACA,EACA,cAAA,CACA,KAAA,OACA,QAAA,IAAA,CAAA,CACA,CACA,EAEA,MAAA,CACA,OAAA,KAAA,eAAA,KAAA,cAAA,GACA,CACA,KAAA,CACA,GAAA,KAAA,cAAA,GACA,KAAA,KAAA,cAAA,KACA,YAAA,KAAA,cAAA,YACA,cAAA,KAAA,cAAA,WACA,KAAA,KAAA,cAAA,MAAA,CAAA,CACA,EACA,mBAAA,EACA,EAEA,CACA,KAAA,CACA,GAAA,GACA,KAAA,GACA,YAAA,GACA,IAAA,GACA,KAAA,CAAA,CACA,EACA,mBAAA,EACA,CAEA,EAEA,SAAA,CACA,GAAAC,EAAA,CACA,oBACA,4BACA,CAAA,CACA,EAEA,QAAA,CACA,GAAAC,EAAA,CACA,CAAA,EAEA,4BAAAC,EAAA,CACA,MAAAC,EAAAD,EAAA,QAAA,IAAAE,IAAA,CAAA,MAAAA,EAAA,MAAAA,CAAA,EAAA,EACA,MAAA,CAAA,CAAA,MAAA,GAAA,MAAA,EAAA,EAAA,GAAAD,CAAA,CACA,EAEA,iBAAA,CACA,KAAA,MAAA,UAAA,KAAA,IAAA,CACA,EAEA,WAAA,CACA,OAAA,KAAA,eAAA,KAAA,cAAA,EACA,EAEA,WAAA,CACA,KAAA,mBAAA,GACA,KAAA,YAMA,KAAA,KAAA,CACA,GAAA,KAAA,cAAA,GACA,KAAA,KAAA,cAAA,KACA,YAAA,KAAA,cAAA,YACA,KAAA,KAAA,cAAA,MAAA,CAAA,CACA,GAVA,KAAA,KAAA,GAAA,KACA,KAAA,KAAA,KAAA,GACA,KAAA,KAAA,YAAA,GACA,KAAA,KAAA,KAAA,CAAA,EASA,CACA,EAEA,SAAA,CACA,KAAA,UAAA,CACA,EAEA,MAAA,CACA,QAAA,CACA,KAAA,QACA,KAAA,UAAA,CAEA,EAEA,eAAA,CACA,KAAA,UAAA,CACA,CACA,CACA"}