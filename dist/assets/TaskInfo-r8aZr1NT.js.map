{"version":3,"file":"TaskInfo-r8aZr1NT.js","sources":["../../src/lib/array.js","../../src/components/widgets/ComboboxModel.vue","../../src/components/tops/ActionPanel.vue","../../src/components/sides/TaskInfo.vue"],"sourcesContent":["/**\n * Finds the intersection of multiple arrays\n * @param {Array<Array>} arrays - An array containing the arrays to compare\n * @returns {Array} - An array containing only elements present in all arrays\n */\nexport const intersection = arrays => {\n  if (!arrays?.length) return []\n  const [first, ...rest] = arrays\n  const sets = rest.map(arr => new Set(arr))\n  return first.filter(item => sets.every(set => set.has(item)))\n}\n","<template>\n  <combobox\n    :label=\"label\"\n    :disabled=\"disabled\"\n    :options=\"modelOptions\"\n    :model-value=\"currentModelId\"\n    @update:model-value=\"emitValue\"\n    @enter=\"emitEnter\"\n  />\n</template>\n\n<script>\nimport Combobox from '@/components/widgets/Combobox.vue'\n\nexport default {\n  name: 'combobox-model',\n\n  components: {\n    Combobox\n  },\n\n  props: {\n    label: {\n      default: '',\n      type: String\n    },\n\n    modelValue: {\n      default: () => {},\n      type: Object\n    },\n\n    models: {\n      default: () => [],\n      type: Array\n    },\n\n    disabled: {\n      default: false,\n      type: Boolean\n    }\n  },\n\n  emits: ['enter', 'update:modelValue'],\n\n  data() {\n    return {\n      currentModelId: '',\n      modelMap: {},\n      modelOptions: []\n    }\n  },\n\n  mounted() {\n    this.reset()\n  },\n\n  methods: {\n    emitValue(value) {\n      this.currentModelId = value\n      const model = this.modelMap[this.currentModelId]\n      this.$emit('update:modelValue', model)\n    },\n\n    emitEnter(value) {\n      this.currentModelId = value\n      const model = this.modelMap[this.currentModelId]\n      this.$emit('enter', model)\n    },\n\n    reset() {\n      if (this.models.length > 0) {\n        this.currentModelId =\n          this.models.find(model => model.id === this.modelValue.id) ??\n          this.models[0].id\n        this.modelMap = {}\n        this.modelOptions = this.models.map(model => ({\n          label: model.name,\n          value: model.id\n        }))\n        this.models.forEach(model => {\n          this.modelMap[model.id] = model\n        })\n      }\n    }\n  },\n\n  watch: {\n    models() {\n      this.reset()\n    }\n  }\n}\n</script>\n","<template>\n  <div>\n    <div class=\"action-topbar unselectable\">\n      <div class=\"menu flexrow\">\n        <div\n          class=\"menu-item status-item\"\n          :class=\"{\n            active: selectedBar === 'change-status'\n          }\"\n          :title=\"$t('menu.change_status')\"\n          @click=\"selectBar('change-status')\"\n          v-if=\"\n            (isCurrentUserManager ||\n              isSupervisorInDepartment ||\n              isInDepartment ||\n              isCurrentViewTodos) &&\n            !isEntitySelection &&\n            !isCurrentViewConcept &&\n            isTaskSelection\n          \"\n        >\n          {{ $t('main.status') }}\n        </div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'assignation'\n          }\"\n          :title=\"$t('menu.assign_tasks')\"\n          @click=\"selectBar('assignation')\"\n          v-if=\"\n            (isCurrentViewSingleEntity || isCurrentViewEntity) &&\n            (isCurrentUserManager ||\n              isSupervisorInDepartment ||\n              isInDepartment ||\n              isCurrentViewSingleEntity) &&\n            !isEntitySelection &&\n            isTaskSelection &&\n            !isCurrentUserArtist\n          \"\n        >\n          <kitsu-icon\n            name=\"user-check\"\n            :active=\"selectedBar === 'assignation'\"\n            :title=\"$t('menu.assign_tasks')\"\n          />\n        </div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'priorities'\n          }\"\n          :title=\"$t('menu.change_priority')\"\n          v-if=\"\n            (isCurrentViewSingleEntity ||\n              isCurrentViewEntity ||\n              isCurrentViewPerson ||\n              isCurrentViewSingleEntity) &&\n            (isCurrentUserManager || isSupervisorInDepartment) &&\n            !isEntitySelection &&\n            isTaskSelection\n          \"\n          @click=\"selectBar('priorities')\"\n        >\n          <kitsu-icon\n            name=\"priority\"\n            :active=\"selectedBar === 'priorities'\"\n            :title=\"$t('menu.change_priority')\"\n          />\n        </div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'thumbnails'\n          }\"\n          :title=\"$t('menu.set_thumbnails')\"\n          v-if=\"\n            isTaskSelection && !isCurrentUserArtist && !isCurrentViewConcept\n          \"\n          @click=\"selectBar('thumbnails')\"\n        >\n          <kitsu-icon\n            name=\"add-thumbnail\"\n            :active=\"selectedBar === 'thumbnails'\"\n            :title=\"$t('menu.set_thumbnails')\"\n          />\n        </div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'subscribe'\n          }\"\n          :title=\"$t('menu.subscribe')\"\n          v-if=\"\n            isTaskSelection &&\n            !isCurrentViewSingleEntity &&\n            !isCurrentViewTodos &&\n            !isCurrentViewConcept\n          \"\n          @click=\"selectBar('subscribe')\"\n        >\n          <kitsu-icon\n            name=\"watch\"\n            :active=\"selectedBar === 'subscribe'\"\n            :title=\"$t('menu.subscribe')\"\n          />\n        </div>\n\n        <div\n          class=\"menu-item ml05\"\n          :class=\"{\n            active: selectedBar === 'edit-concepts'\n          }\"\n          :title=\"$t('menu.edit_concepts')\"\n          @click=\"selectBar('edit-concepts')\"\n          v-if=\"\n            isCurrentViewConcept &&\n            (isCurrentUserManager || isConceptPublisher) &&\n            isTaskSelection\n          \"\n        >\n          <link-icon />\n        </div>\n\n        <div\n          class=\"menu-separator\"\n          v-if=\"!isEntitySelection && isTaskSelection && nbSelectedTasks > 1\"\n        ></div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'playlists'\n          }\"\n          :title=\"$t('menu.generate_playlist')\"\n          v-if=\"\n            (isCurrentViewAsset ||\n              isCurrentViewShot ||\n              isCurrentViewSequence ||\n              isCurrentViewTodos ||\n              isCurrentViewTaskType) &&\n            !isEntitySelection &&\n            !isCurrentViewSingleEntity &&\n            isTaskSelection &&\n            nbSelectedTasks > 0\n          \"\n          @click=\"selectBar('playlists')\"\n        >\n          <kitsu-icon\n            name=\"playlists\"\n            :active=\"selectedBar === 'playlists'\"\n            :title=\"$t('menu.generate_playlist')\"\n          />\n        </div>\n\n        <div\n          v-if=\"\n            (isCurrentViewAsset ||\n              isCurrentViewShot ||\n              isCurrentViewTaskType) &&\n            !isEntitySelection &&\n            !isCurrentViewSingleEntity &&\n            isTaskSelection &&\n            isCurrentUserManager\n          \"\n          class=\"menu-separator\"\n        ></div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'create-tasks'\n          }\"\n          :title=\"$t('menu.create_tasks')\"\n          @click=\"selectBar('create-tasks')\"\n          v-if=\"\n            isCurrentViewEntity &&\n            !isCurrentViewTaskType &&\n            isCurrentUserManager &&\n            !isEntitySelection &&\n            nbSelectedTasks !== 1\n          \"\n        >\n          <check-square-icon />\n        </div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'delete-tasks'\n          }\"\n          :title=\"$t('menu.delete_tasks')\"\n          @click=\"selectBar('delete-tasks')\"\n          v-if=\"\n            isCurrentViewEntity &&\n            isCurrentUserManager &&\n            !isEntitySelection &&\n            !isCurrentViewSingleEntity &&\n            isTaskSelection\n          \"\n        >\n          <kitsu-icon\n            name=\"trash\"\n            :active=\"selectedBar === 'delete-tasks'\"\n            :title=\"$t('menu.delete_tasks')\"\n          />\n        </div>\n\n        <div\n          class=\"menu-separator\"\n          v-if=\"\n            !isEntitySelection &&\n            isTaskSelection &&\n            !isCurrentViewConcept &&\n            customActions?.length\n          \"\n        ></div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'custom-actions'\n          }\"\n          :title=\"$t('menu.run_custom_action')\"\n          @click=\"selectBar('custom-actions')\"\n          v-if=\"\n            !isEntitySelection &&\n            isTaskSelection &&\n            !isCurrentViewConcept &&\n            customActions?.length\n          \"\n        >\n          <play-circle-icon />\n        </div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'delete-assets'\n          }\"\n          :title=\"$t('menu.delete_assets')\"\n          @click=\"selectBar('delete-assets')\"\n          v-if=\"isCurrentViewAsset && isCurrentUserManager && !isTaskSelection\"\n        >\n          <kitsu-icon name=\"trash\" :title=\"$t('menu.delete_assets')\" />\n        </div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'delete-shots'\n          }\"\n          :title=\"$t('menu.delete_shots')\"\n          @click=\"selectBar('delete-shots')\"\n          v-if=\"isCurrentViewShot && isCurrentUserManager && !isTaskSelection\"\n        >\n          <kitsu-icon name=\"trash\" :title=\"$t('menu.delete_shots')\" />\n        </div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'delete-edits'\n          }\"\n          :title=\"$t('menu.delete_edits')\"\n          @click=\"selectBar('delete-edits')\"\n          v-if=\"isCurrentViewEdit && isCurrentUserManager && !isTaskSelection\"\n        >\n          <kitsu-icon name=\"trash\" :title=\"$t('menu.delete_edits')\" />\n        </div>\n\n        <div\n          class=\"menu-item\"\n          :class=\"{\n            active: selectedBar === 'delete-concepts'\n          }\"\n          :title=\"$t('menu.delete_concepts')\"\n          @click=\"selectBar('delete-concepts')\"\n          v-if=\"\n            isCurrentViewConcept && (isCurrentUserManager || isConceptPublisher)\n          \"\n        >\n          <kitsu-icon name=\"trash\" :title=\"$t('menu.delete_concepts')\" />\n        </div>\n\n        <div class=\"filler\"></div>\n\n        <div\n          class=\"menu-item\"\n          :title=\"$t('main.csv.export_file')\"\n          @click=\"$emit('export-task')\"\n          v-if=\"\n            isTaskSelection &&\n            !isEntitySelection &&\n            nbSelectedTasks === 1 &&\n            !isCurrentUserClient\n          \"\n        >\n          <kitsu-icon name=\"export\" :title=\"$t('main.csv.export_file')\" />\n        </div>\n\n        <div\n          class=\"menu-item mr05\"\n          :title=\"$t('main.clear_selection')\"\n          @click=\"clearSelection\"\n        >\n          <x-icon :size=\"16\" />\n        </div>\n      </div>\n\n      <div class=\"flexrow action-bar\" v-if=\"selectedBar && !minimized\">\n        <div class=\"flexcolumn is-wide\" v-if=\"selectedBar === 'change-status'\">\n          <div class=\"flexrow mb05\">\n            <div class=\"flexrow-item change-status-item\">\n              <combobox-status\n                :with-margin=\"false\"\n                :task-status-list=\"availableTaskStatuses\"\n                v-model=\"taskStatusId\"\n              />\n            </div>\n            <div class=\"flexrow-item is-wide\">\n              <textarea\n                class=\"comment-text input w100\"\n                type=\"text\"\n                :placeholder=\"$t('comments.add_comment')\"\n                @keyup.ctrl.enter=\"confirmTaskStatusChange\"\n                @keyup.meta.enter=\"confirmTaskStatusChange\"\n                v-model=\"statusComment\"\n              />\n            </div>\n          </div>\n\n          <div class=\"flexrow-item is-wide\">\n            <button\n              class=\"button confirm-button is-wide\"\n              :class=\"{\n                'is-loading': loading.changeStatus\n              }\"\n              @click=\"confirmTaskStatusChange\"\n            >\n              {{\n                $tc('tasks.change_task_status', nbSelectedTasks, {\n                  nbSelectedTasks\n                })\n              }}\n            </button>\n          </div>\n        </div>\n\n        <div\n          class=\"flexcolumn flexrow-item is-wide\"\n          v-if=\"selectedBar === 'assignation'\"\n        >\n          <div class=\"mb05\" v-if=\"isCurrentUserArtist\">\n            {{ $tc('tasks.to_myself') }}\n          </div>\n          <div\n            class=\"mb05\"\n            v-else-if=\"isCurrentUserManager || isCurrentUserSupervisor\"\n          >\n            <people-field\n              class=\"is-wide assignation-field\"\n              ref=\"assignation-field\"\n              :people=\"currentTeam\"\n              :placeholder=\"$t('tasks.assign_explaination')\"\n              wide\n              v-model=\"person\"\n            />\n          </div>\n\n          <div class=\"flexrow-item mt1 mb1\" v-if=\"loading.assignation\">\n            <spinner :size=\"20\" class=\"spinner\" />\n          </div>\n          <div class=\"flexrow-item is-wide\" v-if=\"!loading.assignation\">\n            <button\n              class=\"button confirm-button is-wide\"\n              @click=\"confirmAssign\"\n            >\n              {{ $tc('tasks.assign', nbSelectedTasks, { nbSelectedTasks }) }}\n            </button>\n          </div>\n          <div class=\"flexrow-item mb05 disclaimer\">\n            <router-link\n              :to=\"{\n                name: 'team',\n                params: {\n                  production_id: currentProduction.id\n                }\n              }\"\n              target=\"_blank\"\n            >\n              {{ $t('tasks.assignation_disclaimer') }}\n            </router-link>\n          </div>\n          <div\n            class=\"flexrow-item is-wide flexrow\"\n            v-if=\"\n              !loading.assignation &&\n              (isCurrentUserManager || isSupervisorInDepartment)\n            \"\n          >\n            <div class=\"mauto flexrow\">\n              <button\n                class=\"button is-link clear-assignation-button filler\"\n                @click=\"clearAssignation\"\n              >\n                {{ $t('tasks.clear_assignations') }}\n              </button>\n              {{ $t('main.or') }}\n              <button\n                class=\"button is-link clear-assignation-button\"\n                @click=\"clearAllAssignations\"\n              >\n                {{ $t('tasks.clear_all_assignations') }}\n              </button>\n            </div>\n          </div>\n          <div\n            class=\"flexrow-item hide-small-screen\"\n            v-else-if=\"!loading.assignation && isCurrentUserArtist\"\n          >\n            <button\n              class=\"button is-link clear-assignation-button hide-small-screen\"\n              @click=\"clearAssignation\"\n            >\n              {{ $t('tasks.clear_own_assignations') }}\n            </button>\n          </div>\n          <div class=\"flexrow-item\" v-if=\"!isShowAssignations\">\n            {{ $t('tasks.assignation_warning') }}\n          </div>\n        </div>\n\n        <div class=\"flexcolumn filler\" v-if=\"selectedBar === 'priorities'\">\n          <div class=\"flexrow-item flexrow priority-combobox mb05\">\n            <div class=\"flexrow-item\">\n              {{ $t('tasks.change_priority_to') }}\n            </div>\n            <combobox-styled\n              class=\"flexrow-item\"\n              is-thin\n              :options=\"priorityOptions\"\n              v-model=\"priority\"\n            />\n          </div>\n          <div class=\"flexrow-item is-wide\">\n            <button\n              class=\"button confirm-button is-wide\"\n              :class=\"{\n                'is-loading': loading.changePriority\n              }\"\n              @click=\"confirmPriorityChange\"\n            >\n              {{\n                $tc('tasks.change_priority', nbSelectedTasks, {\n                  nbSelectedTasks\n                })\n              }}\n            </button>\n          </div>\n        </div>\n\n        <div class=\"flexrow is-wide\" v-if=\"selectedBar === 'create-tasks'\">\n          <button\n            class=\"button confirm-button is-wide\"\n            :class=\"{\n              'is-loading': loading.taskCreation\n            }\"\n            @click=\"confirmTaskCreation\"\n            v-if=\"nbSelectedTasks !== 1\"\n          >\n            {{ $t('tasks.create_for_selection') }}\n          </button>\n        </div>\n\n        <div class=\"flexrow-item is-wide\" v-if=\"selectedBar === 'thumbnails'\">\n          <button\n            class=\"button confirm-button is-wide\"\n            :class=\"{\n              'is-loading': loading.setThumbnails\n            }\"\n            @click=\"confirmSetThumbnailsFromTasks\"\n            v-if=\"nbSelectedTasks > 1\"\n          >\n            {{\n              $tc('tasks.set_thumbnails_from_tasks', nbSelectedTasks, {\n                nbSelectedTasks\n              })\n            }}\n          </button>\n          <div v-else>\n            <button\n              class=\"button confirm-button is-wide\"\n              :class=\"{\n                'is-loading':\n                  loading.setThumbnails || isSetFrameThumbnailLoading\n              }\"\n              @click=\"confirmSetThumbnailsFromTasks\"\n            >\n              {{ $t('tasks.set_preview') }}\n            </button>\n            <label class=\"is-inline-block mt05 pointer\" v-if=\"isMoviePreview\">\n              <input class=\"mr02\" type=\"checkbox\" v-model=\"isUseCurrentFrame\" />\n              {{ $t('tasks.use_current_frame') }}\n            </label>\n          </div>\n        </div>\n\n        <div class=\"flexcolumn filler\" v-if=\"selectedBar === 'subscribe'\">\n          <div v-if=\"loading.tasksSubscription\">\n            <div class=\"flexrow-item\">\n              <spinner :size=\"20\" class=\"spinner\" />\n            </div>\n            <div class=\"flexrow-item\">&nbsp;</div>\n          </div>\n\n          <div class=\"flexrow-item is-wide\" v-if=\"!loading.tasksSubscription\">\n            <button\n              class=\"button confirm-button is-wide\"\n              @click=\"confirmTasksSubscription\"\n            >\n              {{\n                $tc('tasks.subscribe_to_tasks', nbSelectedTasks, {\n                  nbSelectedTasks\n                })\n              }}\n            </button>\n          </div>\n          <div class=\"has-text-centered\" v-if=\"!loading.tasksSubscription\">\n            <button\n              class=\"button is-link filler\"\n              @click=\"confirmTasksUnsubscription\"\n            >\n              {{ $t('tasks.unsubscribe_notifications') }}\n            </button>\n          </div>\n        </div>\n\n        <div class=\"flexrow-item is-wide\" v-if=\"selectedBar === 'playlists'\">\n          <button\n            class=\"button confirm-button is-wide\"\n            @click=\"confirmPlaylistGeneration\"\n          >\n            {{ $t('playlists.create_for_selection') }}\n          </button>\n        </div>\n\n        <div\n          class=\"flexrow-item is-wide\"\n          v-if=\"selectedBar === 'edit-concepts'\"\n        >\n          <h3 class=\"mb05\">{{ $t('concepts.actions.title') }}</h3>\n          <ul class=\"tags mb05\">\n            <li v-if=\"!conceptLinkedEntities.length\">\n              <em>{{ $t('concepts.actions.empty') }}</em>\n            </li>\n            <template v-else>\n              <li\n                :key=\"entity.id\"\n                class=\"tag\"\n                @click=\"onRemoveLink(entity)\"\n                v-for=\"entity in conceptLinkedEntities\"\n              >\n                {{ entity.name }}\n              </li>\n            </template>\n          </ul>\n        </div>\n\n        <div class=\"flexrow-item is-wide\" v-if=\"selectedBar === 'delete-tasks'\">\n          <delete-entities\n            :error-text=\"$t('tasks.delete_for_selection_error')\"\n            :is-loading=\"loading.taskDeletion\"\n            :is-error=\"errors.taskDeletion\"\n            :require-hard-delete-confirmation=\"true\"\n            :hard-delete-lock-text=\"\n              $t('tasks.delete_for_selection_hard_lock_text')\n            \"\n            :hard-delete-text=\"$t('tasks.delete_for_selection_hard_text')\"\n            :text=\"\n              $tc('tasks.delete_for_selection', nbSelectedTasks, {\n                nbSelectedTasks\n              })\n            \"\n            @confirm=\"confirmTaskDeletion\"\n          />\n        </div>\n\n        <div class=\"flexcolumn filler\" v-if=\"selectedBar === 'custom-actions'\">\n          <div class=\"flexrow-item custom-action-combobox is-wide\">\n            <combobox-model\n              class=\"is-wide\"\n              :models=\"customActions\"\n              v-model=\"customAction\"\n            />\n          </div>\n\n          <div class=\"flexrow mt05\">\n            <div\n              class=\"flexrow-item is-wide\"\n              v-if=\"customAction && !customAction.is_ajax\"\n            >\n              <form target=\"_blank\" method=\"POST\" :action=\"customAction.url\">\n                <input\n                  type=\"hidden\"\n                  id=\"personid\"\n                  name=\"personid\"\n                  :value=\"user.id\"\n                />\n                <input\n                  type=\"hidden\"\n                  id=\"personemail\"\n                  name=\"personemail\"\n                  :value=\"user.email\"\n                />\n                <input\n                  type=\"hidden\"\n                  id=\"projectid\"\n                  name=\"projectid\"\n                  :value=\"productionId\"\n                />\n                <input\n                  type=\"hidden\"\n                  id=\"currentpath\"\n                  name=\"currentpath\"\n                  :value=\"currentUrl\"\n                />\n                <input\n                  type=\"hidden\"\n                  id=\"currentserver\"\n                  name=\"currentserver\"\n                  :value=\"currentHost\"\n                />\n                <input\n                  type=\"hidden\"\n                  id=\"selection\"\n                  name=\"selection\"\n                  :value=\"selectedTaskIds\"\n                />\n                <input\n                  type=\"hidden\"\n                  id=\"entitytype\"\n                  name=\"entitytype\"\n                  :value=\"currentEntityType\"\n                />\n                <button class=\"button is-wide\" type=\"submit\">\n                  {{\n                    $tc('custom_actions.run_for_selection', nbSelectedTasks, {\n                      nbSelectedTasks\n                    })\n                  }}\n                </button>\n              </form>\n            </div>\n            <div class=\"flexrow-item is-wide\" v-else>\n              <button class=\"button is-wide\" @click=\"runCustomAction\">\n                {{\n                  $tc('custom_actions.run_for_selection', nbSelectedTasks, {\n                    nbSelectedTasks\n                  })\n                }}\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <div\n          class=\"flexrow-item is-wide\"\n          v-if=\"selectedBar === 'delete-assets'\"\n        >\n          <delete-entities\n            :error-text=\"$t('assets.multiple_delete_error')\"\n            :is-loading=\"loading.assetDeletion\"\n            :is-error=\"errors.assetDeletion\"\n            :text=\"\n              $tc('assets.delete_for_selection', nbSelectedAssets, {\n                nbSelectedAssets\n              })\n            \"\n            :require-hard-delete-confirmation=\"allAssetsCanceled\"\n            :hard-delete-lock-text=\"\n              $tc('assets.delete_for_selection_hard_lock_text')\n            \"\n            :hard-delete-text=\"$tc('assets.delete_for_selection_hard_text')\"\n            @confirm=\"confirmAssetDeletion\"\n          />\n        </div>\n\n        <div class=\"flexrow-item is-wide\" v-if=\"selectedBar === 'delete-shots'\">\n          <delete-entities\n            :error-text=\"$t('shots.multiple_delete_error')\"\n            :is-loading=\"loading.shotDeletion\"\n            :is-error=\"errors.deleteShot\"\n            :text=\"\n              $tc('shots.delete_for_selection', nbSelectedShots, {\n                nbSelectedShots\n              })\n            \"\n            :require-hard-delete-confirmation=\"allShotsCanceled\"\n            :hard-delete-lock-text=\"\n              $t('shots.delete_for_selection_hard_lock_text')\n            \"\n            :hard-delete-text=\"$t('shots.delete_for_selection_hard_text')\"\n            @confirm=\"confirmShotDeletion\"\n          />\n        </div>\n\n        <div class=\"flexrow-item is-wide\" v-if=\"selectedBar === 'delete-edits'\">\n          <delete-entities\n            :error-text=\"$t('edits.multiple_delete_error')\"\n            :is-loading=\"loading.editDeletion\"\n            :is-error=\"errors.deleteEdit\"\n            :text=\"\n              $tc('edits.delete_for_selection', nbSelectedEdits, {\n                nbSelectedEdits\n              })\n            \"\n            :require-hard-delete-confirmation=\"allEditsCanceled\"\n            :hard-delete-lock-text=\"\n              $t('edits.delete_for_selection_hard_lock_text')\n            \"\n            :hard-delete-text=\"$t('edits.delete_for_selection_hard_text')\"\n            @confirm=\"confirmEditDeletion\"\n          />\n        </div>\n\n        <div\n          class=\"flexrow-item is-wide\"\n          v-if=\"selectedBar === 'delete-episodes'\"\n        >\n          <delete-entities\n            :error-text=\"$t('episodes.multiple_delete_error')\"\n            :is-loading=\"loading.episodeDeletion\"\n            :is-error=\"errors.deleteEpisode\"\n            :text=\"\n              $tc('episodes.delete_for_selection', nbSelectedEpisodes, {\n                nbSelectedEpisodes\n              })\n            \"\n            :require-hard-delete-confirmation=\"true\"\n            @confirm=\"confirmEpisodeDeletion\"\n          />\n        </div>\n\n        <div\n          class=\"flexrow-item is-wide\"\n          v-if=\"selectedBar === 'delete-concepts'\"\n        >\n          <delete-entities\n            :error-text=\"$t('concepts.multiple_delete_error')\"\n            :is-loading=\"loading.episodeDeletion\"\n            :is-error=\"errors.deleteEpisode\"\n            :text=\"\n              $tc('concepts.delete_for_selection', nbSelectedConcepts, {\n                nbSelectedConcepts\n              })\n            \"\n            :require-hard-delete-confirmation=\"true\"\n            :hard-delete-lock-text=\"\n              $t('concepts.delete_for_selection_hard_lock_text')\n            \"\n            :hard-delete-text=\"$t('concepts.delete_for_selection_hard_text')\"\n            @confirm=\"confirmConceptDeletion\"\n          />\n        </div>\n      </div>\n    </div>\n\n    <div\n      class=\"flexrow-item is-wide pa1\"\n      v-if=\"selectedBar === 'edit-concepts'\"\n    >\n      <div ref=\"asset-list\" class=\"concept-links\">\n        <h2 class=\"subtitle\">{{ $t('concepts.add_links') }}</h2>\n        <div class=\"flexrow mb2\">\n          <search-field\n            ref=\"entity-search-field\"\n            @change=\"onEntitySearchChange\"\n          />\n          <button-simple\n            class=\"flexrow-item\"\n            :title=\"$t('entities.build_filter.title')\"\n            icon=\"filter\"\n            @click=\"modals.buildFilter = true\"\n          />\n        </div>\n        <spinner v-if=\"loading.links\" />\n        <div class=\"link-list\" v-else>\n          <ul\n            class=\"link-types\"\n            :key=\"`link-types-${index}`\"\n            v-for=\"(linkGroup, index) in availableLinksByType\"\n          >\n            <li class=\"link-type\">\n              <h4 class=\"subtitle\">\n                {{ linkGroup.type }}\n              </h4>\n              <ul class=\"tags\">\n                <li\n                  class=\"tag\"\n                  :key=\"link.id\"\n                  @click=\"onSelectLink(link)\"\n                  v-for=\"link in linkGroup.links\"\n                >\n                  {{ link.name }}\n                </li>\n              </ul>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <build-filter-modal\n      :active=\"modals.buildFilter\"\n      @confirm=\"confirmBuildFilter\"\n      @cancel=\"modals.buildFilter = false\"\n      v-if=\"isCurrentViewConcept\"\n    />\n\n    <view-playlist-modal\n      :active=\"modals.playlist\"\n      :task-ids=\"selectedTaskIds\"\n      sort\n      @cancel=\"hidePlaylistModal\"\n    />\n  </div>\n</template>\n\n<script>\nimport {\n  CheckSquareIcon,\n  LinkIcon,\n  PlayCircleIcon,\n  XIcon\n} from 'lucide-vue-next'\nimport { mapGetters, mapActions } from 'vuex'\n\nimport assetsStore from '@/store/modules/assets.js'\nimport { intersection } from '@/lib/array'\nimport func from '@/lib/func'\n\nimport BuildFilterModal from '@/components/modals/BuildFilterModal.vue'\nimport ButtonSimple from '@/components/widgets/ButtonSimple.vue'\nimport ComboboxModel from '@/components/widgets/ComboboxModel.vue'\nimport ComboboxStatus from '@/components/widgets/ComboboxStatus.vue'\nimport ComboboxStyled from '@/components/widgets/ComboboxStyled.vue'\nimport DeleteEntities from '@/components/tops/actions/DeleteEntities.vue'\nimport KitsuIcon from '@/components/widgets/KitsuIcon.vue'\nimport PeopleField from '@/components/widgets/PeopleField.vue'\nimport SearchField from '@/components/widgets/SearchField.vue'\nimport Spinner from '@/components/widgets/Spinner.vue'\nimport ViewPlaylistModal from '@/components/modals/ViewPlaylistModal.vue'\n\nexport default {\n  name: 'action-panel',\n\n  props: {\n    isMoviePreview: {\n      type: Boolean,\n      default: false\n    },\n    isSetFrameThumbnailLoading: {\n      type: Boolean,\n      default: false\n    },\n    productionId: {\n      type: String,\n      default: null\n    },\n    team: {\n      type: Array,\n      default: () => []\n    }\n  },\n\n  components: {\n    BuildFilterModal,\n    ButtonSimple,\n    CheckSquareIcon,\n    ComboboxModel,\n    ComboboxStatus,\n    ComboboxStyled,\n    DeleteEntities,\n    KitsuIcon,\n    LinkIcon,\n    PeopleField,\n    PlayCircleIcon,\n    SearchField,\n    Spinner,\n    ViewPlaylistModal,\n    XIcon\n  },\n\n  emits: ['export-task', 'set-frame-thumbnail'],\n\n  data() {\n    return {\n      availableTaskStatuses: [],\n      customAction: {},\n      customActions: [],\n      isUseCurrentFrame: false,\n      person: null,\n      priority: '0',\n      selectedBar: '',\n      taskStatusId: '',\n      statusComment: '',\n      modals: {\n        buildFilter: false,\n        playlist: false\n      },\n      priorityOptions: [\n        {\n          label: this.$t('tasks.priority.normal'),\n          value: '0'\n        },\n        {\n          label: this.$t('tasks.priority.high'),\n          value: '1'\n        },\n        {\n          label: this.$t('tasks.priority.very_high'),\n          value: '2'\n        },\n        {\n          label: this.$t('tasks.priority.emergency'),\n          value: '3'\n        }\n      ],\n      loading: {\n        assignation: false,\n        assetDeletion: false,\n        changePriority: false,\n        changeStatus: false,\n        conceptDeletion: false,\n        editDeletion: false,\n        episodeDeletion: false,\n        taskCreation: false,\n        taskDeletion: false,\n        setThumbnails: false,\n        shotDeletion: false,\n        links: false,\n        tasksSubscription: false\n      },\n      errors: {\n        assetDeletion: false,\n        taskDeletion: false,\n        conceptDeletion: false,\n        editDeletion: false,\n        episodeDeletion: false,\n        shotDeletion: false\n      }\n    }\n  },\n\n  mounted() {\n    this.customAction = this.defaultCustomAction\n  },\n\n  beforeUnmount() {\n    window.removeEventListener('keydown', this.onKeyDown)\n  },\n\n  computed: {\n    ...mapGetters([\n      'assetsByType',\n      'currentProduction',\n      'getCustomActionsByType',\n      'isCurrentUserArtist',\n      'isCurrentUserClient',\n      'isCurrentUserManager',\n      'isCurrentUserSupervisor',\n      'isShowAssignations',\n      'nbSelectedTasks',\n      'nbSelectedValidations',\n      'productionMap',\n      'selectedAssets',\n      'selectedConcepts',\n      'selectedEdits',\n      'selectedShots',\n      'selectedTasks',\n      'taskMap',\n      'taskStatusForCurrentUser',\n      'taskTypeMap',\n      'user'\n    ]),\n\n    assetMap() {\n      return assetsStore.cache.assetMap\n    },\n\n    minimized() {\n      return this.selectedBar === ''\n    },\n\n    currentUrl() {\n      return this.$route.path\n    },\n\n    currentHost() {\n      return window.location.host\n    },\n\n    currentEntityType() {\n      if (this.isCurrentViewAsset) return 'asset'\n      if (this.isCurrentViewShot) return 'shot'\n      if (this.isCurrentViewSequence) return 'sequence'\n      if (this.isCurrentViewEdit) return 'edit'\n      return 'episode'\n    },\n\n    currentConcept() {\n      return this.selectedConcepts.values().next().value\n    },\n\n    conceptLinkedEntities() {\n      return this.getLinkedEntities(this.currentConcept)\n    },\n\n    currentTeam() {\n      const isSupervisorWithDepartments =\n        this.isCurrentUserSupervisor && this.user.departments.length > 0\n\n      return this.team.filter(person => {\n        if (!person?.is_bot) {\n          if (isSupervisorWithDepartments) {\n            return (\n              person.departments.length === 0 ||\n              person.departments.some(department =>\n                this.user.departments.includes(department)\n              )\n            )\n          }\n          return true\n        }\n        return false\n      })\n    },\n\n    defaultCustomAction() {\n      return this.customActions?.[0] ?? {}\n    },\n\n    isTaskSelection() {\n      return this.nbSelectedTasks > 0\n    },\n\n    isEntitySelection() {\n      return (\n        this.selectedAssets.size > 0 ||\n        this.selectedShots.size > 0 ||\n        this.selectedEdits.size > 0\n      )\n    },\n\n    nbSelectedAssets() {\n      return this.selectedAssets.size\n    },\n\n    nbSelectedShots() {\n      return this.selectedShots.size\n    },\n\n    nbSelectedEdits() {\n      return this.selectedEdits.size\n    },\n\n    nbSelectedConcepts() {\n      return this.selectedConcepts.size\n    },\n\n    allAssetsCanceled() {\n      return Array.from(this.selectedAssets.values()).every(\n        asset => asset.canceled\n      )\n    },\n\n    allShotsCanceled() {\n      const allShotsCanceled = Array.from(this.selectedShots.values()).every(\n        shot => shot.canceled\n      )\n      return allShotsCanceled\n    },\n\n    allEditsCanceled() {\n      return Array.from(this.selectedEdits.values()).every(\n        edit => edit.canceled\n      )\n    },\n\n    isHidden() {\n      return (\n        (this.nbSelectedTasks === 0 &&\n          this.nbSelectedValidations === 0 &&\n          this.nbSelectedAssets === 0 &&\n          this.nbSelectedShots === 0 &&\n          this.nbSelectedEdits === 0 &&\n          this.nbSelectedConcepts === 0) ||\n        !(\n          this.isCurrentViewAsset ||\n          this.isCurrentViewTodos ||\n          this.isCurrentViewShot ||\n          this.isCurrentViewEpisode ||\n          this.isCurrentViewSequence ||\n          this.isCurrentViewEdit ||\n          this.isCurrentViewConcept\n        )\n      )\n    },\n\n    isConceptPublisher() {\n      return this.currentConcept?.created_by === this.user.id\n    },\n\n    isCurrentViewSingleEntity() {\n      return [\n        'asset',\n        'shot',\n        'edit',\n        'episode',\n        'sequence',\n        'episode-asset',\n        'episode-shot',\n        'episode-edit',\n        'episode-sequence'\n      ].includes(this.$route.name)\n    },\n\n    isCurrentViewAsset() {\n      return this.$route.path.includes('asset') && !this.$route.params.shot_id\n    },\n\n    isCurrentViewShot() {\n      return this.$route.path.includes('shot') && !this.$route.params.shot_id\n    },\n\n    isCurrentViewEdit() {\n      return this.$route.path.includes('edit') && !this.$route.params.edit_id\n    },\n\n    isCurrentViewConcept() {\n      return this.$route.path.includes('concept')\n    },\n\n    isCurrentViewTodos() {\n      return (\n        this.$route.path.includes('my-tasks') ||\n        this.$route.path.includes('people/')\n      )\n    },\n\n    isCurrentViewPerson() {\n      return this.$route.path.includes('people/')\n    },\n\n    isCurrentViewTaskType() {\n      return this.$route.path.includes('task-type')\n    },\n\n    isCurrentViewEntity() {\n      return (\n        this.isCurrentViewAsset ||\n        this.isCurrentViewShot ||\n        this.isCurrentViewEdit ||\n        this.isCurrentViewSequence ||\n        this.isCurrentViewEpisode\n      )\n    },\n\n    isCurrentViewEpisode() {\n      return (\n        !(\n          this.isCurrentViewAsset ||\n          this.isCurrentViewShot ||\n          this.isCurrentViewEdit\n        ) && this.$route.path.includes('episodes')\n      )\n    },\n\n    isCurrentViewSequence() {\n      return (\n        !(\n          this.isCurrentViewAsset ||\n          this.isCurrentViewShot ||\n          this.isCurrentViewEdit\n        ) && this.$route.path.includes('sequences')\n      )\n    },\n\n    selectedPersonId() {\n      return this.person ? this.person.id : null\n    },\n\n    selectedTaskIds() {\n      return Array.from(this.selectedTasks.keys())\n    },\n\n    isInDepartment() {\n      return this.selectedTaskIds.every(taskId => {\n        const task = this.taskMap.get(taskId)\n        if (task) {\n          const taskType = this.taskTypeMap.get(task.task_type_id)\n          return (\n            taskType.department_id &&\n            this.user.departments.includes(taskType.department_id)\n          )\n        } else {\n          return true // We are in the artist todolist.\n        }\n      })\n    },\n\n    isSupervisorInDepartment() {\n      return (\n        this.isCurrentUserSupervisor &&\n        (this.user.departments.length === 0 || this.isInDepartment)\n      )\n    },\n\n    storagePrefix() {\n      let prefix = 'todos-'\n      if (\n        this.isCurrentViewAsset ||\n        this.isCurrentViewShot ||\n        this.isCurrentViewEdit\n      ) {\n        prefix = 'entities-'\n      }\n      if (this.isCurrentViewConcept) prefix = 'concepts-'\n      if (this.isCurrentViewTaskType) prefix = 'tasks-'\n      return prefix\n    },\n\n    availableLinksByType() {\n      const assetGroups = [...this.assetsByType]\n      const result = assetGroups\n        .map(assets => {\n          if (!assets.length) return\n          const links = assets\n            .filter(\n              asset =>\n                !this.conceptLinkedEntities.some(\n                  entity => entity.id === asset.id\n                )\n            )\n            .map(asset => ({\n              id: asset.id,\n              name: asset.name\n            }))\n          return {\n            type: assets[0].asset_type_name,\n            links\n          }\n        })\n        .filter(Boolean)\n      return result\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'assignSelectedTasks',\n      'changeSelectedTaskStatus',\n      'changeSelectedPriorities',\n      'clearSelectedAssets',\n      'clearSelectedShots',\n      'clearSelectedEdits',\n      'clearSelectedConcepts',\n      'clearSelectedTasks',\n      'createSelectedTasks',\n      'deleteSelectedAssets',\n      'deleteSelectedShots',\n      'deleteSelectedTasks',\n      'deleteSelectedEdits',\n      'deleteSelectedEpisodes',\n      'deleteSelectedConcepts',\n      'editConcept',\n      'loadAssets',\n      'postCustomAction',\n      'setAssetSearch',\n      'setLastTaskPreview',\n      'subscribeToTask',\n      'unassignPersonFromTask',\n      'unassignSelectedTasks',\n      'unsubscribeFromTask'\n    ]),\n\n    getLinkedEntities(concept) {\n      return concept.entity_concept_links\n        .map(id => this.assetMap.get(id))\n        .filter(Boolean)\n    },\n\n    confirmTaskStatusChange() {\n      this.loading.changeStatus = true\n      if (!this.taskStatusId) {\n        this.taskStatusId = this.availableTaskStatuses[0].id\n      }\n      this.changeSelectedTaskStatus({\n        taskStatusId: this.taskStatusId,\n        comment: this.statusComment\n      })\n        .then(() => {\n          this.statusComment = ''\n          this.loading.changeStatus = false\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.changeStatus = false\n        })\n    },\n\n    async confirmAssign() {\n      if (this.selectedPersonId || this.isInDepartment) {\n        const personId =\n          this.isCurrentUserManager || this.isCurrentUserSupervisor\n            ? this.selectedPersonId\n            : this.user.id\n        this.loading.assignation = true\n        try {\n          await this.assignSelectedTasks({ personId })\n          this.$refs['assignation-field']?.clear()\n        } catch (err) {\n          console.error(err)\n        } finally {\n          this.loading.assignation = false\n        }\n      }\n    },\n\n    clearAssignation() {\n      const person = this.isCurrentUserArtist ? this.user : this.person\n      if (person) {\n        this.loading.assignation = true\n        func\n          .runPromiseAsSeries(\n            Array.from(this.selectedTasks.values()).map(task => {\n              return this.unassignPersonFromTask({ task, person })\n            })\n          )\n          .then(() => {\n            this.loading.assignation = false\n          })\n          .catch(console.error)\n      }\n    },\n\n    clearAllAssignations() {\n      this.loading.assignation = true\n      return this.unassignSelectedTasks({})\n        .then(() => {\n          this.loading.assignation = false\n        })\n        .catch(console.error)\n    },\n\n    async confirmPriorityChange() {\n      this.loading.changePriority = true\n      await this.changeSelectedPriorities({\n        priority: Number(this.priority)\n      })\n      this.loading.changePriority = false\n    },\n\n    confirmTaskCreation() {\n      const type = this.$route.path.includes('shots')\n        ? 'shots'\n        : this.$route.path.includes('assets')\n          ? 'assets'\n          : this.$route.path.includes('edits')\n            ? 'edits'\n            : 'episodes'\n      this.loading.taskCreation = true\n      this.createSelectedTasks({\n        type,\n        projectId: this.productionId\n      })\n        .then(() => {\n          this.loading.taskCreation = false\n        })\n        .catch(err => {\n          this.loading.taskCreation = false\n          console.error(err)\n        })\n    },\n\n    confirmTaskDeletion() {\n      this.loading.taskDeletion = true\n      this.errors.taskDeletion = false\n      this.deleteSelectedTasks()\n        .then(() => {\n          this.loading.taskDeletion = false\n          this.clearSelectedTasks()\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.taskDeletion = false\n          this.errors.taskDeletion = true\n        })\n    },\n\n    confirmAssetDeletion() {\n      this.loading.deleteAsset = true\n      this.errors.deleteAsset = false\n      this.deleteSelectedAssets()\n        .then(() => {\n          this.loading.deleteAsset = false\n          this.clearSelectedAssets()\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.deleteAsset = false\n          this.errors.deleteAsset = true\n        })\n    },\n\n    confirmShotDeletion() {\n      this.loading.deleteShot = true\n      this.errors.deleteShot = false\n      this.deleteSelectedShots()\n        .then(() => {\n          this.loading.deleteShot = false\n          this.clearSelectedShots()\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.deleteShot = false\n          this.errors.deleteShot = true\n        })\n    },\n\n    confirmEditDeletion() {\n      this.loading.deleteEdit = true\n      this.errors.deleteEdit = false\n      this.deleteSelectedEdits()\n        .then(() => {\n          this.loading.deleteEdit = false\n          this.clearSelectedEdits()\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.deleteEdit = false\n          this.errors.deleteEdit = true\n        })\n    },\n\n    confirmConceptDeletion() {\n      this.loading.deleteConcept = true\n      this.errors.deleteConcept = false\n      this.deleteSelectedConcepts()\n        .then(() => {\n          this.loading.deleteConcept = false\n          this.clearSelectedConcepts()\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.deleteConcept = false\n          this.errors.deleteConcept = true\n        })\n    },\n\n    confirmPlaylistGeneration() {\n      this.modals.playlist = true\n      this.selectedBar = ''\n    },\n\n    confirmTasksSubscription() {\n      this.loading.tasksSubscription = true\n      func\n        .runPromiseAsSeries(\n          Array.from(this.selectedTasks.values()).map(task => {\n            return this.subscribeToTask(task.id)\n          })\n        )\n        .then(() => {\n          this.loading.tasksSubscription = false\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.tasksSubscription = false\n          this.errors.tasksSubscription = false\n        })\n    },\n\n    confirmTasksUnsubscription() {\n      this.loading.tasksSubscription = true\n      func\n        .runPromiseAsSeries(\n          Array.from(this.selectedTasks.values()).map(task => {\n            return this.unsubscribeFromTask(task.id)\n          })\n        )\n        .then(() => {\n          this.loading.tasksSubscription = false\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.tasksSubscription = false\n          this.errors.tasksSubscription = false\n        })\n    },\n\n    hidePlaylistModal() {\n      this.modals.playlist = false\n    },\n\n    confirmSetThumbnailsFromTasks() {\n      this.loading.setThumbnails = true\n      if (this.nbSelectedTasks === 1) {\n        this.$emit(\n          'set-frame-thumbnail',\n          this.isMoviePreview && this.isUseCurrentFrame\n        )\n        this.loading.setThumbnails = false\n      } else {\n        func\n          .runPromiseAsSeries(\n            Array.from(this.selectedTasks.values()).map(task => {\n              return this.setLastTaskPreview(task.id)\n            })\n          )\n          .then(() => {\n            this.loading.setThumbnails = false\n          })\n      }\n    },\n\n    runCustomAction() {\n      this.postCustomAction({\n        data: {\n          entitytype: this.currentEntityType,\n          originurl: this.currentUrl,\n          originserver: this.currentHost,\n          selection: this.selectedTaskIds,\n          productionid: this.productionId,\n          userid: this.user.id,\n          useremail: this.user.email\n        },\n        url: this.customAction.url\n      })\n    },\n\n    onKeyDown(event) {\n      if (event.keyCode === 27) {\n        if (!this.modals.playlist) {\n          this.$store.commit('CLEAR_SELECTED_TASKS')\n        }\n      }\n    },\n\n    clearSelection() {\n      this.clearSelectedAssets()\n      this.clearSelectedShots()\n      this.clearSelectedTasks()\n      this.clearSelectedEdits()\n      this.clearSelectedConcepts()\n    },\n\n    selectBar(barName) {\n      localStorage.setItem(`${this.storagePrefix}-selected-bar`, barName)\n      if (this.selectedBar !== barName) {\n        this.selectedBar = barName\n      } else {\n        this.selectedBar = ''\n      }\n    },\n\n    autoChooseSelectBar() {\n      if (!this.isHidden) {\n        window.addEventListener('keydown', this.onKeyDown)\n        if (this.isCurrentViewAsset && this.nbSelectedAssets > 0) {\n          this.selectedBar = 'delete-assets'\n          return\n        }\n        if (this.isCurrentViewShot && this.nbSelectedShots > 0) {\n          this.selectedBar = 'delete-shots'\n          return\n        }\n        if (this.isCurrentViewEdit && this.nbSelectedEdits > 0) {\n          this.selectedBar = 'delete-edits'\n          return\n        }\n        if (this.isCurrentViewConcept && this.nbSelectedConcepts > 1) {\n          this.selectedBar = 'delete-concepts'\n          return\n        }\n        if (this.nbSelectedTasks === 1) {\n          this.selectedBar = ''\n        }\n\n        const lastSelection = localStorage.getItem(\n          `${this.storagePrefix}-selected-bar`\n        )\n        if (lastSelection) {\n          this.selectedBar = lastSelection\n        } else if (\n          this.isCurrentViewAsset ||\n          this.isCurrentViewShot ||\n          this.isCurrentViewEdit\n        ) {\n          this.selectedBar = 'change-status'\n        }\n      } else {\n        window.removeEventListener('keydown', this.onKeyDown)\n      }\n    },\n\n    setAvailableStatuses() {\n      let availableTaskStatuses\n      if (this.selectedTasks.size === 0) {\n        availableTaskStatuses = []\n      } else if (this.isCurrentViewTodos) {\n        const statusLists = Array.from(this.selectedTasks.values())\n          .map(task => this.productionMap.get(task.project_id)?.task_statuses)\n          .filter(Boolean)\n        const availableStatus = new Set(intersection(statusLists))\n        availableTaskStatuses = this.taskStatusForCurrentUser.filter(status =>\n          availableStatus.has(status.id)\n        )\n      } else {\n        availableTaskStatuses = this.taskStatusForCurrentUser\n      }\n      availableTaskStatuses = availableTaskStatuses.filter(\n        status => Boolean(status.for_concept) === this.isCurrentViewConcept\n      )\n      this.availableTaskStatuses = availableTaskStatuses\n    },\n\n    onRemoveLink(link) {\n      const concept = {\n        id: this.currentConcept.id,\n        entity_concept_links: this.currentConcept.entity_concept_links.filter(\n          id => id !== link.id\n        )\n      }\n      this.editConcept(concept)\n    },\n\n    confirmBuildFilter(query) {\n      this.modals.buildFilter = false\n      this.$refs['entity-search-field'].setValue(query)\n      this.onEntitySearchChange(query)\n    },\n\n    onEntitySearchChange(searchQuery) {\n      this.setAssetSearch(searchQuery)\n    },\n\n    onSelectLink(link) {\n      const concept = {\n        id: this.currentConcept.id,\n        entity_concept_links: [\n          ...this.currentConcept.entity_concept_links\n        ].concat(link.id)\n      }\n      this.editConcept(concept)\n    }\n  },\n\n  watch: {\n    nbSelectedAssets() {\n      this.autoChooseSelectBar()\n      if (this.nbSelectedAssets > 0) this.clearSelectedTasks()\n    },\n\n    nbSelectedShots() {\n      this.autoChooseSelectBar()\n      if (this.nbSelectedShots > 0) this.clearSelectedTasks()\n    },\n\n    nbSelectedEdits() {\n      this.autoChooseSelectBar()\n      if (this.nbSelectedEdits > 0) this.clearSelectedTasks()\n    },\n\n    nbSelectedConcepts() {\n      this.autoChooseSelectBar()\n      if (this.nbSelectedConcepts > 1) this.clearSelectedTasks()\n    },\n\n    isHidden() {\n      this.autoChooseSelectBar()\n    },\n\n    nbSelectedTasks: {\n      immediate: true,\n      handler() {\n        if (this.nbSelectedTasks > 0) {\n          this.setAvailableStatuses()\n\n          const selectedTypes = {\n            Asset: false,\n            Shot: false,\n            Sequence: false,\n            Edit: false,\n            Episode: false\n          }\n          this.selectedTasks.forEach(task => {\n            const type = this.taskTypeMap.get(task.task_type_id)\n            selectedTypes[type?.for_entity] = true\n          })\n\n          this.customActions = this.getCustomActionsByType(\n            selectedTypes.Asset,\n            selectedTypes.Shot,\n            selectedTypes.Sequence,\n            selectedTypes.Edit,\n            selectedTypes.Episode\n          )\n\n          if (this.customActions.length > 0) {\n            const isUrlSelected =\n              this.customAction.url &&\n              this.customActions.findIndex(action => {\n                return action.id === this.customAction.id\n              }) >= 0\n\n            if (!isUrlSelected) {\n              this.customAction = this.customActions[0]\n            }\n          }\n\n          if (this.nbSelectedTasks === 1) {\n            this.lastSelectedBar = this.selectedBar\n            this.selectedBar === ''\n          } else if (this.lastSelectedBar) {\n            this.selectedBar === this.lastSelectedBar\n          }\n        }\n      }\n    },\n\n    $route(oldRoute, newRoute) {\n      if (oldRoute.name !== newRoute.name) {\n        if (this.nbSelectedTasks > 0) {\n          this.clearSelectedTasks()\n        }\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.dark {\n  .action-topbar {\n    background: $dark-grey-light;\n\n    .menu {\n      background: $black;\n      border-bottom: 1px solid $dark-grey-light;\n    }\n\n    .action-bar {\n      border-bottom: 1px solid $dark-grey-light;\n    }\n  }\n\n  .concept-links {\n    background: $dark-grey-light;\n    border: 1px solid #222;\n    box-shadow: 0 0 6px #222;\n  }\n}\n\n.action-topbar {\n  background: #f4f4ff;\n  color: $grey;\n  z-index: 1000;\n}\n\n.hidden {\n  display: none;\n}\n\n.clear-assignation-button {\n  margin: auto;\n}\n.clear-assignation-button:focus,\n.clear-assignation-button:active,\n.clear-assignation-button:hover {\n  box-shadow: none;\n  background: transparent;\n}\n\n.menu {\n  color: var(--text);\n  padding-top: 0.7em;\n  border-bottom: 1px solid $light-grey-light;\n  background: #fcfcff;\n  overflow-x: auto;\n  overflow-y: hidden;\n}\n\n.menu-item {\n  cursor: pointer;\n  font-size: 0.9em;\n  transform: scale(0.9);\n  padding: 0.2em 0.6em 0.4em 0.6em;\n\n  > img {\n    max-width: none;\n  }\n\n  &:hover {\n    transform: scale(1.1);\n    transition: transform ease 0.3s;\n  }\n\n  &.active {\n    color: var(--text-selected);\n\n    &:hover {\n      color: var(--text-selected);\n    }\n  }\n}\n\n.action-bar {\n  padding: 0.5em 0.5em;\n  border-bottom: 1px solid $light-grey-light;\n}\n\n.button {\n  border-radius: 6px;\n}\n\n.comment-text {\n  border-radius: 10px;\n  height: 43px;\n  min-height: 43px;\n  padding: 8px;\n}\n\n.priority-combobox {\n  color: var(--text);\n  margin-left: 0.3em;\n}\n\n.menu-separator {\n  padding: 0.2em;\n  border-right: 2px solid $light-grey-light;\n  height: 26px;\n  margin-bottom: 8px;\n}\n\n.is-wide {\n  margin: 0;\n  flex: 1;\n  width: 100%;\n}\n\n.is-link {\n  color: var(--text);\n}\n\n.change-status-item {\n  margin-right: 0.5em;\n}\n\n.status-item {\n  align-items: center;\n  border: 2px solid var(--text);\n  border-radius: 15px;\n  color: var(--text);\n  font-weight: bold;\n  display: flex;\n  font-size: 0.7em;\n  justify-content: center;\n  height: 100%;\n  margin-left: 1em;\n  margin-top: -1em;\n  padding-top: 0.3em;\n  text-transform: uppercase;\n\n  &.active {\n    border: 2px solid var(--text-selected);\n    color: var(--text-selected);\n  }\n}\n\n.spinner {\n  margin: auto;\n  margin-top: 0.5em;\n}\n\n.disclaimer {\n  font-size: 0.8em;\n  font-style: italic;\n  text-align: center;\n}\n\n.tags {\n  display: inline-flex;\n  flex-wrap: wrap;\n  gap: 10px;\n  margin-left: 0;\n  min-height: 21px;\n  font-weight: 500;\n  letter-spacing: 1px;\n\n  .tag {\n    cursor: pointer;\n    display: inline-flex;\n    gap: 1em;\n    border: 1px solid $light-green;\n    transition: transform 0.1s linear;\n\n    .action {\n      border-radius: 50%;\n      display: none;\n      height: 14px;\n      width: 14px;\n      line-height: 8px;\n    }\n\n    &:hover {\n      transform: scale(1.1);\n\n      .action {\n        display: inline-block;\n      }\n    }\n  }\n}\n\n.concept-links {\n  overflow-y: auto;\n  padding: 1em;\n  background: $white;\n  border: 1px solid $white-grey;\n  box-shadow: 0 0 6px #e0e0e0;\n  border-radius: 1em;\n\n  .subtitle {\n    margin-top: 0;\n    border-bottom: 0;\n  }\n\n  .link-types {\n    list-style: none;\n    margin-left: 0;\n  }\n\n  .link-list {\n    height: 300px;\n    overflow-y: auto;\n  }\n\n  .link-type {\n    .subtitle {\n      text-transform: uppercase;\n      color: $grey;\n      border-bottom: 1px solid $light-grey;\n      font-size: 1.2em;\n      margin-top: 1em;\n      margin-bottom: 1em;\n    }\n\n    .tag {\n      border-color: $light-grey;\n      cursor: pointer;\n      transition: transform 0.1s linear;\n\n      &:hover {\n        transform: scale(1.1);\n      }\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"side-wrapper\">\n    <div\n      class=\"extend-bar\"\n      @mousedown.prevent=\"onExtendDown\"\n      @touchstart.prevent=\"onExtendDown\"\n      v-if=\"extendable\"\n    ></div>\n    <div class=\"side task-info\">\n      <action-panel\n        v-if=\"\n          withActions &&\n          (!isConceptTask || selectedConcepts.size > 0) &&\n          (nbSelectedEntities > 0 ||\n            nbSelectedTasks > 0 ||\n            nbSelectedValidations > 0)\n        \"\n        :is-movie-preview=\"isMoviePreview\"\n        :is-set-frame-thumbnail-loading=\"loading.setFrameThumbnail\"\n        :production-id=\"currentProductionId\"\n        :team=\"currentTeam\"\n        @export-task=\"onExportClick\"\n        @set-frame-thumbnail=\"onSetCurrentFrameAsThumbnail\"\n      />\n\n      <div\n        class=\"multi-selection-info pa1\"\n        v-if=\"\n          withActions &&\n          ((nbSelectedTasks || 0) > 1 || nbSelectedValidations > 0)\n        \"\n      >\n        <h1 class=\"title\">\n          {{ $tc('tasks.selected_tasks') }}\n          ({{ nbSelectedTasks }})\n        </h1>\n        <div class=\"task-list mt1\">\n          <div\n            class=\"selected-task-line flexrow\"\n            :key=\"task.id\"\n            v-for=\"task in selectedTasksToDisplay\"\n          >\n            <task-type-name\n              class=\"flexrow-item task-type\"\n              :task-type=\"taskTypeMap.get(task.task_type_id)\"\n              :production-id=\"task.project_id\"\n            />\n            <span class=\"flexrow-item\">{{ task.entity_name }}</span>\n            <span\n              class=\"flexrow-item pointer\"\n              @click=\"removeTaskFromSelection(task)\"\n            >\n              <x-icon :size=\"12\" />\n            </span>\n          </div>\n          <div class=\"mt2 selected-task-line\" v-if=\"nbSelectedValidations > 0\">\n            <span v-if=\"nbSelectedTasks > 0\">+</span>\n            {{ nbSelectedValidations }}\n            {{ $tc('tasks.empty_cells_selected', nbSelectedValidations) }}\n          </div>\n        </div>\n      </div>\n\n      <div v-else-if=\"task\">\n        <div class=\"flexrow extra-buttons pa05\">\n          <div class=\"filler\"></div>\n          <div\n            class=\"pointer\"\n            :title=\"$t('main.csv.export_file')\"\n            @click=\"onExportClick\"\n            v-if=\"!withActions && !isCurrentUserClient\"\n          >\n            <kitsu-icon name=\"export\" :title=\"$t('main.csv.export_file')\" />\n          </div>\n        </div>\n\n        <div class=\"pa1 pb0 pt0\">\n          <div class=\"flexrow header-title\" v-if=\"!isConceptTask\">\n            <task-type-name\n              class=\"flexrow-item task-type mr1\"\n              :task-type=\"currentTaskType\"\n              :production-id=\"task.project_id\"\n              v-if=\"currentTaskType\"\n            />\n            <div class=\"title flexrow-item filler\">\n              <router-link :to=\"taskEntityPath\" v-if=\"!isCurrentUserClient\">\n                {{ title }}\n              </router-link>\n              <template v-else>\n                {{ title }}\n              </template>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"flexrow\" v-if=\"showAssignees && task.assignees.length > 0\">\n          <span class=\"flexrow-item ml1\">\n            {{ $t('tasks.fields.assignees') }}:\n          </span>\n          <people-avatar\n            :key=\"`assignee-${assigneeId}`\"\n            class=\"flexrow-item\"\n            :font-size=\"14\"\n            :person=\"personMap.get(assigneeId)\"\n            :size=\"24\"\n            v-for=\"assigneeId in task.assignees\"\n          />\n        </div>\n\n        <div class=\"task-columns pa1 pt0\" ref=\"task-columns\">\n          <div class=\"task-column preview-column\" v-if=\"isPreview\">\n            <div class=\"preview-column-content\">\n              <div class=\"flexrow\" v-if=\"!isConceptTask\">\n                <div\n                  class=\"preview-list flexrow w100\"\n                  v-if=\"previewOptions.length > 0\"\n                >\n                  <combobox-styled\n                    class=\"preview-combo flexrow-item\"\n                    :options=\"previewOptions\"\n                    is-preview\n                    thin\n                    :model-value=\"previewOptions[currentPreviewIndex]?.value\"\n                    @update:model-value=\"onPreviewChanged\"\n                  />\n                </div>\n                <div class=\"filler\"></div>\n                <div>\n                  <router-link\n                    class=\"history-button flexrow-item\"\n                    :to=\"taskPath\"\n                  >\n                    <corner-right-up-icon :size=\"12\" />\n                  </router-link>\n                </div>\n              </div>\n\n              <div class=\"preview\">\n                <template v-if=\"taskPreviews && taskPreviews.length > 0\">\n                  <preview-player\n                    :entity-preview-files=\"taskEntityPreviews\"\n                    :entity-type=\"entityType\"\n                    :extra-wide=\"isExtraWide\"\n                    :is-assigned=\"isAssigned\"\n                    :last-preview-files=\"taskPreviews\"\n                    :light=\"!isWide\"\n                    :link=\"currentPreviewComment?.links?.[0]\"\n                    :previews=\"currentPreview ? currentPreview.previews : []\"\n                    :read-only=\"isPreviewPlayerReadOnly\"\n                    :task=\"task\"\n                    :task-type-map=\"taskTypeMap\"\n                    @annotation-changed=\"onAnnotationChanged\"\n                    @change-current-preview=\"changeCurrentPreview\"\n                    @add-extra-preview=\"onAddExtraPreview\"\n                    @remove-extra-preview=\"onRemoveExtraPreview\"\n                    @previews-order-change=\"onPreviewsOrderChange\"\n                    @comment-added=\"onCommentAdded\"\n                    @frame-updated=\"onFrameUpdated\"\n                    ref=\"preview-player\"\n                  />\n                </template>\n\n                <div\n                  class=\"no-preview\"\n                  v-if=\"!taskPreviews || taskPreviews.length === 0\"\n                >\n                  <em>{{ $t('tasks.no_preview') }}</em>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"task-column comments-column mt1\">\n            <div>\n              <div>\n                <add-comment\n                  ref=\"add-comment\"\n                  :team=\"currentTeam\"\n                  :task-types=\"currentTaskTypes\"\n                  :task=\"task\"\n                  :task-status=\"taskStatuses\"\n                  :is-loading=\"loading.addComment\"\n                  :preview-forms=\"previewForms\"\n                  :is-error=\"errors.addComment\"\n                  :is-max-retakes-error=\"errors.addCommentMaxRetakes\"\n                  :fps=\"currentFps\"\n                  :frame=\"currentFrame || currentFrameRaw\"\n                  :revision=\"currentRevision\"\n                  :is-movie=\"isMoviePreview\"\n                  @add-comment=\"addComment\"\n                  @add-preview=\"onAddPreviewClicked\"\n                  @file-drop=\"selectFile\"\n                  @clear-files=\"clearPreviewFiles\"\n                  @remove-preview=\"onPreviewFormRemoved\"\n                  @annotation-snapshots-requested=\"extractAnnotationSnapshots\"\n                  v-if=\"isCommentingAllowed\"\n                />\n\n                <div\n                  class=\"comments\"\n                  v-if=\"\n                    taskComments && taskComments.length > 0 && !loading.task\n                  \"\n                >\n                  <XyzTransitionGroup\n                    appear\n                    v-xyz=\"{ fade: animOn, up: animOn, 'flip-up': animOn }\"\n                  >\n                    <comment\n                      :key=\"`comment-${comment.id}`\"\n                      :comment=\"comment\"\n                      :fps=\"currentFps\"\n                      :frame=\"currentFrame || currentFrameRaw\"\n                      :is-change=\"isStatusChange(index)\"\n                      :is-checkable=\"\n                        user.id === comment.person?.id ||\n                        (isCurrentUserArtist && isAssigned) ||\n                        isDepartmentSupervisor ||\n                        isCurrentUserManager\n                      \"\n                      :is-editable=\"\n                        user.id === comment.person?.id || isCurrentUserManager\n                      \"\n                      :is-pinnable=\"\n                        isDepartmentSupervisor || isCurrentUserManager\n                      \"\n                      :is-replyable=\"\n                        user.id === comment.person?.id ||\n                        isAssigned ||\n                        isDepartmentSupervisor ||\n                        isCurrentUserManager ||\n                        isClientFromSameStudio(comment.person)\n                      \"\n                      :revision=\"currentRevision\"\n                      :task=\"task\"\n                      :team=\"currentTeam\"\n                      :task-types=\"currentTaskTypes\"\n                      @ack-comment=\"onAckComment\"\n                      @duplicate-comment=\"onDuplicateComment\"\n                      @pin-comment=\"onPinComment\"\n                      @edit-comment=\"onEditComment\"\n                      @delete-comment=\"onDeleteComment\"\n                      @checklist-updated=\"saveComment\"\n                      @time-code-clicked=\"timeCodeClicked\"\n                      v-for=\"(comment, index) in taskComments\"\n                    />\n                  </XyzTransitionGroup>\n                </div>\n                <div class=\"no-comment\" v-else-if=\"!loading.task\">\n                  <em>\n                    {{ $t('tasks.no_comment') }}\n                  </em>\n                </div>\n              </div>\n            </div>\n\n            <div class=\"has-text-centered\" v-if=\"loading.task\">\n              <spinner />\n            </div>\n          </div>\n        </div>\n\n        <add-preview-modal\n          ref=\"add-preview-modal\"\n          :active=\"modals.addPreview\"\n          :is-loading=\"loading.addPreview\"\n          :is-error=\"errors.addPreview\"\n          :expected-frames=\"entityFrames\"\n          :fps=\"currentFps\"\n          @cancel=\"closeAddPreviewModal\"\n          @confirm=\"confirmAddPreviewModal\"\n        />\n\n        <add-preview-modal\n          ref=\"add-extra-preview-modal\"\n          :active=\"modals.addExtraPreview\"\n          :is-loading=\"loading.addExtraPreview\"\n          :is-error=\"errors.addExtraPreview\"\n          :form-data=\"addExtraPreviewFormData\"\n          message=\"\"\n          @cancel=\"onCloseExtraPreview\"\n          @confirm=\"createExtraPreview\"\n        />\n\n        <edit-comment-modal\n          :active=\"modals.editComment\"\n          :comment-to-edit=\"commentToEdit\"\n          :fps=\"currentFps\"\n          :frame=\"currentFrame || currentFrameRaw\"\n          :is-loading=\"loading.editComment\"\n          :is-error=\"errors.editComment\"\n          :revision=\"currentRevision\"\n          :team=\"currentTeam\"\n          :task-types=\"currentTaskTypes\"\n          @confirm=\"confirmEditTaskComment\"\n          @cancel=\"onCancelEditComment\"\n        />\n\n        <delete-modal\n          :active=\"modals.deleteComment\"\n          :is-loading=\"loading.deleteComment\"\n          :is-error=\"errors.deleteComment\"\n          :text=\"$t('tasks.delete_comment')\"\n          :error-text=\"$t('tasks.delete_comment_error')\"\n          @confirm=\"confirmDeleteTaskComment\"\n          @cancel=\"onCancelDeleteComment\"\n        />\n\n        <delete-modal\n          :active=\"modals.deleteExtraPreview\"\n          :is-loading=\"loading.deleteExtraPreview\"\n          :is-error=\"errors.deleteExtraPreview\"\n          :text=\"$t('tasks.delete_preview')\"\n          :error-text=\"$t('tasks.delete_preview_error')\"\n          @cancel=\"onCancelRemoveExtraPreview\"\n          @confirm=\"confirmDeleteTaskPreview\"\n        />\n      </div>\n      <div class=\"side task-info pa1\" v-else-if=\"nbSelectedEntities > 0\">\n        <h1 class=\"title mt2\">{{ $tc('tasks.selected_entities') }}</h1>\n        <div class=\"pa2 mt1\">\n          <div\n            class=\"entity-line\"\n            :key=\"entity.id\"\n            v-for=\"entity in Array.from(selectedEntities.values())\"\n          >\n            <span :class=\"{ canceled: entity.canceled }\">{{\n              entity.full_name\n            }}</span>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"side task-info empty\" v-else>\n        <div class=\"has-text-centered mb0\">\n          <template v-if=\"entityType === 'Concept'\">\n            {{ $t('concepts.no_concept_selected') }}\n          </template>\n          <template v-else>\n            {{ $t('tasks.no_task_selected') }}\n          </template>\n        </div>\n        <hr class=\"no-selection-separator\" />\n        <div class=\"empty-section\">\n          <slot />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { CornerRightUpIcon, XIcon } from 'lucide-vue-next'\nimport moment from 'moment'\nimport { mapGetters, mapActions } from 'vuex'\n\nimport csv from '@/lib/csv'\nimport drafts from '@/lib/drafts'\nimport { getTaskEntityPath, getTaskPath } from '@/lib/path'\nimport preferences from '@/lib/preferences'\nimport { getTaskTypeStyle } from '@/lib/render'\nimport { sortPeople, sortTaskNames } from '@/lib/sorting'\nimport stringHelpers from '@/lib/string'\nimport { formatDate } from '@/lib/time'\n\nimport { taskMixin } from '@/components/mixins/task'\nimport { domMixin } from '@/components/mixins/dom'\n\nimport ActionPanel from '@/components/tops/ActionPanel.vue'\nimport AddComment from '@/components/widgets/AddComment.vue'\nimport AddPreviewModal from '@/components/modals/AddPreviewModal.vue'\nimport Comment from '@/components/widgets/Comment.vue'\nimport ComboboxStyled from '@/components/widgets/ComboboxStyled.vue'\nimport DeleteModal from '@/components/modals/DeleteModal.vue'\nimport EditCommentModal from '@/components/modals/EditCommentModal.vue'\nimport KitsuIcon from '@/components/widgets/KitsuIcon.vue'\nimport PeopleAvatar from '@/components/widgets/PeopleAvatar.vue'\nimport PreviewPlayer from '@/components/previews/PreviewPlayer.vue'\nimport Spinner from '@/components/widgets/Spinner.vue'\nimport TaskTypeName from '@/components/widgets/TaskTypeName.vue'\n\nconst DEFAULT_PANEL_WIDTH = 400\n\nexport default {\n  name: 'task-info',\n\n  mixins: [domMixin, taskMixin],\n\n  components: {\n    ActionPanel,\n    AddComment,\n    AddPreviewModal,\n    ComboboxStyled,\n    Comment,\n    CornerRightUpIcon,\n    DeleteModal,\n    EditCommentModal,\n    KitsuIcon,\n    PeopleAvatar,\n    PreviewPlayer,\n    Spinner,\n    TaskTypeName,\n    XIcon\n  },\n\n  props: {\n    currentFrame: {\n      type: Number,\n      default: 0\n    },\n    currentParentPreview: {\n      type: Object,\n      default: null\n    },\n    entityType: {\n      type: String,\n      default: 'Asset'\n    },\n    extendable: {\n      type: Boolean,\n      default: true\n    },\n    isLoading: {\n      type: Boolean,\n      default: true\n    },\n    isPreview: {\n      type: Boolean,\n      default: true\n    },\n    silent: {\n      type: Boolean,\n      default: false\n    },\n    showAssignees: {\n      type: Boolean,\n      default: false\n    },\n    task: {\n      type: Object,\n      default: () => {}\n    },\n    withActions: {\n      type: Boolean,\n      default: false\n    },\n    player: {\n      type: Object,\n      default: null\n    },\n    root: {\n      type: Boolean,\n      default: true\n    }\n  },\n\n  emits: ['comment-added', 'task-removed', 'time-code-clicked'],\n\n  provide() {\n    if (this.root) {\n      return {\n        draftComment: this.draftComment\n      }\n    }\n    return {}\n  },\n\n  data() {\n    return {\n      draftComment: {},\n      addExtraPreviewFormData: null,\n      animOn: false,\n      previewForms: [],\n      currentFrameRaw: 0,\n      currentPreviewIndex: 0,\n      currentPreviewPath: '',\n      currentPreviewDlPath: '',\n      currentTask: null,\n      commentToEdit: null,\n      isWide: false,\n      isExtraWide: false,\n      otherPreviews: [],\n      panelWidth: 800,\n      selectedEpisodes: null,\n      selectedSequences: null,\n      taskComments: [],\n      taskPreviews: [],\n      domEvents: [\n        ['mousemove', this.onExtendMove],\n        ['touchmove', this.onExtendMove],\n        ['mouseup', this.onExtendUp],\n        ['mouseleave', this.onExtendUp],\n        ['touchend', this.onExtendUp],\n        ['touchcancel', this.onExtendUp]\n      ],\n      errors: {\n        addComment: false,\n        addCommentMaxRetakes: false,\n        addPreview: false,\n        addExtraPreview: false,\n        editComment: false,\n        deleteComment: false,\n        confirmDeleteTaskPreview: false,\n        task: false\n      },\n      loading: {\n        addComment: false,\n        addPreview: false,\n        addExtraPreview: false,\n        editComment: false,\n        deleteComment: false,\n        confirmDeleteTaskPreview: false,\n        task: false,\n        setFrameThumbnail: false\n      },\n      modals: {\n        addPreview: false,\n        addExtraPreview: false,\n        editComment: false,\n        deleteComment: false,\n        deleteExtraPreview: false\n      }\n    }\n  },\n\n  mounted() {\n    if (this.sideColumnParent) {\n      const panelWidth = preferences.getIntPreference(\n        'task:panel-width',\n        DEFAULT_PANEL_WIDTH\n      )\n      this.setWidth(panelWidth)\n      this.refreshPreviewPlay()\n    }\n  },\n\n  beforeUnmount() {\n    this.removeEvents(this.domEvents)\n  },\n\n  computed: {\n    ...mapGetters([\n      'currentEpisode',\n      'currentProduction',\n      'getTaskComment',\n      'getTaskComments',\n      'getTaskPreviews',\n      'getTaskStatusForCurrentUser',\n      'isCurrentUserArtist',\n      'isCurrentUserClient',\n      'isCurrentUserManager',\n      'isCurrentUserSupervisor',\n      'isSavingCommentPreview',\n      'isSingleEpisode',\n      'isTVShow',\n      'nbSelectedTasks',\n      'personMap',\n      'productionMap',\n      'selectedAssets',\n      'selectedConcepts',\n      'selectedEdits',\n      'selectedShots',\n      'selectedTasks',\n      'shotMap',\n      'nbSelectedValidations',\n      'taskEntityPreviews',\n      'taskMap',\n      'taskTypeMap',\n      'user'\n    ]),\n\n    sideColumnParent() {\n      if (this.$el.parentElement.classList.contains('side-column')) {\n        return this.$el.parentElement\n      }\n      return undefined\n    },\n\n    nbSelectedEntities() {\n      return this.selectedEntities?.size || 0\n    },\n\n    selectedEntities() {\n      return this[`selected${this.entityType}s`]\n    },\n\n    currentProductionId() {\n      return this.task?.project_id || this.currentProduction?.id\n    },\n\n    currentTeam() {\n      if (!this.task) return []\n      const production = this.productionMap.get(this.task.project_id)\n      if (!production?.team) return []\n      return sortPeople(\n        production.team\n          .map(personId => this.personMap.get(personId))\n          .filter(Boolean)\n      )\n    },\n\n    // get current task types for this project filtered by current task entity type (Shot or Asset)\n    currentTaskTypes() {\n      if (!this.task || !this.currentProduction) return []\n\n      // task types for this project\n      const task_types = this.currentProduction.task_types\n\n      // get the current task entity type eg. 'Shot' or 'Asset'\n      const current_task_type = this.taskTypeMap.get(this.task.task_type_id)\n      const task_type_entity = current_task_type.for_entity\n      const task_type_entity_slug = task_type_entity.toLowerCase() + 's'\n\n      // lets get a map of all tasks that are the same entity\n      // where the key is the task type id\n      const entity_tasks = {}\n      for (const keyValue of this.taskMap) {\n        const task = keyValue[1]\n        if (task.entity_id === this.task.entity_id)\n          entity_tasks[task.task_type_id] = task\n      }\n\n      const filtered = task_types\n        // get all task type objects\n        .map(taskTypeId => this.taskTypeMap.get(taskTypeId))\n\n        // filter down to just those that match this task entity type Shot, Asset etc.\n        .filter(taskType => taskType?.for_entity === task_type_entity)\n\n        // filter to tasks that exist\n        .filter(taskType => entity_tasks[taskType.id])\n\n        // add a url that points to the task\n        .map(taskType => {\n          const task = entity_tasks[taskType.id]\n          if (task)\n            taskType.url = `/productions/${task.project_id}/episodes/${task.episode_id || 'all'}/${task_type_entity_slug}/tasks/${task.id}`\n          return taskType\n        })\n      return filtered\n    },\n\n    title() {\n      if (this.task) {\n        const entityName = this.task.full_entity_name || this.task.entity_name\n        return `${entityName}`\n      } else {\n        return this.$t('main.loading')\n      }\n    },\n\n    isAssigned() {\n      return (\n        this.task?.assignees.some(personId => personId === this.user.id) ??\n        false\n      )\n    },\n\n    isCommentingAllowed() {\n      return (\n        this.task &&\n        (this.isAssigned ||\n          this.isCurrentUserClient ||\n          this.isDepartmentSupervisor ||\n          this.isCurrentUserManager)\n      )\n    },\n\n    isConceptTask() {\n      return this.entityType === 'Concept'\n    },\n\n    isDepartmentSupervisor() {\n      if (!this.isCurrentUserSupervisor) {\n        return false\n      }\n      if (this.user.departments.length === 0) {\n        return true\n      }\n      return this.user.departments.includes(this.currentTaskType?.department_id)\n    },\n\n    isPreviewPlayerReadOnly() {\n      if (this.task) {\n        if (this.isCurrentUserManager || this.isCurrentUserClient) {\n          return false\n        } else if (this.isCurrentUserSupervisor) {\n          if (this.user.departments.length === 0) {\n            return false\n          } else {\n            return !this.user.departments.includes(\n              this.currentTaskType?.department_id\n            )\n          }\n        }\n      }\n      return true\n    },\n\n    isSetThumbnailAllowed() {\n      return (\n        this.currentPreviewId &&\n        this.task &&\n        this.task.entity &&\n        this.currentPreviewId !== this.task.entity.preview_file_id &&\n        this.extension !== 'gif'\n      )\n    },\n\n    currentTaskType() {\n      return this.taskTypeMap.get(this.task?.task_type_id)\n    },\n\n    currentPreview() {\n      const index = this.currentPreviewIndex\n      return this.taskPreviews && this.taskPreviews.length > 0\n        ? this.taskPreviews[index]\n        : null\n    },\n\n    currentPreviewComment() {\n      return this.taskComments.find(comment =>\n        comment.previews?.some(\n          preview => preview.revision === this.currentRevision\n        )\n      )\n    },\n\n    currentPreviewId() {\n      const index = this.currentPreviewIndex\n      if (\n        this.taskPreviews &&\n        this.taskPreviews.length > 0 &&\n        this.taskPreviews[index]\n      ) {\n        return this.taskPreviews[index].id\n      } else {\n        return null\n      }\n    },\n\n    currentFps() {\n      return parseInt(this.productionMap.get(this.task.project_id)?.fps) || 25\n    },\n\n    currentRevision() {\n      return this.currentParentPreview && this.currentParentPreview.revision\n        ? this.currentParentPreview.revision\n        : this.currentPreview\n          ? this.currentPreview.revision\n          : 0\n    },\n\n    extension() {\n      const index = this.currentPreviewIndex\n      return this.taskPreviews && this.taskPreviews.length > 0\n        ? this.taskPreviews[index].extension\n        : ''\n    },\n\n    isStandardPreview() {\n      return (\n        this.taskPreviews &&\n        this.taskPreviews.length > 0 &&\n        [\n          'ai',\n          'blend',\n          'ma',\n          'mb',\n          'pdf',\n          'psd',\n          'rar',\n          'ae',\n          'fla',\n          'flv',\n          'swf',\n          'zip'\n        ].includes(this.extension)\n      )\n    },\n\n    isMoviePreview() {\n      return (\n        this.taskPreviews &&\n        this.taskPreviews.length > 0 &&\n        this.extension === 'mp4'\n      )\n    },\n\n    isPicturePreview() {\n      return (\n        this.taskPreviews &&\n        this.taskPreviews.length > 0 &&\n        ['png', 'gif'].includes(this.extension)\n      )\n    },\n\n    is3DModelPreview() {\n      return (\n        this.taskPreviews &&\n        this.taskPreviews.length > 0 &&\n        this.extension === 'obj'\n      )\n    },\n\n    moviePath() {\n      const previewId = this.currentPreview.id\n      return `/api/movies/originals/preview-files/${previewId}.mp4`\n    },\n\n    taskStatuses() {\n      return this.getTaskStatusForCurrentUser(\n        this.task.project_id,\n        this.isConceptTask\n      )\n    },\n\n    taskTypeStyle() {\n      return getTaskTypeStyle(this.task)\n    },\n\n    taskPath() {\n      return getTaskPath(\n        this.task,\n        null,\n        this.isTVShow,\n        this.currentEpisode,\n        this.taskTypeMap\n      )\n    },\n\n    taskEntityPath() {\n      const episodeId = this.$route.params.episode_id\n      return getTaskEntityPath(this.task, episodeId)\n    },\n\n    previewOptions() {\n      if (!this.taskPreviews) return []\n      return [...this.taskPreviews]\n        .sort((a, b) => b.revision - a.revision)\n        .map(preview => ({\n          value: preview.id,\n          label: `v${preview.revision}`,\n          validation_status: preview.validation_status\n        }))\n    },\n\n    selectedTasksToDisplay() {\n      return sortTaskNames(\n        Array.from(this.selectedTasks.values()),\n        this.taskTypeMap\n      )\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'addAttachmentToComment',\n      'ackComment',\n      'addCommentExtraPreview',\n      'commentTask',\n      'commentTaskWithPreview',\n      'deleteAttachment',\n      'deleteTaskComment',\n      'deleteTaskPreview',\n      'editTaskComment',\n      'loadComment',\n      'loadPreviewFileFormData',\n      'loadTask',\n      'loadTaskComments',\n      'loadTaskSubscribed',\n      'refreshPreview',\n      'pinComment',\n      'refreshComment',\n      'removeSelectedTask',\n      'setPreview',\n      'subscribeToTask',\n      'unsubscribeFromTask',\n      'updatePreviewAnnotation'\n    ]),\n\n    loadTaskData() {\n      if (this.task) {\n        this.loading.task = true\n        this.errors.task = false\n        this.loadTaskComments({\n          taskId: this.task.id,\n          entityId: this.task.entity_id\n        })\n          .then(() => {\n            this.loading.task = false\n            this.reset()\n          })\n          .catch(err => {\n            console.error(err)\n            this.errors.task = true\n          })\n      }\n    },\n\n    addComment(\n      comment,\n      attachment,\n      checklist,\n      taskStatusId,\n      revision = undefined,\n      link = undefined\n    ) {\n      this.animOn = true\n      this.$nextTick(() => {\n        let preview = this.currentParentPreview\n          ? this.currentParentPreview\n          : this.currentPreview\n        // find real preview, which contains the `revision`\n        preview = this.taskPreviews.find(p => p.id === preview.id)\n        const params = {\n          taskId: this.task.id,\n          taskStatusId,\n          attachment,\n          checklist,\n          comment,\n          links: link ? [link] : null,\n          revision\n        }\n        const action =\n          this.previewForms.length > 0\n            ? 'commentTaskWithPreview'\n            : 'commentTask'\n        this.loading.addComment = true\n        this.errors.addComment = false\n        this.errors.addCommentMaxRetakes = false\n        this.$store\n          .dispatch(action, params)\n          .then(() => {\n            drafts.clearTaskDraft(this.task.id)\n            this.$refs['add-comment']?.reset()\n            this.reset()\n            this.loading.addComment = false\n            this.$emit('comment-added')\n          })\n          .catch(err => {\n            console.error(err)\n            const isRetakeError = err.body?.message?.includes('retake') ?? false\n            this.errors.addComment = !isRetakeError\n            this.errors.addCommentMaxRetakes = isRetakeError\n            this.loading.addComment = false\n          })\n      })\n    },\n\n    reset({ keepPreviewFiles = false } = {}) {\n      this.resetModals()\n      if (!keepPreviewFiles) {\n        this.clearPreviewFiles()\n      }\n      if (this.task) {\n        this.taskComments = this.getTaskComments(this.task.id)\n        this.taskPreviews = this.getTaskPreviews(this.task.id)\n        this.setOtherPreviews()\n        this.currentPreviewPath = this.getOriginalPath()\n        this.currentPreviewDlPath = this.getOriginalDlPath()\n        this.resetDraft()\n        this.$nextTick(() => {\n          this.$refs['preview-player']?.focus()\n        })\n      }\n    },\n\n    focusCommentTextarea() {\n      this.$refs['add-comment']?.focus()\n    },\n\n    getOriginalPath() {\n      const previewId = this.currentPreviewId\n      const extension = this.extension ? this.extension : 'png'\n      return `/api/pictures/originals/preview-files/${previewId}.${extension}`\n    },\n\n    getOriginalDlPath() {\n      const previewId = this.currentPreviewId\n      return `/api/pictures/originals/preview-files/${previewId}/download`\n    },\n\n    setOtherPreviews() {\n      if (this.taskPreviews) {\n        this.otherPreviews = this.taskPreviews.filter(p => {\n          return p.id !== this.currentPreviewId && p.extension === 'mp4'\n        })\n      }\n      return this.otherPreviews\n    },\n\n    selectFile(forms) {\n      this.previewForms = this.previewForms.concat(forms)\n      this.loadPreviewFileFormData(this.previewForms)\n    },\n\n    onPreviewFormRemoved(previewForm) {\n      this.previewForms = this.previewForms.filter(f => f !== previewForm)\n      this.loadPreviewFileFormData(this.previewForms)\n    },\n\n    clearPreviewFiles() {\n      this.previewForms = []\n      this.loadPreviewFileFormData(this.previewForms)\n      this.$store.commit('CLEAR_UPLOAD_PROGRESS')\n    },\n\n    createExtraPreview(forms) {\n      this.selectFile(forms)\n      this.errors.addExtraPreview = false\n      this.loading.addExtraPreview = true\n      const comment = this.taskComments.find(comment =>\n        comment.previews.find(preview => preview.id === this.currentPreviewId)\n      )\n      this.addCommentExtraPreview({\n        taskId: this.task.id,\n        commentId: comment?.id,\n        previewId: this.currentPreviewId\n      })\n        .then(() => {\n          this.loading.addExtraPreview = false\n          this.$refs['add-extra-preview-modal'].reset()\n          this.reset()\n          setTimeout(() => {\n            this.$refs['preview-player'].displayLast()\n          }, 0)\n          this.modals.addExtraPreview = false\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.addExtraPreview = false\n          this.errors.addExtraPreview = true\n        })\n    },\n\n    onPreviewAdded(eventData) {\n      const taskId = eventData.task_id\n      const commentId = eventData.comment_id\n      const previewId = eventData.preview_file_id\n      const revision = eventData.revision\n      const extension = eventData.extension\n      const comment = this.getTaskComment(taskId, commentId)\n\n      if (this.task) {\n        if (\n          taskId === this.task.id &&\n          comment &&\n          (comment.previews.length === 0 ||\n            comment.previews[0].id !== previewId)\n        ) {\n          this.$store.commit('ADD_PREVIEW_END', {\n            preview: {\n              id: previewId,\n              revision,\n              extension\n            },\n            taskId,\n            commentId,\n            comment\n          })\n          this.reset({ keepPreviewFiles: true })\n        }\n      }\n    },\n\n    onPreviewsOrderChange() {\n      this.taskPreviews = this.getTaskPreviews(this.task.id)\n      this.setOtherPreviews()\n      this.currentPreviewPath = this.getOriginalPath()\n      this.currentPreviewDlPath = this.getOriginalDlPath()\n    },\n\n    onAnnotationChanged({ preview, additions, deletions, updates }) {\n      let taskId = this.task ? this.task.id : this.previousTaskId\n      taskId = taskId || preview.task_id\n      if (taskId) {\n        this.updatePreviewAnnotation({\n          taskId,\n          preview,\n          additions,\n          deletions,\n          updates\n        })\n      }\n    },\n\n    onAddPreviewClicked() {\n      this.modals.addPreview = true\n    },\n\n    onAddExtraPreview() {\n      this.clearPreviewFiles()\n      this.modals.addExtraPreview = true\n    },\n\n    onRemoveExtraPreview(preview) {\n      this.currentExtraPreviewId = preview.id\n      this.modals.deleteExtraPreview = true\n    },\n\n    onCommentAdded() {\n      this.taskComments = this.getTaskComments(this.task.id)\n    },\n\n    onCancelRemoveExtraPreview() {\n      this.modals.deleteExtraPreview = false\n    },\n\n    closeAddPreviewModal() {\n      this.modals.addPreview = false\n    },\n\n    confirmAddPreviewModal(forms) {\n      this.selectFile(forms)\n      this.closeAddPreviewModal()\n    },\n\n    onCloseExtraPreview() {\n      this.modals.addExtraPreview = false\n    },\n\n    onPreviewChanged(previewId) {\n      this.currentPreviewIndex = this.taskPreviews.findIndex(\n        p => p.id === previewId\n      )\n      this.currentPreviewPath = this.getOriginalPath()\n      this.currentPreviewDlPath = this.getOriginalDlPath()\n    },\n\n    changeCurrentPreview(previewFile) {\n      const index = this.taskPreviews.findIndex(p => p.id === previewFile.id)\n      if (index || index === 0) {\n        this.currentPreviewIndex = index\n        this.currentPreviewPath = this.getOriginalPath()\n        this.currentPreviewDlPath = this.getOriginalDlPath()\n      }\n    },\n\n    setCurrentPreviewAsEntityThumbnail(frame) {\n      const previewPlayer = this.$refs['preview-player']\n      const previewId = previewPlayer.currentPreview.id\n      this.setPreview({\n        taskId: this.task.id,\n        entityId: this.task.entity_id,\n        previewId,\n        frame\n      }).finally(() => {\n        this.loading.setFrameThumbnail = false\n      })\n    },\n\n    onAckComment(comment) {\n      this.ackComment(comment)\n    },\n\n    onDuplicateComment(comment) {\n      this.$refs['add-comment'].setValue(comment)\n    },\n\n    onPinComment(comment) {\n      this.pinComment(comment)\n    },\n\n    onEditComment(comment) {\n      this.commentToEdit = comment\n      this.modals.editComment = true\n    },\n\n    onDeleteComment(comment) {\n      this.commentToEdit = comment\n      this.modals.deleteComment = true\n    },\n\n    onCancelEditComment() {\n      this.modals.editComment = false\n    },\n\n    onCancelDeleteComment() {\n      this.modals.deleteComment = false\n    },\n\n    isClientFromSameStudio(person) {\n      return (\n        this.isCurrentUserClient &&\n        this.user.studio_id === person.studio_id &&\n        person.role === 'client'\n      )\n    },\n\n    async saveComment(comment) {\n      try {\n        await this.editTaskComment({\n          taskId: this.task.id,\n          comment\n        })\n      } catch (err) {\n        console.error(err)\n        await this.loadTaskData()\n      }\n    },\n\n    confirmDeleteTaskComment() {\n      this.animOn = true\n      this.loading.deleteComment = true\n      this.errors.deleteComment = false\n      const commentId = this.commentToEdit.id\n\n      this.deleteTaskComment({\n        taskId: this.task.id,\n        commentId\n      })\n        .then(() => {\n          this.reset()\n          this.loading.deleteComment = false\n          this.modals.deleteComment = false\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.deleteComment = false\n          this.errors.deleteComment = true\n        })\n        .finally(() => {\n          this.animOn = false\n        })\n    },\n\n    getCurrentTaskComments() {\n      return this.getTaskComments(this.task.id)\n    },\n\n    confirmDeleteTaskPreview() {\n      this.loading.deleteExtraPreview = true\n      this.errors.deleteExtraPreview = false\n      const previewId = this.currentExtraPreviewId\n      const comment = this.getCurrentTaskComments().find(comment => {\n        return comment.previews.findIndex(p => p.id === previewId) >= 0\n      })\n\n      this.$refs['preview-player'].displayFirst()\n      this.deleteTaskPreview({\n        taskId: this.task.id,\n        commentId: comment?.id,\n        previewId\n      })\n        .then(() => {\n          this.loading.deleteExtraPreview = false\n          this.modals.deleteExtraPreview = false\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.deleteExtraPreview = false\n          this.errors.deleteExtraPreview = true\n        })\n    },\n\n    onRemoteAcknowledge(eventData, type) {\n      if (this.task) {\n        const comment = this.getTaskComment(this.task.id, eventData.comment_id)\n        const user = this.personMap.get(eventData.person_id)\n        if (comment && user) {\n          if (this.user.id === user.id) {\n            if (\n              (type === 'ack' && !comment.acknowledgements.includes(user.id)) ||\n              (type === 'unack' && comment.acknowledgements.includes(user.id))\n            ) {\n              this.$store.commit('ACK_COMMENT', { comment, user })\n            }\n          } else {\n            this.$store.commit('ACK_COMMENT', { comment, user })\n          }\n        }\n      }\n    },\n\n    isStatusChange(index) {\n      const comment = this.taskComments[index]\n      return (\n        index === this.taskComments.length - 1 ||\n        comment.task_status_id !== this.taskComments[index + 1].task_status_id\n      )\n    },\n\n    timeCodeClicked({\n      versionRevision,\n      minutes,\n      seconds,\n      milliseconds,\n      frame\n    }) {\n      if (!this.isPreview) {\n        this.$emit('time-code-clicked', {\n          versionRevision,\n          minutes,\n          seconds,\n          milliseconds,\n          frame\n        })\n        return\n      }\n      this.changeCurrentPreview(\n        this.taskPreviews.find(p => p.revision === parseInt(versionRevision))\n      )\n      setTimeout(() => {\n        this.$refs['preview-player']?.setCurrentFrame(frame)\n        this.$refs['preview-player']?.focus()\n      }, 20)\n    },\n\n    onFrameUpdated(frame) {\n      this.currentFrameRaw = frame\n    },\n\n    async extractAnnotationSnapshots() {\n      let previewPlayer = this.$refs['preview-player']\n      if (!previewPlayer) previewPlayer = this.player\n      this.$refs['add-comment'].showAnnotationLoading()\n      const files = await previewPlayer.extractAnnotationSnapshots()\n      this.$refs['add-comment'].hideAnnotationLoading()\n      this.$refs['add-comment'].setAnnotationSnapshots(files)\n      return files\n    },\n\n    onExportClick() {\n      const nameData = [\n        moment().format('YYYY-MM-DD'),\n        'kitsu',\n        this.productionMap.get(this.task.project_id)?.name,\n        this.task.entity_name.replaceAll(' / ', '_'),\n        this.taskTypeMap.get(this.task.task_type_id).name,\n        'comments'\n      ]\n      const name = stringHelpers.slugify(nameData.join('_'))\n      const headers = [\n        this.$t('comments.fields.created_at'),\n        this.$t('comments.fields.task_status'),\n        this.$t('comments.fields.person'),\n        this.$t('comments.fields.text'),\n        this.$t('comments.fields.checklist'),\n        this.$t('comments.fields.acknowledgements')\n      ]\n      const commentLines = []\n      this.getCurrentTaskComments().forEach(comment => {\n        commentLines.push([\n          formatDate(comment.created_at),\n          comment.task_status.name,\n          comment.person.name,\n          comment.text,\n          comment.checklist\n            ? comment.checklist\n                .map(\n                  checkListElement =>\n                    `[${checkListElement.checked ? 'x' : ' '}] ${\n                      checkListElement.text\n                    }`\n                )\n                .join('\\n')\n            : '',\n          comment.acknowledgements\n            ? comment.acknowledgements\n                .map(personId => this.personMap.get(personId).name)\n                .join(',')\n            : ''\n        ])\n        if (comment.replies) {\n          comment.replies.forEach(reply =>\n            commentLines.push([\n              formatDate(reply.date),\n              'Reply',\n              this.personMap.get(reply.person_id).name,\n              reply.text\n            ])\n          )\n        }\n      })\n      csv.buildCsvFile(name, [headers].concat(commentLines))\n    },\n\n    onExtendDown(event) {\n      if (!this.sideColumnParent) {\n        return\n      }\n      this.lastWidthX = this.getClientX(event)\n      const panelWidth = this.sideColumnParent.offsetWidth\n      this.lastWidth = panelWidth\n      this.addEvents(this.domEvents)\n    },\n\n    onExtendMove(event) {\n      const diff = this.lastWidthX - this.getClientX(event)\n      let panelWidth = Math.max(this.lastWidth + diff, DEFAULT_PANEL_WIDTH)\n      if (panelWidth > 900) panelWidth = 900\n      this.setWidth(panelWidth)\n      this.refreshPreviewPlay()\n    },\n\n    onExtendUp() {\n      this.removeEvents(this.domEvents)\n      this.refreshPreviewPlay()\n      if (this.sideColumnParent) {\n        const panelWidth = this.sideColumnParent.offsetWidth\n        preferences.setPreference('task:panel-width', panelWidth)\n      }\n    },\n\n    setWidth(width) {\n      if (!this.sideColumnParent) {\n        return\n      }\n      this.sideColumnParent.style['min-width'] = `${width}px`\n      this.isWide = width > 699\n      this.isExtraWide = width >= 900\n    },\n\n    onSetCurrentFrameAsThumbnail(isUseCurrentFrame) {\n      if (this.$refs['preview-player']) {\n        this.loading.setFrameThumbnail = true\n        let frame = null\n        if (isUseCurrentFrame) {\n          frame = this.currentFrameRaw + 1\n        }\n        return this.setCurrentPreviewAsEntityThumbnail(frame)\n      }\n    },\n\n    refreshPreviewPlay() {\n      this.$refs['preview-player']?.previewViewer?.resize()\n    },\n\n    removeTaskFromSelection(task) {\n      const data = {\n        column: { id: task.task_type_id },\n        entity: { id: task.entity_id },\n        task\n      }\n      this.removeSelectedTask({ task: data }) // remove list selection\n      this.removeSelectedTask({ task }) // remove\n      this.$emit('task-removed', task)\n    }\n  },\n\n  watch: {\n    task() {\n      this.clearPreviewFiles()\n      this.currentPreviewIndex = 0\n      if (!this.silent) {\n        this.loadTaskData()\n      }\n    },\n\n    silent: {\n      immediate: true,\n      handler() {\n        if (!this.silent) {\n          this.loadTaskData()\n        }\n      }\n    },\n\n    currentFrame() {\n      this.currentFrameRaw = this.currentFrame\n    }\n  },\n\n  socket: {\n    events: {\n      'preview-file:add-file'(eventData) {\n        this.onPreviewAdded(eventData)\n      },\n\n      'preview-file:update'(eventData) {\n        const comment = this.taskComments.find(\n          c =>\n            c.previews &&\n            c.previews.length > 0 &&\n            c.previews[0].id === eventData.preview_file_id\n        )\n        if (comment && this.task) {\n          this.refreshPreview({\n            taskId: this.task.id,\n            previewId: eventData.preview_file_id\n          }).then(preview => {\n            comment.previews[0].validation_status = preview.validation_status\n          })\n        }\n      },\n\n      'task:update'(eventData) {\n        const task = this.getTask()\n        // Wait for data to be reinitialized by App.vue to update comments.\n        if (task && eventData.task_id === task.id) {\n          setTimeout(() => {\n            const task = this.getTask()\n            // in case the task changed during the timeout\n            if (task && eventData.task_id === task.id) {\n              this.taskComments = this.getTaskComments(task.id)\n            }\n          }, 1000)\n        }\n      },\n\n      'comment:new'(eventData) {\n        setTimeout(() => {\n          this.animOn = true\n          const comments = this.task ? this.getTaskComments(this.task.id) : null\n          if (\n            this.task &&\n            comments &&\n            comments.length !== this.taskComments.length &&\n            eventData.task_id === this.task.id &&\n            !this.loading.task\n          ) {\n            this.taskComments = comments\n            this.taskPreviews = this.getTaskPreviews(this.task.id)\n          }\n          this.animOn = false\n        }, 1000)\n      },\n\n      'comment:update'(eventData) {\n        const commentId = eventData.comment_id\n        if (\n          this.isSavingCommentPreview ||\n          (!this.task && !this.taskComments.some(({ id }) => id === commentId))\n        ) {\n          return\n        }\n        this.loadComment({ commentId }).catch(console.error)\n      },\n\n      'comment:acknowledge'(eventData) {\n        this.onRemoteAcknowledge(eventData, 'ack')\n      },\n\n      'comment:unacknowledge'(eventData) {\n        this.onRemoteAcknowledge(eventData, 'unack')\n      },\n\n      'comment:reply'(eventData) {\n        if (this.task) {\n          const comment = this.taskComments.find(\n            c => c.id === eventData.comment_id\n          )\n          if (comment) {\n            if (!comment.replies) comment.replies = []\n            const reply = comment.replies.find(r => r.id === eventData.reply_id)\n            if (!reply) {\n              this.refreshComment({\n                commentId: eventData.comment_id\n              })\n                .then(remoteComment => {\n                  comment.replies = remoteComment.replies\n                })\n                .catch(console.error)\n            }\n          }\n        }\n      },\n\n      'comment:delete'(eventData) {\n        const task = this.getTask()\n        this.animOn = true\n        if (task) {\n          const comments = this.getComments()\n          const comment = comments.find(c => c.id === eventData.comment_id)\n          if (comment) {\n            this.$store.commit('REMOVE_TASK_COMMENT', { task, comment })\n            this.taskComments = this.getTaskComments(this.task.id)\n            this.taskPreviews = this.getTaskPreviews(this.task.id)\n          }\n          this.animOn = false\n        }\n      },\n\n      'comment:delete-reply'(eventData) {\n        if (this.task) {\n          const comment = this.taskComments.find(\n            c => c.id === eventData.comment_id\n          )\n          if (comment) {\n            if (!comment.replies) comment.replies = []\n            this.$store.commit('REMOVE_REPLY_FROM_COMMENT', {\n              comment,\n              reply: { id: eventData.reply_id }\n            })\n          }\n        }\n      },\n\n      'preview-file:annotation-update'(eventData) {\n        const previewPlayer = this.$refs['preview-player']\n        if (!previewPlayer) return\n        const isValid = previewPlayer.isValidPreviewModification(\n          eventData.preview_file_id,\n          eventData.updated_at\n        )\n        if (isValid) {\n          this.refreshPreview({\n            previewId: previewPlayer.currentPreview.id,\n            taskId: previewPlayer.currentPreview.task_id\n          }).then(() => {\n            if (!previewPlayer.notSaved) {\n              this.taskPreviews = this.getTaskPreviews(this.task.id)\n              previewPlayer.reloadAnnotations()\n              previewPlayer.loadAnnotation()\n            }\n          })\n        }\n      }\n    },\n\n    head() {\n      return {\n        title: this.title\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.dark {\n  .add-comment,\n  .comment,\n  .no-comment {\n    background: #46494f;\n    border-color: $dark-grey;\n    box-shadow: 0 0 6px #333;\n  }\n\n  .extend-bar {\n    background: #46494f;\n  }\n\n  .no-preview {\n    padding: 0.5em;\n  }\n\n  .side {\n    background: #36393f;\n  }\n\n  .task-info {\n    color: white;\n  }\n}\n\n.side {\n  background: #f8f8f8;\n  min-height: 100%;\n}\n\n.add-comment {\n  padding: 0.5em;\n  margin-bottom: 0.5em;\n  box-shadow: 0 0 6px #e0e0e0;\n}\n\n.page-header {\n  padding: 0;\n  margin-top: 0;\n}\n\n.header-title .flexrow-item {\n  margin-bottom: 0.5em;\n}\n\n.title {\n  color: $grey;\n  flex: 1;\n  font-size: 1.3em;\n  font-weight: 500;\n  line-height: 1.5em;\n  margin: 0;\n  margin-top: 3px;\n}\n\n.title a {\n  color: inherit;\n  padding-top: 10px;\n}\n\n.history-button {\n  flex: 1;\n}\n\n.no-comment {\n  background: white;\n  padding: 1em;\n  border-radius: 5px;\n  box-shadow: 0 0 6px #e0e0e0;\n}\n\n.task-columns {\n  display: flex;\n  flex-direction: column;\n}\n\n.comment {\n  border-top: 1px solid $white-grey;\n  border-bottom: 1px solid $white-grey;\n  border-right: 1px solid $white-grey;\n  margin-top: 0.1em;\n  box-shadow: 0 0 6px #e0e0e0;\n}\n\n.add-preview-button {\n  margin-top: 0.5em;\n  width: 100%;\n}\n\n.no-comment {\n  background: white;\n  box-shadow: 0 0 6px #e0e0e0;\n}\n\n.comments {\n  padding-bottom: 1em;\n}\n\n.preview-colum-content {\n  box-shadow: 0 0 6px #e0e0e0;\n}\n\n.preview-standard-file {\n  text-align: center;\n  padding: 1em;\n}\n\n.model-viewer {\n  padding: 0.3em;\n}\n\n.change-wideness-button,\n.set-thumbnail-button,\n.subscribe-button {\n  margin-right: 0.2em;\n}\n\n.preview {\n  position: relative;\n}\n\n.preview-column-content {\n  border-radius: 5px;\n}\n\n.selected-task-line {\n  color: $grey;\n  font-weight: bold;\n  margin-bottom: 0.5em;\n}\n\n.entity-line {\n  color: $grey;\n  font-weight: bold;\n  margin-bottom: 0.5em;\n}\n\n.side-wrapper {\n  display: flex;\n  align-items: stretch;\n  min-height: 100%;\n}\n\n.side {\n  flex: 1;\n  overflow: auto;\n}\n\n.extend-bar {\n  width: 3px;\n  margin-left: 3px;\n  background: #ccc;\n  cursor: ew-resize;\n}\n\n.revision-thumbnail {\n  border: 2px solid transparent;\n  border-radius: 3px;\n  height: 33px;\n  margin-bottom: 4px;\n  position: relative;\n\n  &:hover {\n    border: 2px solid $grey;\n  }\n\n  &.selected {\n    border: 2px solid $dark-purple;\n  }\n\n  span {\n    background: $dark-purple;\n    border-radius: 0;\n    border-bottom-right-radius: 4px;\n    color: $white;\n    font-size: 0.8em;\n    height: 14px;\n    line-height: 1.1em;\n    margin: 0;\n    opacity: 0.8;\n    left: 0;\n    padding: 0;\n    position: absolute;\n    text-align: center;\n    top: 0;\n    width: 14px;\n  }\n}\n\n.empty {\n  padding-top: 1em;\n}\n\n.empty-section {\n  display: flex;\n  flex-direction: column;\n  padding: 0 1em 1em 1em;\n  position: relative;\n  bottom: 0;\n  right: 0;\n  left: 0;\n}\n\n.no-selection-separator {\n  background-color: var(--border-alt);\n  margin: 1em;\n}\n\n.task-type {\n  margin-right: 1em;\n}\n\n.extra-buttons {\n  img {\n    width: 16px;\n  }\n}\n</style>\n"],"names":["intersection","arrays","first","rest","sets","arr","item","set","_sfc_main","Combobox","value","model","_createBlock","_component_combobox","$props","$data","$options","BuildFilterModal","ButtonSimple","CheckSquareIcon","ComboboxModel","ComboboxStatus","ComboboxStyled","DeleteEntities","KitsuIcon","LinkIcon","PeopleField","PlayCircleIcon","SearchField","Spinner","ViewPlaylistModal","XIcon","mapGetters","assetsStore","isSupervisorWithDepartments","person","department","asset","shot","edit","taskId","task","taskType","prefix","assets","links","entity","mapActions","concept","id","err","personId","func","type","event","barName","lastSelection","availableTaskStatuses","statusLists","availableStatus","status","link","query","searchQuery","selectedTypes","action","oldRoute","newRoute","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_10","_hoisted_12","_hoisted_13","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_34","_hoisted_36","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_49","_hoisted_54","_hoisted_55","_hoisted_57","_hoisted_60","_hoisted_61","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_67","_hoisted_68","_hoisted_69","_hoisted_70","_hoisted_80","_hoisted_81","_hoisted_83","_hoisted_84","_hoisted_85","_hoisted_86","_createElementBlock","_createElementVNode","_ctx","_normalizeClass","_toDisplayString","_createCommentVNode","_createVNode","_component_kitsu_icon","_component_link_icon","_openBlock","_hoisted_9","_hoisted_11","_component_check_square_icon","_hoisted_14","_component_play_circle_icon","args","_component_x_icon","_hoisted_22","_hoisted_23","_component_combobox_status","_cache","$event","_withKeys","_withModifiers","_hoisted_29","_hoisted_30","_hoisted_31","_component_people_field","_hoisted_32","_component_spinner","_hoisted_33","_component_router_link","_withCtx","_createTextVNode","_hoisted_35","_hoisted_37","_hoisted_38","_hoisted_39","_component_combobox_styled","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_Fragment","_renderList","_hoisted_56","_hoisted_58","_component_delete_entities","_hoisted_59","_component_combobox_model","_hoisted_62","_hoisted_71","_hoisted_72","_hoisted_73","_hoisted_74","_hoisted_75","_hoisted_76","_hoisted_77","_hoisted_78","_hoisted_79","_component_search_field","_component_button_simple","_hoisted_82","linkGroup","index","_component_build_filter_modal","_component_view_playlist_modal","DEFAULT_PANEL_WIDTH","domMixin","taskMixin","ActionPanel","AddComment","AddPreviewModal","Comment","CornerRightUpIcon","DeleteModal","EditCommentModal","PeopleAvatar","PreviewPlayer","TaskTypeName","panelWidth","preferences","production","sortPeople","task_types","task_type_entity","task_type_entity_slug","entity_tasks","keyValue","taskTypeId","comment","preview","getTaskTypeStyle","getTaskPath","episodeId","getTaskEntityPath","a","b","sortTaskNames","attachment","checklist","taskStatusId","revision","p","params","drafts","isRetakeError","keepPreviewFiles","previewId","extension","forms","previewForm","f","eventData","commentId","additions","deletions","updates","previewFile","frame","user","versionRevision","minutes","seconds","milliseconds","previewPlayer","files","nameData","moment","name","stringHelpers","headers","commentLines","formatDate","checkListElement","reply","csv","diff","width","isUseCurrentFrame","data","c","comments","r","remoteComment","_component_action_panel","_component_task_type_name","assigneeId","_component_people_avatar","_component_corner_right_up_icon","_component_preview_player","_component_add_comment","_component_XyzTransitionGroup","_component_comment","_component_add_preview_modal","_component_edit_comment_modal","_component_delete_modal","_renderSlot"],"mappings":"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"}