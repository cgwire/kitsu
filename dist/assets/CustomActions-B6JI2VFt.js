import{_ as y,T as b,a4 as E,z as g,r,c as u,o as f,e as s,f as c,t as n,F as k,g as A,ac as v,ad as T,af as x,b as w,ah as D,j as $,ai as j,l as V,n as B,m as L,a as F,a9 as M,aa as N,ab as U}from"./index-BDVbXc-T.js";import{L as I}from"./ListPageHeader-By83UyFw.js";const O={name:"custom-action-list",mixins:[g],components:{RowActionsCell:E,TableInfo:b},props:{entries:{type:Array,default:()=>[]},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},emits:["delete-clicked","edit-clicked"]},S={class:"data-list"},z={class:"datatable-wrapper"},H={class:"datatable"},G={class:"datatable-head"},K={scope:"col",class:"name"},P={scope:"col",class:"url"},R={scope:"col",class:"entity-type"},q={scope:"col",class:"is-ajax"},J={class:"datatable-body"},Q={scope:"row",class:"name datatable-row-header"},W={class:"url"},X={class:"entity-type"},Y={class:"is-ajax"},Z={class:"has-text-centered nb-custom-actions"};function tt(t,e,i,m,o,l){const _=r("row-actions-cell"),h=r("table-info");return f(),u("div",S,[s("div",z,[s("table",H,[s("thead",G,[s("tr",null,[s("th",K,n(t.$t("custom_actions.fields.name")),1),s("th",P,n(t.$t("custom_actions.fields.url")),1),s("th",R,n(t.$t("custom_actions.fields.entity_type")),1),s("th",q,n(t.$t("custom_actions.fields.is_ajax")),1),e[0]||(e[0]=s("th",{scope:"col",class:"actions"},"Â ",-1))])]),s("tbody",J,[(f(!0),u(k,null,A(i.entries,a=>(f(),u("tr",{class:"datatable-row",key:a.id},[s("td",Q,n(a.name),1),s("td",W,n(a.url),1),s("td",X,n(a.entity_type),1),s("td",Y,n(t.formatBoolean(a.is_ajax)),1),c(_,{onEditClicked:p=>t.$emit("edit-clicked",a),onDeleteClicked:p=>t.$emit("delete-clicked",a)},null,8,["onEditClicked","onDeleteClicked"])]))),128))])])]),c(h,{"is-loading":i.isLoading,"is-error":i.isError},null,8,["is-loading","is-error"]),s("p",Z,n(i.entries.length)+" "+n(t.$tc("custom_actions.number",i.entries.length)),1)])}const et=y(O,[["render",tt],["__scopeId","data-v-5002600a"]]),ot={name:"edit-custom-action-modal",mixins:[D],components:{Combobox:w,ComboboxBoolean:x,ModalFooter:T,TextField:v},props:{active:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},customActionToEdit:{type:Object,default:()=>{}}},emits:["cancel","confirm"],data(){return{form:{name:"",url:"",entityType:"all",isAjax:"false"},entityTypeOptions:[{label:"all",value:"all"},{label:"asset",value:"asset"},{label:"shot",value:"shot"}]}},methods:{confirmClicked(){this.$emit("confirm",this.form)},isEditing(){return this.customActionToEdit&&this.customActionToEdit.id}},watch:{customActionToEdit(){this.customActionToEdit&&(this.form={name:this.customActionToEdit.name,url:this.customActionToEdit.url,entityType:this.customActionToEdit.entity_type,isAjax:(!!this.customActionToEdit.is_ajax).toString()})},active(){this.active&&setTimeout(()=>{this.$refs.nameField.focus()},100)}}},st={class:"modal-content"},it={class:"box"},lt={key:0,class:"title"},nt={key:1,class:"title"};function at(t,e,i,m,o,l){const _=r("text-field"),h=r("combobox"),a=r("combobox-boolean"),p=r("modal-footer"),C=$("focus");return f(),u("div",{class:B({modal:!0,"is-active":i.active})},[s("div",{class:"modal-background",onClick:e[0]||(e[0]=d=>t.$emit("cancel"))}),s("div",st,[s("div",it,[l.isEditing()?(f(),u("h1",lt,n(t.$t("custom_actions.edit_title"))+" "+n(i.customActionToEdit.name),1)):(f(),u("h1",nt,n(t.$t("custom_actions.new_custom_action")),1)),s("form",{onSubmit:e[5]||(e[5]=j(()=>{},["prevent"]))},[V(c(_,{ref:"nameField",label:t.$t("custom_actions.fields.name"),modelValue:o.form.name,"onUpdate:modelValue":e[1]||(e[1]=d=>o.form.name=d)},null,8,["label","modelValue"]),[[C]]),c(_,{label:t.$t("custom_actions.fields.url"),placeholder:"https://...",type:"url",modelValue:o.form.url,"onUpdate:modelValue":e[2]||(e[2]=d=>o.form.url=d),modelModifiers:{trim:!0},onEnter:l.confirmClicked},null,8,["label","modelValue","onEnter"]),c(h,{label:t.$t("custom_actions.fields.entity_type"),options:o.entityTypeOptions,modelValue:o.form.entityType,"onUpdate:modelValue":e[3]||(e[3]=d=>o.form.entityType=d),"locale-key-prefix":"custom_actions.entity_types.",onEnter:l.confirmClicked},null,8,["label","options","modelValue","onEnter"]),c(a,{label:t.$t("custom_actions.fields.is_ajax"),modelValue:o.form.isAjax,"onUpdate:modelValue":e[4]||(e[4]=d=>o.form.isAjax=d),onEnter:l.confirmClicked},null,8,["label","modelValue","onEnter"])],32),c(p,{"error-text":t.$t("custom_actions.create_error"),"is-error":i.isError,onConfirm:l.confirmClicked,onCancel:e[6]||(e[6]=d=>t.$emit("cancel"))},null,8,["error-text","is-error","onConfirm"])])])],2)}const ct=y(ot,[["render",at],["__scopeId","data-v-6aceb4ab"]]),rt={name:"custom-actions",components:{CustomActionList:et,DeleteModal:M,EditCustomActionModal:ct,ListPageHeader:I},data(){return{modals:{edit:!1,del:!1},loading:{edit:!1,del:!1,list:!1},errors:{edit:!1,del:!1,list:!1},customActionToDelete:null,customActionToEdit:null}},computed:{...F(["customActions"]),deleteText(){const t=this.customActionToDelete;return t?this.$t("custom_actions.delete_text",{name:t.name}):""}},created(){this.loading.list=!0,this.errors.list=!1,this.loadCustomActions(t=>{this.loading.list=!1,t&&(this.errors.list=!0)})},methods:{...L(["deleteCustomAction","editCustomAction","loadCustomActions","newCustomAction"]),confirmEditCustomAction(t){let e="newCustomAction";this.customActionToEdit&&this.customActionToEdit.id&&(e="editCustomAction",t.id=this.customActionToEdit.id),this.loading.edit=!0,this.errors.edit=!1,this[e](t).then(()=>{this.loading.edit=!1,this.modals.edit=!1}).catch(i=>{console.error(i),this.errors.edit=!0,this.modals.isNewDisplayed=!1})},confirmDeleteCustomAction(){this.loading.del=!0,this.errors.del=!1,this.deleteCustomAction(this.customActionToDelete).then(()=>{this.loading.del=!1,this.modals.del=!1}).catch(t=>{console.error(t),this.errors.del=!0,this.loading.del=!1})},onExportClicked(){const t=N.slugify(this.$t("custom_actions.title")),i=[[this.$t("main.type"),this.$t("custom_actions.fields.name"),this.$t("custom_actions.fields.url"),this.$t("custom_actions.fields.entity_type"),this.$t("custom_actions.fields.is_ajax")]].concat(this.customActions.map(m=>[m.type,m.name,m.url,m.entity_type,m.is_ajax]));U.buildCsvFile(t,i)},onNewClicked(){this.customActionToEdit={},this.errors.edit=!1,this.modals.edit=!0},onEditClicked(t){this.customActionToEdit=t,this.errors.edit=!1,this.modals.edit=!0},onDeleteClicked(t){this.customActionToDelete=t,this.errors.del=!1,this.modals.del=!0}},head(){return{title:`${this.$t("custom_actions.title")} - Kitsu`}}},dt={class:"custom-actions page fixed-page"};function mt(t,e,i,m,o,l){const _=r("list-page-header"),h=r("custom-action-list"),a=r("edit-custom-action-modal"),p=r("delete-modal");return f(),u("div",dt,[c(_,{title:t.$t("custom_actions.title"),"new-entry-label":t.$t("custom_actions.new_custom_action"),onExportClicked:l.onExportClicked,onNewClicked:l.onNewClicked},null,8,["title","new-entry-label","onExportClicked","onNewClicked"]),c(h,{entries:t.customActions,"is-loading":o.loading.list,"is-error":o.errors.list,onEditClicked:l.onEditClicked,onDeleteClicked:l.onDeleteClicked},null,8,["entries","is-loading","is-error","onEditClicked","onDeleteClicked"]),c(a,{active:o.modals.edit,"is-loading":o.loading.edit,"is-error":o.errors.edit,"custom-action-to-edit":o.customActionToEdit,onCancel:e[0]||(e[0]=C=>o.modals.edit=!1),onConfirm:l.confirmEditCustomAction},null,8,["active","is-loading","is-error","custom-action-to-edit","onConfirm"]),c(p,{active:o.modals.del,"is-loading":o.loading.del,"is-error":o.errors.del,text:l.deleteText,"error-text":t.$t("custom_actions.delete_error"),onCancel:e[1]||(e[1]=C=>o.modals.del=!1),onConfirm:l.confirmDeleteCustomAction},null,8,["active","is-loading","is-error","text","error-text","onConfirm"])])}const _t=y(rt,[["render",mt]]);export{_t as default};
//# sourceMappingURL=CustomActions-B6JI2VFt.js.map
