import{_ as C,T as k,a5 as g,z as v,r as c,c as f,o as m,e as s,f as r,t as n,F as A,g as T,ad as x,ae as w,ag as $,b as D,ai as j,j as V,aj as B,l as L,n as M,m as N,a as F,aa as U,k as b,d as E,ab as I,ac as O}from"./index-DxngxtIo.js";import{L as S}from"./ListPageHeader-CsMKpdFt.js";const q={name:"custom-action-list",mixins:[v],components:{RowActionsCell:g,TableInfo:k},props:{entries:{type:Array,default:()=>[]},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},emits:["delete-clicked","edit-clicked"]},z={class:"data-list"},H={class:"datatable-wrapper"},G={class:"datatable"},K={class:"datatable-head"},P={scope:"col",class:"name"},R={scope:"col",class:"url"},J={scope:"col",class:"entity-type"},Q={scope:"col",class:"is-ajax"},W={class:"datatable-body"},X={scope:"row",class:"name datatable-row-header"},Y={class:"url"},Z={class:"entity-type"},ee={class:"is-ajax"},te={class:"has-text-centered nb-custom-actions"};function oe(e,t,i,u,o,l){const _=c("row-actions-cell"),h=c("table-info");return m(),f("div",z,[s("div",H,[s("table",G,[s("thead",K,[s("tr",null,[s("th",P,n(e.$t("custom_actions.fields.name")),1),s("th",R,n(e.$t("custom_actions.fields.url")),1),s("th",J,n(e.$t("custom_actions.fields.entity_type")),1),s("th",Q,n(e.$t("custom_actions.fields.is_ajax")),1),t[0]||(t[0]=s("th",{scope:"col",class:"actions"},"Â ",-1))])]),s("tbody",W,[(m(!0),f(A,null,T(i.entries,a=>(m(),f("tr",{class:"datatable-row",key:a.id},[s("td",X,n(a.name),1),s("td",Y,n(a.url),1),s("td",Z,n(e.$t(`custom_actions.entity_types.${a.entity_type}`)),1),s("td",ee,n(e.formatBoolean(a.is_ajax)),1),r(_,{onEditClicked:p=>e.$emit("edit-clicked",a),onDeleteClicked:p=>e.$emit("delete-clicked",a)},null,8,["onEditClicked","onDeleteClicked"])]))),128))])])]),r(h,{"is-loading":i.isLoading,"is-error":i.isError},null,8,["is-loading","is-error"]),s("p",te,n(i.entries.length)+" "+n(e.$tc("custom_actions.number",i.entries.length)),1)])}const se=C(q,[["render",oe],["__scopeId","data-v-db21cde9"]]),ie={name:"edit-custom-action-modal",mixins:[j],components:{Combobox:D,ComboboxBoolean:$,ModalFooter:w,TextField:x},props:{active:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},customActionToEdit:{type:Object,default:()=>{}}},emits:["cancel","confirm"],data(){return{form:{name:"",url:"",entityType:"all",isAjax:"false"},entityTypeOptions:[{label:"all",value:"all"},{label:"asset",value:"asset"},{label:"shot",value:"shot"},{label:"sequence",value:"sequence"},{label:"edit",value:"edit"},{label:"episode",value:"episode"}]}},methods:{confirmClicked(){this.$emit("confirm",this.form)},isEditing(){return!!this.customActionToEdit?.id}},watch:{customActionToEdit:{immediate:!0,handler(){this.customActionToEdit&&(this.form={name:this.customActionToEdit.name,url:this.customActionToEdit.url,entityType:this.customActionToEdit.entity_type,isAjax:(!!this.customActionToEdit.is_ajax).toString()})}},active:{immediate:!0,handler(){this.active&&this.$nextTick(()=>{this.$refs.nameField?.focus()})}}}},le={class:"modal-content"},ne={class:"box"},ae={key:0,class:"title"},ce={key:1,class:"title"};function de(e,t,i,u,o,l){const _=c("text-field"),h=c("combobox"),a=c("combobox-boolean"),p=c("modal-footer"),y=V("focus");return m(),f("div",{class:M({modal:!0,"is-active":i.active})},[s("div",{class:"modal-background",onClick:t[0]||(t[0]=d=>e.$emit("cancel"))}),s("div",le,[s("div",ne,[l.isEditing()?(m(),f("h1",ae,n(e.$t("custom_actions.edit_title"))+" "+n(i.customActionToEdit.name),1)):(m(),f("h1",ce,n(e.$t("custom_actions.new_custom_action")),1)),s("form",{onSubmit:t[5]||(t[5]=B(()=>{},["prevent"]))},[L(r(_,{ref:"nameField",label:e.$t("custom_actions.fields.name"),modelValue:o.form.name,"onUpdate:modelValue":t[1]||(t[1]=d=>o.form.name=d),modelModifiers:{trim:!0},onEnter:l.confirmClicked},null,8,["label","modelValue","onEnter"]),[[y]]),r(_,{label:e.$t("custom_actions.fields.url"),placeholder:"https://...",type:"url",modelValue:o.form.url,"onUpdate:modelValue":t[2]||(t[2]=d=>o.form.url=d),modelModifiers:{trim:!0},onEnter:l.confirmClicked},null,8,["label","modelValue","onEnter"]),r(h,{label:e.$t("custom_actions.fields.entity_type"),options:o.entityTypeOptions,modelValue:o.form.entityType,"onUpdate:modelValue":t[3]||(t[3]=d=>o.form.entityType=d),"locale-key-prefix":"custom_actions.entity_types.",onEnter:l.confirmClicked},null,8,["label","options","modelValue","onEnter"]),r(a,{label:e.$t("custom_actions.fields.is_ajax"),modelValue:o.form.isAjax,"onUpdate:modelValue":t[4]||(t[4]=d=>o.form.isAjax=d),onEnter:l.confirmClicked},null,8,["label","modelValue","onEnter"])],32),r(p,{"error-text":e.$t("custom_actions.create_error"),"is-loading":i.isLoading,"is-error":i.isError,onConfirm:l.confirmClicked,onCancel:t[6]||(t[6]=d=>e.$emit("cancel"))},null,8,["error-text","is-loading","is-error","onConfirm"])])])],2)}const re=C(ie,[["render",de],["__scopeId","data-v-9e390c6b"]]),me={name:"custom-actions",components:{CustomActionList:se,DeleteModal:U,EditCustomActionModal:re,ListPageHeader:S},data(){return{modals:{edit:!1,del:!1},loading:{edit:!1,del:!1,list:!1},errors:{edit:!1,del:!1,list:!1},customActionToDelete:null,customActionToEdit:null}},computed:{...F(["customActions"]),deleteText(){const e=this.customActionToDelete;return e?this.$t("custom_actions.delete_text",{name:e.name}):""}},async created(){this.loading.list=!0,this.errors.list=!1;try{await this.loadCustomActions()}catch{this.errors.list=!0}finally{this.loading.list=!1}},methods:{...N(["deleteCustomAction","editCustomAction","loadCustomActions","newCustomAction"]),confirmEditCustomAction(e){let t="newCustomAction";this.customActionToEdit&&this.customActionToEdit.id&&(t="editCustomAction",e.id=this.customActionToEdit.id),this.loading.edit=!0,this.errors.edit=!1,this[t](e).then(()=>{this.modals.edit=!1}).catch(i=>{console.error(i),this.errors.edit=!0,this.modals.isNewDisplayed=!1}).finally(()=>{this.loading.edit=!1})},confirmDeleteCustomAction(){this.loading.del=!0,this.errors.del=!1,this.deleteCustomAction(this.customActionToDelete).then(()=>{this.modals.del=!1}).catch(e=>{console.error(e),this.errors.del=!0}).finally(()=>{this.loading.del=!1})},onExportClicked(){const e=I.slugify(this.$t("custom_actions.title")),i=[[this.$t("main.type"),this.$t("custom_actions.fields.name"),this.$t("custom_actions.fields.url"),this.$t("custom_actions.fields.entity_type"),this.$t("custom_actions.fields.is_ajax")]].concat(this.customActions.map(u=>[u.type,u.name,u.url,u.entity_type,u.is_ajax]));O.buildCsvFile(e,i)},onNewClicked(){this.customActionToEdit={},this.errors.edit=!1,this.modals.edit=!0},onEditClicked(e){this.customActionToEdit=e,this.errors.edit=!1,this.modals.edit=!0},onDeleteClicked(e){this.customActionToDelete=e,this.errors.del=!1,this.modals.del=!0}},head(){return{title:`${this.$t("custom_actions.title")} - Kitsu`}}},ue={class:"custom-actions page fixed-page"};function fe(e,t,i,u,o,l){const _=c("list-page-header"),h=c("custom-action-list"),a=c("edit-custom-action-modal"),p=c("delete-modal");return m(),f("div",ue,[r(_,{title:e.$t("custom_actions.title"),"new-entry-label":e.$t("custom_actions.new_custom_action"),onExportClicked:l.onExportClicked,onNewClicked:l.onNewClicked},null,8,["title","new-entry-label","onExportClicked","onNewClicked"]),r(h,{entries:e.customActions,"is-loading":o.loading.list,"is-error":o.errors.list,onEditClicked:l.onEditClicked,onDeleteClicked:l.onDeleteClicked},null,8,["entries","is-loading","is-error","onEditClicked","onDeleteClicked"]),o.modals.edit?(m(),b(a,{key:0,active:"","is-loading":o.loading.edit,"is-error":o.errors.edit,"custom-action-to-edit":o.customActionToEdit,onCancel:t[0]||(t[0]=y=>o.modals.edit=!1),onConfirm:l.confirmEditCustomAction},null,8,["is-loading","is-error","custom-action-to-edit","onConfirm"])):E("",!0),o.modals.del?(m(),b(p,{key:1,active:"","is-loading":o.loading.del,"is-error":o.errors.del,text:l.deleteText,"error-text":e.$t("custom_actions.delete_error"),onCancel:t[1]||(t[1]=y=>o.modals.del=!1),onConfirm:l.confirmDeleteCustomAction},null,8,["is-loading","is-error","text","error-text","onConfirm"])):E("",!0)])}const pe=C(me,[["render",fe]]);export{pe as default};
//# sourceMappingURL=CustomActions-1CERcfGC.js.map
