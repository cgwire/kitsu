import{_ as y,M as k,b as F,r,q as g,o as n,c as a,d as l,t as u,I as c,g as p,h,k as x,f as m,O as E,F as M,e as S,n as w}from"./index-C2m_IhNF.js";import{C as B}from"./Combobox-DQpIQydI.js";import{M as U}from"./BuildFilterModal-C3nrV5vY.js";import{M as D}from"./ModalFooter-BJ98b-60.js";import{T as P}from"./TextField-p_HJuEKt.js";import{T as j}from"./TextareaField-Bd7jnoYr.js";const O={name:"edit-edit-modal",mixins:[k],components:{Combobox:B,MetadataField:U,ModalFooter:D,TextField:P,TextareaField:j},props:{active:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},editToEdit:{type:Object,default:()=>{}}},emits:["cancel","confirm","confirm-and-stay"],data(){return{form:{name:"",description:"",parent_id:null,data:{resolution:""}},editSuccessText:""}},computed:{...F(["currentProduction","currentEpisode","editCreated","editMetadataDescriptors","episodes","isTVShow","openProductions"]),episodeOptions(){const i=this.episodes.map(e=>({label:e.name,value:e.id}));return[{label:"-",value:null}].concat(i)}},methods:{runConfirmation(){this.isEditing()?this.confirmClicked():this.confirmAndStayClicked()},confirmAndStayClicked(){this.$emit("confirm-and-stay",this.form)},confirmClicked(){this.$emit("confirm",this.form)},isEditing(){return this.editToEdit&&this.editToEdit.id},resetForm(){this.editSuccessText="",this.isEditing()?this.form={project_id:this.editToEdit.project_id,name:this.editToEdit.name,description:this.editToEdit.description,parent_id:this.editToEdit.parent_id,data:{...this.editToEdit.data,resolution:this.editToEdit.data.resolution||""}}:(this.openProductions.length>0&&(this.form.project_id=this.currentProduction?this.currentProduction.id:""),this.form.name="",this.form.description="",this.form.parent_id=this.currentEpisode?this.currentEpisode.id:null,this.form.data={resolution:""})}},mounted(){this.resetForm()},watch:{active(){this.editSuccessText="",this.resetForm(),this.active&&setTimeout(()=>{this.$refs.nameField.focus()},100)},editToEdit(){this.resetForm()},editCreated(){this.isEditing()?this.editSuccessText=this.$t("edits.edit_success",{name:this.editCreated}):this.editSuccessText=this.$t("edits.new_success",{name:this.editCreated})}}},K={class:"modal-content"},L={class:"box"},N={key:0,class:"title"},A={key:1,class:"title"};function I(i,e,s,q,o,d){const T=r("combobox"),f=r("text-field"),_=r("textarea-field"),C=r("metadata-field"),b=r("modal-footer"),V=g("focus");return n(),a("div",{class:w({modal:!0,"is-active":s.active})},[l("div",{class:"modal-background",onClick:e[0]||(e[0]=t=>i.$emit("cancel"))}),l("div",K,[l("div",L,[s.editToEdit&&s.editToEdit.id?(n(),a("h1",N,u(i.$t("edits.edit_title"))+" "+u(s.editToEdit.name),1)):(n(),a("h1",A,u(i.$t("edits.new_edit")),1)),l("form",{onSubmit:e[5]||(e[5]=c(()=>{},["prevent"]))},[i.isTVShow?(n(),p(T,{key:0,label:i.$t("edits.fields.episode"),options:d.episodeOptions,modelValue:o.form.parent_id,"onUpdate:modelValue":e[1]||(e[1]=t=>o.form.parent_id=t)},null,8,["label","options","modelValue"])):h("",!0),x(m(f,{ref:"nameField",label:i.$t("edits.fields.name"),modelValue:o.form.name,"onUpdate:modelValue":e[2]||(e[2]=t=>o.form.name=t),modelModifiers:{trim:!0},onEnter:d.runConfirmation},null,8,["label","modelValue","onEnter"]),[[V]]),m(f,{ref:"resolutionField",label:i.$t("shots.fields.resolution"),onEnter:d.runConfirmation,modelValue:o.form.data.resolution,"onUpdate:modelValue":e[3]||(e[3]=t=>o.form.data.resolution=t)},null,8,["label","onEnter","modelValue"]),m(_,{ref:"descriptionField",label:i.$t("edits.fields.description"),modelValue:o.form.description,"onUpdate:modelValue":e[4]||(e[4]=t=>o.form.description=t),onKeyup:[E(c(d.runConfirmation,["ctrl"]),["enter"]),E(c(d.runConfirmation,["meta"]),["enter"])]},null,8,["label","modelValue","onKeyup"]),s.editToEdit?(n(!0),a(M,{key:1},S(i.editMetadataDescriptors,t=>(n(),p(C,{key:t.id,descriptor:t,entity:s.editToEdit,onEnter:d.runConfirmation,modelValue:o.form.data[t.field_name],"onUpdate:modelValue":v=>o.form.data[t.field_name]=v},null,8,["descriptor","entity","onEnter","modelValue","onUpdate:modelValue"]))),128)):h("",!0)],32),m(b,{"error-text":i.$t("edits.edit_error"),"is-loading":s.isLoading,"is-error":s.isError,onConfirm:d.confirmClicked,onCancel:e[6]||(e[6]=t=>i.$emit("cancel"))},null,8,["error-text","is-loading","is-error","onConfirm"])])])],2)}const W=y(O,[["render",I],["__scopeId","data-v-607b0be3"]]);export{W as E};
//# sourceMappingURL=EditEditModal-BS_3jZ0f.js.map
