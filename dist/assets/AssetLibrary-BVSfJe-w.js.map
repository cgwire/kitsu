{"version":3,"file":"AssetLibrary-BVSfJe-w.js","sources":["../../src/components/sides/ManageLibrary.vue","../../src/components/pages/AssetLibrary.vue"],"sourcesContent":["<template>\n  <div class=\"side-wrapper\">\n    <div class=\"extend-bar\" v-if=\"extendable\"></div>\n    <div class=\"side manage-library\">\n      <div class=\"flexrowcolumn\" v-if=\"selectedEntities.length\">\n        <delete-entities\n          :error-text=\"$t('assets.multiple_delete_error')\"\n          :is-loading=\"loading\"\n          :is-error=\"error\"\n          :text=\"\n            $tc('library.remove_selected_assets', selectedEntities.length, {\n              nbSelectedAssets: selectedEntities.length\n            })\n          \"\n          @confirm=\"removeSharedEntities(selectedEntities)\"\n        />\n        <div class=\"has-text-centered pa1\">\n          <a @click=\"clearSelectedAssets()\">{{ $t('main.clear_selection') }}</a>\n        </div>\n        <!--h1 class=\"title mt05\">{{ $tc('tasks.selected_entities') }}</h1>\n        <div class=\"pa2 mt1\">\n          <div\n            class=\"entity-line\"\n            :key=\"entity.id\"\n            v-for=\"entity in selectedEntities\"\n          >\n            {{ entity.full_name }}\n          </div>\n        </div-->\n      </div>\n\n      <hr v-if=\"selectedEntities.length\" />\n\n      <h2 class=\"mt0\">{{ $t('library.manage') }}</h2>\n      <div class=\"has-text-centered mt2\" v-if=\"!openProductions.length\">\n        {{ $t('library.no_open_productions') }}\n      </div>\n\n      <template v-else>\n        <div class=\"flexcolumn mt2\">\n          <combobox-production\n            class=\"flexrow-item\"\n            :label=\"$t('library.select_production')\"\n            :production-list=\"openProductions\"\n            :with-margin=\"false\"\n            v-model=\"productionId\"\n          />\n          <combobox\n            class=\"flexrow-item mt2\"\n            :disabled=\"!productionId\"\n            :label=\"$t('library.select_asset_type')\"\n            :options=\"productionEntityTypes\"\n            :with-margin=\"false\"\n            v-model=\"entityTypeId\"\n          />\n        </div>\n        <div class=\"flexcolumn mt2\">\n          <button-simple\n            class=\"flexrow-item mb05\"\n            :disabled=\"!productionId\"\n            :is-loading=\"loading\"\n            :text=\"$t('library.import_from_production')\"\n            @click=\"importFromProduction(productionId)\"\n          />\n\n          <button-simple\n            class=\"flexrow-item\"\n            :disabled=\"!productionId\"\n            :is-loading=\"loading\"\n            :text=\"$t('library.import_from_asset_type')\"\n            @click=\"importFromAssetType(productionId, entityTypeId)\"\n          />\n          <hr class=\"mt1\" />\n\n          <button-simple\n            class=\"flexrow-item\"\n            :disabled=\"!entityIds.length\"\n            :is-loading=\"loading\"\n            :text=\"$t('library.import_from_list')\"\n            @click=\"importFromEntityIds(entityIds)\"\n          />\n        </div>\n        <div class=\"flexcolumn\">\n          <div class=\"mt1\" v-if=\"!productionUnsharedEntities.length\">\n            {{ $t('library.no_entities') }}\n          </div>\n          <div class=\"unshared-entities mt1\" v-else>\n            <table class=\"datatable\">\n              <tr\n                class=\"datatable-row\"\n                :key=\"entity.id\"\n                v-for=\"entity in productionUnsharedEntities\"\n              >\n                <td\n                  class=\"datatable-row-header pointer\"\n                  @click=\"toggleEntity(entity)\"\n                >\n                  <div class=\"flexrow\">\n                    <input\n                      type=\"checkbox\"\n                      class=\"flexrow-item\"\n                      :checked=\"isSelected(entity)\"\n                    />\n                    <entity-thumbnail\n                      class=\"entity-thumbnail flexrow-item\"\n                      :entity=\"entity\"\n                      :width=\"50\"\n                      :height=\"30\"\n                      :empty-width=\"50\"\n                      :empty-height=\"32\"\n                    />\n                    <span class=\"entity-name ml05\">\n                      {{ entity.name }}\n                    </span>\n                  </div>\n                </td>\n              </tr>\n            </table>\n          </div>\n        </div>\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\n\nimport ButtonSimple from '@/components/widgets/ButtonSimple.vue'\nimport Combobox from '@/components/widgets/Combobox.vue'\nimport ComboboxProduction from '@/components/widgets/ComboboxProduction.vue'\nimport DeleteEntities from '@/components/tops/actions/DeleteEntities.vue'\nimport EntityThumbnail from '@/components/widgets/EntityThumbnail.vue'\n\nexport default {\n  name: 'manage-library',\n\n  components: {\n    ButtonSimple,\n    Combobox,\n    ComboboxProduction,\n    DeleteEntities,\n    EntityThumbnail\n  },\n\n  props: {\n    extendable: {\n      type: Boolean,\n      default: true\n    }\n  },\n\n  emits: ['library-updated'],\n\n  data() {\n    return {\n      productionId: null,\n      entityTypeId: null,\n      entityIds: [],\n      loading: false,\n      error: false\n    }\n  },\n\n  async mounted() {\n    this.productionId = this.openProductions[0]?.id\n    this.$nextTick(() => {\n      this.entityTypeId = this.productionEntityTypes[0]?.value\n    })\n    await this.refresh()\n  },\n\n  computed: {\n    ...mapGetters([\n      'assetTypes',\n      'assetTypeMap',\n      'openProductions',\n      'productionMap',\n      'selectedAssets',\n      'unsharedAssets'\n    ]),\n\n    productionEntityTypes() {\n      const production = this.productionMap.get(this.productionId)\n      if (!production) return []\n\n      const types = !production.asset_types?.length\n        ? this.assetTypes\n        : this.assetTypes.filter(type =>\n            production.asset_types.includes(type.id)\n          )\n\n      return types.map(type => ({ label: type.name, value: type.id }))\n    },\n\n    productionUnsharedEntities() {\n      return this.unsharedAssets.filter(\n        entity =>\n          entity.project_id === this.productionId &&\n          entity.entity_type_id === this.entityTypeId\n      )\n    },\n\n    selectedEntities() {\n      return [...this.selectedAssets.values()]\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'clearSelectedAssets',\n      'loadUnsharedAssets',\n      'shareAssets',\n      'unshareAssets'\n    ]),\n\n    async refresh() {\n      this.loading = true\n      this.entityIds = []\n      const production = this.productionMap.get(this.productionId)\n      try {\n        await this.loadUnsharedAssets({ production })\n      } catch (error) {\n        console.error(error)\n      }\n      this.loading = false\n    },\n\n    toggleEntities(entities) {\n      const allSelected = entities.every(entity => this.isSelected(entity))\n      entities.forEach(entity => this.toggleEntity(entity, !allSelected))\n    },\n\n    toggleEntity(entity, force = false) {\n      if (force || !this.isSelected(entity)) {\n        this.entityIds.push(entity.id)\n      } else {\n        this.entityIds = this.entityIds.filter(id => id !== entity.id)\n      }\n    },\n\n    isSelected(entity) {\n      return this.entityIds.includes(entity.id)\n    },\n\n    async importFromProduction(productionId) {\n      this.loading = true\n      const production = this.productionMap.get(productionId)\n      try {\n        await this.shareAssets({ production })\n        this.$emit('library-updated')\n      } catch (error) {\n        console.error(error)\n      }\n      this.loading = false\n      await this.refresh()\n    },\n\n    async importFromAssetType(productionId, assetTypeId) {\n      this.loading = true\n      const production = this.productionMap.get(productionId)\n      const assetType = this.assetTypeMap.get(assetTypeId)\n      try {\n        await this.shareAssets({ production, assetType })\n        this.$emit('library-updated')\n      } catch (error) {\n        console.error(error)\n      }\n      this.loading = false\n      await this.refresh()\n    },\n\n    async importFromEntityIds(entityIds) {\n      this.loading = true\n      try {\n        await this.shareAssets({ assetIds: entityIds })\n        this.$emit('library-updated')\n      } catch (error) {\n        console.error(error)\n      }\n      this.loading = false\n      await this.refresh()\n    },\n\n    async removeSharedEntities(entities) {\n      this.loading = true\n      const entityIds = entities.map(entitie => entitie.id)\n      try {\n        await this.unshareAssets({ assetIds: entityIds })\n        this.$emit('library-updated')\n        this.clearSelectedAssets()\n      } catch (error) {\n        console.error(error)\n      }\n      this.loading = false\n      await this.refresh()\n    }\n  },\n\n  watch: {\n    productionId() {\n      this.refresh()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.dark {\n  .extend-bar {\n    background: #46494f;\n  }\n\n  .side {\n    background: #36393f;\n    color: $white;\n  }\n}\n\n.extend-bar {\n  width: 3px;\n  margin-left: 3px;\n  background: #ccc;\n}\n\n.side-wrapper {\n  display: flex;\n  align-items: stretch;\n  min-height: 100%;\n}\n\n.side {\n  flex: 1;\n  overflow: auto;\n  background: #f8f8f8;\n  min-height: 100%;\n}\n\n.manage-library {\n  padding: 1em;\n}\n\n.mt0 {\n  margin-top: 0;\n}\n\n.unshared-entities {\n  min-height: 200px;\n  max-height: calc(100vh - 530px);\n  overflow: hidden auto;\n\n  .entity-name {\n    font-weight: bold;\n  }\n}\n</style>\n","<template>\n  <page-layout :side=\"isCurrentUserManager\">\n    <template #main>\n      <div class=\"asset-library\">\n        <header class=\"flexrow\">\n          <page-title class=\"mt1 filler\" :text=\"$t('library.asset_library')\" />\n        </header>\n\n        <div class=\"filters flexrow\">\n          <search-field\n            ref=\"search-field\"\n            class=\"flexrow-item\"\n            @change=\"onSearchChange\"\n            :can-save=\"false\"\n            v-focus\n          />\n          <combobox-production\n            class=\"flexrow-item\"\n            :label=\"$t('main.production')\"\n            :production-list=\"productionList\"\n            v-model=\"filters.productionId\"\n          />\n          <span class=\"filler\"></span>\n          <combobox\n            class=\"flexrow-item\"\n            :label=\"$t('main.sorted_by')\"\n            :options=\"sorting.options\"\n            locale-key-prefix=\"library.fields.\"\n            v-model=\"sorting.current\"\n          />\n        </div>\n\n        <div class=\"entities mb2\">\n          <table-info\n            :is-loading=\"loading.sharedAssets\"\n            :is-error=\"errors.sharedAssets\"\n            v-if=\"loading.sharedAssets || errors.sharedAssets\"\n          />\n          <div\n            class=\"has-text-centered\"\n            v-else-if=\"!displayedSharedAssets.length\"\n          >\n            {{ $t('library.no_shared_assets') }}\n          </div>\n          <template v-else>\n            <div\n              class=\"pb1\"\n              :key=\"index\"\n              v-for=\"(group, index) in sortedSharedAssetsByType\"\n            >\n              <h2 class=\"mt0\">\n                {{ group[0].asset_type_name }} ({{ group.length }})\n              </h2>\n              <ul class=\"items\">\n                <li\n                  class=\"item flexcolumn\"\n                  :class=\"{\n                    'selectable-item': isCurrentUserManager,\n                    'selected-item': isSelected(entity)\n                  }\"\n                  :key=\"entity.id\"\n                  @click=\"isCurrentUserManager && toggleEntity(entity)\"\n                  v-for=\"entity in group\"\n                >\n                  <div class=\"card\" :title=\"entity.full_name\">\n                    <entity-preview\n                      :empty-height=\"100\"\n                      :empty-width=\"150\"\n                      :height=\"100\"\n                      :width=\"150\"\n                      :entity=\"entity\"\n                      is-rounded-top-border\n                    />\n                    <div class=\"item-description flexrow\">\n                      <production-name\n                        class=\"flexrow-item mr0\"\n                        :production=\"entity.production\"\n                        :size=\"20\"\n                        only-avatar\n                      />\n                      <div class=\"entity-name ml1 flexrow-item\">\n                        {{ entity.name }}\n                      </div>\n                    </div>\n                  </div>\n                </li>\n              </ul>\n            </div>\n          </template>\n        </div>\n      </div>\n    </template>\n    <template #side>\n      <manage-library @library-updated=\"refresh(true)\" />\n    </template>\n  </page-layout>\n</template>\n\n<script>\nimport { firstBy } from 'thenby'\nimport { mapGetters, mapActions } from 'vuex'\n\nimport { searchMixin } from '@/components/mixins/search'\n\nimport Combobox from '@/components/widgets/Combobox.vue'\nimport ComboboxProduction from '@/components/widgets/ComboboxProduction.vue'\nimport EntityPreview from '@/components/widgets/EntityPreview.vue'\nimport ManageLibrary from '@/components/sides/ManageLibrary.vue'\nimport PageLayout from '@/components/layouts/PageLayout.vue'\nimport PageTitle from '@/components/widgets/PageTitle.vue'\nimport ProductionName from '@/components/widgets/ProductionName.vue'\nimport SearchField from '@/components/widgets/SearchField.vue'\nimport TableInfo from '@/components/widgets/TableInfo.vue'\n\nexport default {\n  name: 'asset-library',\n\n  mixins: [searchMixin],\n\n  components: {\n    Combobox,\n    ComboboxProduction,\n    EntityPreview,\n    ManageLibrary,\n    PageLayout,\n    PageTitle,\n    ProductionName,\n    SearchField,\n    TableInfo\n  },\n\n  data() {\n    return {\n      errors: {\n        sharedAssets: false\n      },\n      filters: {\n        productionId: null\n      },\n      loading: {\n        sharedAssets: false\n      },\n      sorting: {\n        current: 'name',\n        options: ['name', 'production', 'created_at', 'updated_at'].map(\n          name => ({\n            label: name,\n            value: name\n          })\n        )\n      }\n    }\n  },\n\n  mounted() {\n    this.filters.productionId = this.$route.query.production || undefined\n    this.searchField.setValue(this.$route.query.search || undefined)\n    this.$nextTick(() => {\n      this.onSearchChange()\n    })\n  },\n\n  computed: {\n    ...mapGetters([\n      'displayedSharedAssets',\n      'displayedSharedAssetsByType',\n      'isCurrentUserManager',\n      'openProductions',\n      'productionMap',\n      'selectedAssets'\n    ]),\n\n    searchField() {\n      return this.$refs['search-field']\n    },\n\n    productionList() {\n      return [{ name: this.$t('main.all') }, ...this.openProductions]\n    },\n\n    sortedSharedAssetsByType() {\n      const nameFilter = (a, b) =>\n        a.name.localeCompare(b.name, undefined, { numeric: true })\n      const productionFilter = (a, b) =>\n        a.production.name.localeCompare(b.production.name, undefined, {\n          numeric: true\n        })\n      return this.displayedSharedAssetsByType.map(type => {\n        if (this.sorting.current === 'production') {\n          return type.sort(firstBy(productionFilter).thenBy(nameFilter))\n        }\n        if (this.sorting.current === 'created_at') {\n          return type.sort(firstBy('created_at'))\n        }\n        if (this.sorting.current === 'updated_at') {\n          return type.sort(firstBy('updated_at', -1))\n        }\n        return type.sort(firstBy(nameFilter).thenBy(productionFilter))\n      })\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'loadSharedAssets',\n      'setAssetSelection',\n      'setSharedAssetSearch'\n    ]),\n\n    async refresh(silent = false) {\n      this.loading.sharedAssets = !silent\n      const production = this.productionMap.get(this.filters.productionId)\n      try {\n        await this.loadSharedAssets({ production })\n      } catch (error) {\n        console.error(error)\n        this.errors.sharedAssets = true\n      }\n      this.loading.sharedAssets = false\n    },\n\n    toggleEntity(entity) {\n      const selected = this.isSelected(entity)\n      this.setAssetSelection({ asset: entity, selected: !selected })\n    },\n\n    isSelected(entity) {\n      return this.selectedAssets.has(entity.id)\n    },\n\n    onSearchChange() {\n      const searchQuery = this.searchField.getValue() || ''\n      this.setSharedAssetSearch(searchQuery)\n      this.setSearchInUrl()\n    },\n\n    updateRoute({ production, search }) {\n      const query = {\n        ...this.$route.query,\n        production: production || undefined,\n        search: search || undefined\n      }\n\n      if (JSON.stringify(query) !== JSON.stringify(this.$route.query)) {\n        this.$router.push({ query })\n      }\n    }\n  },\n\n  watch: {\n    'filters.productionId'(value) {\n      this.updateRoute({ production: value })\n      this.refresh()\n    }\n  },\n\n  head() {\n    return {\n      title: `${this.$t('library.asset_library')} - Kitsu`\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.asset-library {\n  display: flex;\n  flex-direction: column;\n  max-height: 100%;\n  padding: 4em 2em 1em 2em;\n  color: var(--text);\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.entities {\n  .items {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 20px;\n  }\n\n  .item {\n    background-color: var(--background);\n    border: 5px solid transparent;\n    border-radius: 1em;\n    height: fit-content;\n    transition: border-color 0.2s ease-in-out;\n\n    &.selectable-item {\n      cursor: pointer;\n\n      &:hover {\n        border-color: var(--background-selectable);\n      }\n    }\n\n    &.selected-item {\n      border-color: var(--background-selected);\n    }\n\n    .card {\n      border-radius: inherit;\n      box-shadow: 4px 4px 4px rgba(0, 0, 0, 0.1);\n\n      .dark & {\n        background-color: var(--background-alt);\n      }\n    }\n\n    .item-description {\n      color: var(--text-strong);\n      font-size: 0.9em;\n      font-weight: bold;\n      max-width: 150px;\n      min-width: 150px;\n      padding: 0.5em;\n\n      .entity-name {\n        margin-left: 0.5em;\n        word-break: break-word;\n      }\n    }\n  }\n}\n</style>\n"],"names":["_sfc_main","ButtonSimple","Combobox","ComboboxProduction","DeleteEntities","EntityThumbnail","mapGetters","production","type","entity","mapActions","error","entities","allSelected","force","id","productionId","assetTypeId","assetType","entityIds","entitie","_hoisted_1","_hoisted_3","_hoisted_5","_hoisted_7","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_openBlock","_createElementBlock","$props","_hoisted_2","_createCommentVNode","_createElementVNode","$options","_hoisted_4","_createVNode","_component_delete_entities","_ctx","$data","_cache","$event","_hoisted_6","_toDisplayString","_Fragment","_component_combobox_production","_component_combobox","_component_button_simple","_hoisted_13","_renderList","_component_entity_thumbnail","_hoisted_12","_hoisted_8","searchMixin","EntityPreview","ManageLibrary","PageLayout","PageTitle","ProductionName","SearchField","TableInfo","name","nameFilter","a","b","productionFilter","firstBy","silent","selected","searchQuery","search","query","value","_createBlock","_component_page_layout","_component_page_title","_component_search_field","_component_table_info","group","index","_normalizeClass","_component_entity_preview","_component_production_name","_component_manage_library"],"mappings":"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"}