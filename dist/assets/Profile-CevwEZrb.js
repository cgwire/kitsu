import{_ as V,R as A,r as u,o as d,c as p,d as l,f as i,t,k as b,b_ as v,F as k,e as C,b$ as P,g as c,h as _,n as m,c0 as F,a as S,m as U,b as E}from"./index-DF-DoQlt.js";import{C as L}from"./ComboboxBoolean-DT116Lfu.js";import{C as y}from"./ChangeAvatarModal--OG4x0GT.js";import{T as M}from"./TextField-BKWlN2Ov.js";import{T as z}from"./TwoFactorAuthenticationSetup-3e596Ht1.js";import"./Combobox-A6pnhVs3.js";import"./FileUpload-GCzHM4-i.js";import"./ModalFooter-Chk0SGv-.js";import"./circle-x-BpLnzO06.js";import"./copy-DgQ7ppWI.js";import"./trash-DWKk5Pv9.js";const R={name:"profile",components:{ComboboxBoolean:L,PeopleAvatar:A,ChangeAvatarModal:y,TextField:M,TwoFactorAuthenticationSetup:z},data(){return{form:{first_name:"",last_name:"",notifications_enabled:"false",notifications_slack_enabled:"false",notifications_slack_userid:"",notifications_mattermost_enabled:"false",notifications_mattermost_userid:"",notifications_discord_enabled:"false",notifications_discord_userid:"",email:"",phone:"",timezone:"Europe/Paris",locale:"French"},passwordForm:{oldPassword:"",password:"",password2:""},changeAvatar:{isModalShown:!1,isLoading:!1,isLoadingError:!1,formData:null}}},watch:{user(){Object.assign(this.form,this.user)}},computed:{...E(["changePassword","isSaveProfileLoading","isSaveProfileLoadingError","user"]),timezones(){return U.tz.names().filter(e=>e.indexOf("/")>0&&e.indexOf("Etc")<0)}},methods:{...S(["checkNewPasswordValidityAndSave","clearAvatar","saveProfile","uploadAvatar"]),localeChanged(){F.setLocale(this.form.locale)},async passwordChangeRequested(){await this.checkNewPasswordValidityAndSave({form:this.passwordForm}),this.changePassword.isSuccess&&(this.passwordForm={oldPassword:"",password:"",password2:""})},selectFile(e){this.$store.commit("CHANGE_AVATAR_FILE",e)},uploadAvatarFile(){this.changeAvatar.isLoading=!0,this.changeAvatar.isError=!1,this.uploadAvatar().catch(e=>{console.error(e),this.changeAvatar.isError=!0}).finally(()=>{this.changeAvatar.isLoading=!1,this.hideAvatarModal()})},hideAvatarModal(){this.changeAvatar.isModalShown=!1},showAvatarModal(){this.changeAvatar.isModalShown=!0},removeAvatar(){this.clearAvatar()}},mounted(){this.form=Object.assign(this.form,this.user),this.form.notifications_enabled=this.form.notifications_enabled?"true":"false",this.form.notifications_slack_enabled=this.form.notifications_slack_enabled?"true":"false",this.form.notifications_mattermost_enabled=this.form.notifications_mattermost_enabled?"true":"false",this.form.notifications_discord_enabled=this.form.notifications_discord_enabled?"true":"false"},head(){return{title:`${this.$t("profile.title")} - Kitsu`}}},N={class:"profile page"},D={class:"profile-content"},B={class:"has-text-centered profile-header"},T={class:"profile-header-content has-text-centered"},H={class:"profile-body"},O={class:"field"},j={class:"label"},G={class:"select is-medium"},I={class:"field"},K={class:"label"},q={class:"select is-medium"},J=["value"],W={class:"field"},Q={class:"field"},X={class:"field"},Y={class:"field"},Z=["disabled"];function $(e,o,x,ee,s,r){const h=u("people-avatar"),n=u("text-field"),f=u("combobox-boolean"),g=u("two-factor-authentication-setup"),w=u("change-avatar-modal");return d(),p("div",N,[l("div",D,[l("div",B,[l("div",T,[i(h,{"is-lazy":!1,person:e.user,size:150,"font-size":60},null,8,["person"]),l("p",null,[l("button",{class:"button is-link change-avatar-button",onClick:o[0]||(o[0]=(...a)=>r.showAvatarModal&&r.showAvatarModal(...a))},t(e.$t("profile.change_avatar")),1)]),l("p",null,[l("button",{class:"button is-link clear-avatar-button",onClick:o[1]||(o[1]=(...a)=>r.removeAvatar&&r.removeAvatar(...a))},t(e.$t("profile.clear_avatar")),1)]),l("h1",null,t(e.$t("profile.title")),1)])]),l("div",H,[l("h2",null,t(e.$t("profile.info_title")),1),i(n,{label:e.$t("people.fields.first_name"),disabled:e.user.is_generated_from_ldap,modelValue:s.form.first_name,"onUpdate:modelValue":o[2]||(o[2]=a=>s.form.first_name=a)},null,8,["label","disabled","modelValue"]),i(n,{label:e.$t("people.fields.last_name"),disabled:e.user.is_generated_from_ldap,modelValue:s.form.last_name,"onUpdate:modelValue":o[3]||(o[3]=a=>s.form.last_name=a)},null,8,["label","disabled","modelValue"]),i(n,{label:e.$t("people.fields.email"),disabled:e.user.is_generated_from_ldap,modelValue:s.form.email,"onUpdate:modelValue":o[4]||(o[4]=a=>s.form.email=a)},null,8,["label","disabled","modelValue"]),i(n,{label:e.$t("people.fields.phone"),modelValue:s.form.phone,"onUpdate:modelValue":o[5]||(o[5]=a=>s.form.phone=a)},null,8,["label","modelValue"]),l("div",O,[l("label",j,t(e.$t("profile.timezone")),1),l("span",G,[b(l("select",{"onUpdate:modelValue":o[6]||(o[6]=a=>s.form.timezone=a)},[(d(!0),p(k,null,C(r.timezones,a=>(d(),p("option",{key:a},t(a),1))),128))],512),[[v,s.form.timezone]])])]),l("div",I,[l("label",K,t(e.$t("profile.language")),1),l("span",q,[b(l("select",{"onUpdate:modelValue":o[7]||(o[7]=a=>s.form.locale=a),value:s.form.locale,onChange:o[8]||(o[8]=(...a)=>r.localeChanged&&r.localeChanged(...a))},o[21]||(o[21]=[P('<option value="zh_Hans_CN" data-v-633c4c71>Chinese</option><option value="zh_Hant_TW" data-v-633c4c71>Chinese (TC)</option><option value="da_DA" data-v-633c4c71>Dannish</option><option value="nl_NL" data-v-633c4c71>Dutch</option><option value="en_US" data-v-633c4c71>English</option><option value="fr_FR" data-v-633c4c71>French</option><option value="de_DE" data-v-633c4c71>German</option><option value="hu_HU" data-v-633c4c71>Hungarian</option><option value="ja_JP" data-v-633c4c71>Japanese</option><option value="ko_KR" data-v-633c4c71>Korean</option><option value="pt_BR" data-v-633c4c71>Portuguese (Brasilian)</option><option value="fa_IR" data-v-633c4c71>Persian</option><option value="es_ES" data-v-633c4c71>Spanish</option><option value="ru_RU" data-v-633c4c71>Russian</option>',14)]),40,J),[[v,s.form.locale]])])]),l("div",W,[i(f,{label:e.$t("profile.notifications_enabled"),modelValue:s.form.notifications_enabled,"onUpdate:modelValue":o[9]||(o[9]=a=>s.form.notifications_enabled=a)},null,8,["label","modelValue"])]),l("div",Q,[i(f,{label:e.$t("profile.notifications_slack_enabled"),modelValue:s.form.notifications_slack_enabled,"onUpdate:modelValue":o[10]||(o[10]=a=>s.form.notifications_slack_enabled=a)},null,8,["label","modelValue"])]),s.form.notifications_slack_enabled==="true"?(d(),c(n,{key:0,label:e.$t("profile.notifications_slack_user"),modelValue:s.form.notifications_slack_userid,"onUpdate:modelValue":o[11]||(o[11]=a=>s.form.notifications_slack_userid=a)},null,8,["label","modelValue"])):_("",!0),l("div",X,[i(f,{label:e.$t("profile.notifications_mattermost_enabled"),modelValue:s.form.notifications_mattermost_enabled,"onUpdate:modelValue":o[12]||(o[12]=a=>s.form.notifications_mattermost_enabled=a)},null,8,["label","modelValue"])]),s.form.notifications_mattermost_enabled==="true"?(d(),c(n,{key:1,label:e.$t("profile.notifications_mattermost_user"),modelValue:s.form.notifications_mattermost_userid,"onUpdate:modelValue":o[13]||(o[13]=a=>s.form.notifications_mattermost_userid=a)},null,8,["label","modelValue"])):_("",!0),l("div",Y,[i(f,{label:e.$t("profile.notifications_discord_enabled"),modelValue:s.form.notifications_discord_enabled,"onUpdate:modelValue":o[14]||(o[14]=a=>s.form.notifications_discord_enabled=a)},null,8,["label","modelValue"])]),s.form.notifications_discord_enabled==="true"?(d(),c(n,{key:2,label:e.$t("profile.notifications_discord_user"),modelValue:s.form.notifications_discord_userid,"onUpdate:modelValue":o[15]||(o[15]=a=>s.form.notifications_discord_userid=a)},null,8,["label","modelValue"])):_("",!0),l("button",{class:m({button:!0,"save-button":!0,"is-medium":!0,"is-loading":e.isSaveProfileLoading}),onClick:o[16]||(o[16]=a=>e.saveProfile({form:s.form}))},t(e.$t("profile.save.button")),3),l("p",{class:m({error:!0,"is-hidden":!e.isSaveProfileLoadingError})},t(e.$t("profile.save.error")),3),l("h2",null,t(e.$t("profile.password_title")),1),i(n,{autocomplete:"current-password",label:e.$t("people.fields.old_password"),disabled:e.user.is_generated_from_ldap,type:"password",modelValue:s.passwordForm.oldPassword,"onUpdate:modelValue":o[17]||(o[17]=a=>s.passwordForm.oldPassword=a)},null,8,["label","disabled","modelValue"]),i(n,{autocomplete:"new-password",label:e.$t("people.fields.password"),disabled:e.user.is_generated_from_ldap,type:"password",modelValue:s.passwordForm.password,"onUpdate:modelValue":o[18]||(o[18]=a=>s.passwordForm.password=a)},null,8,["label","disabled","modelValue"]),i(n,{autocomplete:"new-password",label:e.$t("people.fields.password_2"),disabled:e.user.is_generated_from_ldap,type:"password",modelValue:s.passwordForm.password2,"onUpdate:modelValue":o[19]||(o[19]=a=>s.passwordForm.password2=a)},null,8,["label","disabled","modelValue"]),l("button",{class:m({button:!0,"save-button":!0,"is-medium":!0,"is-loading":e.changePassword.isLoading}),disabled:e.user.is_generated_from_ldap,onClick:o[20]||(o[20]=a=>r.passwordChangeRequested())},t(e.$t("profile.change_password.button")),11,Z),l("p",{class:m({"show-message":!0,error:!0,"is-hidden":e.changePassword.isValid})},t(e.$t("profile.change_password.unvalid")),3),l("p",{class:m({"show-message":!0,success:!0,"is-hidden":!e.changePassword.isSuccess})},t(e.$t("profile.change_password.success")),3),l("p",{class:m({"show-message":!0,error:!0,"is-hidden":!e.changePassword.isError})},t(e.$t("profile.change_password.error")),3),l("h2",null,t(e.$t("profile.two_factor_authentication.title")),1),i(g,{"show-cancel-button":""})])]),i(w,{active:s.changeAvatar.isModalShown,"is-loading":s.changeAvatar.isLoading,"is-error":s.changeAvatar.isLoadingError,"form-data":s.changeAvatar.formData,title:e.$t("profile.avatar.title"),onFileselected:r.selectFile,onConfirm:r.uploadAvatarFile,onCancel:r.hideAvatarModal},null,8,["active","is-loading","is-error","form-data","title","onFileselected","onConfirm","onCancel"])])}const fe=V(R,[["render",$],["__scopeId","data-v-633c4c71"]]);export{fe as default};
//# sourceMappingURL=Profile-CevwEZrb.js.map
