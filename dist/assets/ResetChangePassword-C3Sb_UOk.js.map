{"version":3,"file":"ResetChangePassword-C3Sb_UOk.js","sources":["../../src/components/pages/ResetChangePassword.vue"],"sourcesContent":["<template>\n  <div class=\"hero is-fullheight\">\n    <div class=\"container has-text-centered\">\n      <div class=\"box has-text-left\">\n        <div class=\"has-text-centered\">\n          <h1 class=\"title\">\n            {{\n              isNew\n                ? $t('login.set_password_title')\n                : $t('login.reset_change_password_title')\n            }}\n          </h1>\n        </div>\n\n        <div class=\"field mt2\">\n          <p class=\"control has-icon\">\n            <input\n              class=\"input is-medium email\"\n              type=\"password\"\n              autocomplete=\"new-password\"\n              :placeholder=\"$t('login.fields.password')\"\n              @keyup.enter=\"confirmResetChangePassword\"\n              v-model=\"password\"\n              v-focus\n            />\n            <span class=\"icon\">\n              <lock-icon :size=\"20\" />\n            </span>\n          </p>\n          <p class=\"control has-icon\">\n            <input\n              class=\"input is-medium email\"\n              type=\"password\"\n              autocomplete=\"new-password\"\n              :placeholder=\"$t('login.fields.password2')\"\n              @keyup.enter=\"confirmResetChangePassword\"\n              v-model=\"password2\"\n            />\n            <span class=\"icon\">\n              <lock-icon :size=\"20\" />\n            </span>\n          </p>\n        </div>\n\n        <p class=\"control\">\n          <a\n            :class=\"{\n              'main-button': true,\n              'is-fullwidth': true,\n              'is-loading': isLoading\n            }\"\n            @click=\"confirmResetChangePassword\"\n            v-if=\"!isSuccess\"\n          >\n            {{\n              isNew\n                ? $t('login.set_password')\n                : $t('login.reset_change_password')\n            }}\n          </a>\n        </p>\n        <p class=\"error\" v-show=\"isFormError\">\n          {{ $t('login.reset_change_password_form_failed') }}\n        </p>\n        <p class=\"error\" v-show=\"isError\">\n          {{ $t('login.reset_change_password_failed') }}\n        </p>\n        <p class=\"success\" v-show=\"isSuccess\">\n          {{ $t('login.reset_change_password_succeed') }}\n        </p>\n        <p class=\"has-text-centered mt2 mb2\" v-show=\"isSuccess\">\n          {{ $t('login.redirecting', { secondsLeft }) }}\n        </p>\n        <p class=\"has-text-centered\">\n          <router-link :to=\"{ name: 'login' }\">\n            <span v-if=\"isSuccess\">\n              {{ $t('login.back_to_login') }}\n            </span>\n            <span v-else>\n              {{ $t('login.login_page') }}\n            </span>\n          </router-link>\n        </p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { LockIcon } from 'lucide-vue-next'\nimport { mapActions } from 'vuex'\n\nimport auth from '@/lib/auth'\n\nexport default {\n  name: 'reset-change-password',\n\n  components: {\n    LockIcon\n  },\n\n  data() {\n    return {\n      password: '',\n      password2: '',\n      isLoading: false,\n      isError: false,\n      isFormError: false,\n      isSuccess: false,\n      secondsLeft: 5\n    }\n  },\n\n  mounted() {\n    this.$store.commit('LOGIN_SUCCESS')\n    this.isLoading = false\n    this.isError = false\n    this.secondsLeft = 5\n  },\n\n  computed: {\n    isNew() {\n      return this.$route.query.type === 'new'\n    }\n  },\n\n  methods: {\n    ...mapActions(['resetChangePassword']),\n\n    confirmResetChangePassword() {\n      this.isFormError = false\n      this.isError = false\n      if (auth.isPasswordValid(this.password, this.password2)) {\n        this.isLoading = true\n        this.isSuccess = false\n        this.resetChangePassword({\n          email: this.$route.query.email,\n          token: this.$route.query.token,\n          password: this.password,\n          password2: this.password2\n        })\n          .then(() => {\n            this.isLoading = false\n            this.isSuccess = true\n            const interval = setInterval(() => {\n              this.secondsLeft--\n              if (this.secondsLeft === 0) {\n                this.$router.push({ name: 'login' })\n                clearInterval(interval)\n              }\n            }, 1000)\n          })\n          .catch(() => {\n            this.isLoading = false\n            this.isError = true\n            this.isSuccess = false\n          })\n      } else {\n        this.isFormError = true\n      }\n    }\n  },\n\n  head() {\n    return {\n      title: this.$t('login.reset_change_password_title')\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.box {\n  border-radius: 1em;\n}\n\n.input {\n  height: 3em;\n  padding: 1.5em;\n  border-radius: 4px;\n\n  &::placeholder {\n    color: #999;\n  }\n\n  &:focus {\n    border: 1px solid $green;\n  }\n}\n\n.icon {\n  padding: 0.25em;\n}\n</style>\n"],"names":["_sfc_main","LockIcon","mapActions","auth","interval","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_openBlock","_createElementBlock","_createElementVNode","_toDisplayString","$options","_ctx","_cache","_withKeys","args","$event","$data","_createVNode","_component_lock_icon","_createCommentVNode","_normalizeClass","_withDirectives","_component_router_link","_withCtx","_hoisted_15","_hoisted_16"],"mappings":"oKA8FA,MAAKA,EAAU,CACb,KAAM,wBAEN,WAAY,CACV,SAAAC,GAGF,MAAO,CACL,MAAO,CACL,SAAU,GACV,UAAW,GACX,UAAW,GACX,QAAS,GACT,YAAa,GACb,UAAW,GACX,YAAa,CACf,CACF,EAEA,SAAU,CACR,KAAK,OAAO,OAAO,eAAe,EAClC,KAAK,UAAY,GACjB,KAAK,QAAU,GACf,KAAK,YAAc,CACrB,EAEA,SAAU,CACR,OAAQ,CACN,OAAO,KAAK,OAAO,MAAM,OAAS,KACpC,GAGF,QAAS,CACP,GAAGC,EAAW,CAAC,qBAAqB,CAAC,EAErC,4BAA6B,CAC3B,KAAK,YAAc,GACnB,KAAK,QAAU,GACXC,EAAK,gBAAgB,KAAK,SAAU,KAAK,SAAS,GACpD,KAAK,UAAY,GACjB,KAAK,UAAY,GACjB,KAAK,oBAAoB,CACvB,MAAO,KAAK,OAAO,MAAM,MACzB,MAAO,KAAK,OAAO,MAAM,MACzB,SAAU,KAAK,SACf,UAAW,KAAK,UACjB,EACE,KAAK,IAAM,CACV,KAAK,UAAY,GACjB,KAAK,UAAY,GACjB,MAAMC,EAAW,YAAY,IAAM,CACjC,KAAK,cACD,KAAK,cAAgB,IACvB,KAAK,QAAQ,KAAK,CAAE,KAAM,QAAS,EACnC,cAAcA,CAAQ,EAE1B,EAAG,GAAI,CACT,CAAC,EACA,MAAM,IAAM,CACX,KAAK,UAAY,GACjB,KAAK,QAAU,GACf,KAAK,UAAY,EACnB,CAAC,GAEH,KAAK,YAAc,EAEvB,GAGF,MAAO,CACL,MAAO,CACL,MAAO,KAAK,GAAG,mCAAmC,CACpD,CACF,CACF,EAvKOC,EAAA,CAAA,MAAM,oBAAoB,EACxBC,EAAA,CAAA,MAAM,6BAA6B,EACjCC,EAAA,CAAA,MAAM,mBAAmB,EACvBC,EAAA,CAAA,MAAM,mBAAmB,EACxBC,EAAA,CAAA,MAAM,OAAO,EASdC,EAAA,CAAA,MAAM,WAAW,EACjBC,EAAA,CAAA,MAAM,kBAAkB,EAfrCC,EAAA,CAAA,aAAA,EAyBkBC,EAAA,CAAA,MAAM,MAAM,EAIjBC,EAAA,CAAA,MAAM,kBAAkB,EA7BrCC,EAAA,CAAA,aAAA,EAsCkBC,EAAA,CAAA,MAAM,MAAM,EAMnBC,EAAA,CAAA,MAAM,SAAS,EA6BfC,EAAA,CAAA,MAAM,mBAAmB,KAzEpC,IAAA,CAAA,KAAA,IAAA,CAAA,iFACE,OAAAC,EAAA,EAAAC,EAoFM,MApFNf,EAoFM,CAnFJgB,EAkFM,MAlFNf,EAkFM,CAjFJe,EAgFM,MAhFNd,EAgFM,CA/EJc,EAQM,MARNb,EAQM,CAPJa,EAMK,KANLZ,EAMKa,EAJDC,EAAA,MAAwBC,EAAA,GAAE,0BAAA,EAA+CA,EAAA,GAAE,mCAAA,CAAA,EAAA,CAAA,IAOjFH,EA4BM,MA5BNX,EA4BM,CA3BJW,EAaI,IAbJV,EAaI,GAZFU,EAQE,QAAA,CAPA,MAAM,wBACN,KAAK,WACL,aAAa,eACZ,YAAaG,EAAA,GAAE,uBAAA,EACf,QAAKC,EAAA,CAAA,IAAAA,EAAA,CAAA,EArBpBC,UAqB4BH,EAAA,4BAAAA,EAAA,2BAAA,GAAAI,CAAA,EAA0B,CAAA,OAAA,CAAA,GArBtD,sBAAAF,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAsBuBC,EAAA,SAAQD,EAtB/B,EAAA,KAAA,GAAAhB,CAAA,EAAA,IAsBuBiB,EAAA,QAAQ,QAGnBR,EAEO,OAFPR,EAEO,CADLiB,EAAwBC,EAAA,CAAZ,KAAM,EAAE,CAAA,MAGxBV,EAYI,IAZJP,EAYI,GAXFO,EAOE,QAAA,CANA,MAAM,wBACN,KAAK,WACL,aAAa,eACZ,YAAaG,EAAA,GAAE,wBAAA,EACf,QAAKC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAnCpBC,UAmC4BH,EAAA,4BAAAA,EAAA,2BAAA,GAAAI,CAAA,EAA0B,CAAA,OAAA,CAAA,GAnCtD,sBAAAF,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAoCuBC,EAAA,UAASD,EApChC,EAAA,KAAA,GAAAb,CAAA,EAAA,IAoCuBc,EAAA,SAAS,IAEpBR,EAEO,OAFPL,EAEO,CADLc,EAAwBC,EAAA,CAAZ,KAAM,EAAE,CAAA,QAK1BV,EAgBI,IAhBJJ,EAgBI,CAROY,EAAA,UApDnBG,EAAA,GAAA,EAAA,OA6CUZ,EAcI,IAAA,CA3Dd,IAAA,EA8Ca,MA9Cba,EAAA,iDA8CyHJ,EAAA,YAK5G,4BAAON,EAAA,4BAAAA,EAAA,2BAAA,GAAAI,CAAA,MAINJ,EAAA,MAAwBC,EAAA,GAAE,oBAAA,EAAyCA,EAAA,GAAE,6BAAA,CAAA,EAAA,CAAA,KAM3EU,EAAAb,EAEI,IAAA,CAFD,MAAM,OAAO,IACXG,EAAA,GAAE,yCAAA,CAAA,EAAA,GAAA,EAAA,IADkBK,EAAA,WAAW,IAGpCK,EAAAb,EAEI,IAAA,CAFD,MAAM,OAAO,IACXG,EAAA,GAAE,oCAAA,CAAA,EAAA,GAAA,EAAA,IADkBK,EAAA,OAAO,IAGhCK,EAAAb,EAEI,IAAA,CAFD,MAAM,SAAS,IACbG,EAAA,GAAE,qCAAA,CAAA,EAAA,GAAA,EAAA,IADoBK,EAAA,SAAS,IAGpCK,EAAAb,EAEI,KAFD,MAAM,2BAA2B,EAAAC,EAC/BE,EAAA,oCAA0BK,EAAA,WAAW,CAAA,CAAA,EAAA,GAAA,EAAA,IADGA,EAAA,SAAS,IAGtDR,EASI,IATJH,EASI,CARFY,EAOcK,EAAA,CAPA,GAAI,CAAA,KAAA,OAAA,GAAiB,CA1E7C,QAAAC,EA2EY,IAEO,CAFKP,EAAA,eAAZT,EAEO,OA7EnBiB,IA4EiBb,EAAA,GAAE,qBAAA,CAAA,EAAA,CAAA,QAEPJ,EAEO,OAhFnBkB,IA+EiBd,EAAA,GAAE,kBAAA,CAAA,EAAA,CAAA,KA/EnB,EAAA"}