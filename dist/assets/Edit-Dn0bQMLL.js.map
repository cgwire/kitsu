{"version":3,"file":"Edit-Dn0bQMLL.js","sources":["../../src/components/previews/PreviewsPerTaskType.vue","../../src/components/pages/Edit.vue"],"sourcesContent":["<template>\n  <div class=\"flexrow\">\n    <combobox-styled\n      ref=\"task-type-combobox\"\n      class=\"flexrow-item\"\n      :options=\"taskTypeOptions\"\n      v-model=\"taskTypeId\"\n      v-if=\"taskTypeOptions.length > 0\"\n    />\n\n    <combobox-styled\n      class=\"flexrow-item\"\n      :options=\"previewFileOptions\"\n      v-if=\"previewFileOptions.length\"\n      v-model=\"previewFileId\"\n    />\n    <span class=\"text flexrow-item\" v-else>Selected task has no previews.</span>\n\n    <div class=\"flexrow-item\" v-if=\"taskStatus\">\n      <validation-tag\n        class=\"flexrow-item\"\n        :task=\"{ task_status_id: taskStatus.id }\"\n        :is-static=\"true\"\n        :thin=\"false\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\n/*\n * Widget displaying entity's revisions of previews per task type.\n * It allows to select a given revision for a given task type for current entity.\n */\nimport firstBy from 'thenby'\nimport { mapGetters } from 'vuex'\n\nimport editStore from '@/store/modules/edits'\n\nimport ComboboxStyled from '@/components/widgets/ComboboxStyled.vue'\nimport ValidationTag from '@/components/widgets/ValidationTag.vue'\n\nexport default {\n  name: 'previews-per-task-type',\n\n  components: {\n    ComboboxStyled,\n    ValidationTag\n  },\n\n  emits: ['preview-changed'],\n\n  data() {\n    return {\n      taskTypeId: null,\n      previewFileId: this.entity.preview_file_id\n    }\n  },\n\n  props: {\n    index: {\n      default: 0,\n      type: Number\n    },\n    entity: {\n      default: () => {},\n      type: Object\n    }\n  },\n\n  mounted() {\n    this.setCurrentParameters()\n  },\n\n  computed: {\n    ...mapGetters([\n      'taskMap',\n      'taskTypeMap',\n      'taskStatusMap',\n      'isCurrentUserManager'\n    ]),\n\n    taskTypeOptions() {\n      const entity = editStore.cache.editMap.get(this.entity.id)\n      return entity.tasks\n        .map(taskId => this.taskMap.get(taskId))\n        .map(task => this.taskTypeMap.get(task.task_type_id))\n        .sort(firstBy('priority', 1).thenBy('name'))\n        .map(taskType => {\n          return {\n            label: taskType.name,\n            value: taskType.id\n          }\n        })\n    },\n\n    previewFileOptions() {\n      const previewFiles = this.entity.preview_files[this.taskTypeId] || []\n      return previewFiles.map(previewFile => ({\n        label: `v${previewFile.revision}`,\n        value: previewFile.id\n      }))\n    },\n\n    taskStatus() {\n      if (!editStore.cache.editMap) return ''\n\n      const entity = editStore.cache.editMap.get(this.entity.id)\n      if (!entity) return ''\n\n      const taskId = entity.validations.get(this.taskTypeId)\n      if (taskId) {\n        const task = this.taskMap.get(taskId)\n        if (!task) return ''\n        const taskStatus = this.taskStatusMap.get(task.task_status_id)\n        return taskStatus\n      } else {\n        return ''\n      }\n    }\n  },\n\n  methods: {\n    getTaskTypeIdForPreviewFile(taskTypeIds, previewFileId) {\n      return taskTypeIds.find(taskTypeId => {\n        const previewFiles = this.entity.preview_files[taskTypeId]\n        return previewFiles.some(previewFile => {\n          return previewFile.id === previewFileId\n        })\n      })\n    },\n\n    setCurrentParameters() {\n      // Find task type matching current preview.\n      const taskTypeIds = Object.keys(this.entity.preview_files)\n      if (taskTypeIds.length > 0) {\n        if (this.entity.preview_file_id) {\n          this.taskTypeId = this.getTaskTypeIdForPreviewFile(\n            taskTypeIds,\n            this.entity.preview_file_id\n          )\n        }\n        if (!this.taskTypeId) {\n          this.taskTypeId = taskTypeIds[0]\n        }\n      }\n    }\n  },\n\n  watch: {\n    taskTypeId() {\n      // Set current preview was last preview selected. If there is no preview\n      // matching this task type, it selects the first preview available for\n      // this task type.\n      const previewFiles = this.entity.preview_files[this.taskTypeId]\n      if (previewFiles && previewFiles.length > 0) {\n        const isPreviewFile = previewFiles.some(previewFile => {\n          return previewFile.id === this.entity.preview_file_id\n        })\n        if (isPreviewFile) {\n          this.previewFileId = this.entity.preview_file_id\n        } else {\n          this.previewFileId = previewFiles[0].id\n        }\n      } else {\n        this.previewFileId = null\n      }\n    },\n\n    previewFileId() {\n      let previewFile = null\n      const previewFiles = this.entity.preview_files[this.taskTypeId]\n      if (previewFiles && previewFiles.length > 0) {\n        previewFile = previewFiles.find(previewFile => {\n          return previewFile.id === this.previewFileId\n        })\n      }\n      this.$emit('preview-changed', this.entity, previewFile)\n    },\n\n    'entity.preview_file_id': function () {\n      if (this.previewFileId !== this.entity.preview_file_id) {\n        this.previewFileId = this.entity.preview_file_id\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.field {\n  margin-bottom: 0;\n}\n.text {\n  color: var(--text);\n}\n</style>\n","<template>\n  <div class=\"columns fixed-page edit xyz-in\" xyz=\"fade\">\n    <div class=\"column main-column\">\n      <div class=\"page-header flexrow flexrow-item\" ref=\"page-header-row\">\n        <div class=\"flexrow block mb0 main-block\">\n          <router-link\n            class=\"flexrow-item has-text-centered back-link\"\n            :to=\"editsPath\"\n          >\n            <corner-left-up-icon />\n          </router-link>\n          <span class=\"flexrow-item\">\n            <entity-thumbnail\n              class=\"entity-thumbnail\"\n              :entity=\"currentEntity\"\n              :empty-height=\"60\"\n              :empty-width=\"100\"\n              :height=\"60\"\n              :width=\"100\"\n              v-if=\"currentEntity\"\n            />\n          </span>\n          <div class=\"entity-title flexrow-item mr1\">\n            {{ title }}\n          </div>\n          <div\n            class=\"flexrow-item has-text-centered\"\n            :key=\"currentEntity.id\"\n            v-if=\"!isLoading && currentEntity\"\n          >\n            <previews-per-task-type\n              ref=\"previews-per-task-type\"\n              :entity=\"currentEntity\"\n              @preview-changed=\"onPreviewChanged\"\n            />\n          </div>\n        </div>\n        <div class=\"filler\"></div>\n        <div class=\"flexrow-item block mt0\">\n          <preview-room\n            :ref=\"previewRoomRef\"\n            :room=\"room\"\n            @open-room=\"openRoom\"\n            @join-room=\"joinRoom\"\n            @leave-room=\"leaveRoom\"\n            v-if=\"\n              currentEdit &&\n              isValidRoomId(currentEdit.id) &&\n              currentPreview &&\n              currentPreview.id\n            \"\n          />\n        </div>\n      </div>\n\n      <div ref=\"container\" class=\"edit player block\">\n        <div class=\"flexrow filler\" v-show=\"!isLoading\">\n          <div class=\"flexrow filler video-container\" ref=\"video-container\">\n            <raw-video-player\n              ref=\"raw-player\"\n              class=\"raw-player\"\n              :style=\"{\n                position: 'static',\n                opacity: overlayOpacity\n              }\"\n              :entities=\"entityList\"\n              :full-screen=\"fullScreen\"\n              :is-hd=\"isHd\"\n              :is-repeating=\"isRepeating\"\n              :current-preview-index=\"currentPreviewIndex\"\n              :muted=\"isMuted\"\n              @max-duration-update=\"onMaxDurationUpdate\"\n              @frame-update=\"onFrameUpdate\"\n              @metadata-loaded=\"onMetadataLoaded\"\n              @repeat=\"onVideoRepeated\"\n              @video-loaded=\"onVideoLoaded\"\n              v-show=\"isCurrentPreviewMovie && !isLoading\"\n            />\n\n            <object-viewer\n              ref=\"object-player\"\n              class=\"object-player\"\n              :preview-url=\"currentPreviewDlPath\"\n              :style=\"{\n                position: 'static',\n                opacity: overlayOpacity\n              }\"\n              :full-screen=\"fullScreen\"\n              v-if=\"isCurrentPreviewModel && !isLoading\"\n            />\n\n            <sound-viewer\n              ref=\"sound-player\"\n              class=\"sound-player\"\n              :preview-url=\"currentPreviewDlPath\"\n              :full-screen=\"fullScreen\"\n              @play-ended=\"pause\"\n              v-if=\"isCurrentPreviewSound && !isLoading\"\n            />\n\n            <p\n              :style=\"{ width: '100%' }\"\n              class=\"preview-standard-file has-text-centered\"\n              v-show=\"isCurrentPreviewFile && !isLoading\"\n            >\n              <a\n                class=\"button\"\n                ref=\"preview-file\"\n                :href=\"currentPreviewDlPath\"\n                v-if=\"extension && extension.length > 0\"\n              >\n                <download-icon class=\"icon\" />\n                <span class=\"text\">\n                  {{ $t('tasks.download_pdf_file', { extension: extension }) }}\n                </span>\n              </a>\n            </p>\n\n            <div\n              class=\"picture-preview-wrapper flexrow\"\n              ref=\"picture-player-wrapper\"\n              :style=\"{\n                position: 'static',\n                opacity: overlayOpacity,\n                left: 0,\n                right: 0\n              }\"\n              v-show=\"isCurrentPreviewPicture && !isLoading\"\n            >\n              <img\n                ref=\"picture-player\"\n                id=\"picture-player\"\n                class=\"picture-preview\"\n                :src=\"isCurrentPreviewPicture ? currentPreviewPath : null\"\n                v-show=\"isCurrentPreviewPicture\"\n              />\n            </div>\n\n            <div class=\"loading-wrapper\" v-if=\"isLoading\">\n              <spinner />\n            </div>\n\n            <div\n              class=\"canvas-wrapper\"\n              ref=\"canvas-wrapper\"\n              oncontextmenu=\"return false;\"\n              v-show=\"!isCurrentPreviewFile\"\n            >\n              <canvas\n                id=\"edit-annotation-canvas\"\n                ref=\"annotation-canvas\"\n                class=\"canvas\"\n              >\n              </canvas>\n            </div>\n          </div>\n          <task-info\n            ref=\"task-info\"\n            class=\"flexrow-item task-info-column\"\n            :task=\"task\"\n            :is-preview=\"false\"\n            :silent=\"isCommentsHidden\"\n            :current-time-raw=\"currentTimeRaw - frameDuration\"\n            :current-parent-preview=\"currentPreview\"\n            @time-code-clicked=\"onTimeCodeClicked\"\n            v-show=\"!isCommentsHidden\"\n          />\n        </div>\n\n        <video-progress\n          ref=\"video-progress\"\n          class=\"video-progress pull-bottom\"\n          :annotations=\"annotations\"\n          :frame-duration=\"frameDuration\"\n          :movie-dimensions=\"movieDimensions\"\n          :nb-frames=\"nbFrames\"\n          :handle-in=\"-1\"\n          :handle-out=\"-1\"\n          :preview-id=\"currentPreview ? currentPreview.id : ''\"\n          @start-scrub=\"onScrubStart\"\n          @end-scrub=\"onScrubEnd\"\n          @progress-changed=\"onProgressChanged\"\n          v-show=\"isCurrentPreviewMovie && currentPreview.id\"\n        />\n\n        <div\n          class=\"player-footer flexrow\"\n          ref=\"button-bar\"\n          v-if=\"currentEntity && currentEntity.id\"\n        >\n          <div\n            class=\"flexrow flexrow-item mr0\"\n            v-if=\"\n              isCurrentPreviewMovie ||\n              isCurrentPreviewPicture ||\n              isCurrentPreviewSound\n            \"\n          >\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"playClicked\"\n              :title=\"$t('playlists.actions.play')\"\n              icon=\"play\"\n              v-if=\"!isPlaying\"\n            />\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"pauseClicked\"\n              :title=\"$t('playlists.actions.pause')\"\n              icon=\"pause\"\n              v-else\n            />\n          </div>\n          <div class=\"separator\"></div>\n\n          <template v-if=\"isCurrentPreviewPicture\">\n            {{ framesSeenOfPicture }} /\n            <input\n              type=\"number\"\n              min=\"0\"\n              class=\"frame-per-image-input\"\n              :title=\"$t('playlists.actions.frames_per_picture')\"\n              v-model=\"framesPerImage[playingEntityIndex]\"\n            />\n          </template>\n          <div class=\"separator\" v-if=\"isCurrentPreviewPicture\"></div>\n\n          <div\n            class=\"flexrow flexrow-item\"\n            v-if=\"currentEntityPreviewLength > 1\"\n          >\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              icon=\"left\"\n              :title=\"$t('playlists.actions.files_previous')\"\n              :disabled=\"isPlaying\"\n              @click=\"onPreviousPreviewClicked\"\n            />\n            <span\n              class=\"ml05 mr05\"\n              :title=\"$t('playlists.actions.files_position')\"\n            >\n              {{ currentPreviewIndex + 1 }} / {{ currentEntityPreviewLength }}\n            </span>\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              icon=\"right\"\n              :title=\"$t('playlists.actions.files_next')\"\n              :disabled=\"isPlaying\"\n              @click=\"onNextPreviewClicked\"\n            />\n            <a\n              class=\"button player-button flexrow-item\"\n              :href=\"currentPreviewPath\"\n              :title=\"$t('playlists.actions.see_original_file')\"\n              target=\"blank\"\n            >\n              <arrow-up-right-icon class=\"icon\" />\n            </a>\n          </div>\n\n          <div class=\"flexrow flexrow-item\" v-if=\"isCurrentPreviewMovie\">\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"onSpeedClicked\"\n              :title=\"$t('playlists.actions.speed')\"\n              text=\"x1.00\"\n              v-if=\"speed === 3\"\n            />\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"onSpeedClicked\"\n              :title=\"$t('playlists.actions.speed')\"\n              text=\"x0.50\"\n              v-else-if=\"speed === 2\"\n            />\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"onSpeedClicked\"\n              :title=\"$t('playlists.actions.speed')\"\n              text=\"x0.25\"\n              v-else\n            />\n\n            <button-simple\n              class=\"flexrow-item player-button\"\n              :title=\"$t('playlists.actions.unmute')\"\n              icon=\"soundoff\"\n              @click=\"onToggleSoundClicked\"\n              v-if=\"isMuted\"\n            />\n            <button-simple\n              class=\"flexrow-item player-button\"\n              :title=\"$t('playlists.actions.mute')\"\n              icon=\"soundon\"\n              @click=\"onToggleSoundClicked\"\n              v-else\n            />\n\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              :active=\"isRepeating\"\n              :title=\"$t('playlists.actions.looping')\"\n              icon=\"repeat\"\n              @click=\"onRepeatClicked\"\n            />\n\n            <span\n              class=\"flexrow-item time-indicator\"\n              :title=\"$t('playlists.actions.current_time')\"\n            >\n              {{ currentTime }}\n            </span>\n            <span class=\"flexrow-item time-indicator\"> / </span>\n            <span\n              class=\"flexrow-item time-indicator\"\n              :title=\"$t('playlists.actions.max_duration')\"\n            >\n              {{ maxDuration }}\n            </span>\n            <span\n              class=\"flexrow-item time-indicator mr1\"\n              :title=\"$t('playlists.actions.frame_number')\"\n            >\n              ({{ currentFrame }} / {{ (nbFrames + '').padStart(3, '0') }})\n            </span>\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"onPreviousFrameClicked\"\n              :title=\"$t('playlists.actions.previous_frame')\"\n              icon=\"left\"\n            />\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"onNextFrameClicked\"\n              :title=\"$t('playlists.actions.next_frame')\"\n              icon=\"right\"\n            />\n          </div>\n          <span class=\"filler\"></span>\n\n          <div\n            class=\"flexrow\"\n            v-if=\"\n              !isCurrentUserArtist &&\n              (isCurrentPreviewMovie || isCurrentPreviewPicture)\n            \"\n          >\n            <button-simple\n              class=\"player-button flexrow-item\"\n              icon=\"undo\"\n              :title=\"$t('playlists.actions.annotation_undo')\"\n              @click=\"undoLastAction\"\n            />\n\n            <button-simple\n              class=\"player-button flexrow-item\"\n              :title=\"$t('playlists.actions.annotation_redo')\"\n              icon=\"redo\"\n              @click=\"redoLastAction\"\n            />\n\n            <transition name=\"slide\">\n              <div class=\"annotation-tools\" v-show=\"isTyping\">\n                <color-picker\n                  :color=\"textColor\"\n                  @toggle-palette=\"onPickColor\"\n                  @change=\"onChangeTextColor\"\n                />\n              </div>\n            </transition>\n            <button-simple\n              :class=\"{\n                'player-button': true,\n                'flexrow-item': true,\n                active: isTyping\n              }\"\n              :title=\"$t('playlists.actions.annotation_text')\"\n              @click=\"onTypeClicked\"\n              icon=\"type\"\n            />\n\n            <transition name=\"slide\">\n              <div class=\"annotation-tools\" v-show=\"isDrawing\">\n                <pencil-picker\n                  :pencil=\"pencil\"\n                  :sizes=\"pencilPalette\"\n                  @toggle-palette=\"onPickPencil\"\n                  @change=\"onChangePencil\"\n                />\n\n                <color-picker\n                  :color=\"color\"\n                  @toggle-palette=\"onPickColor\"\n                  @change=\"onChangeColor\"\n                />\n              </div>\n            </transition>\n            <button-simple\n              :class=\"{\n                'player-button': true,\n                'flexrow-item': true,\n                active: isDrawing\n              }\"\n              :title=\"$t('playlists.actions.annotation_draw')\"\n              @click=\"onAnnotateClicked\"\n              icon=\"pencil\"\n            />\n            <button-simple\n              class=\"player-button flexrow-item\"\n              icon=\"remove\"\n              :title=\"$t('playlists.actions.annotation_delete')\"\n              @click=\"onDeleteClicked\"\n            />\n          </div>\n          <div class=\"separator\"></div>\n          <button-simple\n            class=\"button player-button flexrow-item\"\n            :active=\"!isCommentsHidden\"\n            :title=\"$t('playlists.actions.comments')\"\n            @click=\"onCommentClicked\"\n            icon=\"comment\"\n          />\n          <button-simple\n            class=\"player-button flexrow-item\"\n            :title=\"\n              $t('playlists.actions.' + (isHd ? 'switch_ld' : 'switch_hd'))\n            \"\n            :text=\"isHd ? 'HD' : 'LD'\"\n            @click=\"isHd = !isHd\"\n            v-if=\"isCurrentPreviewMovie\"\n          />\n\n          <button-simple\n            class=\"button player-button flexrow-item\"\n            :title=\"$t('playlists.actions.fullscreen')\"\n            @click=\"onFullscreenClicked\"\n            icon=\"maximize\"\n            v-if=\"isFullScreenEnabled\"\n          />\n        </div>\n      </div>\n\n      <div class=\"edit-data block\">\n        <div class=\"flexrow\">\n          <combobox-styled\n            class=\"section-combo flexrow-item\"\n            :options=\"entityNavOptions\"\n            v-model=\"currentSection\"\n          />\n          <div class=\"filler\"></div>\n          <span\n            class=\"flexrow-item mt05\"\n            v-show=\"currentSection === 'schedule'\"\n          >\n            {{ $t('schedule.zoom_level') }}:\n          </span>\n          <combobox-number\n            class=\"zoom-level flexrow-item\"\n            :options=\"zoomOptions\"\n            is-simple\n            v-model=\"zoomLevel\"\n            v-show=\"currentSection === 'schedule'\"\n          />\n        </div>\n\n        <div\n          ref=\"info-row\"\n          class=\"infos flexrow pa0\"\n          v-if=\"currentSection === 'infos'\"\n        >\n          <div class=\"flexrow-item\">\n            <div class=\"flexrow\">\n              <div class=\"flexcolumn flexrow-item\">\n                <page-subtitle class=\"flerow-item\" :text=\"$t('edits.tasks')\" />\n                <entity-task-list\n                  class=\"task-list flexrow-item\"\n                  :entries=\"currentTasks\"\n                  :is-loading=\"!currentEdit\"\n                  :is-error=\"false\"\n                />\n              </div>\n\n              <div class=\"flexcolumn flexrow-item\">\n                <div class=\"flexrow\">\n                  <page-subtitle class=\"flerow-item\" :text=\"$t('main.info')\" />\n                  <div class=\"flexrow-item has-text-right\">\n                    <button-simple\n                      icon=\"edit\"\n                      @click=\"modals.edit = true\"\n                      v-if=\"isCurrentUserManager\"\n                    />\n                  </div>\n                </div>\n                <div class=\"table-body edit-metadata flexrow-item\">\n                  <table class=\"datatable no-header\" v-if=\"currentEdit\">\n                    <tbody class=\"datatable-body\">\n                      <tr class=\"datatable-row\">\n                        <td class=\"field-label\">\n                          {{ $t('edits.fields.description') }}\n                        </td>\n                        <description-cell :entry=\"currentEdit\" :full=\"true\" />\n                      </tr>\n                      <tr\n                        :key=\"descriptor.id\"\n                        class=\"datatable-row\"\n                        v-for=\"descriptor in editMetadataDescriptors\"\n                      >\n                        <td class=\"field-label\">{{ descriptor.name }}</td>\n                        <td>\n                          {{\n                            currentEdit.data\n                              ? currentEdit.data[descriptor.field_name]\n                              : ''\n                          }}\n                        </td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div\n          ref=\"schedule-row\"\n          class=\"infos schedule\"\n          v-if=\"currentSection === 'schedule' && scheduleItems.length > 0\"\n        >\n          <div\n            class=\"schedule mt1\"\n            v-if=\"scheduleItems[0].children.length > 0\"\n            v-show=\"currentSection === 'schedule'\"\n          >\n            <div class=\"wrapper\">\n              <schedule\n                ref=\"schedule-widget\"\n                :start-date=\"tasksStartDate\"\n                :end-date=\"tasksEndDate\"\n                :hierarchy=\"scheduleItems\"\n                :zoom-level=\"zoomLevel\"\n                :is-loading=\"false\"\n                :is-estimation-linked=\"true\"\n                :hide-root=\"true\"\n                :with-milestones=\"false\"\n              />\n            </div>\n          </div>\n        </div>\n\n        <entity-preview-files\n          :entity=\"currentEdit\"\n          v-if=\"currentSection === 'preview-files'\"\n        />\n\n        <entity-news\n          :entity=\"currentEdit\"\n          v-if=\"currentSection === 'activity'\"\n        />\n\n        <entity-time-logs\n          :entity=\"currentEdit\"\n          v-if=\"currentSection === 'time-logs'\"\n        />\n      </div>\n    </div>\n\n    <edit-edit-modal\n      ref=\"edit-edit-modal\"\n      :active=\"modals.edit\"\n      :is-loading=\"isLoading\"\n      :is-error=\"errors.edit\"\n      :edit-to-edit=\"currentEdit\"\n      @cancel=\"modals.edit = false\"\n      @confirm=\"confirmEditEdit\"\n    />\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nimport {\n  ArrowUpRightIcon,\n  CornerLeftUpIcon,\n  DownloadIcon\n} from 'lucide-vue-next'\n\nimport editStore from '@/store/modules/edits'\n\nimport { annotationMixin } from '@/components/mixins/annotation'\nimport { domMixin } from '@/components/mixins/dom'\nimport { entityMixin } from '@/components/mixins/entity'\nimport { getEntitiesPath } from '@/lib/path'\nimport { formatListMixin } from '@/components/mixins/format'\nimport { previewRoomMixin } from '@/components/mixins/previewRoom'\nimport { playerMixin } from '@/components/mixins/player'\nimport { DEFAULT_NB_FRAMES_PICTURE } from '@/lib/playlist'\n\nimport ButtonSimple from '@/components/widgets/ButtonSimple.vue'\nimport ComboboxNumber from '@/components/widgets/ComboboxNumber.vue'\nimport DescriptionCell from '@/components/cells/DescriptionCell.vue'\nimport EditEditModal from '@/components/modals/EditEditModal.vue'\nimport EntityNews from '@/components/pages/entities/EntityNews.vue'\nimport EntityPreviewFiles from '@/components/pages/entities/EntityPreviewFiles.vue'\nimport EntityTaskList from '@/components/lists/EntityTaskList.vue'\nimport EntityTimeLogs from '@/components/pages/entities/EntityTimeLogs.vue'\nimport EntityThumbnail from '@/components/widgets/EntityThumbnail.vue'\nimport ColorPicker from '@/components/widgets/ColorPicker.vue'\nimport ComboboxStyled from '@/components/widgets/ComboboxStyled.vue'\nimport ObjectViewer from '@/components/previews/ObjectViewer.vue'\nimport PageSubtitle from '@/components/widgets/PageSubtitle.vue'\nimport PencilPicker from '@/components/widgets/PencilPicker.vue'\nimport PreviewRoom from '@/components/widgets/PreviewRoom.vue'\nimport PreviewsPerTaskType from '@/components/previews/PreviewsPerTaskType.vue'\nimport RawVideoPlayer from '@/components/pages/playlists/RawVideoPlayer.vue'\nimport Schedule from '@/components/widgets/Schedule.vue'\nimport Spinner from '@/components/widgets/Spinner.vue'\nimport SoundViewer from '@/components/previews/SoundViewer.vue'\nimport TaskInfo from '@/components/sides/TaskInfo.vue'\nimport VideoProgress from '@/components/previews/VideoProgress.vue'\n\nexport default {\n  name: 'edit',\n\n  mixins: [\n    annotationMixin,\n    domMixin,\n    entityMixin,\n    formatListMixin,\n    previewRoomMixin,\n    playerMixin\n  ],\n\n  components: {\n    ArrowUpRightIcon,\n    ButtonSimple,\n    CornerLeftUpIcon,\n    ColorPicker,\n    ComboboxStyled,\n    ComboboxNumber,\n    DescriptionCell,\n    DownloadIcon,\n    EditEditModal,\n    EntityNews,\n    EntityPreviewFiles,\n    EntityTaskList,\n    EntityTimeLogs,\n    EntityThumbnail,\n    ObjectViewer,\n    PageSubtitle,\n    PencilPicker,\n    PreviewRoom,\n    PreviewsPerTaskType,\n    RawVideoPlayer,\n    SoundViewer,\n    Schedule,\n    Spinner,\n    TaskInfo,\n    VideoProgress\n  },\n\n  data() {\n    return {\n      type: 'edit',\n      currentEdit: null,\n      currentSection: 'infos',\n      isLoading: true,\n      isError: false,\n      movieDimensions: { width: 0, height: 0 },\n      previewRoomRef: 'edits-preview-room',\n      previewFileMap: new Map(),\n      room: {\n        id: null,\n        people: [],\n        newComer: true\n      },\n      tempMode: false,\n      errors: {\n        edit: false\n      },\n      entityNavOptions: [\n        { label: 'Infos', value: 'infos' },\n        { label: 'Schedule', value: 'schedule' },\n        { label: 'Preview Files', value: 'preview-files' },\n        { label: 'Activity', value: 'activity' },\n        { label: 'Timelog', value: 'time-logs' }\n      ],\n      modals: {\n        edit: false\n      }\n    }\n  },\n\n  mounted() {\n    this.resetData()\n    this.$options.scrubbing = false\n    this.isHd = Boolean(this.organisation.hd_by_default)\n    if (this.picturePlayer) {\n      this.picturePlayer.addEventListener('load', async () => {\n        const wasPlaying = this.isPlaying\n        await this.resetPictureCanvas()\n        this.isPlaying = wasPlaying\n      })\n    }\n    this.$nextTick(() => {\n      this.configureEvents()\n      this.setupFabricCanvas()\n      this.setPlayerSpeed(1)\n      this.onFrameUpdate(1)\n    })\n  },\n\n  computed: {\n    ...mapGetters([\n      'currentEpisode',\n      'currentProduction',\n      'getTaskPreviews',\n      'getTaskTypePriority',\n      'isCurrentUserManager',\n      'isTVShow',\n      'route',\n      'editMetadataDescriptors',\n      'taskMap',\n      'taskTypeMap',\n      'user'\n    ]),\n\n    title() {\n      if (this.currentEdit) {\n        if (this.currentEdit.episode_name) {\n          return (\n            `${this.currentEdit.episode_name} / ` + `${this.currentEdit.name}`\n          )\n        } else {\n          return `${this.currentEdit.name}`\n        }\n      } else {\n        return 'Loading...'\n      }\n    },\n\n    editsPath() {\n      return getEntitiesPath(\n        this.currentProduction.id,\n        'edits',\n        this.currentEpisode ? this.currentEpisode.id : this.currentEpisode\n      )\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'editEdit',\n      'loadEdits',\n      'loadTaskEntityPreviewFiles',\n      'updatePreviewAnnotation'\n    ]),\n\n    resetPreviewFileMap() {\n      this.previewFileMap.clear()\n      if (this.previewFiles) {\n        Object.values(this.previewFiles).forEach(previewFiles => {\n          previewFiles.forEach(previewFile => {\n            this.previewFileMap.set(previewFile.id, previewFile)\n          })\n        })\n      }\n    },\n\n    resetHeight() {\n      this.$nextTick(() => {\n        let height = window.innerHeight\n        height -= this.$refs.header ? this.$refs.header.offsetHeight : 0\n        if (this.$refs['button-bar']) {\n          height -= this.$refs['button-bar'].offsetHeight\n        }\n        if (this.$refs['video-progress']) {\n          height -= this.$refs['video-progress'].$el.offsetHeight\n        }\n        if (this.$refs['info-row']) {\n          height -= this.$refs['info-row'].offsetHeight\n        }\n        if (this.$refs['schedule-row']) {\n          height -= this.$refs['schedule-row'].offsetHeight\n        }\n        if (this.$refs['page-header-row']) {\n          height -= this.$refs['page-header-row'].offsetHeight\n        }\n        height = Math.min(window.innerHeight * 0.4, Math.max(480, height))\n        if (this.$refs['video-container']) {\n          this.$refs['video-container'].style.height = `${height}px`\n        }\n        if (!this.isCommentsHidden && this.$refs['task-info']) {\n          this.$refs['task-info'].$el.style.height = `${height}px`\n        }\n        if (this.rawPlayer) this.rawPlayer.resetHeight(height)\n        this.$nextTick(() => {\n          this.resetCanvas()\n          this.updateProgressBar()\n        })\n      })\n    },\n\n    initPlayer() {\n      if (!this.currentEdit) return\n\n      this.currentPreviewIndex = 0\n      // There's only one entity in this player, which is current Edit entity,\n      // so playingEntityIndex is always 0\n      this.playingEntityIndex = 0\n      this.entityList = [\n        {\n          ...this.currentEdit,\n          preview_file_id: null,\n          preview_files: this.previewFiles\n        }\n      ]\n      this.framesPerImage[0] =\n        this.currentEdit.preview_nb_frames || DEFAULT_NB_FRAMES_PICTURE\n      this.pause()\n      if (this.rawPlayer) this.rawPlayer.setCurrentFrame(1)\n      this.currentTimeRaw = 0\n      this.updateProgressBar()\n      this.updateTaskPanel()\n      this.clearCanvas()\n      this.annotations = []\n      this.resetHeight()\n      this.resetCanvas().then(() => {\n        if (this.isCurrentPreview) {\n          this.annotations = this.currentEntity.preview_file_annotations\n          this.loadAnnotation(this.getAnnotation(0))\n        }\n      })\n    },\n\n    getCurrentEdit() {\n      return editStore.cache.editMap.get(this.route.params.edit_id) || null\n    },\n\n    confirmEditEdit(form) {\n      form.id = this.currentEdit.id\n      this.isLoading = true\n      this.errors.edit = false\n      this.editEdit(form)\n        .then(() => {\n          this.isLoading = false\n          this.modals.edit = false\n        })\n        .catch(err => {\n          console.error(err)\n          this.isLoading = false\n          this.errors.edit = true\n        })\n    },\n\n    setPreviewFile(previewFile) {\n      this.playingPreviewFileId = previewFile.id\n\n      this.currentEntity.preview_file_id = previewFile.id\n      this.currentEntity.preview_file_task_id = previewFile.task_id\n      this.currentEntity.preview_file_extension = previewFile.extension\n      this.currentEntity.preview_file_annotations =\n        previewFile.annotations || []\n      this.currentEntity.preview_file_previews = previewFile.previews\n\n      this.annotations = this.currentEntity.preview_file_annotations\n\n      if (this.rawPlayer) this.rawPlayer.reloadCurrentEntity()\n      this.clearCanvas()\n      this.updateTaskPanel()\n      this.updateProgressBar()\n    },\n\n    onPreviewChanged(entity, previewFile) {\n      this.pause()\n      if (!previewFile) {\n        // TODO: handle the situation when now preview file is selected\n        // (e.g. if selected task has none)\n      }\n      const isDifferentPreviewFile =\n        this.playingPreviewFileId !== previewFile.id\n      this.setPreviewFile(previewFile)\n      if (isDifferentPreviewFile) this.sendUpdatePlayingStatus()\n    },\n\n    onAnnotationChanged({ preview, additions, deletions, updates }) {\n      const taskId = preview.task_id\n      this.updatePreviewAnnotation({\n        taskId,\n        preview,\n        additions,\n        deletions,\n        updates\n      })\n    },\n\n    onVideoLoaded() {\n      this.movieDimensions = {\n        width: this.currentPreview.width,\n        height: this.currentPreview.height\n      }\n    },\n\n    scrollToEntity() {\n      // This method in unused here, required by PlaylistPlayer that shares\n      // playerMixin.\n    },\n\n    resetData() {\n      this.$nextTick(() => {\n        this.loadEdits().then(() => {\n          this.currentEdit = this.getCurrentEdit()\n          this.room.id = this.currentEdit ? this.currentEdit.id : null\n          if (!this.currentEdit) {\n            return\n          }\n          this.loadTaskEntityPreviewFiles(this.currentEdit.id).then(\n            previewFiles => {\n              this.previewFiles = previewFiles\n              this.resetPreviewFileMap()\n              this.initPlayer()\n              this.isLoading = false\n            }\n          )\n        })\n      })\n    },\n\n    onPreviewFilesUpdate() {\n      this.loadTaskEntityPreviewFiles(this.currentEdit.id).then(\n        previewFiles => {\n          this.previewFiles = previewFiles\n          this.currentEntity.preview_files = previewFiles\n          this.resetPreviewFileMap()\n          // FIXME: combo should continue displaying currently selected task preview\n          // unless it's no longer available (e.g. was deleted along with the comment)\n          if (\n            this.currentEntity &&\n            this.currentEntity.preview_file_id &&\n            !this.previewFileMap.has(this.currentEntity.preview_file_id)\n          ) {\n            // TODO: handle deletion of currently displayed preview file\n          }\n        }\n      )\n    }\n  },\n\n  watch: {\n    currentEdit() {\n      this.room.id = this.currentEdit ? this.currentEdit.id : null\n    },\n\n    // Needed when reloading the page with F5\n    currentProduction() {\n      if (!this.isTVShow) this.resetData()\n    },\n\n    currentEpisode() {\n      if (this.isTVShow && editStore.cache.editMap.size === 0) {\n        this.resetData()\n      }\n    },\n\n    playingPreviewFileId() {\n      // In case preview was switched by someone else in the room,\n      // make sure that comboboxes reflect this change too.\n      if (!this.currentEntity || !this.playingPreviewFileId) return\n\n      const previewsCombo = this.$refs['previews-per-task-type']\n      if (!previewsCombo) return\n\n      const previews = this.currentEntity.preview_files\n      for (const taskTypeId in previews) {\n        const previewFile = previews[taskTypeId].find(\n          p => p.id === this.playingPreviewFileId\n        )\n        if (previewFile) {\n          this.setPreviewFile(previewFile)\n          if (\n            previewsCombo.taskTypeId !== taskTypeId ||\n            previewsCombo.previewFileId !== this.playingPreviewFileId\n          ) {\n            previewsCombo.taskTypeId = taskTypeId\n            previewsCombo.previewFileId = this.playingPreviewFileId\n          }\n          break\n        }\n      }\n    }\n  },\n\n  socket: {\n    events: {\n      ...previewRoomMixin.socket.events,\n      ...playerMixin.socket.events,\n\n      'preview-file:add-file'(eventData) {\n        if (eventData.project_id !== this.task.project_id) return\n        const taskId = eventData.task_id\n\n        const previews = this.currentEntity.preview_files\n        for (const taskTypeId in previews) {\n          const previewFile = previews[taskTypeId].find(\n            p => p.task_id === taskId\n          )\n          if (previewFile) {\n            // Added preview affects one of the tasks, preview files must be refreshed\n            this.onPreviewFilesUpdate()\n            break\n          }\n        }\n      },\n\n      'comment:delete'(eventData) {\n        // Deleting a comment might remove a task preview, preview files must be refreshed\n        if (eventData.project_id !== this.task.project_id) return\n        this.onPreviewFilesUpdate()\n      }\n    }\n  },\n\n  head() {\n    return {\n      title: `${this.title} - Kitsu`\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.dark .page {\n  background: $dark-grey-light;\n  height: 100%;\n  padding-bottom: 1em;\n}\n\n.dark .wrapper {\n  background: $dark-grey-2;\n}\n\n.block {\n  margin: 0;\n}\n\n.entity-title {\n  font-weight: bold;\n}\n\n.entity-thumbnail {\n  margin-bottom: 0;\n}\n\n.main-block {\n  padding: 0.5em 1.5em;\n}\n\n.edit-data {\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  margin: 0 1em 0 1em;\n  overflow: hidden;\n  min-height: 300px;\n}\n\n.edit-metadata {\n  width: 100%;\n}\n\nh2.subtitle {\n  border-bottom: 0;\n  margin-top: 0;\n  margin-bottom: 0.5em;\n  font-size: 1.5em;\n}\n\n.page {\n  background: #f9f9f9;\n  padding: 0;\n}\n\n.page-header {\n  margin-top: calc(50px + 2em);\n  margin-left: 1em;\n  margin-right: 1em;\n}\n\n.infos {\n  margin-top: 1em;\n\n  .flexrow-item {\n    align-self: flex-start;\n    flex: 1;\n  }\n}\n\n.edit-thumbnail {\n  max-width: 100px;\n}\n\n.field-label {\n  font-weight: bold;\n  width: 140px;\n}\n\n.data-list {\n  max-width: 100%;\n}\n\n.page-header .thumbnail-picture {\n  margin: 0 1em 0 0;\n  max-width: 80px;\n}\n\n.back-link {\n  padding-top: 3px;\n}\n\n.task-list {\n  width: 100%;\n}\n\n.datatable-row {\n  user-select: text;\n}\n\n.schedule {\n  position: relative;\n  height: 300px;\n  padding: 10px;\n\n  .schedule-title {\n    margin-bottom: 5px;\n  }\n\n  .wrapper {\n    height: 230px;\n    border-radius: 10px;\n  }\n}\n\n.column.main-column {\n  background: var(--background-page);\n  padding-bottom: 1em;\n}\n\n@media screen and (max-width: 768px) {\n  .task-column {\n    margin-bottom: 1em;\n  }\n\n  .column:first-child {\n    margin-right: 0;\n  }\n\n  .entity-title {\n    font-size: 1.3em;\n    line-height: 1.5em;\n  }\n}\n\n/* Player styles */\n\n.full-height {\n  height: 100%;\n}\n\n.player {\n  margin: 1em;\n\n  .player-button {\n    background: $white-grey;\n    margin: 0;\n    border: 0;\n    border-radius: 0;\n\n    &.active {\n      color: $green;\n    }\n\n    &.topbar-button {\n      border-radius: 10px;\n      margin-right: 0.5em;\n    }\n  }\n}\n\n.dark .player {\n  background: $dark-grey;\n\n  .player-button {\n    background: $dark-grey-light;\n    color: $white-grey;\n\n    &:hover {\n      background: $dark-grey-lighter;\n    }\n\n    &.active {\n      color: $green;\n    }\n\n    &.topbar-button {\n      border: 1px solid $dark-grey-strong;\n    }\n  }\n}\n\n.player-footer {\n  background: $white-grey;\n}\n\n.dark .player-footer {\n  background: $dark-grey-light;\n  color: $white-grey;\n}\n\n.loading-background {\n  width: 100%;\n  height: 100%;\n  background: black;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n}\n\n.spinner {\n  margin: auto;\n}\n\n.task-info-column {\n  min-width: 450px;\n  max-width: 450px;\n  overflow-y: auto;\n}\n\n.smaller {\n  height: 16px;\n}\n\n.right {\n  margin-left: auto;\n}\n\n.video-player {\n  display: flex;\n  flex-direction: column;\n  align-content: flex-end;\n  height: 100%;\n}\n\n.video-wrapper {\n  flex: 1;\n  display: flex;\n  background: black;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  margin: auto;\n  width: 100%;\n}\n\n.annotation-movie {\n  margin: auto;\n  width: 100%;\n}\n\n.dark .time-indicator {\n  color: $light-grey;\n  padding-left: 0.8em;\n  margin-right: 0;\n}\n\n.video-container {\n  position: relative;\n  margin: auto;\n  min-height: 480px;\n}\n\n.canvas-wrapper {\n  margin: auto;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.buttons {\n  height: 32px;\n}\n\nprogress::-moz-progress-bar {\n  background-color: #43b581;\n}\n\nprogress::-webkit-progress-value {\n  background-color: #43b581;\n}\n\nprogress {\n  width: 100%;\n  border-radius: 0;\n  margin: 0;\n  padding: 0;\n  border: 0;\n  background: $grey;\n  height: 8px;\n  display: block;\n}\n\n.progress span#progress-bar {\n  width: 100%;\n  border-radius: 0;\n  margin: 0;\n  padding: 0;\n  background-color: #43b581;\n}\n\n.mr1 {\n  margin-right: 1em;\n}\n\n.mr0 {\n  margin-right: 0;\n}\n\n.video-progress {\n  transition: opacity 0.5s ease;\n}\n\n.spinner {\n  margin-top: 80px;\n  margin-left: 1em;\n}\n\n.annotation-tools {\n  display: flex;\n  align-items: stretch;\n  height: 100%;\n}\n\n.slide-enter-active {\n  transition: all 0.3s ease;\n}\n.slide-leave-active {\n  transition: all 0.3s ease;\n}\n.slide-enter,\n.slide-leave-to {\n  transform: translateX(100%);\n}\n\n.for-client {\n  background: $dark-purple-strong;\n  border: 2px solid $dark-purple-strong;\n  color: $white;\n  padding: 0.3em;\n  margin-left: 1em;\n  margin-right: 0;\n  border-radius: 5px;\n}\n\n#edit-annotation-canvas {\n  margin: auto;\n}\n\n.picture-preview-wrapper {\n  display: flex;\n  height: inherit;\n  justify-content: center;\n  align-items: center;\n  flex: 1;\n}\n\n.picture-preview {\n  max-height: 100%;\n  max-width: 100%;\n  color: var(--text);\n}\n\n.raw-player {\n  margin: auto;\n}\n\n.disabled {\n  color: $grey-strong;\n}\n\n.loading-wrapper {\n  width: 100%;\n}\n\n.disabled {\n  color: $grey;\n}\n\n.dark .frame-per-image-input {\n  padding: 2px;\n  margin-left: 3px;\n  background-color: $dark-grey-2;\n  border: 1px solid $dark-grey-stronger;\n  color: white;\n  width: 3rem;\n}\n</style>\n"],"names":["_sfc_main","ComboboxStyled","ValidationTag","mapGetters","editStore","taskId","task","firstBy","taskType","previewFile","entity","taskTypeIds","previewFileId","taskTypeId","previewFiles","_hoisted_1","_openBlock","_createElementBlock","$options","_createBlock","_component_combobox_styled","$data","_cache","$event","_createCommentVNode","_hoisted_2","_hoisted_3","_createVNode","_component_validation_tag","annotationMixin","domMixin","entityMixin","formatListMixin","previewRoomMixin","playerMixin","ArrowUpRightIcon","ButtonSimple","CornerLeftUpIcon","ColorPicker","ComboboxNumber","DescriptionCell","DownloadIcon","EditEditModal","EntityNews","EntityPreviewFiles","EntityTaskList","EntityTimeLogs","EntityThumbnail","ObjectViewer","PageSubtitle","PencilPicker","PreviewRoom","PreviewsPerTaskType","RawVideoPlayer","SoundViewer","Schedule","Spinner","TaskInfo","VideoProgress","wasPlaying","getEntitiesPath","mapActions","height","DEFAULT_NB_FRAMES_PICTURE","form","err","isDifferentPreviewFile","preview","additions","deletions","updates","previewsCombo","previews","p","eventData","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_9","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_20","_hoisted_23","_hoisted_24","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_49","_createElementVNode","_component_router_link","_withCtx","_component_corner_left_up_icon","_ctx","_component_entity_thumbnail","_toDisplayString","_component_previews_per_task_type","_component_preview_room","_hoisted_8","_withDirectives","_hoisted_10","_component_raw_video_player","_normalizeStyle","_vShow","_component_object_viewer","_component_sound_viewer","_hoisted_11","_component_download_icon","_hoisted_15","_component_spinner","_hoisted_16","_hoisted_17","_component_task_info","_component_video_progress","_hoisted_18","_hoisted_19","_component_button_simple","_Fragment","_createTextVNode","_vModelText","_hoisted_21","_hoisted_22","_component_arrow_up_right_icon","_hoisted_25","_hoisted_29","_Transition","_component_color_picker","_normalizeClass","_component_pencil_picker","_component_combobox_number","_hoisted_34","_component_page_subtitle","_component_entity_task_list","_hoisted_42","_component_description_cell","_renderList","descriptor","_hoisted_47","_hoisted_48","_component_schedule","_component_entity_preview_files","_component_entity_news","_component_entity_time_logs","_component_edit_edit_modal"],"mappings":"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"}