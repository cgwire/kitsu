import{_ as f,b as k,o as l,c as o,F as p,h as a,d as u,g as m,i as h,O as c,n as y,I as g,aI as C}from"./index-Dw-uod2x.js";import{a as T}from"./render-GdzifLjz.js";import{s as x}from"./string-B0Tq569e.js";const b={name:"description-cell",data(){return{isEditing:!1,isOpen:!1,tooltipPosition:{top:0,left:0}}},props:{editable:{type:Boolean,default:!1},entry:{type:Object,default:()=>{}},full:{type:Boolean,default:!1}},emits:["description-changed"],computed:{...k(["isDarkTheme"]),tooltipStyle(){return{top:this.tooltipPosition.top+"px",left:this.tooltipPosition.left+"px"}}},methods:{renderMarkdown:T,shortenText:x.shortenText,onClick(n){if(n.currentTarget.classList.contains("description-cell")&&!n.target.closest(".description-cell .tooltip")||n.keyCode===27){if(this.isOpen=!this.isOpen,this.isOpen){const s=n.currentTarget.getBoundingClientRect(),d=window.pageYOffset||document.documentElement.scrollTop,r=window.pageXOffset||document.documentElement.scrollLeft;this.tooltipPosition={top:s.top+d-105,left:s.left+r+s.width/2-160}}else if(this.isEditing){this.isEditing=!1;const t=this.$refs.text.value;this.$emit("description-changed",t)}}},onDoubleClick(){if(this.editable){if(this.isEditing){const n=this.$refs.text.value;this.$emit("description-changed",n)}this.isEditing=!this.isEditing,this.isEditing&&this.$nextTick(()=>{this.$refs.text.focus()})}}}},w=["innerHTML"],E={key:0,class:"c-mask"},M=["innerHTML"],D=["innerHTML"],L=["value"];function O(n,t,s,d,r,e){return l(),o("td",{class:"description-cell",onKeyup:t[5]||(t[5]=c((...i)=>e.onClick&&e.onClick(...i),["esc"])),onClick:t[6]||(t[6]=(...i)=>e.onClick&&e.onClick(...i))},[s.full?(l(),o("div",{key:0,class:"description-shorten-text",innerHTML:e.renderMarkdown(s.entry.description)},null,8,w)):(l(),o(p,{key:1},[r.isOpen?(l(),o("div",E)):a("",!0),u("span",{class:"description-shorten-text selectable",innerHTML:e.renderMarkdown(e.shortenText(s.entry.description,20),{allowedLinkTag:!1})},null,8,M),(l(),m(C,{to:"body"},[r.isOpen?(l(),o("div",{key:0,class:y(["tooltip",{dark:n.isDarkTheme}]),onDblclick:t[3]||(t[3]=(...i)=>e.onDoubleClick&&e.onDoubleClick(...i)),onKeyup:t[4]||(t[4]=c((...i)=>e.onClick&&e.onClick(...i),["esc"])),style:h(e.tooltipStyle)},[r.isEditing?(l(),o("textarea",{key:1,class:"tooltip-editor",ref:"text",value:s.entry.description,onKeyup:[t[1]||(t[1]=c((...i)=>e.onClick&&e.onClick(...i),["esc"])),t[2]||(t[2]=c(g((...i)=>e.onDoubleClick&&e.onDoubleClick(...i),["ctrl"]),["enter"]))]},"          ",40,L)):(l(),o("div",{key:0,class:"tooltip-text",onKeyup:t[0]||(t[0]=c((...i)=>e.onClick&&e.onClick(...i),["esc"])),innerHTML:e.renderMarkdown(s.entry.description)},null,40,D))],38)):a("",!0)]))],64))],32)}const _=f(b,[["render",O],["__scopeId","data-v-5ca880bc"]]);export{_ as D};
//# sourceMappingURL=DescriptionCell-Cm2KfHAo.js.map
