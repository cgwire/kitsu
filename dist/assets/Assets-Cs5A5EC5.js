import{_ as Q,E as J,B as W,x as X,y as Z,a as q,z as j,A as x,D as $,G as ee,b as G,r as c,q as se,o as l,c as r,d as f,f as u,k as z,t as y,g as k,h,F as S,e as A,n as b,v as Y,w as te,H as N,i as ie,I as ae,J as oe,p as le,K as ne}from"./index-DF-DoQlt.js";import{c as O}from"./csv-IlynXFQz.js";import{s as re}from"./string-B0Tq569e.js";import{s as de}from"./search-CWIHq9c3.js";import{V as me,T as he,a as ce,M as ue,S as pe,C as fe,_ as ye,A as ge,b as ke,e as Ce}from"./SortingInfo-CgBowHF9.js";import{d as Te,B as Se}from"./BuildFilterModal-C18AF9bI.js";import{d as Me}from"./dom-tO7tlkHV.js";import{e as Ae}from"./entity_list-D-byES5y.js";import{f as De}from"./format-D3oTyBU9.js";import{M as ve,s as we}from"./MetadataHeader-DNtGPcAE.js";import{C as be}from"./ComboboxTaskType-C7Rz0ksS.js";import{D as _e}from"./DescriptionCell-BohJMv7b.js";import{R as Ee}from"./RowActionsCell-DR7b8Q1u.js";import{T as Le}from"./TableInfo-D6xnVb4C.js";import{T as Ve}from"./TableMetadataSelectorMenu-B1W55tUc.js";import{V as Ie}from"./ValidationCell-BAjZxoUN.js";import{_ as K}from"./empty_asset-CsDXgViP.js";import{C as Fe}from"./ComboboxDepartment-Cjj8YvK6.js";import{D as Pe}from"./DeleteModal-DwXK5r5w.js";import{E as He}from"./EditAssetModal-BWrIAv6P.js";import{I as Ue,a as Re}from"./ImportRenderModal-BN76z3RH.js";import{H as Be}from"./HardDeleteModal-BLE4oONO.js";import{S as Ne}from"./SearchField-BdP8lRoc.js";import{S as Oe}from"./SearchQueryList-jldyJweR.js";import ze from"./TaskInfo-C2DOZkHo.js";import"./DepartmentName-DCchDYyW.js";import"./PreviewPlayer-Bpr7Jn1C.js";import"./PlaylistPlayer-ByYDRf10.js";import"./ComboboxSimple-B2TmvsnK.js";import"./ModalFooter-Chk0SGv-.js";import"./TextField-BKWlN2Ov.js";import"./video-Yn96Kb74.js";import"./clipboard-CQqgyZ_h.js";import"./Combobox-A6pnhVs3.js";import"./ComboboxStyled-BlKJF8gk.js";import"./index-Bnig1aiX.js";import"./BaseModal-D3KB-h7q.js";import"./ComboboxStudio-D3qg68ZP.js";import"./play-DUQ3D5JY.js";import"./render-DYxr_jus.js";import"./EmojiButton-CJhEAvTS.js";import"./FileUpload-GCzHM4-i.js";import"./ComboboxStatus-CBgYMSHg.js";import"./ConfirmModal-BIIMruUl.js";import"./TaskTypeName-C0px4urt.js";import"./triangle-alert-CW28Rlrw.js";import"./ValidationTag-Cx26FfxH.js";import"./thumbs-up-UCZcudrF.js";import"./copy-DgQ7ppWI.js";import"./vue.esm-bundler-pS9-uSLU.js";import"./VideoViewer-B89y-Tko.js";import"./ComboboxBoolean-DT116Lfu.js";import"./check-CO1MD15r.js";import"./ComboboxOptions-CyreNGd5.js";import"./PageTitle-CtScP8aV.js";import"./PeopleField-BoranyvF.js";import"./trash-DWKk5Pv9.js";import"./refresh-cw-CYYYI9XK.js";import"./vuedraggable.umd-DaNNd7iu.js";import"./grip-vertical-BnOzHbNG.js";import"./eye-CYjxZyJy.js";import"./TextareaField-BVvnEY8u.js";import"./Checkbox-DbTOIZ1h.js";import"./BooleanField-r8LThAuD.js";import"./ColorField-ByrVYH4e.js";import"./trash-2-Clb81WsB.js";import"./chevron-up-C5NMcayJ.js";import"./DeleteEntities-5LkT8YiQ.js";import"./corner-right-up-xDF204hE.js";const Ke={name:"asset-list",mixins:[Ae,Te,Me,De,we],components:{ButtonSimple:W,ComboboxTaskType:be,DescriptionCell:_e,EntityThumbnail:J,MetadataInput:ue,MetadataHeader:ve,RowActionsCell:Ee,TableInfo:Le,TableHeaderMenu:ce,TableMetadataHeaderMenu:he,TableMetadataSelectorMenu:Ve,ValidationCell:Ie,ValidationHeader:me},props:{contactSheetMode:{type:Boolean,default:!1},displaySettings:{type:Object,default:()=>{}},displayedAssets:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!0},isError:{type:Boolean,default:!0},validationColumns:{type:Array,default:()=>[]},departmentFilter:{type:Array,default:()=>[]}},emits:["asset-changed","asset-type-clicked","create-tasks","delete-clicked","edit-clicked","metadata-changed","new-clicked","restore-clicked","scroll"],data(){return{type:"asset",columnSelectorDisplayed:!1,hiddenColumns:{},isSelectableMap:{},lastSelection:null,lastHeaderMenuDisplayed:null,lastMetadaDataHeaderMenuDisplayed:null,lastHeaderMenuDisplayedIndexInGrid:null,metadataDisplayHeaders:{estimation:!0,readyFor:!0,resolution:!0,timeSpent:!0},stickedColumns:{},domEvents:[["mousemove",this.onMouseMove],["touchmove",this.onMouseMove],["mouseup",this.stopBrowsing],["mouseleave",this.stopBrowsing],["touchend",this.stopBrowsing],["touchcancel",this.stopBrowsing],["keyup",this.stopBrowsing]],offsets:{},lastSelectedAsset:null}},computed:{...G(["assets","assetFilledColumns","assetMap","assetMetadataDescriptors","assetSearchText","assetSelectionGrid","currentEpisode","currentProduction","displayedAssetsCount","displayedAssetsLength","displayedAssetsTimeSpent","displayedAssetsEstimation","nbSelectedTasks","organisation","isAssetDescription","isAssetResolution","isCurrentUserClient","isCurrentUserManager","isCurrentUserSupervisor","isShowAssignations","isAssetEstimation","isAssetTime","isTVShow","productionAssetTaskTypes","productionShotTaskTypes","selectedAssets","selectedTasks","taskMap","user"]),assetTypeMap(){return ee.cache.assetTypeMap},episodeMap(){return $.cache.episodeMap},taskTypeMap(){return x.cache.taskTypeMap},isEmptyList(){return this.displayedAssetsCount===0&&!this.isLoading&&!this.isError&&(!this.assetSearchText||this.assetSearchText.length===0)},isEmptyTask(){return!this.isEmptyList&&!this.isLoading&&this.validationColumns&&this.validationColumns.length===0},isListVisible(){return!this.isLoading&&!this.isError&&this.displayedAssetsCount>0},displayedValidationColumns(){return this.validationColumns.filter(e=>this.assetFilledColumns[e]&&(!this.hiddenColumns[e]||this.displaySettings.showInfos))},metadataDescriptors(){return this.assetMetadataDescriptors},localStorageStickKey(){return`stick-assets-${this.currentProduction?.id}`},readyForTaskTypes(){return[{id:null,name:this.$t("tasks.fields.no_task_type"),color:"#CCC"},...j(this.productionShotTaskTypes,this.currentProduction)]},isAssetsOnly(){return this.currentProduction?.production_type==="assets"},formatDurationInHours(){return this.organisation.format_duration_in_hours}},methods:{...q(["displayMoreAssets","editAsset","setAssetSelection"]),assetEpisodes(e,s){if(!this.episodeMap)return"";const i=this.episodeMap.get(e.episode_id),d=i?i.name:"MP",t=(e.casting_episode_ids||[]).map(g=>this.episodeMap.get(g).name).filter(g=>g!==d);let a="";return t.length>2?s?a=t.join(", "):a=t.slice(0,2).join(", ")+", ...":t.length>0&&(a=t.join(", ")),t.length>0?d+", "+a:d},isSelectable(e,s){if(e.shared)return!1;const i=e.asset_type_id+s;if(this.isSelectableMap===void 0&&(this.isSelectableMap={}),this.isSelectableMap[i]===void 0){const d=this.taskTypeMap.get(s);let a=this.assetTypeMap.get(e.asset_type_id)?.task_types||[];a.length===0&&(a=this.productionAssetTaskTypes.map(g=>g.id)),this.isSelectable[i]=a.includes(d.id)}return this.isSelectable[i]},isSelected(e,s,i){const d=this.getIndex(e,s);return this.assetSelectionGrid[d][i]},toggleLine(e,s){const i=s.target.checked,d=[e];if(i&&this.shiftKeyPressed&&this.lastSelectedAsset){const t=this.displayedAssets.flat();let a=t.findIndex(T=>T.id===this.lastSelectedAsset.id),g=t.findIndex(T=>T.id===e.id);a>g&&([a,g]=[g,a]),a>=0&&g>=0&&Z(a,g).forEach(T=>{d.push(t[T])})}i&&(this.lastSelectedAsset=e),d.forEach(t=>{this.setAssetSelection({asset:t,selected:i})})},onBodyScroll(e){if(!this.$refs.body)return;const s=e.target;this.$emit("scroll",s.scrollTop),this.$refs.body.scrollHeight-this.$refs.body.offsetHeight<s.scrollTop+100&&this.loadMoreAssets()},onReadyForChanged(e,s){if(this.selectedAssets.has(e.id))this.selectedAssets.forEach(i=>{const d={id:i.id,ready_for:s};this.$emit("asset-changed",d)});else{const i={id:e.id,ready_for:s};this.$emit("asset-changed",i)}},loadMoreAssets(){this.displayMoreAssets()},getIndex(e,s){return this.getEntityLineNumber(this.displayedAssets,e,s)},assetPath(e){return this.getPath("asset",e)},getPath(e,s){const i={name:e,params:{production_id:this.currentProduction?.id}};return this.isTVShow&&this.currentEpisode&&(i.name=`episode-${e}`,i.params.episode_id=this.currentEpisode.id),s&&(i.params.asset_id=s),i},onInputKeyUp(e,s,i){const d=this.visibleMetadataDescriptors.length,t=this.displayedAssetsCount;this.keyMetadataNavigation(d,t,s,i,e.key)},toggleStickedColumns(e){const s=!this.stickedColumns[e];this.stickedColumns={...this.stickedColumns,[e]:s},X.setObjectPreference(this.localStorageStickKey,this.stickedColumns)},stickColumnClicked(){this.toggleStickedColumns(this.lastHeaderMenuDisplayed),this.showHeaderMenu()},metadataStickColumnClicked(e){this.toggleStickedColumns(this.lastMetadaDataHeaderMenuDisplayed),this.showMetadataHeaderMenu(this.lastMetadaDataHeaderMenuDisplayed,e)},updateOffsets(){this.isLoading||this.$nextTick(function(){let e=this.$refs["th-name"].clientWidth;if(this.offsets={},this.displaySettings.showInfos)for(let s=0;s<this.stickedVisibleMetadataDescriptors.length;s++)this.offsets[`editor-${s}`]=e,e+=this.$refs[`editor-${s}`][0].$el.clientWidth;for(let s=0;s<this.stickedDisplayedValidationColumns.length;s++)this.offsets[`validation-${s}`]=e,e+=this.$refs[`validation-${s}`][0].$el.clientWidth})}},watch:{displayedAssets:{deep:!0,handler(){this.$options.lineIndex={}}},validationColumns:{deep:!0,handler(){this.initHiddenColumns(this.validationColumns,this.hiddenColumns)}},stickedColumns(){this.updateOffsets()},isLoading(){this.updateOffsets()},"displaySettings.bigThumbnails"(){this.updateOffsets()},currentProduction(){this.isSelectableMap={}}}},Qe={class:"data-list"},We={class:"datatable multi-section"},qe={class:"datatable-head",id:"datatable-asset"},Ge={ref:"th-name",class:"name datatable-row-header",scope:"col"},Ye={class:"flexrow"},Je={class:"flexrow-item"},Xe=["title"],Ze=["title"],je={key:6,scope:"col",class:"resolution"},xe={scope:"col",class:"actions",ref:"actionsSection"},$e={key:0,class:"datatable-type-header"},es={scope:"rowgroup"},ss=["onClick"],ts=["title"],is={class:"flexrow"},as=["checked","disabled","onInput"],os={key:0,class:"episode"},ls=["title"],ns=["title"],rs={key:2,class:"task-type-name ready-for"},ds={key:4,class:"time-spent selectable number-cell"},ms={key:5,class:"estimation selectable number-cell"},hs={key:6,class:"resolution"},cs=["value","onInput","onKeyup"],us={key:1,class:"metadata-value selectable"},ps=["title"],fs={key:10,class:"actions"},ys={key:0,class:"has-text-centered"},gs={class:"info"},ks={key:1,class:"has-text-centered"},Cs={class:"info"},Ts={key:0,class:"has-text-centered nb-assets"},Ss={key:0};function Ms(e,s,i,d,t,a){const g=c("table-header-menu"),T=c("table-metadata-header-menu"),v=c("button-simple"),_=c("metadata-header"),E=c("validation-header"),V=c("table-metadata-selector-menu"),I=c("entity-thumbnail"),F=c("router-link"),L=c("metadata-input"),w=c("validation-cell"),P=c("combobox-task-type"),H=c("description-cell"),U=c("row-actions-cell"),R=c("table-info"),B=se("columns-resizable");return l(),r("div",Qe,[f("div",{ref:"body",class:"datatable-wrapper",onScrollPassive:s[18]||(s[18]=(...n)=>a.onBodyScroll&&a.onBodyScroll(...n))},[u(g,{ref:"headerMenu","is-minimized":t.hiddenColumns[t.lastHeaderMenuDisplayed],"is-edit-allowed":e.isCurrentUserManager,"is-sticked":t.stickedColumns[t.lastHeaderMenuDisplayed],onMinimizeClicked:s[0]||(s[0]=n=>e.onMinimizeColumnToggled()),onDeleteAllClicked:s[1]||(s[1]=n=>e.onDeleteAllTasksClicked()),onSortByClicked:s[2]||(s[2]=n=>e.onSortByTaskTypeClicked()),onSelectColumn:s[3]||(s[3]=n=>e.onSelectColumn("asset")),onToggleStick:s[4]||(s[4]=n=>a.stickColumnClicked())},null,8,["is-minimized","is-edit-allowed","is-sticked"]),u(T,{ref:"headerMetadataMenu","is-edit-allowed":e.isMetadataColumnEditAllowed(t.lastMetadaDataHeaderMenuDisplayed),"is-sticked":t.stickedColumns[t.lastMetadaDataHeaderMenuDisplayed],onEditClicked:s[5]||(s[5]=n=>e.onEditMetadataClicked()),onDeleteClicked:s[6]||(s[6]=n=>e.onDeleteMetadataClicked()),onSortByClicked:s[7]||(s[7]=n=>e.onSortByMetadataClicked()),onToggleStick:s[8]||(s[8]=n=>a.metadataStickColumnClicked(n))},null,8,["is-edit-allowed","is-sticked"]),f("table",We,[z((l(),r("thead",qe,[f("tr",null,[f("th",Ge,[f("div",Ye,[f("span",Je,y(e.$t("assets.fields.name")),1),(e.isCurrentUserManager||e.isCurrentUserSupervisor)&&!i.isLoading?(l(),k(v,{key:0,class:"is-small flexrow-item",icon:"plus",text:"",onClick:e.onAddMetadataClicked},null,8,["onClick"])):h("",!0)])],512),e.isTVShow&&i.displaySettings.showInfos?(l(),r("th",{key:0,scope:"col",class:"episode",ref:"th-episode"},y(e.$t("assets.fields.episode")),513)):h("",!0),(l(!0),r(S,null,A(e.stickedVisibleMetadataDescriptors,(n,p)=>(l(),k(_,{ref_for:!0,ref:`editor-${p}`,key:"sticky-header"+n.id,descriptor:n,left:t.offsets["editor-"+p]?`${t.offsets["editor-"+p]}px`:"0","is-stick":"",style:{"z-index":1001},onShowMetadataHeaderMenu:o=>e.showMetadataHeaderMenu(n.id,o)},null,8,["descriptor","left","onShowMetadataHeaderMenu"]))),128)),i.isLoading?h("",!0):(l(!0),r(S,{key:1},A(e.stickedDisplayedValidationColumns,(n,p)=>(l(),k(E,{ref_for:!0,ref:`validation-${p}`,key:"sticky-header"+n,"hidden-columns":t.hiddenColumns,"column-id":n,"validation-style":e.getValidationStyle(n),left:t.offsets["validation-"+p]?`${t.offsets["validation-"+p]}px`:"0",type:"assets","is-stick":"",onShowHeaderMenu:o=>e.showHeaderMenu(n,p,o)},null,8,["hidden-columns","column-id","validation-style","left","onShowHeaderMenu"]))),128)),e.isCurrentUserManager&&i.displaySettings.showInfos&&!a.isAssetsOnly&&t.metadataDisplayHeaders.readyFor?(l(),r("th",{key:2,ref:"th-ready-for",scope:"col",class:"ready-for",title:e.$t("assets.fields.ready_for")},y(e.$t("assets.fields.ready_for")),9,Xe)):h("",!0),!e.isCurrentUserClient&&i.displaySettings.showInfos&&e.isAssetDescription?(l(),r("th",{key:3,scope:"col",class:"description",ref:"th-description"},y(e.$t("assets.fields.description")),513)):h("",!0),!e.isCurrentUserClient&&i.displaySettings.showInfos&&e.isAssetTime&&t.metadataDisplayHeaders.timeSpent?(l(),r("th",{key:4,scope:"col",class:"time-spent number-cell",ref:"th-spent"},y(e.$t("assets.fields.time_spent")),513)):h("",!0),!e.isCurrentUserClient&&i.displaySettings.showInfos&&e.isAssetEstimation&&t.metadataDisplayHeaders.estimation?(l(),r("th",{key:5,scope:"col",class:"estimation number-cell",title:e.$t("main.estimation"),ref:"th-spent"},y(e.$t("main.estimation_short")),9,Ze)):h("",!0),e.isAssetResolution&&i.displaySettings.showInfos&&t.metadataDisplayHeaders.resolution?(l(),r("th",je,y(e.$t("shots.fields.resolution")),1)):h("",!0),i.displaySettings.showInfos?(l(!0),r(S,{key:7},A(e.nonStickedVisibleMetadataDescriptors,n=>(l(),k(_,{key:"header"+n.id,descriptor:n,onShowMetadataHeaderMenu:p=>e.showMetadataHeaderMenu(n.id,p)},null,8,["descriptor","onShowMetadataHeaderMenu"]))),128)):h("",!0),i.isLoading?h("",!0):(l(!0),r(S,{key:8},A(e.nonStickedDisplayedValidationColumns,(n,p)=>(l(),k(E,{key:"header"+n,"hidden-columns":t.hiddenColumns,"column-id":n,"validation-style":e.getValidationStyle(n),type:"assets",onShowHeaderMenu:o=>{e.showHeaderMenu(n,p,o)}},null,8,["hidden-columns","column-id","validation-style","onShowHeaderMenu"]))),128)),f("th",xe,[e.isCurrentUserManager&&i.displayedAssets.length>0&&!i.isLoading?(l(),k(v,{key:0,class:b({"is-small":!0,highlighted:a.isEmptyTask}),icon:"plus",text:e.$t("tasks.create_tasks"),onClick:s[9]||(s[9]=n=>e.$emit("create-tasks"))},null,8,["class","text"])):h("",!0),i.displaySettings.showInfos?z((l(),k(V,{key:1,descriptors:e.assetMetadataDescriptors,exclude:{timeSpent:!e.isAssetTime,estimation:!e.isAssetEstimation},namespace:"assets",modelValue:t.metadataDisplayHeaders,"onUpdate:modelValue":s[10]||(s[10]=n=>t.metadataDisplayHeaders=n)},null,8,["descriptors","exclude","modelValue"])),[[Y,t.columnSelectorDisplayed]]):h("",!0),i.displaySettings.showInfos?(l(),k(v,{key:2,class:"is-small is-pulled-right mr05",icon:"down",onClick:e.toggleColumnSelector},null,8,["onClick"])):h("",!0)],512)])])),[[B]]),!i.isLoading&&a.isListVisible?(l(!0),r(S,{key:0},A(i.displayedAssets,(n,p)=>(l(),r("tbody",{class:"datatable-body",key:"group-"+e.getGroupKey(n,p,"asset_type_id"),onMousedown:s[15]||(s[15]=(...o)=>e.startBrowsing&&e.startBrowsing(...o)),onTouchstart:s[16]||(s[16]=(...o)=>e.startBrowsing&&e.startBrowsing(...o))},[n[0]?(l(),r("tr",$e,[f("th",es,[f("span",{class:"datatable-row-header pointer",onClick:o=>e.$emit("asset-type-clicked",n[0].asset_type_name)},y(n[0]?n[0].asset_type_name:""),9,ss)])])):h("",!0),(l(!0),r(S,null,A(n,(o,M)=>(l(),r("tr",{class:b(["datatable-row",{canceled:o.canceled,shared:o.shared}]),scope:"row",key:`row${o.id}`,title:o.shared?e.$t("library.from_library"):void 0},[f("th",{class:b({"datatable-row-header":!0,name:!0,bold:!o.canceled})},[f("div",is,[e.isCurrentUserManager?(l(),r("input",{key:0,type:"checkbox",class:"flexrow-item",checked:e.selectedAssets.has(o.id)||null,disabled:o.shared,onInput:m=>a.toggleLine(o,m)},null,40,as)):h("",!0),u(I,{class:"entity-thumbnail flexrow-item",entity:o,width:i.displaySettings.bigThumbnails?150:50,height:i.displaySettings.bigThumbnails?100:30,"empty-width":i.displaySettings.bigThumbnails?150:50,"empty-height":i.displaySettings.bigThumbnails?100:32},null,8,["entity","width","height","empty-width","empty-height"]),!o.shared&&!e.isCurrentUserClient?(l(),k(F,{key:1,tabindex:"-1",class:"asset-link asset-name flexrow-item",to:a.assetPath(o.id),title:o.full_name},{default:te(()=>[N(y(o.name),1)]),_:2},1032,["to","title"])):(l(),r(S,{key:2},[N(y(o.name),1)],64))])],2),e.isTVShow&&i.displaySettings.showInfos?(l(),r("td",os,[f("div",{class:"flexrow",title:a.assetEpisodes(o,!0)},y(a.assetEpisodes(o,!1)),9,ls)])):h("",!0),(l(!0),r(S,null,A(e.stickedVisibleMetadataDescriptors,(m,C)=>(l(),r("td",{class:"metadata-descriptor datatable-row-header",title:o.data?o.data[m.field_name]:"",style:ie({"z-index":1e3-M-p*100,left:t.offsets["editor-"+C]?`${t.offsets["editor-"+C]}px`:"0"}),key:"sticky-desc-"+o.id+"-"+m.id},[u(L,{entity:o,descriptor:m,indexes:{i:M,j:C,k:p},onMetadataChanged:s[11]||(s[11]=D=>e.$emit("metadata-changed",D))},null,8,["entity","descriptor","indexes"])],12,ns))),128)),i.isLoading?h("",!0):(l(!0),r(S,{key:1},A(e.stickedDisplayedValidationColumns,(m,C)=>(l(),k(w,{ref_for:!0,ref:`validation-${a.getIndex(M,p)}-${C}`,class:b({"validation-cell":!t.hiddenColumns[m],"hidden-validation-cell":t.hiddenColumns[m],"datatable-row-header":!0}),"contact-sheet":i.displaySettings.contactSheetMode,key:"sticky-validation-"+m+"-"+o.id,canceled:o.canceled,column:a.taskTypeMap.get(m),entity:o,"task-test":e.taskMap.get(o.validations.get(m)),selected:a.isSelected(M,p,C),"row-x":a.getIndex(M,p),"column-y":C,minimized:t.hiddenColumns[m],"is-static":!0,"is-assignees":i.displaySettings.showAssignations,left:t.offsets["validation-"+C]?`${t.offsets["validation-"+C]}px`:"0",sticked:!0,onSelect:s[12]||(s[12]=D=>e.onTaskSelected(D,!0)),onUnselect:s[13]||(s[13]=D=>e.onTaskUnselected(D,!0))},null,8,["class","contact-sheet","canceled","column","entity","task-test","selected","row-x","column-y","minimized","is-assignees","left"]))),128)),e.isCurrentUserManager&&i.displaySettings.showInfos&&!a.isAssetsOnly&&t.metadataDisplayHeaders.readyFor?(l(),r("td",rs,[u(P,{class:"mb0","model-value":o.ready_for,"task-type-list":a.readyForTaskTypes,shy:!0,"onUpdate:modelValue":m=>a.onReadyForChanged(o,m)},null,8,["model-value","task-type-list","onUpdate:modelValue"])])):h("",!0),!e.isCurrentUserClient&&i.displaySettings.showInfos&&e.isAssetDescription?(l(),k(H,{key:3,class:"description",onDescriptionChanged:m=>e.onDescriptionChanged(o,m),editable:e.isCurrentUserManager&&!o.shared,entry:o},null,8,["onDescriptionChanged","editable","entry"])):h("",!0),!e.isCurrentUserClient&&i.displaySettings.showInfos&&e.isAssetTime&&t.metadataDisplayHeaders.timeSpent?(l(),r("td",ds,y(e.formatDuration(o.timeSpent)),1)):h("",!0),!e.isCurrentUserClient&&i.displaySettings.showInfos&&e.isAssetEstimation&&t.metadataDisplayHeaders.estimation?(l(),r("td",ms,y(e.formatDuration(o.estimation)),1)):h("",!0),e.isAssetResolution&&i.displaySettings.showInfos&&t.metadataDisplayHeaders.resolution?(l(),r("td",hs,[e.isCurrentUserManager?(l(),r("input",{key:0,class:b({"input-editor":!0,error:!e.isValidResolution(o)}),value:e.getMetadataFieldValue({field_name:"resolution"},o),onInput:m=>e.onMetadataFieldChanged(o,{field_name:"resolution"},m),onKeyup:ae(m=>a.onInputKeyUp(m,a.getIndex(M,p),e.descriptorLength+3),["ctrl"])},null,42,cs)):(l(),r("span",us,y(e.getMetadataFieldValue({field_name:"resolution"},o)),1))])):h("",!0),i.displaySettings.showInfos?(l(!0),r(S,{key:7},A(e.nonStickedVisibleMetadataDescriptors,(m,C)=>(l(),r("td",{class:"metadata-descriptor",title:o.data?o.data[m.field_name]:"",key:"desc"+o.id+"-"+m.id},[u(L,{entity:o,descriptor:m,indexes:{i:M,j:C,k:p},onMetadataChanged:s[14]||(s[14]=D=>e.$emit("metadata-changed",D))},null,8,["entity","descriptor","indexes"])],8,ps))),128)):h("",!0),i.isLoading?h("",!0):(l(!0),r(S,{key:8},A(e.nonStickedDisplayedValidationColumns,(m,C)=>(l(),k(w,{ref_for:!0,ref:`validation-${a.getIndex(M,p)}-${C+e.stickedDisplayedValidationColumns.length}`,class:b({"validation-cell":!t.hiddenColumns[m],"hidden-validation-cell":t.hiddenColumns[m]}),key:"validation"+m+"-"+o.id,canceled:o.canceled,column:a.taskTypeMap.get(m),"contact-sheet":i.displaySettings.contactSheetMode,entity:o,"task-test":e.taskMap.get(o.validations.get(m)),selected:a.isSelected(M,p,C+e.stickedDisplayedValidationColumns.length),"row-x":a.getIndex(M,p),"column-y":C,minimized:t.hiddenColumns[m],"is-static":!0,"is-assignees":i.displaySettings.showAssignations,selectable:a.isSelectable(o,m),disabled:!a.isSelectable(o,m),onSelect:e.onTaskSelected,onUnselect:e.onTaskUnselected},null,8,["class","canceled","column","contact-sheet","entity","task-test","selected","row-x","column-y","minimized","is-assignees","selectable","disabled","onSelect","onUnselect"]))),128)),e.isCurrentUserManager&&!o.shared?(l(),k(U,{key:9,entry:o,onEditClicked:m=>e.$emit("edit-clicked",o),onDeleteClicked:m=>e.$emit("delete-clicked",o),onRestoreClicked:m=>e.$emit("restore-clicked",o)},null,8,["entry","onEditClicked","onDeleteClicked","onRestoreClicked"])):(l(),r("td",fs))],10,ts))),128))],32))),128)):h("",!0)]),a.isEmptyList&&!e.isCurrentUserClient&&!i.isLoading?(l(),r("div",ys,[s[19]||(s[19]=f("p",{class:"info"},[f("img",{src:K})],-1)),f("p",gs,y(e.$t("assets.empty_list")),1),u(v,{class:"level-item big-button",text:e.$t("assets.new_assets"),onClick:s[17]||(s[17]=n=>e.$emit("new-clicked"))},null,8,["text"])])):h("",!0),a.isEmptyList&&e.isCurrentUserClient&&!i.isLoading?(l(),r("div",ks,[s[20]||(s[20]=f("p",{class:"info"},[f("img",{src:K})],-1)),f("p",Cs,y(e.$t("assets.empty_list_client")),1)])):h("",!0),u(R,{"is-loading":i.isLoading,"is-error":i.isError},null,8,["is-loading","is-error"])],544),!a.isEmptyList&&!i.isLoading?(l(),r("p",Ts,[N(y(e.displayedAssetsLength)+" "+y(e.$tc("assets.number",e.displayedAssetsLength))+" ",1),e.displayedAssetsTimeSpent>0||e.displayedAssetsEstimation>0?(l(),r("span",Ss," ("+y(e.formatDuration(e.displayedAssetsTimeSpent))+" "+y(e.isDurationInHours?e.$tc("main.hours_spent",e.formatDuration(e.displayedAssetsTimeSpent,!1)):e.$tc("main.days_spent",e.formatDuration(e.displayedAssetsTimeSpent,!1)))+", "+y(e.formatDuration(e.displayedAssetsEstimation))+" "+y(e.isDurationInHours?e.$tc("main.hours_estimated",e.formatDuration(e.displayedAssetsEstimation,!1)):e.$tc("main.man_days",e.formatDuration(e.displayedAssetsEstimation,!1)))+") ",1)):h("",!0)])):h("",!0)])}const As=Q(Ke,[["render",Ms],["__scopeId","data-v-ad3da907"]]),Ds={name:"assets",mixins:[de,Ce],components:{AssetList:As,AddMetadataModal:ke,AddThumbnailsModal:ge,BuildFilterModal:Se,ButtonSimple:W,ComboboxDepartment:Fe,ComboboxDisplayOptions:ye,CreateTasksModal:fe,DeleteModal:Pe,EditAssetModal:He,HardDeleteModal:Be,ImportModal:Re,ImportRenderModal:Ue,SearchField:Ne,SearchQueryList:Oe,SortingInfo:pe,TaskInfo:ze},data(){return{type:"asset",assetToDelete:{},assetToRestore:{},assetToEdit:{},assetFilters:[{type:"Type",value:{name:"open"}}],assetFilterTypes:["Type"],contactSheetMode:!1,deleteAllTasksLockText:null,descriptorToEdit:{},departmentFilter:[],displaySettings:{bigThumbnails:!1,contactSheetMode:!1,showAssignations:!0,showInfos:!0,showSharedAssets:!0},optionalColumns:["Description","Ready for","Resolution"],pageName:"Assets",parsedCSV:[],selectedDepartment:"ALL",taskTypeForTaskDeletion:null,errors:{addMetadata:!1,addThumbnails:!1,creatingTasks:!1,delete:!1,deleteMetadata:!1,edit:!1,restore:!1,importing:!1,importingError:null},genericColumns:["Metadata column name (text value)","Task type name (task status name value)","Task type name + comment (text value)"],initialLoading:!0,loading:{addMetadata:!1,addThumbnails:!1,creatingTasks:!1,deleteAllTasks:!1,deleteMetadata:!1,delete:!1,edit:!1,importing:!1,restore:!1,savingSearch:!1,stay:!1,taskStay:!1},modals:{isAddMetadataDisplayed:!1,isAddThumbnailsDisplayed:!1,isBuildFilterDisplayed:!1,isCreateTasksDisplayed:!1,isDeleteDisplayed:!1,isDeleteAllTasksDisplayed:!1,isDeleteMetadataDisplayed:!1,isImportDisplayed:!1,isImportRenderDisplayed:!1,isNewDisplayed:!1},success:{edit:!1}}},created(){this.setLastProductionScreen("assets")},mounted(){const e=this.$route.query.search??"";this.assetSearchText&&this.$refs["asset-search-field"]?.setValue(this.assetSearchText),this.$refs["asset-list"]?.setScrollPosition(this.assetListScrollPosition);const s=()=>{this.$refs["asset-list"]&&(this.searchField.setValue(e),this.applySearchFromUrl(),this.$refs["asset-list"].setScrollPosition(this.assetListScrollPosition),this.$nextTick(()=>{this.$refs["asset-list"]?.selectTaskFromQuery()}))};this.assetMap.size<2||this.assetValidationColumns.length===0||this.assetValidationColumns.length>0&&(!this.assetMap.get(this.assetMap.keys().next().value).validations||this.assetMap.get(this.assetMap.keys().next().value).validations.size===0)?setTimeout(()=>{this.loadAssets().then(()=>{setTimeout(()=>{this.initialLoading=!1,s()},500)})},0):(this.isAssetsLoading||(this.initialLoading=!1),s())},beforeUnmount(){this.clearSelectedAssets()},computed:{...G(["assetMap","assetsPath","assetListScrollPosition","assetsCsvFormData","assetSearchText","assetSearchFilterGroups","assetSearchQueries","assetSorting","assetTypes","assetValidationColumns","currentEpisode","currentProduction","currentSection","departmentMap","departments","displayedAssets","displayedAssetsByType","episodeMap","isAssetEstimation","isAssetTime","isAssetsLoading","isAssetsLoadingError","isCurrentUserClient","isCurrentUserManager","isTVShow","isAssetResolution","openProductions","productionAssetTaskTypes","selectedAssets","taskTypeMap","user"]),addThumbnailsModal(){return this.$refs["add-thumbnails-modal"]},searchField(){return this.$refs["asset-search-field"]},displayedAssetsByTypeWithoutShared(){return this.displayedAssetsByType.map(e=>e.filter(s=>!s.shared))},filteredAssets(){const e={};return this.displayedAssetsByType.forEach(s=>{s.forEach(i=>{let d="";this.isTVShow&&i.episode_id&&this.episodeMap.has(i.episode_id)&&(d+=this.episodeMap.get(i.episode_id).name),d+=`${i.asset_type_name}${i.name}`,e[d]=!0})}),e},tvShowPageTitle(){const e=this.currentProduction?.name||"";let s="";if(this.currentEpisode)switch(this.currentEpisode.id){case"all":s=this.$t("main.all");break;case"main":s=this.$t("main.main_pack");break;default:s=this.currentEpisode.name}return`${e} - ${s} | ${this.$t("assets.title")} - Kitsu`},shortPageTitle(){return`${this.currentProduction?.name||""} | ${this.$t("assets.title")} - Kitsu`},dataMatchers(){return this.isTVShow?["Episode","Type","Name"]:["Type","Name"]},renderColumns(){const e=[...this.dataMatchers,...this.optionalColumns];return this.productionAssetTaskTypes.forEach(s=>{e.push(s.name),e.push(`${s.name} comment`)}),e}},methods:{...q(["addMetadataDescriptor","changeAssetSort","clearSelectedAssets","commentTaskWithPreview","createTasks","deleteAllAssetTasks","deleteAsset","deleteMetadataDescriptor","editAsset","getAssetsCsvLines","loadAssets","loadEpisodes","newAsset","removeAssetSearch","restoreAsset","saveAssetSearch","setLastProductionScreen","setAssetSearch","setPreview","uploadAssetFile"]),setOptionalImportColumns(){const e=[this.$t("assets.fields.description"),this.$t("assets.fields.ready_for"),this.$t("shots.fields.resolution")];this.isPaperProduction&&e.splice(1,1),this.optionalColumns=e},showNewModal(){this.assetToEdit={},this.modals.isNewDisplayed=!0},onEditClicked(e){this.assetToEdit=e,this.modals.isNewDisplayed=!0},onDeleteClicked(e){this.assetToDelete=e,this.modals.isDeleteDisplayed=!0},onRestoreClicked(e){this.assetToRestore=e,this.modals.isRestoreDisplayed=!0},confirmNewAssetStay(e){this.loading.stay=!0,this.success.edit=!1,this.newAsset(e).then(()=>{this.loading.stay=!1,this.loading.edit=!1,this.resetLightEditModal(),this.$refs["edit-asset-modal"].focusName(),this.success.edit=!0}).catch(s=>{console.error(s),this.loading.stay=!1,this.loading.edit=!1,this.success.edit=!1,this.errors.edit=!0})},confirmEditAsset(e){let s="newAsset";this.loading.edit=!0,this.errors.edit=!1,this.assetToEdit&&this.assetToEdit.id&&(s="editAsset",e.id=this.assetToEdit.id),this[s](e).then(i=>{this.loading.edit=!1,this.modals.isNewDisplayed=!1,this.applySearchFromUrl(!1)}).catch(i=>{console.error(i),this.loading.edit=!1,this.errors.edit=!0})},confirmDeleteAsset(){this.loading.delete=!0,this.errors.delete=!1,this.deleteAsset(this.assetToDelete).then(e=>{this.loading.delete=!1,this.modals.isDeleteDisplayed=!1}).catch(e=>{console.error(e),this.loading.delete=!1,this.errors.delete=!0})},confirmRestoreAsset(){this.loading.restore=!0,this.errors.restore=!1,this.restoreAsset(this.assetToRestore).then(e=>{this.loading.restore=!1,this.modals.isRestoreDisplayed=!1}).catch(e=>{console.error(e),this.loading.restore=!1,this.errors.restore=!0})},confirmCreateTasks({form:e,selectionOnly:s}){this.loading.creatingTasks=!0,this.runTasksCreation(e,s).then(()=>{this.reset(),this.hideCreateTasksModal(),this.loading.creatingTasks=!1})},confirmCreateTasksAndStay({form:e,selectionOnly:s}){this.loading.taskStay=!0,this.runTasksCreation(e,s).then(()=>{this.reset(),this.loading.taskStay=!1})},runTasksCreation(e,s){return this.errors.creatingTasks=!1,this.createTasks({type:"assets",task_type_id:e.task_type_id,project_id:this.currentProduction.id,selectionOnly:s}).catch(i=>{this.errors.creatingTasks=!0,console.error(i)})},confirmDeleteAllTasks(e){const s=this.taskTypeForTaskDeletion.id,i=this.currentProduction.id;this.errors.deleteAllTasks=!1,this.loading.deleteAllTasks=!0,this.deleteAllAssetTasks({projectId:i,taskTypeId:s,selectionOnly:e}).then(()=>{e||this.loadAssets(),this.modals.isDeleteAllTasksDisplayed=!1}).catch(d=>{console.error(d),this.errors.deleteAllTasks=!0}).finally(()=>{this.loading.deleteAllTasks=!1})},confirmDeleteMetadata(){this.errors.deleteMetadata=!1,this.loading.deleteMetadata=!0,this.deleteMetadataDescriptor(this.descriptorIdToDelete).then(()=>{this.errors.deleteMetadata=!1,this.modals.isDeleteMetadataDisplayed=!1}).catch(e=>{console.error(e),this.errors.deleteMetadata=!0}).finally(()=>{this.loading.deleteMetadata=!1})},resetLightEditModal(){const e={name:"",entity_type_id:this.assetToEdit.entity_type_id,production_id:this.currentProduction.id};this.assetToEdit=e},resetEditModal(){const e={name:""};this.assetTypes.length>0&&(e.asset_type_id=this.assetTypes[0].id),e.production_id=this.currentProduction.id,this.assetToEdit=e},deleteText(){const e=this.assetToDelete;return e&&(e.canceled||!e.tasks||e.tasks.length===0)?this.$t("assets.delete_text",{name:e.name}):e?this.$t("assets.cancel_text",{name:e.name}):""},deleteAllTasksText(){const e=this.taskTypeForTaskDeletion;return e?this.$t("tasks.delete_all_text",{name:e.name}):""},restoreText(){const e=this.assetToRestore;return e?this.$t("assets.restore_text",{name:e.name}):""},renderImport(e,s){this.loading.importing=!0,this.errors.importing=!1,this.formData=e,s==="file"&&(e=e.get("file")),O.processCSV(e).then(i=>{this.parsedCSV=i,this.hideImportModal(),this.loading.importing=!1,this.showImportRenderModal()})},uploadImportFile(e,s){const i=new FormData,d="import.csv",t=O.turnEntriesToCsvString(e),a=new File([t],d,{type:"text/csv"});i.append("file",a),this.loading.importing=!0,this.errors.importing=!1,this.$store.commit("ASSET_CSV_FILE_SELECTED",i),this.uploadAssetFile(s).then(()=>{this.hideImportRenderModal(),this.loadEpisodes().catch(console.error),this.loadAssets()}).catch(g=>{this.errors.importing=!0,this.errors.importingError=g}).finally(()=>{this.loading.importing=!1})},resetImport(){this.errors.importing=!1,this.hideImportRenderModal(),this.$store.commit("ASSET_CSV_FILE_SELECTED",null),this.$refs["import-modal"].reset(),this.showImportModal()},saveSearchQuery(e){this.loading.savingSearch||(this.loading.savingSearch=!0,this.saveAssetSearch(e).catch(console.error).finally(()=>{this.loading.savingSearch=!1}))},removeSearchQuery(e){this.removeAssetSearch(e).catch(s=>{s&&console.error(s)})},saveScrollPosition(e){this.$store.commit("SET_ASSET_LIST_SCROLL_POSITION",e)},onDeleteAllTasksClicked(e){const s=this.taskTypeMap.get(e);this.taskTypeForTaskDeletion=s,this.deleteAllTasksLockText=s.name,this.modals.isDeleteAllTasksDisplayed=!0},confirmAddMetadata(e){this.loading.addMetadata=!0,e.entity_type="Asset",this.addMetadataDescriptor(e).then(()=>{this.loading.addMetadata=!1,this.modals.isAddMetadataDisplayed=!1}).catch(s=>{console.error(s),this.loading.addMetadata=!1,this.errors.addMetadata=!0})},confirmAddThumbnails(e){const s=i=>(this.addThumbnailsModal?.markLoading(i.task.entity_id),this.commentTaskWithPreview({taskId:i.task.id,commentText:"",taskStatusId:i.task.task_status_id,form:i}).then(({newComment:d,preview:t})=>this.setPreview({taskId:i.task.id,entityId:i.task.entity_id,previewId:t.id})).then(()=>{this.addThumbnailsModal?.markUploaded(i.task.entity_id)}));this.loading.addThumbnails=!0,ne.runPromiseMapAsSeries(e,s).then(()=>{this.loading.addThumbnails=!1,this.modals.isAddThumbnailsDisplayed=!1})},onAddMetadataClicked(){this.descriptorToEdit={},this.modals.isAddMetadataDisplayed=!0},onDeleteMetadataClicked(e){this.descriptorIdToDelete=e,this.modals.isDeleteMetadataDisplayed=!0},onEditMetadataClicked(e){this.descriptorToEdit=this.currentProduction.descriptors.find(s=>s.id===e),this.modals.isAddMetadataDisplayed=!0},onExportClick(){this.getAssetsCsvLines().then(e=>{const s=[oe().format("YYYY-MM-DD"),"kitsu",this.currentProduction.name,this.$t("assets.title")];this.currentEpisode&&s.splice(3,0,this.currentEpisode.name);const i=re.slugify(s.join("_"));let d=this.isTVShow?["Episode"]:[];d=d.concat([this.$t("assets.fields.type"),this.$t("assets.fields.name"),this.$t("assets.fields.description"),this.$t("assets.fields.ready_for")]),le([...this.currentProduction.descriptors]).filter(t=>t.entity_type==="Asset").forEach(t=>{d.push(t.name)}),this.isAssetTime&&d.push(this.$t("assets.fields.time_spent")),this.isAssetEstimation&&d.push(this.$t("main.estimation_short")),this.isAssetResolution&&d.push(this.$t("shots.fields.resolution")),this.assetValidationColumns.forEach(t=>{d.push(this.taskTypeMap.get(t).name),d.push("Assignations")}),O.buildCsvFile(i,[d].concat(e))})},onAssetTypeClicked(e){this.searchField.setValue(`${this.assetSearchText} type=[${e}]`),this.onSearchChange()},onChangeSortClicked(e){this.changeAssetSort(e)},async onFieldChanged({entry:e,fieldName:s,value:i}){const d={id:e.id,[s]:i};await this.editAsset(d),this.applySearchFromUrl(!1)},async onMetadataChanged({entry:e,descriptor:s,value:i}){const d={id:e.id,data:{[s.field_name]:i}};await this.editAsset(d),this.applySearchFromUrl(!1)},async onAssetChanged(e){await this.editAsset(e),this.applySearchFromUrl(!1)},reset(){this.initialLoading=!0,this.loadAssets().then(()=>{this.initialLoading=!1,this.applySearchFromUrl()})}},watch:{currentProduction(){this.setOptionalImportColumns(),this.$refs["asset-search-field"]?.setValue(""),this.$store.commit("SET_ASSET_LIST_SCROLL_POSITION",0),this.initialLoading=!0,this.isTVShow||this.reset()},currentEpisode(){this.$refs["asset-search-field"]?.setValue(""),this.$store.commit("SET_ASSET_LIST_SCROLL_POSITION",0),this.isTVShow&&this.currentEpisode&&this.reset()},currentSection(){this.isTVShow&&this.currentEpisode?.id&&!this.displayedAssets.find(e=>e.episode_id===this.currentEpisode.id)&&(this.searchField.setValue(""),this.$store.commit("SET_ASSET_LIST_SCROLL_POSITION",0),this.initialLoading=!0,this.reset())}},head(){return this.isTVShow?{title:this.tvShowPageTitle}:{title:this.shortPageTitle}}},vs={class:"columns fixed-page"},ws={class:"column main-column"},bs={class:"assets page"},_s={class:"asset-list-header page-header"},Es={class:"flexrow mb1"},Ls={key:0,class:"flexrow flexrow-item"},Vs={key:1,class:"flexrow"},Is={class:"query-list"},Fs={id:"side-column",class:"column side-column"};function Ps(e,s,i,d,t,a){const g=c("search-field"),T=c("button-simple"),v=c("combobox-department"),_=c("combobox-display-options"),E=c("search-query-list"),V=c("sorting-info"),I=c("asset-list"),F=c("task-info"),L=c("edit-asset-modal"),w=c("delete-modal"),P=c("hard-delete-modal"),H=c("import-render-modal"),U=c("import-modal"),R=c("create-tasks-modal"),B=c("add-metadata-modal"),n=c("add-thumbnails-modal"),p=c("build-filter-modal");return l(),r("div",vs,[f("div",ws,[f("div",bs,[f("div",_s,[f("div",Es,[u(g,{ref:"asset-search-field",class:"flexrow-item","can-save":!0,onChange:e.onSearchChange,onSave:a.saveSearchQuery,placeholder:"ex: props modeling=wip"},null,8,["onChange","onSave"]),u(T,{class:"flexrow-item",title:e.$t("entities.build_filter.title"),icon:"filter",onClick:s[0]||(s[0]=o=>t.modals.isBuildFilterDisplayed=!0)},null,8,["title"]),s[11]||(s[11]=f("div",{class:"flexrow-item filler"},null,-1)),e.isCurrentUserClient?h("",!0):(l(),r("div",Ls,[e.departments.length>0?(l(),k(v,{key:0,class:"combobox-department flexrow-item","selectable-departments":e.selectableDepartments("Asset"),"display-all-and-my-departments":!0,rounded:"",modelValue:t.selectedDepartment,"onUpdate:modelValue":s[1]||(s[1]=o=>t.selectedDepartment=o)},null,8,["selectable-departments","modelValue"])):h("",!0),u(_,{class:"flexrow-item",type:t.type,modelValue:t.displaySettings,"onUpdate:modelValue":s[2]||(s[2]=o=>t.displaySettings=o)},null,8,["type","modelValue"])])),e.isCurrentUserManager?(l(),r("div",Vs,[u(T,{class:"flexrow-item",title:e.$t("entities.thumbnails.title"),icon:"import-files",onClick:e.showAddThumbnailsModal},null,8,["title","onClick"]),u(T,{class:"flexrow-item",title:e.$t("main.csv.import_file"),icon:"import",onClick:e.showImportModal},null,8,["title","onClick"]),u(T,{class:"flexrow-item",icon:"export",title:e.$t("main.csv.export_file"),onClick:a.onExportClick},null,8,["title","onClick"]),u(T,{class:"flexrow-item",text:e.$t("assets.new_asset"),icon:"plus",onClick:a.showNewModal},null,8,["text","onClick"])])):h("",!0)]),f("div",Is,[!e.isAssetsLoading&&!t.initialLoading?(l(),k(E,{key:0,groups:e.assetSearchFilterGroups,"is-group-enabled":!0,queries:e.assetSearchQueries,type:"asset",onRemoveSearch:a.removeSearchQuery},null,8,["groups","queries","onRemoveSearch"])):h("",!0)])]),e.assetSorting?.length?(l(),k(V,{key:0,sorting:e.assetSorting,onClearSorting:s[3]||(s[3]=o=>a.onChangeSortClicked(null))},null,8,["sorting"])):h("",!0),u(I,{ref:"asset-list","displayed-assets":t.displaySettings.showSharedAssets?e.displayedAssetsByType:a.displayedAssetsByTypeWithoutShared,"display-settings":t.displaySettings,"is-loading":e.isAssetsLoading||t.initialLoading,"is-error":e.isAssetsLoadingError,"department-filter":t.departmentFilter,"validation-columns":e.assetValidationColumns,onChangeSort:a.onChangeSortClicked,onCreateTasks:e.showCreateTasksModal,onDeleteAllTasks:a.onDeleteAllTasksClicked,onNewClicked:a.showNewModal,onEditClicked:a.onEditClicked,onDeleteClicked:a.onDeleteClicked,onRestoreClicked:a.onRestoreClicked,onAddMetadata:a.onAddMetadataClicked,onEditMetadata:a.onEditMetadataClicked,onDeleteMetadata:a.onDeleteMetadataClicked,onMetadataChanged:a.onMetadataChanged,onAssetChanged:a.onAssetChanged,onFieldChanged:a.onFieldChanged,onScroll:a.saveScrollPosition,onAssetTypeClicked:a.onAssetTypeClicked,onKeepTaskPanelOpen:e.onKeepTaskPanelOpenChanged},null,8,["displayed-assets","display-settings","is-loading","is-error","department-filter","validation-columns","onChangeSort","onCreateTasks","onDeleteAllTasks","onNewClicked","onEditClicked","onDeleteClicked","onRestoreClicked","onAddMetadata","onEditMetadata","onDeleteMetadata","onMetadataChanged","onAssetChanged","onFieldChanged","onScroll","onAssetTypeClicked","onKeepTaskPanelOpen"])])]),z(f("div",Fs,[u(F,{task:e.selectedTasks.values().next().value,"entity-type":"Asset","with-actions":""},null,8,["task"])],512),[[Y,e.isTaskSidePanelOpen]]),u(L,{ref:"edit-asset-modal",active:t.modals.isNewDisplayed,"is-loading":t.loading.edit,"is-loading-stay":t.loading.stay,"is-error":t.errors.edit,"is-success":t.success.edit,"asset-to-edit":t.assetToEdit,onConfirm:a.confirmEditAsset,onConfirmAndStay:a.confirmNewAssetStay,onCancel:s[4]||(s[4]=o=>t.modals.isNewDisplayed=!1)},null,8,["active","is-loading","is-loading-stay","is-error","is-success","asset-to-edit","onConfirm","onConfirmAndStay"]),u(w,{ref:"delete-asset-modal",active:t.modals.isDeleteDisplayed,"is-loading":t.loading.delete,"is-error":t.errors.delete,text:a.deleteText(),"error-text":e.$t("assets.delete_error"),onConfirm:a.confirmDeleteAsset,onCancel:s[5]||(s[5]=o=>t.modals.isDeleteDisplayed=!1)},null,8,["active","is-loading","is-error","text","error-text","onConfirm"]),u(w,{ref:"restore-asset-modal",active:t.modals.isRestoreDisplayed,"is-loading":t.loading.restore,"is-error":t.loading.delete,text:a.restoreText(),"error-text":e.$t("assets.restore_error"),onConfirm:a.confirmRestoreAsset,onCancel:s[6]||(s[6]=o=>t.modals.isRestoreDisplayed=!1)},null,8,["active","is-loading","is-error","text","error-text","onConfirm"]),u(P,{ref:"delete-all-tasks-modal",active:t.modals.isDeleteAllTasksDisplayed,"is-loading":t.loading.deleteAllTasks,"is-error":t.errors.deleteAllTasks,text:a.deleteAllTasksText(),"error-text":e.$t("tasks.delete_all_error"),"lock-text":t.deleteAllTasksLockText,"selection-option":!0,onConfirm:a.confirmDeleteAllTasks,onCancel:s[7]||(s[7]=o=>t.modals.isDeleteAllTasksDisplayed=!1)},null,8,["active","is-loading","is-error","text","error-text","lock-text","onConfirm"]),u(w,{ref:"delete-metadata-modal",active:t.modals.isDeleteMetadataDisplayed,"is-loading":t.loading.deleteMetadata,"is-error":t.errors.deleteMetadata,text:e.$t("productions.metadata.delete_text"),"error-text":e.$t("productions.metadata.delete_error"),onConfirm:a.confirmDeleteMetadata,onCancel:s[8]||(s[8]=o=>t.modals.isDeleteMetadataDisplayed=!1)},null,8,["active","is-loading","is-error","text","error-text","onConfirm"]),u(H,{active:t.modals.isImportRenderDisplayed,"is-loading":t.loading.importing,"is-error":t.errors.importing,"import-error":t.errors.importingError,"parsed-csv":t.parsedCSV,"form-data":e.assetsCsvFormData,columns:a.renderColumns,"data-matchers":a.dataMatchers,database:a.filteredAssets,onReupload:a.resetImport,onConfirm:a.uploadImportFile,onCancel:e.hideImportRenderModal},null,8,["active","is-loading","is-error","import-error","parsed-csv","form-data","columns","data-matchers","database","onReupload","onConfirm","onCancel"]),u(U,{ref:"import-modal",active:t.modals.isImportDisplayed,"is-loading":t.loading.importing,"is-error":t.errors.importing,"form-data":e.assetsCsvFormData,columns:a.dataMatchers,"optional-columns":t.optionalColumns,"generic-columns":t.genericColumns,onConfirm:a.renderImport,onCancel:e.hideImportModal},null,8,["active","is-loading","is-error","form-data","columns","optional-columns","generic-columns","onConfirm","onCancel"]),u(R,{active:t.modals.isCreateTasksDisplayed,"is-loading":t.loading.creatingTasks,"is-loading-stay":t.loading.taskStay,"is-error":t.errors.creatingTasks,title:e.$t("tasks.create_tasks_asset"),text:e.$t("tasks.create_tasks_asset_explaination"),"error-text":e.$t("tasks.create_tasks_asset_failed"),onConfirm:a.confirmCreateTasks,onConfirmAndStay:a.confirmCreateTasksAndStay,onCancel:e.hideCreateTasksModal},null,8,["active","is-loading","is-loading-stay","is-error","title","text","error-text","onConfirm","onConfirmAndStay","onCancel"]),u(B,{active:t.modals.isAddMetadataDisplayed,"is-loading":t.loading.addMetadata,"is-error":t.errors.addMetadata,"descriptor-to-edit":t.descriptorToEdit,"entity-type":"Asset",onConfirm:a.confirmAddMetadata,onCancel:s[9]||(s[9]=o=>t.modals.isAddMetadataDisplayed=!1)},null,8,["active","is-loading","is-error","descriptor-to-edit","onConfirm"]),t.modals.isAddThumbnailsDisplayed?(l(),k(n,{key:0,ref:"add-thumbnails-modal",active:"","entity-type":"Asset",parent:"assets","is-loading":t.loading.addThumbnails,"is-error":t.errors.addThumbnails,onConfirm:a.confirmAddThumbnails,onCancel:e.hideAddThumbnailsModal},null,8,["is-loading","is-error","onConfirm","onCancel"])):h("",!0),u(p,{ref:"build-filter-modal",active:t.modals.isBuildFilterDisplayed,onConfirm:e.confirmBuildFilter,onCancel:s[10]||(s[10]=o=>t.modals.isBuildFilterDisplayed=!1)},null,8,["active","onConfirm"])])}const Zt=Q(Ds,[["render",Ps],["__scopeId","data-v-f9e18fb8"]]);export{Zt as default};
//# sourceMappingURL=Assets-Cs5A5EC5.js.map
