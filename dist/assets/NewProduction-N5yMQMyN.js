import{d as Y}from"./vuedraggable.umd-CN5ywgj8.js";import{_ as L,r as p,o as l,c as m,d as r,g as h,n as E,t as n,h as u,a8 as G,au as I,S as J,f as d,w as c,F,e as M,H as f,K,a as Q,Y as P,J as O,p as W,av as S,A as X,aw as Z,G as $,b as tt,ax as R}from"./index-C2m_IhNF.js";import{c as k}from"./csv-cx9HGs3n.js";import{C as et}from"./Combobox-DQpIQydI.js";import{C as st}from"./ComboboxStyled-fscUNRmK.js";import{C as ot}from"./ComboboxStatus-DYpCiml-.js";import{C as it}from"./ComboboxTaskType-CiBcPUsC.js";import{D as rt}from"./DateField-OvNA3wsX.js";import{E as at}from"./EditAssetTypeModal-BwrW-ate.js";import{E as nt}from"./EditTaskStatusModal-BemNlHXv.js";import{E as lt}from"./EditTaskTypeModal-CH0Ouw_v.js";import{I as dt,a as pt}from"./ImportRenderModal-DmK76ufV.js";import{M as ut}from"./ManageShotsModal-2-UXZtgL.js";import{T as mt}from"./TaskTypeName-bEgQZfX7.js";import{T as ct}from"./TextField-p_HJuEKt.js";import{C as ht}from"./check-_fRnDsm9.js";import{V as Tt}from"./ValidationTag-C6BUHddW.js";import"./vue.esm-bundler-Cb2j4MJL.js";import"./string-B0Tq569e.js";import"./ComboboxBoolean-DJwCfClJ.js";import"./ModalFooter-BJ98b-60.js";import"./TextareaField-Bd7jnoYr.js";import"./BooleanField-BK_C2MOf.js";import"./ColorField--VnpcHkf.js";import"./ComboboxSimple-DU0Ahozo.js";import"./ComboboxDepartment-whRm-Bo0.js";import"./DepartmentName-C_7ZW05X.js";import"./FileUpload-C4E3YXqL.js";import"./Checkbox-ByQFc4Am.js";import"./PageTitle-DzrTLr4-.js";const yt={name:"timeline-item",components:{CheckIcon:ht},props:{title:String,subtitle:String,isLast:{type:Boolean,default:!1},step:Number,isCompleted:{type:Boolean,default:!1},optional:{type:Boolean,default:!1}}},gt={class:"wrapper"},ft={class:"timeline"},kt={key:2,class:"dots"},Ct={class:"timeline-content"},St={class:"subtitle"},_t={key:0};function bt(t,e,a,g,s,o){const T=p("check-icon");return l(),m("div",gt,[r("div",ft,[a.isCompleted?(l(),h(T,{key:0,class:"check"})):(l(),m("span",{key:1,class:E({step:!0,optional:a.optional})},n(a.step),3)),a.isLast?u("",!0):(l(),m("div",kt))]),r("div",Ct,[r("h3",{class:E(["title",{"is-completed":a.isCompleted,optional:a.optional}])},n(a.title),3),r("p",St,n(a.subtitle),1),G(t.$slots,"default",{},void 0,!0),a.isLast?u("",!0):(l(),m("hr",_t))])])}const At=L(yt,[["render",bt],["__scopeId","data-v-7626170d"]]),vt={name:"new-production",components:{draggable:Y,Combobox:et,ComboboxStyled:st,ComboboxTaskType:it,ComboboxStatus:ot,DateField:rt,EditAssetTypeModal:at,EditTaskStatusModal:nt,EditTaskTypeModal:lt,ImportModal:pt,ImportRenderModal:dt,ManageShotsModal:ut,Spinner:J,TaskTypeName:mt,TextField:ct,TimelineItem:At,ValidationTag:Tt},data(){return{errors:{creatingProduction:!1,creatingProductionError:"",creatingTaskType:!1,importingAssets:!1,importingAssetsError:null,importingShots:!1,importingShotsError:null},loading:{createProduction:!1,importingAssets:!1,importingShots:!1,creatingTaskType:!1},modals:{isAddAssetsDisplayed:!1,isAddAssetTypeDisplayed:!1,isAddShotsDisplayed:!1,isAddTaskStatusDisplayed:!1,isAddTaskTypeDisplayed:!1,isAssetsImportDisplayed:!1,isAssetsImportRenderDisplayed:!1,isShotsImportDisplayed:!1,isShotsImportRenderDisplayed:!1},parsedAssetsCSV:[],parsedShotsCSV:[],productionToCreate:{assetsToAdd:null,assetTypes:[],assetTaskTypes:[],episodesToCreate:[],name:null,sequencesToCreate:[],settings:{dateStart:null,dateEnd:null,fps:25,ratio:[16,9],resolution:[1920,1080],style:R[0].value,type:S[0].value},shotsToAdd:null,shotTaskTypes:[],shotsToCreate:[],taskStatuses:[]},assetsOptionalColumns:["Description","Ready for","Resolution"],shotsOptionalColumns:["Description","Nb Frames","Frame In","Frame Out","FPS","Resolution"],taskTypeForEntity:"Asset",genericColumns:["metadata_column_name => text value","task_type_name => task_status_name","task_type_name comment => comment text"],productionStyleOptions:R,productionTypeOptions:S}},mounted(){this.$refs.nameField.focus()},computed:{...tt(["assetsCsvFormData","assetTaskTypes","assetTypes","productionStatus","shotsCsvFormData","shotTaskTypes","taskStatus"]),assetTypeMap(){return $.cache.assetTypeMap},taskStatusMap(){return Z.cache.taskStatusMap},taskTypeMap(){return X.cache.taskTypeMap},isTVShow(){return this.productionToCreate.settings.type==="tvshow"},isAssetsOnly(){return this.productionToCreate.settings.type==="assets"},isShotsOnly(){return this.productionToCreate.settings.type==="shots"},assetsDataMatchers(){return this.isTVShow?["Episode","Type","Name"]:["Type","Name"]},assetsRenderColumns(){const t=[...this.assetsDataMatchers,...this.assetsOptionalColumns];return this.productionToCreate.assetTaskTypes.forEach(e=>{t.push(e.name),t.push(e.name+" comment")}),t},shotsRenderColumns(){const t=[...this.shotsDataMatchers,...this.shotsOptionalColumns];return this.productionToCreate.shotTaskTypes.forEach(e=>{t.push(e.name),t.push(e.name+" comment")}),t},shotsDataMatchers(){return this.isTVShow?["Episode","Sequence","Name"]:["Sequence","Name"]},allowedProductionTypes(){return S.map(t=>t.value)},hasValidName(){return!this.isEmpty(this.productionToCreate.name)},hasValidStartDate(){return!this.isEmpty(this.productionToCreate.settings.dateStart)},hasValidEndDate(){return!this.isEmpty(this.productionToCreate.settings.dateEnd)},hasValidAssets(){return this.nbAssetsToImport>0},hasValidAssetTypes(){return this.productionToCreate.assetTypes.length>0},hasValidShots(){return this.nbShotsToImport>0},hasValidSettings(){return this.hasValidType&&this.hasValidFPS&&this.hasValidRatio&&this.hasValidResolution&&this.hasValidStartDate&&this.hasValidEndDate},hasValidFPS(){const t=parseInt(this.productionToCreate.settings.fps);return t>0&&t<=60},hasValidRatio(){return this.isEmpty(this.productionToCreate.settings.ratio)?!1:this.productionToCreate.settings.ratio.length===2&&this.isFloat(this.productionToCreate.settings.ratio[0])&&this.isInteger(this.productionToCreate.settings.ratio[1])},hasValidResolution(){return this.isEmpty(this.productionToCreate.settings.resolution)?!1:this.productionToCreate.settings.resolution.length===2&&this.isInteger(this.productionToCreate.settings.resolution[0])&&this.isInteger(this.productionToCreate.settings.resolution[1])},hasValidType(){return this.allowedProductionTypes.includes(this.productionToCreate.settings.type)},hasValidAssetTaskTypes(){return this.productionToCreate.assetTaskTypes.length>0},hasValidShotTaskTypes(){return this.productionToCreate.shotTaskTypes.length>0},hasValidTaskStatuses(){return this.productionToCreate.taskStatuses.length>0},hasAllDataCorrect(){return this.hasValidName&&this.hasValidSettings&&(this.hasValidAssetTaskTypes||this.isShotsOnly)&&(this.hasValidShotTaskTypes||this.isAssetsOnly)&&this.hasValidTaskStatuses&&(this.hasValidAssetTypes||this.isShotsOnly)},availableAssetTaskTypes(){return this.assetTaskTypes.filter(t=>!this.productionToCreate.assetTaskTypes.includes(t)&&!t.archived)},availableAssetTypes(){const t=W(this.assetTypes.filter(e=>!this.productionToCreate.assetTypes.includes(e)));return[{name:"+ Add Asset Type",id:"-"},...t].map(e=>({label:e.name,value:e.id}))},availableShotTaskTypes(){return this.shotTaskTypes.filter(t=>!this.productionToCreate.shotTaskTypes.includes(t)&&!t.archived)},availableTaskStatuses(){return this.taskStatus.filter(t=>!this.productionToCreate.taskStatuses.includes(t)&&!t.is_default&&!t.for_concept)},nbAssetsToImport(){return this.productionToCreate.assetsToAdd?this.productionToCreate.assetsToAdd.filter(e=>e.length>1).length-1:0},nbShotsToImport(){let t=this.productionToCreate.shotsToCreate.length;if(this.productionToCreate.shotsToAdd){const e=this.productionToCreate.shotsToAdd.filter(a=>a.length>1);t+=e.length-1}return t},startDatePlaceholder(){return P(O())},endDatePlaceholder(){return P(O().add(3,"month"))}},methods:{...Q(["addAssetTypeToProduction","addTaskStatusToProduction","addTaskTypeToProduction","loadContext","newAssetType","newProduction","newTaskStatus","newTaskType","setProduction","uploadAssetFile","uploadShotFile"]),removeModelFromList:I,deleteFromList(t,e){this.productionToCreate[e]=I(this.productionToCreate[e],t)},isEmpty(t){return t==null||t===""||t===[]||t==={}},isFloat(t){return!this.isEmpty(t)&&/^[(\d)*,(\d)+]|(\d)+$/.test(t)},isInteger(t){return!this.isEmpty(t)&&/^\d+$/.test(t)},async createTaskTypesAndStatuses(){await K.runPromiseAsSeries(this.productionToCreate.assetTaskTypes.concat(this.productionToCreate.shotTaskTypes).map(async(t,e)=>{const a=t.for_entity==="Shot"?e-this.productionToCreate.assetTaskTypes.length:e;return await this.addTaskTypeToProduction({taskTypeId:t.id,priority:a+1})}).concat(this.productionToCreate.taskStatuses.map(async t=>await this.addTaskStatusToProduction(t.id))))},async createAssets(){this.productionToCreate.assetsToAdd!==null&&(this.loading.importingAssets=!0,this.errors.importingAssets=!1,await this.uploadAssetFile(!1).then(()=>{this.loading.importingAssets=!1}).catch(t=>{this.loading.importingAssets=!1,this.errors.importingAssets=!0,this.errors.importingAssetsError=t}))},createAssetTypes(){this.productionToCreate.assetTypes.map(async t=>await this.addAssetTypeToProduction(t.id))},async createShots(){this.productionToCreate.shotsToAdd!==null&&(this.loading.importingShots=!0,this.errors.importingShots=!1,await this.uploadShotFile(!1).then(()=>{this.loading.importingShots=!1}).catch(t=>{this.loading.importingShots=!1,this.errors.importingShots=!0,this.errors.importingShotsError=t}))},createTaskType(t){this.loading.creatingTaskType=!0,this.errors.creatingTaskType=!1,this.newTaskType(t).then(()=>{this.loading.creatingTaskType=!1,this.modals.isAddTaskTypeDisplayed=!1}).catch(e=>{console.error(e),this.loading.creatingTaskType=!1,this.errors.creatingTaskType=!0})},createTaskStatus(t){this.loading.creatingTaskStatus=!0,this.errors.creatingTaskStatus=!1,this.newTaskStatus(t).then(()=>{this.loading.creatingTaskStatus=!1,this.modals.isAddTaskStatusDisplayed=!1}).catch(e=>{console.error(e),this.loading.creatingTaskStatus=!1,this.errors.creatingTaskStatus=!0})},createAssetType(t){this.loading.creatingAssetType=!0,this.errors.creatingAssetType=!1,this.newAssetType(t).then(()=>{this.loading.creatingAssetType=!1,this.modals.isAddAssetTypeDisplayed=!1}).catch(e=>{console.error(e),this.loading.creatingAssetType=!1,this.errors.creatingAssetType=!0})},createProductionRoute(t){const e={production_id:t.id};let a="assets";return this.isTVShow?(e.episode_id="all",a="episode-assets"):this.isShotsOnly&&(a="shots"),{name:a,params:e}},async createProduction(){if(!this.loading.createProduction){this.loading.createProduction=!0,this.errors.creatingProduction=!1,this.errors.creatingProductionError="";try{const t=await this.newProduction({name:this.productionToCreate.name,project_status_id:this.productionStatus[0].id,fps:this.productionToCreate.settings.fps,ratio:this.productionToCreate.settings.ratio.join(":"),resolution:this.productionToCreate.settings.resolution.join("x"),production_type:this.productionToCreate.settings.type,production_style:this.productionToCreate.settings.style,start_date:this.productionToCreate.settings.dateStart,end_date:this.productionToCreate.settings.dateEnd});await this.setProduction(t.id),await this.createTaskTypesAndStatuses(),await this.createAssetTypes(),await this.createAssets(),this.productionToCreate.production_type!=="assets"&&await this.createShots(),await this.loadContext(),await this.$router.push(this.createProductionRoute(t))}catch(t){console.error(t),this.errors.creatingProduction=!0,this.errors.creatingProductionError=t.body?.message?.substring(0,165)??""}this.loading.createProduction=!1}},toggleModal(t){this.modals[t]=!this.modals[t]},renderAssetsImport(t,e){this.loading.importingAssets=!0,this.errors.importingAssets=!1,e==="file"&&(t=t.get("file")),k.processCSV(t).then(a=>{this.parsedAssetsCSV=a,this.toggleModal("isAssetsImportDisplayed"),this.loading.importingAssets=!1,this.toggleModal("isAssetsImportRenderDisplayed")})},resetAssetsImport(){this.errors.importingAssets=!1,this.toggleModal("isAssetsImportRenderDisplayed"),this.$store.commit("ASSET_CSV_FILE_SELECTED",null),this.productionToCreate.assetsToAdd=null,this.$refs["import-assets-modal"].reset(),this.toggleModal("isAssetsImportDisplayed")},uploadAssetsImportFile(t,e){const a=new FormData,g="import.csv",s=k.turnEntriesToCsvString(t),o=new File([s],g,{type:"text/csv"});a.append("file",o),this.$store.commit("ASSET_CSV_FILE_SELECTED",a),this.productionToCreate.assetsToAdd=t,this.toggleModal("isAssetsImportRenderDisplayed")},renderShotsImport(t,e){this.loading.importingShots=!0,this.errors.importingShots=!1,e==="file"&&(t=t.get("file")),k.processCSV(t).then(a=>{this.parsedShotsCSV=a,this.toggleModal("isShotsImportDisplayed"),this.loading.importingShots=!1,this.toggleModal("isShotsImportRenderDisplayed")})},resetShotsImport(){this.errors.importingShots=!1,this.toggleModal("isShotsImportRenderDisplayed"),this.$store.commit("SHOT_CSV_FILE_SELECTED",null),this.productionToCreate.shotsToAdd=null,this.$refs["import-shots-modal"].reset(),this.toggleModal("isShotsImportDisplayed")},uploadShotsImportFile(t,e){const a=new FormData,g="import.csv",s=k.turnEntriesToCsvString(t),o=new File([s],g,{type:"text/csv"});a.append("file",o),this.$store.commit("SHOT_CSV_FILE_SELECTED",a),this.productionToCreate.shotsToAdd=t,this.toggleModal("isShotsImportRenderDisplayed")},addEpisode(t,e){this.productionToCreate.episodesToCreate.push(t),t.id=this.productionToCreate.episodesToCreate.length-1,e(t)},addSequence(t,e){this.productionToCreate.sequencesToCreate.push(t),t.id=this.productionToCreate.sequencesToCreate.length-1,e(t)},addShot(t,e){this.productionToCreate.shotsToCreate.push(t),t.id=this.productionToCreate.shotsToCreate.length-1,e(t)},onAddLibraryAssetTaskTypeClicked(){this.taskTypeForEntity="Asset",this.modals.isAddTaskTypeDisplayed=!0},onAddLibraryShotTaskTypeClicked(){this.taskTypeForEntity="Shot",this.modals.isAddTaskTypeDisplayed=!0}}},Vt={class:"new-production page"},Dt={class:"columns"},wt={class:"column is-offset-one-quarter is-half"},Et={class:"hero"},It={class:"hero-body"},Ft={class:"subtitle"},Mt={class:"title"},Pt={class:"flexrow"},Ot={class:"mb1 explaination"},Rt={class:"flexrow"},Lt={class:"mb1 explaination"},Ut={class:"label"},Nt={class:"date-picker-wrapper"},xt={class:"mb1 explaination"},qt={class:"flexrow mb1"},Bt={class:"flexrow mb1"},zt={class:"flexrow"},jt={class:"flexrow mt1"},Ht={class:"flexrow asset-types mb1"},Yt={class:"flexrow mt1"},Gt=["onClick"],Jt={class:"import-content"},Kt={key:0,class:"tag mr1"},Qt={class:"import-content"},Wt={key:0,class:"tag mr1"},Xt={class:"has-text-centered mt2"},Zt={key:0,class:"error"},$t={key:1,class:"error"},te={key:2,class:"error"},ee={key:4,class:"button big-button"};function se(t,e,a,g,s,o){const T=p("text-field"),y=p("timeline-item"),_=p("combobox-styled"),b=p("date-field"),A=p("task-type-name"),v=p("combobox-task-type"),V=p("draggable"),U=p("combobox-status"),N=p("validation-tag"),x=p("combobox"),q=p("spinner"),B=p("edit-task-type-modal"),z=p("edit-task-status-modal"),j=p("edit-asset-type-modal"),D=p("import-render-modal"),w=p("import-modal"),H=p("manage-shots-modal");return l(),m("div",Vt,[r("div",Dt,[r("div",wt,[r("section",Et,[r("div",It,[r("h2",Ft,n(t.$t("productions.creation.new_project")),1),r("h1",Mt,n(t.$t("productions.creation.create_production")),1)])]),d(y,{title:t.$t("productions.creation.give_a_name"),subtitle:t.$t("productions.creation.give_a_name_description"),step:1,"is-completed":o.hasValidName},{default:c(()=>[d(T,{ref:"nameField","input-class":" is-inline",placeholder:t.$t("productions.creation.placeholder_name"),modelValue:s.productionToCreate.name,"onUpdate:modelValue":e[0]||(e[0]=i=>s.productionToCreate.name=i)},null,8,["placeholder","modelValue"])]),_:1},8,["title","subtitle","is-completed"]),d(y,{title:t.$t("productions.creation.production_settings"),subtitle:t.$t("productions.creation.production_settings_description"),step:2,"is-completed":o.hasValidSettings},{default:c(()=>[r("div",Pt,[d(_,{class:"flexrow-item",options:s.productionTypeOptions,label:t.$t("productions.fields.type"),"locale-key-prefix":"productions.type.",modelValue:s.productionToCreate.settings.type,"onUpdate:modelValue":e[1]||(e[1]=i=>s.productionToCreate.settings.type=i),thin:"","is-inline":""},null,8,["options","label","modelValue"]),d(_,{class:"flexrow-item",options:s.productionStyleOptions,label:t.$t("productions.fields.style"),"locale-key-prefix":"productions.style.",modelValue:s.productionToCreate.settings.style,"onUpdate:modelValue":e[2]||(e[2]=i=>s.productionToCreate.settings.style=i),thin:"","is-inline":""},null,8,["options","label","modelValue"])]),r("div",Ot,n(t.$t("productions.creation.explaination_type")),1),r("div",Rt,[d(T,{class:"flexrow-item","input-class":" is-small is-size-4",label:t.$t("productions.fields.fps"),type:"number",max:60,step:.001,placeholder:t.$t("productions.creation.placeholder_fps"),errored:!o.hasValidFPS,modelValue:s.productionToCreate.settings.fps,"onUpdate:modelValue":e[3]||(e[3]=i=>s.productionToCreate.settings.fps=i),thin:""},null,8,["label","placeholder","errored","modelValue"]),e[31]||(e[31]=r("span",{class:"input-separator flexrow-item mr1"},null,-1)),d(T,{class:"flexrow-item mr0","input-class":" is-small is-size-3",label:t.$t("productions.fields.ratio"),type:"number",step:.01,placeholder:t.$t("productions.creation.placeholder_ratio1"),modelValue:s.productionToCreate.settings.ratio[0],"onUpdate:modelValue":e[4]||(e[4]=i=>s.productionToCreate.settings.ratio[0]=i),thin:""},null,8,["label","placeholder","modelValue"]),e[32]||(e[32]=r("span",{class:"input-separator flexrow-item mt15 mr0"},":",-1)),d(T,{class:"flexrow-item","input-class":" is-small is-size-2",type:"number",step:1,placeholder:t.$t("productions.creation.placeholder_ratio2"),"empty-label":!0,modelValue:s.productionToCreate.settings.ratio[1],"onUpdate:modelValue":e[5]||(e[5]=i=>s.productionToCreate.settings.ratio[1]=i),thin:""},null,8,["placeholder","modelValue"]),e[33]||(e[33]=r("span",{class:"input-separator flexrow-item mr1"},null,-1)),d(T,{class:"flexrow-item mr0 ml2","input-class":" is-small is-size-4",label:t.$t("productions.fields.resolution"),type:"number",step:1,placeholder:t.$t("productions.creation.placeholder_resolution1"),modelValue:s.productionToCreate.settings.resolution[0],"onUpdate:modelValue":e[6]||(e[6]=i=>s.productionToCreate.settings.resolution[0]=i),thin:""},null,8,["label","placeholder","modelValue"]),e[34]||(e[34]=r("span",{class:"input-separator flexrow-item mt15 mr05"},"x",-1)),d(T,{class:"flexrow-item","input-class":" is-small is-size-4",type:"number",placeholder:t.$t("productions.creation.placeholder_resolution2"),step:1,"empty-label":!0,modelValue:s.productionToCreate.settings.resolution[1],"onUpdate:modelValue":e[7]||(e[7]=i=>s.productionToCreate.settings.resolution[1]=i),thin:""},null,8,["placeholder","modelValue"])]),r("div",Lt,n(t.$t("productions.creation.explaination_video")),1),r("div",null,[r("label",Ut,n(t.$t("productions.creation.start_and_end_dates")),1),r("div",Nt,[d(b,{"can-delete":!1,label:t.$t("main.start_date"),"max-date":s.productionToCreate.settings.dateEnd,placeholder:o.startDatePlaceholder,modelValue:s.productionToCreate.settings.dateStart,"onUpdate:modelValue":e[8]||(e[8]=i=>s.productionToCreate.settings.dateStart=i)},null,8,["label","max-date","placeholder","modelValue"]),e[35]||(e[35]=r("span",{class:"input-separator"},"-",-1)),d(b,{"can-delete":!1,label:t.$t("main.end_date"),"min-date":s.productionToCreate.settings.dateStart,placeholder:o.endDatePlaceholder,modelValue:s.productionToCreate.settings.dateEnd,"onUpdate:modelValue":e[9]||(e[9]=i=>s.productionToCreate.settings.dateEnd=i)},null,8,["label","min-date","placeholder","modelValue"])])]),r("div",xt,n(t.$t("productions.creation.explaination_date")),1)]),_:1},8,["title","subtitle","is-completed"]),o.isShotsOnly?u("",!0):(l(),h(y,{key:0,title:t.$t("productions.creation.select_asset_task_type"),subtitle:t.$t("productions.creation.select_asset_task_type_description"),step:3,"is-completed":o.hasValidAssetTaskTypes},{default:c(()=>[d(V,{"item-key":"id",modelValue:s.productionToCreate.assetTaskTypes,"onUpdate:modelValue":e[12]||(e[12]=i=>s.productionToCreate.assetTaskTypes=i)},{item:c(({element:i})=>[d(A,{class:"task-type",deletable:"","task-type":i,onDelete:C=>o.deleteFromList(i,"assetTaskTypes")},null,8,["task-type","onDelete"])]),header:c(()=>[r("div",qt,[o.availableAssetTaskTypes.length?(l(),h(v,{key:0,class:"is-inline inline-task-type-combo flexrow-item mb0","task-type-list":o.availableAssetTaskTypes,"add-placeholder":"","onUpdate:modelValue":e[10]||(e[10]=i=>s.productionToCreate.assetTaskTypes.push(o.taskTypeMap.get(i)))},null,8,["task-type-list"])):u("",!0),r("button",{class:"button is-link flexrow-item",onClick:e[11]||(e[11]=(...i)=>o.onAddLibraryAssetTaskTypeClicked&&o.onAddLibraryAssetTaskTypeClicked(...i))},n(t.$t("task_types.add_task_type_to_library")),1)])]),_:1},8,["modelValue"])]),_:1},8,["title","subtitle","is-completed"])),o.isAssetsOnly?u("",!0):(l(),h(y,{key:1,title:t.$t("productions.creation.select_shot_task_type"),subtitle:t.$t("productions.creation.select_shot_task_type_description"),step:o.isShotsOnly?3:4,"is-completed":o.hasValidShotTaskTypes},{default:c(()=>[d(V,{"item-key":"id",modelValue:s.productionToCreate.shotTaskTypes,"onUpdate:modelValue":e[15]||(e[15]=i=>s.productionToCreate.shotTaskTypes=i)},{item:c(({element:i})=>[d(A,{class:"task-type",deletable:"","task-type":i,onDelete:C=>o.deleteFromList(i,"shotTaskTypes")},null,8,["task-type","onDelete"])]),header:c(()=>[r("div",Bt,[o.availableShotTaskTypes.length?(l(),h(v,{key:0,class:"is-inline inline-task-type-combo flexrow-item mb0","task-type-list":o.availableShotTaskTypes,"add-placeholder":"","onUpdate:modelValue":e[13]||(e[13]=i=>s.productionToCreate.shotTaskTypes.push(o.taskTypeMap.get(i)))},null,8,["task-type-list"])):u("",!0),r("button",{class:"button is-link flexrow-item",onClick:e[14]||(e[14]=(...i)=>o.onAddLibraryShotTaskTypeClicked&&o.onAddLibraryShotTaskTypeClicked(...i))},n(t.$t("task_types.add_task_type_to_library")),1)])]),_:1},8,["modelValue"])]),_:1},8,["title","subtitle","step","is-completed"])),d(y,{title:t.$t("productions.creation.select_task_status"),subtitle:t.$t("productions.creation.select_task_status_description"),step:o.isShotsOnly||o.isAssetsOnly?4:5,"is-completed":o.hasValidTaskStatuses},{default:c(()=>[r("div",zt,[o.availableTaskStatuses.length>0?(l(),h(U,{key:0,class:"flexrow-item","task-status-list":o.availableTaskStatuses,"with-margin":!1,big:"","add-placeholder":"","onUpdate:modelValue":e[16]||(e[16]=i=>s.productionToCreate.taskStatuses.push(o.taskStatusMap.get(i)))},null,8,["task-status-list"])):u("",!0),r("button",{class:"button is-link flexrow-item",onClick:e[17]||(e[17]=i=>s.modals.isAddTaskStatusDisplayed=!0)},n(t.$t("task_status.add_task_status_to_library")),1)]),r("div",jt,[(l(!0),m(F,null,M(s.productionToCreate.taskStatuses,i=>(l(),h(N,{class:"task-status flexrow-item",task:{task_status_id:i.id},key:i.id,pointer:"","is-static":"",onClick:C=>o.deleteFromList(i,"taskStatuses")},null,8,["task","onClick"]))),128))])]),_:1},8,["title","subtitle","step","is-completed"]),o.isShotsOnly?u("",!0):(l(),h(y,{key:2,title:t.$t("productions.creation.add_asset_types"),subtitle:t.$t("productions.creation.add_asset_types_description"),step:o.isAssetsOnly?5:6,"is-completed":o.hasValidAssetTypes},{default:c(()=>[r("div",Ht,[o.availableAssetTypes.length>1?(l(),h(x,{key:0,class:"flexrow-item",options:o.availableAssetTypes,"with-margin":!1,"onUpdate:modelValue":e[18]||(e[18]=i=>{o.assetTypeMap.get(i)&&s.productionToCreate.assetTypes.push(o.assetTypeMap.get(i))})},null,8,["options"])):u("",!0),r("button",{class:"button is-link flexrow-item",onClick:e[19]||(e[19]=i=>s.modals.isAddAssetTypeDisplayed=!0)},n(t.$t("asset_types.add_asset_type_to_library")),1)]),r("div",Yt,[(l(!0),m(F,null,M(s.productionToCreate.assetTypes,i=>(l(),m("span",{key:i.id,class:"asset-type-name flexrow-item",onClick:C=>o.deleteFromList(i,"assetTypes")},n(i.name),9,Gt))),128))])]),_:1},8,["title","subtitle","step","is-completed"])),o.isShotsOnly?u("",!0):(l(),h(y,{key:3,title:t.$t("productions.creation.add_assets"),subtitle:t.$t("productions.creation.add_assets_description"),step:o.isAssetsOnly?6:7,"is-completed":o.hasValidAssets,optional:!0,"is-last":o.isAssetsOnly},{default:c(()=>[r("div",Jt,[o.nbAssetsToImport>0?(l(),m("span",Kt,n(o.nbAssetsToImport)+" "+n(t.$t("productions.creation.assets_to_import")),1)):u("",!0),r("button",{class:"button import-button",onClick:e[20]||(e[20]=i=>o.toggleModal("isAssetsImportDisplayed"))},n(t.$t("productions.creation.import_assets_button")),1)])]),_:1},8,["title","subtitle","step","is-completed","is-last"])),o.isAssetsOnly?u("",!0):(l(),h(y,{key:4,title:t.$t("productions.creation.add_shots"),subtitle:t.$t("productions.creation.add_shots_description"),step:o.isShotsOnly?5:8,"is-completed":o.hasValidShots,optional:!0,"is-last":""},{default:c(()=>[r("div",Qt,[o.nbShotsToImport>0?(l(),m("span",Wt,n(o.nbShotsToImport)+" "+n(t.$t("productions.creation.shots_to_import")),1)):u("",!0),r("button",{class:"button import-button",onClick:e[21]||(e[21]=i=>o.toggleModal("isShotsImportDisplayed"))},n(t.$t("productions.creation.import_shots_button")),1)])]),_:1},8,["title","subtitle","step","is-completed"])),r("section",Xt,[s.errors.importingAssets?(l(),m("p",Zt,[f(n(t.$t("productions.creation.errorImportingAssets"))+" ",1),e[36]||(e[36]=r("br",null,null,-1)),f(" "+n(s.errors.importingAssetsError),1)])):u("",!0),s.errors.importingShots?(l(),m("p",$t,[f(n(t.$t("productions.creation.errorImportingShots"))+" ",1),e[37]||(e[37]=r("br",null,null,-1)),f(" "+n(s.errors.importingShotsError),1)])):u("",!0),s.errors.creatingProduction?(l(),m("p",te,n(t.$t("productions.creation.error"))+" "+n(s.errors.creatingProductionError),1)):u("",!0),o.hasAllDataCorrect?(l(),m("button",{key:3,class:"button big-button",onClick:e[22]||(e[22]=(...i)=>o.createProduction&&o.createProduction(...i))},[s.loading.createProduction?(l(),h(q,{key:0,class:"mr05 mt05",size:20,"is-white":""})):u("",!0),f(" "+n(t.$t("productions.creation.create_button")),1)])):(l(),m("button",ee,n(t.$t("productions.creation.create_button_disabled")),1))])])]),d(B,{active:s.modals.isAddTaskTypeDisplayed,"is-loading":s.loading.creatingTaskType,"is-error":s.errors.creatingTaskType,"for-entity":s.taskTypeForEntity,onCancel:e[23]||(e[23]=i=>s.modals.isAddTaskTypeDisplayed=!1),onConfirm:o.createTaskType},null,8,["active","is-loading","is-error","for-entity","onConfirm"]),d(z,{active:s.modals.isAddTaskStatusDisplayed,"is-loading":s.loading.creatingTaskStatus,"is-error":s.errors.creatingTaskStatus,onCancel:e[24]||(e[24]=i=>s.modals.isAddTaskStatusDisplayed=!1),onConfirm:o.createTaskStatus},null,8,["active","is-loading","is-error","onConfirm"]),d(j,{active:s.modals.isAddAssetTypeDisplayed,"is-loading":s.loading.creatingAssetType,"is-error":s.errors.creatingAssetType,onCancel:e[25]||(e[25]=i=>s.modals.isAddAssetTypeDisplayed=!1),onConfirm:o.createAssetType},null,8,["active","is-loading","is-error","onConfirm"]),d(D,{active:s.modals.isAssetsImportRenderDisplayed,"is-loading":s.loading.importingAssets,"is-error":s.errors.importingAssets,"import-error":s.errors.importingAssetsError,"parsed-csv":s.parsedAssetsCSV,"form-data":t.assetsCsvFormData,columns:o.assetsRenderColumns,"data-matchers":o.assetsDataMatchers,database:{},"disable-update":!0,onReupload:o.resetAssetsImport,onConfirm:o.uploadAssetsImportFile,onCancel:e[26]||(e[26]=i=>o.toggleModal("isAssetsImportRenderDisplayed"))},null,8,["active","is-loading","is-error","import-error","parsed-csv","form-data","columns","data-matchers","onReupload","onConfirm"]),d(w,{ref:"import-assets-modal",active:s.modals.isAssetsImportDisplayed,"is-loading":s.loading.importingAssets,"is-error":s.errors.importingAssets,"form-data":t.assetsCsvFormData,columns:o.assetsDataMatchers,"optional-columns":s.assetsOptionalColumns,"generic-columns":s.genericColumns,onConfirm:o.renderAssetsImport,onCancel:e[27]||(e[27]=i=>o.toggleModal("isAssetsImportDisplayed"))},null,8,["active","is-loading","is-error","form-data","columns","optional-columns","generic-columns","onConfirm"]),d(D,{active:s.modals.isShotsImportRenderDisplayed,"is-loading":s.loading.importingShots,"is-error":s.errors.importingShots,"import-error":s.errors.importingShotsError,"parsed-csv":s.parsedShotsCSV,"form-data":t.shotsCsvFormData,columns:o.shotsRenderColumns,"data-matchers":o.shotsDataMatchers,database:{},"disable-update":!0,onReupload:o.resetShotsImport,onConfirm:o.uploadShotsImportFile,onCancel:e[28]||(e[28]=i=>o.toggleModal("isShotsImportRenderDisplayed"))},null,8,["active","is-loading","is-error","import-error","parsed-csv","form-data","columns","data-matchers","onReupload","onConfirm"]),d(w,{ref:"import-shots-modal",active:s.modals.isShotsImportDisplayed,"is-loading":s.loading.importingShots,"is-error":s.errors.importingShots,"form-data":t.shotsCsvFormData,columns:o.shotsDataMatchers,"optional-columns":s.shotsOptionalColumns,"generic-columns":s.genericColumns,onConfirm:o.renderShotsImport,onCancel:e[29]||(e[29]=i=>o.toggleModal("isShotsImportDisplayed"))},null,8,["active","is-loading","is-error","form-data","columns","optional-columns","generic-columns","onConfirm"]),d(H,{active:s.modals.isAddShotsDisplayed,onAddEpisode:o.addEpisode,onAddSequence:o.addSequence,onAddShot:o.addShot,onCancel:e[30]||(e[30]=i=>o.toggleModal("isAddShotsDisplayed"))},null,8,["active","onAddEpisode","onAddSequence","onAddShot"])])}const Pe=L(vt,[["render",se],["__scopeId","data-v-8abaee73"]]);export{Pe as default};
//# sourceMappingURL=NewProduction-N5yMQMyN.js.map
