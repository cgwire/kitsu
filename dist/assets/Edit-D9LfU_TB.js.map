{"version":3,"file":"Edit-D9LfU_TB.js","sources":["../../src/components/previews/PreviewsPerTaskType.vue","../../src/components/pages/Edit.vue"],"sourcesContent":["<template>\n  <div class=\"flexrow\">\n    <combobox-styled\n      ref=\"task-type-combobox\"\n      class=\"flexrow-item\"\n      :options=\"taskTypeOptions\"\n      v-model=\"taskTypeId\"\n      v-if=\"taskTypeOptions.length > 0\"\n    />\n\n    <combobox-styled\n      class=\"flexrow-item\"\n      :options=\"previewFileOptions\"\n      v-if=\"previewFileOptions.length\"\n      v-model=\"previewFileId\"\n    />\n    <span class=\"text flexrow-item\" v-else>Selected task has no previews.</span>\n\n    <div class=\"flexrow-item\" v-if=\"taskStatus\">\n      <validation-tag\n        class=\"flexrow-item\"\n        :task=\"{ task_status_id: taskStatus.id }\"\n        :is-static=\"true\"\n        :thin=\"false\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\n/*\n * Widget displaying entity's revisions of previews per task type.\n * It allows to select a given revision for a given task type for current entity.\n */\nimport firstBy from 'thenby'\nimport { mapGetters } from 'vuex'\n\nimport editStore from '@/store/modules/edits'\n\nimport ComboboxStyled from '@/components/widgets/ComboboxStyled.vue'\nimport ValidationTag from '@/components/widgets/ValidationTag.vue'\n\nexport default {\n  name: 'previews-per-task-type',\n\n  components: {\n    ComboboxStyled,\n    ValidationTag\n  },\n\n  emits: ['preview-changed'],\n\n  data() {\n    return {\n      taskTypeId: null,\n      previewFileId: this.entity.preview_file_id\n    }\n  },\n\n  props: {\n    index: {\n      default: 0,\n      type: Number\n    },\n    entity: {\n      default: () => {},\n      type: Object\n    }\n  },\n\n  mounted() {\n    this.setCurrentParameters()\n  },\n\n  computed: {\n    ...mapGetters([\n      'taskMap',\n      'taskTypeMap',\n      'taskStatusMap',\n      'isCurrentUserManager'\n    ]),\n\n    taskTypeOptions() {\n      const entity = editStore.cache.editMap.get(this.entity.id)\n      return entity.tasks\n        .map(taskId => this.taskMap.get(taskId))\n        .map(task => this.taskTypeMap.get(task.task_type_id))\n        .sort(firstBy('priority', 1).thenBy('name'))\n        .map(taskType => {\n          return {\n            label: taskType.name,\n            value: taskType.id\n          }\n        })\n    },\n\n    previewFileOptions() {\n      const previewFiles = this.entity.preview_files[this.taskTypeId] || []\n      return previewFiles.map(previewFile => ({\n        label: `v${previewFile.revision}`,\n        value: previewFile.id\n      }))\n    },\n\n    taskStatus() {\n      if (!editStore.cache.editMap) return ''\n\n      const entity = editStore.cache.editMap.get(this.entity.id)\n      if (!entity) return ''\n\n      const taskId = entity.validations.get(this.taskTypeId)\n      if (taskId) {\n        const task = this.taskMap.get(taskId)\n        if (!task) return ''\n        const taskStatus = this.taskStatusMap.get(task.task_status_id)\n        return taskStatus\n      } else {\n        return ''\n      }\n    }\n  },\n\n  methods: {\n    getTaskTypeIdForPreviewFile(taskTypeIds, previewFileId) {\n      return taskTypeIds.find(taskTypeId => {\n        const previewFiles = this.entity.preview_files[taskTypeId]\n        return previewFiles.some(previewFile => {\n          return previewFile.id === previewFileId\n        })\n      })\n    },\n\n    setCurrentParameters() {\n      // Find task type matching current preview.\n      const taskTypeIds = Object.keys(this.entity.preview_files)\n      if (taskTypeIds.length > 0) {\n        if (this.entity.preview_file_id) {\n          this.taskTypeId = this.getTaskTypeIdForPreviewFile(\n            taskTypeIds,\n            this.entity.preview_file_id\n          )\n        }\n        if (!this.taskTypeId) {\n          this.taskTypeId = taskTypeIds[0]\n        }\n      }\n    }\n  },\n\n  watch: {\n    taskTypeId() {\n      // Set current preview was last preview selected. If there is no preview\n      // matching this task type, it selects the first preview available for\n      // this task type.\n      const previewFiles = this.entity.preview_files[this.taskTypeId]\n      if (previewFiles && previewFiles.length > 0) {\n        const isPreviewFile = previewFiles.some(previewFile => {\n          return previewFile.id === this.entity.preview_file_id\n        })\n        if (isPreviewFile) {\n          this.previewFileId = this.entity.preview_file_id\n        } else {\n          this.previewFileId = previewFiles[0].id\n        }\n      } else {\n        this.previewFileId = null\n      }\n    },\n\n    previewFileId() {\n      let previewFile = null\n      const previewFiles = this.entity.preview_files[this.taskTypeId]\n      if (previewFiles && previewFiles.length > 0) {\n        previewFile = previewFiles.find(previewFile => {\n          return previewFile.id === this.previewFileId\n        })\n      }\n      this.$emit('preview-changed', this.entity, previewFile)\n    },\n\n    'entity.preview_file_id': function () {\n      if (this.previewFileId !== this.entity.preview_file_id) {\n        this.previewFileId = this.entity.preview_file_id\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.field {\n  margin-bottom: 0;\n}\n.text {\n  color: var(--text);\n}\n</style>\n","<template>\n  <div class=\"columns fixed-page edit xyz-in\" xyz=\"fade\">\n    <div class=\"column main-column\">\n      <div class=\"page-header flexrow flexrow-item\" ref=\"page-header-row\">\n        <div class=\"flexrow block mb0 main-block\">\n          <router-link\n            class=\"flexrow-item has-text-centered back-link\"\n            :to=\"editsPath\"\n          >\n            <corner-left-up-icon />\n          </router-link>\n          <span class=\"flexrow-item\">\n            <entity-thumbnail\n              class=\"entity-thumbnail\"\n              :entity=\"currentEntity\"\n              :empty-height=\"60\"\n              :empty-width=\"100\"\n              :height=\"60\"\n              :width=\"100\"\n              v-if=\"currentEntity\"\n            />\n          </span>\n          <div class=\"entity-title flexrow-item mr1\">\n            {{ title }}\n          </div>\n          <div\n            class=\"flexrow-item has-text-centered\"\n            :key=\"currentEntity.id\"\n            v-if=\"!isLoading && currentEntity\"\n          >\n            <previews-per-task-type\n              ref=\"previews-per-task-type\"\n              :entity=\"currentEntity\"\n              @preview-changed=\"onPreviewChanged\"\n            />\n          </div>\n        </div>\n        <div class=\"filler\"></div>\n        <div class=\"flexrow-item block mt0\">\n          <preview-room\n            :ref=\"previewRoomRef\"\n            :room=\"room\"\n            @open-room=\"openRoom\"\n            @join-room=\"joinRoom\"\n            @leave-room=\"leaveRoom\"\n            v-if=\"isValidRoomId(currentEdit) && currentPreview?.id\"\n          />\n        </div>\n        <router-link\n          class=\"flexrow-item has-text-centered back-link ml1\"\n          :to=\"previousEntityPath\"\n          v-if=\"previousEntityPath && entityList.length > 1\"\n        >\n          <chevron-left-icon />\n        </router-link>\n        <router-link\n          class=\"flexrow-item has-text-centered back-link\"\n          :to=\"nextEntityPath\"\n          v-if=\"nextEntityPath && entityList.length > 1\"\n        >\n          <chevron-right-icon />\n        </router-link>\n      </div>\n\n      <div ref=\"container\" class=\"edit player block\">\n        <div class=\"flexrow filler\" v-show=\"!isLoading\">\n          <div class=\"flexrow filler video-container\" ref=\"video-container\">\n            <raw-video-player\n              ref=\"raw-player\"\n              class=\"raw-player\"\n              :style=\"{\n                position: 'static',\n                opacity: overlayOpacity\n              }\"\n              :entities=\"entityList\"\n              :full-screen=\"fullScreen\"\n              :is-hd=\"isHd\"\n              :is-repeating=\"isRepeating\"\n              :current-preview-index=\"currentPreviewIndex\"\n              :muted=\"isMuted\"\n              @max-duration-update=\"onMaxDurationUpdate\"\n              @frame-update=\"onFrameUpdate\"\n              @metadata-loaded=\"onMetadataLoaded\"\n              @repeat=\"onVideoRepeated\"\n              @video-loaded=\"onVideoLoaded\"\n              v-show=\"isCurrentPreviewMovie && !isLoading\"\n            />\n\n            <object-viewer\n              ref=\"object-player\"\n              class=\"object-player\"\n              :preview-url=\"currentPreviewDlPath\"\n              :style=\"{\n                position: 'static',\n                opacity: overlayOpacity\n              }\"\n              :full-screen=\"fullScreen\"\n              v-if=\"isCurrentPreviewModel && !isLoading\"\n            />\n\n            <sound-viewer\n              ref=\"sound-player\"\n              class=\"sound-player\"\n              :preview-url=\"currentPreviewDlPath\"\n              :full-screen=\"fullScreen\"\n              @play-ended=\"pause\"\n              v-if=\"isCurrentPreviewSound && !isLoading\"\n            />\n\n            <p\n              :style=\"{ width: '100%' }\"\n              class=\"preview-standard-file has-text-centered\"\n              v-show=\"isCurrentPreviewFile && !isLoading\"\n            >\n              <a\n                class=\"button\"\n                ref=\"preview-file\"\n                :href=\"currentPreviewDlPath\"\n                v-if=\"extension && extension.length > 0\"\n              >\n                <download-icon class=\"icon\" />\n                <span class=\"text\">\n                  {{ $t('tasks.download_pdf_file', { extension: extension }) }}\n                </span>\n              </a>\n            </p>\n\n            <div\n              class=\"picture-preview-wrapper flexrow\"\n              ref=\"picture-player-wrapper\"\n              :style=\"{\n                position: 'static',\n                opacity: overlayOpacity,\n                left: 0,\n                right: 0\n              }\"\n              v-show=\"isCurrentPreviewPicture && !isLoading\"\n            >\n              <img\n                ref=\"picture-player\"\n                id=\"picture-player\"\n                class=\"picture-preview\"\n                :src=\"isCurrentPreviewPicture ? currentPreviewPath : null\"\n                v-show=\"isCurrentPreviewPicture\"\n              />\n            </div>\n\n            <div class=\"loading-wrapper\" v-if=\"isLoading\">\n              <spinner />\n            </div>\n\n            <div\n              class=\"canvas-wrapper\"\n              ref=\"canvas-wrapper\"\n              oncontextmenu=\"return false;\"\n              v-show=\"!isCurrentPreviewFile\"\n            >\n              <canvas\n                id=\"edit-annotation-canvas\"\n                ref=\"annotation-canvas\"\n                class=\"canvas\"\n              >\n              </canvas>\n            </div>\n          </div>\n          <task-info\n            ref=\"task-info\"\n            class=\"flexrow-item task-info-column\"\n            :task=\"task\"\n            :is-preview=\"false\"\n            :silent=\"isCommentsHidden\"\n            :current-frame=\"parseInt(currentFrame) - 1\"\n            :current-parent-preview=\"currentPreview\"\n            @time-code-clicked=\"onTimeCodeClicked\"\n            v-show=\"!isCommentsHidden\"\n          />\n        </div>\n\n        <video-progress\n          ref=\"video-progress\"\n          class=\"video-progress pull-bottom\"\n          :annotations=\"annotations\"\n          :frame-duration=\"frameDuration\"\n          :movie-dimensions=\"movieDimensions\"\n          :nb-frames=\"nbFrames\"\n          :handle-in=\"-1\"\n          :handle-out=\"-1\"\n          :preview-id=\"currentPreview ? currentPreview.id : ''\"\n          @start-scrub=\"onScrubStart\"\n          @end-scrub=\"onScrubEnd\"\n          @progress-changed=\"onProgressChanged\"\n          v-show=\"isCurrentPreviewMovie && currentPreview.id\"\n        />\n\n        <div\n          class=\"player-footer flexrow\"\n          ref=\"button-bar\"\n          v-if=\"currentEntity && currentEntity.id\"\n        >\n          <div\n            class=\"flexrow flexrow-item mr0\"\n            v-if=\"\n              isCurrentPreviewMovie ||\n              isCurrentPreviewPicture ||\n              isCurrentPreviewSound\n            \"\n          >\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"playClicked\"\n              :title=\"$t('playlists.actions.play')\"\n              icon=\"play\"\n              v-if=\"!isPlaying\"\n            />\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"pauseClicked\"\n              :title=\"$t('playlists.actions.pause')\"\n              icon=\"pause\"\n              v-else\n            />\n          </div>\n          <div class=\"separator\"></div>\n\n          <template v-if=\"isCurrentPreviewPicture\">\n            {{ framesSeenOfPicture }} /\n            <input\n              type=\"number\"\n              min=\"0\"\n              class=\"frame-per-image-input\"\n              :title=\"$t('playlists.actions.frames_per_picture')\"\n              v-model=\"framesPerImage[playingEntityIndex]\"\n            />\n          </template>\n          <div class=\"separator\" v-if=\"isCurrentPreviewPicture\"></div>\n\n          <div\n            class=\"flexrow flexrow-item\"\n            v-if=\"currentEntityPreviewLength > 1\"\n          >\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              icon=\"left\"\n              :title=\"$t('playlists.actions.files_previous')\"\n              :disabled=\"isPlaying\"\n              @click=\"onPreviousPreviewClicked\"\n            />\n            <span\n              class=\"ml05 mr05 nowrap\"\n              :title=\"$t('playlists.actions.files_position')\"\n            >\n              {{ currentPreviewIndex + 1 }} / {{ currentEntityPreviewLength }}\n            </span>\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              icon=\"right\"\n              :title=\"$t('playlists.actions.files_next')\"\n              :disabled=\"isPlaying\"\n              @click=\"onNextPreviewClicked\"\n            />\n            <a\n              class=\"button player-button flexrow-item\"\n              :href=\"currentPreviewPath\"\n              :title=\"$t('playlists.actions.see_original_file')\"\n              target=\"blank\"\n            >\n              <arrow-up-right-icon class=\"icon\" />\n            </a>\n          </div>\n\n          <div class=\"flexrow flexrow-item\" v-if=\"isCurrentPreviewMovie\">\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"onSpeedClicked\"\n              :title=\"$t('playlists.actions.speed')\"\n              text=\"x1.00\"\n              v-if=\"speed === 3\"\n            />\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"onSpeedClicked\"\n              :title=\"$t('playlists.actions.speed')\"\n              text=\"x0.50\"\n              v-else-if=\"speed === 2\"\n            />\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"onSpeedClicked\"\n              :title=\"$t('playlists.actions.speed')\"\n              text=\"x0.25\"\n              v-else\n            />\n\n            <button-simple\n              class=\"flexrow-item player-button\"\n              :title=\"$t('playlists.actions.unmute')\"\n              icon=\"soundoff\"\n              @click=\"onToggleSoundClicked\"\n              v-if=\"isMuted\"\n            />\n            <button-simple\n              class=\"flexrow-item player-button\"\n              :title=\"$t('playlists.actions.mute')\"\n              icon=\"soundon\"\n              @click=\"onToggleSoundClicked\"\n              v-else\n            />\n\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              :active=\"isRepeating\"\n              :title=\"$t('playlists.actions.looping')\"\n              icon=\"repeat\"\n              @click=\"onRepeatClicked\"\n            />\n\n            <span\n              class=\"flexrow-item time-indicator\"\n              :title=\"$t('playlists.actions.current_time')\"\n            >\n              {{ currentTime }}\n            </span>\n            <span class=\"flexrow-item time-indicator\"> / </span>\n            <span\n              class=\"flexrow-item time-indicator\"\n              :title=\"$t('playlists.actions.max_duration')\"\n            >\n              {{ maxDuration }}\n            </span>\n            <span\n              class=\"flexrow-item time-indicator mr1\"\n              :title=\"$t('playlists.actions.frame_number')\"\n            >\n              ({{ currentFrame }} / {{ (nbFrames + '').padStart(3, '0') }})\n            </span>\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"onPreviousFrameClicked\"\n              :title=\"$t('playlists.actions.previous_frame')\"\n              icon=\"left\"\n            />\n            <button-simple\n              class=\"button player-button flexrow-item\"\n              @click=\"onNextFrameClicked\"\n              :title=\"$t('playlists.actions.next_frame')\"\n              icon=\"right\"\n            />\n          </div>\n          <span class=\"filler\"></span>\n\n          <div\n            class=\"flexrow\"\n            v-if=\"\n              !isCurrentUserArtist &&\n              (isCurrentPreviewMovie || isCurrentPreviewPicture)\n            \"\n          >\n            <button-simple\n              class=\"player-button flexrow-item\"\n              icon=\"undo\"\n              :title=\"$t('playlists.actions.annotation_undo')\"\n              @click=\"undoLastAction\"\n            />\n\n            <button-simple\n              class=\"player-button flexrow-item\"\n              :title=\"$t('playlists.actions.annotation_redo')\"\n              icon=\"redo\"\n              @click=\"redoLastAction\"\n            />\n\n            <transition name=\"slide\">\n              <div class=\"annotation-tools\" v-show=\"isTyping\">\n                <color-picker\n                  :color=\"textColor\"\n                  @toggle-palette=\"onPickTextColor\"\n                  @change=\"onChangeTextColor\"\n                />\n              </div>\n            </transition>\n            <button-simple\n              :class=\"{\n                'player-button': true,\n                'flexrow-item': true,\n                active: isTyping\n              }\"\n              :title=\"$t('playlists.actions.annotation_text')\"\n              @click=\"onTypeClicked\"\n              icon=\"type\"\n            />\n\n            <transition name=\"slide\">\n              <div class=\"annotation-tools\" v-show=\"isDrawing\">\n                <pencil-picker\n                  :pencil=\"pencil\"\n                  :sizes=\"pencilPalette\"\n                  @toggle-palette=\"onPickPencilWidth\"\n                  @change=\"onChangePencilWidth\"\n                />\n\n                <color-picker\n                  :color=\"color\"\n                  @toggle-palette=\"onPickPencilColor\"\n                  @change=\"onChangePencilColor\"\n                />\n              </div>\n            </transition>\n            <button-simple\n              :class=\"{\n                'player-button': true,\n                'flexrow-item': true,\n                active: isDrawing\n              }\"\n              :title=\"$t('playlists.actions.annotation_draw')\"\n              @click=\"onAnnotateClicked\"\n              icon=\"pencil\"\n            />\n            <button-simple\n              class=\"player-button flexrow-item\"\n              icon=\"remove\"\n              :title=\"$t('playlists.actions.annotation_delete')\"\n              @click=\"onDeleteClicked\"\n            />\n          </div>\n          <div class=\"separator\"></div>\n          <button-simple\n            class=\"button player-button flexrow-item\"\n            :active=\"!isCommentsHidden\"\n            :title=\"$t('playlists.actions.comments')\"\n            @click=\"onCommentClicked\"\n            icon=\"comment\"\n          />\n          <button-simple\n            class=\"player-button flexrow-item\"\n            :title=\"\n              $t('playlists.actions.' + (isHd ? 'switch_ld' : 'switch_hd'))\n            \"\n            :text=\"isHd ? 'HD' : 'LD'\"\n            @click=\"isHd = !isHd\"\n            v-if=\"isCurrentPreviewMovie\"\n          />\n\n          <button-simple\n            class=\"button player-button flexrow-item\"\n            :title=\"$t('playlists.actions.fullscreen')\"\n            @click=\"onFullscreenClicked\"\n            icon=\"maximize\"\n            v-if=\"isFullScreenEnabled\"\n          />\n        </div>\n      </div>\n\n      <div class=\"edit-data block\">\n        <div class=\"flexrow\">\n          <combobox-styled\n            class=\"section-combo flexrow-item\"\n            :options=\"entityNavOptions\"\n            v-model=\"currentSection\"\n          />\n          <div class=\"filler\"></div>\n          <span\n            class=\"flexrow-item mt05\"\n            v-show=\"currentSection === 'schedule'\"\n          >\n            {{ $t('schedule.zoom_level') }}:\n          </span>\n          <combobox-number\n            class=\"zoom-level flexrow-item\"\n            :options=\"zoomOptions\"\n            is-simple\n            v-model=\"zoomLevel\"\n            v-show=\"currentSection === 'schedule'\"\n          />\n        </div>\n\n        <div\n          ref=\"info-row\"\n          class=\"infos flexrow pa0\"\n          v-if=\"currentSection === 'infos'\"\n        >\n          <div class=\"flexrow-item\">\n            <div class=\"flexrow\">\n              <div class=\"flexcolumn flexrow-item\">\n                <page-subtitle class=\"flerow-item\" :text=\"$t('edits.tasks')\" />\n                <entity-task-list\n                  class=\"task-list flexrow-item\"\n                  :entries=\"currentTasks\"\n                  :is-loading=\"!currentEdit\"\n                  :is-error=\"false\"\n                />\n              </div>\n\n              <div class=\"flexcolumn flexrow-item\">\n                <div class=\"flexrow\">\n                  <page-subtitle class=\"flerow-item\" :text=\"$t('main.info')\" />\n                  <div class=\"flexrow-item has-text-right\">\n                    <button-simple\n                      icon=\"edit\"\n                      :title=\"$t('edits.edit_title')\"\n                      @click=\"modals.edit = true\"\n                      v-if=\"isCurrentUserManager\"\n                    />\n                  </div>\n                </div>\n                <div class=\"table-body edit-metadata flexrow-item\">\n                  <table class=\"datatable no-header\" v-if=\"currentEdit\">\n                    <tbody class=\"datatable-body\">\n                      <tr class=\"datatable-row\">\n                        <td class=\"field-label\">\n                          {{ $t('edits.fields.description') }}\n                        </td>\n                        <description-cell :entry=\"currentEdit\" :full=\"true\" />\n                      </tr>\n                      <tr\n                        :key=\"descriptor.id\"\n                        class=\"datatable-row\"\n                        v-for=\"descriptor in editMetadataDescriptors\"\n                      >\n                        <td class=\"field-label\">{{ descriptor.name }}</td>\n                        <td>\n                          {{\n                            currentEdit.data\n                              ? currentEdit.data[descriptor.field_name]\n                              : ''\n                          }}\n                        </td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div\n          ref=\"schedule-row\"\n          class=\"infos schedule\"\n          v-if=\"currentSection === 'schedule' && scheduleItems.length > 0\"\n        >\n          <div\n            class=\"schedule mt1\"\n            v-if=\"scheduleItems[0].children.length > 0\"\n            v-show=\"currentSection === 'schedule'\"\n          >\n            <div class=\"wrapper\">\n              <schedule\n                ref=\"schedule-widget\"\n                :start-date=\"tasksStartDate\"\n                :end-date=\"tasksEndDate\"\n                :hierarchy=\"scheduleItems\"\n                :zoom-level=\"zoomLevel\"\n                :is-loading=\"false\"\n                :is-estimation-linked=\"true\"\n                :hide-root=\"true\"\n                :with-milestones=\"false\"\n              />\n            </div>\n          </div>\n        </div>\n\n        <entity-preview-files\n          :entity=\"currentEdit\"\n          v-if=\"currentSection === 'preview-files'\"\n        />\n\n        <entity-news\n          :entity=\"currentEdit\"\n          v-if=\"currentSection === 'activity'\"\n        />\n\n        <entity-time-logs\n          :entity=\"currentEdit\"\n          v-if=\"currentSection === 'time-logs'\"\n        />\n      </div>\n    </div>\n\n    <edit-edit-modal\n      ref=\"edit-edit-modal\"\n      :active=\"modals.edit\"\n      :is-loading=\"isLoading\"\n      :is-error=\"errors.edit\"\n      :edit-to-edit=\"currentEdit\"\n      @cancel=\"modals.edit = false\"\n      @confirm=\"confirmEditEdit\"\n    />\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nimport {\n  ArrowUpRightIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n  CornerLeftUpIcon,\n  DownloadIcon\n} from 'lucide-vue-next'\n\nimport editStore from '@/store/modules/edits'\n\nimport { annotationMixin } from '@/components/mixins/annotation'\nimport { domMixin } from '@/components/mixins/dom'\nimport { entityMixin } from '@/components/mixins/entity'\nimport { getEntitiesPath } from '@/lib/path'\nimport { formatListMixin } from '@/components/mixins/format'\nimport { previewRoomMixin } from '@/components/mixins/previewRoom'\nimport { playerMixin } from '@/components/mixins/player'\nimport { DEFAULT_NB_FRAMES_PICTURE } from '@/lib/playlist'\n\nimport ButtonSimple from '@/components/widgets/ButtonSimple.vue'\nimport ComboboxNumber from '@/components/widgets/ComboboxNumber.vue'\nimport DescriptionCell from '@/components/cells/DescriptionCell.vue'\nimport EditEditModal from '@/components/modals/EditEditModal.vue'\nimport EntityNews from '@/components/pages/entities/EntityNews.vue'\nimport EntityPreviewFiles from '@/components/pages/entities/EntityPreviewFiles.vue'\nimport EntityTaskList from '@/components/lists/EntityTaskList.vue'\nimport EntityTimeLogs from '@/components/pages/entities/EntityTimeLogs.vue'\nimport EntityThumbnail from '@/components/widgets/EntityThumbnail.vue'\nimport ColorPicker from '@/components/widgets/ColorPicker.vue'\nimport ComboboxStyled from '@/components/widgets/ComboboxStyled.vue'\nimport ObjectViewer from '@/components/previews/ObjectViewer.vue'\nimport PageSubtitle from '@/components/widgets/PageSubtitle.vue'\nimport PencilPicker from '@/components/widgets/PencilPicker.vue'\nimport PreviewRoom from '@/components/widgets/PreviewRoom.vue'\nimport PreviewsPerTaskType from '@/components/previews/PreviewsPerTaskType.vue'\nimport RawVideoPlayer from '@/components/pages/playlists/RawVideoPlayer.vue'\nimport Schedule from '@/components/widgets/Schedule.vue'\nimport Spinner from '@/components/widgets/Spinner.vue'\nimport SoundViewer from '@/components/previews/SoundViewer.vue'\nimport TaskInfo from '@/components/sides/TaskInfo.vue'\nimport VideoProgress from '@/components/previews/VideoProgress.vue'\n\nexport default {\n  name: 'edit',\n\n  mixins: [\n    annotationMixin,\n    domMixin,\n    entityMixin,\n    formatListMixin,\n    previewRoomMixin,\n    playerMixin\n  ],\n\n  components: {\n    ArrowUpRightIcon,\n    ButtonSimple,\n    ChevronLeftIcon,\n    ChevronRightIcon,\n    CornerLeftUpIcon,\n    ColorPicker,\n    ComboboxStyled,\n    ComboboxNumber,\n    DescriptionCell,\n    DownloadIcon,\n    EditEditModal,\n    EntityNews,\n    EntityPreviewFiles,\n    EntityTaskList,\n    EntityTimeLogs,\n    EntityThumbnail,\n    ObjectViewer,\n    PageSubtitle,\n    PencilPicker,\n    PreviewRoom,\n    PreviewsPerTaskType,\n    RawVideoPlayer,\n    SoundViewer,\n    Schedule,\n    Spinner,\n    TaskInfo,\n    VideoProgress\n  },\n\n  data() {\n    return {\n      type: 'edit',\n      currentEdit: null,\n      currentSection: 'infos',\n      isLoading: true,\n      isError: false,\n      movieDimensions: { width: 0, height: 0 },\n      previewRoomRef: 'edits-preview-room',\n      previewFileMap: new Map(),\n      room: {\n        id: null,\n        people: [],\n        newComer: true\n      },\n      tempMode: false,\n      errors: {\n        edit: false\n      },\n      entityNavOptions: [\n        { label: this.$t('main.label.info'), value: 'infos' },\n        { label: this.$t('main.label.schedule'), value: 'schedule' },\n        { label: this.$t('main.label.preview_files'), value: 'preview-files' },\n        { label: this.$t('main.activity'), value: 'activity' },\n        { label: this.$t('main.label.timelog'), value: 'time-logs' }\n      ],\n      modals: {\n        edit: false\n      }\n    }\n  },\n\n  mounted() {\n    this.init()\n  },\n\n  computed: {\n    ...mapGetters([\n      'currentEpisode',\n      'currentProduction',\n      'getTaskPreviews',\n      'getTaskTypePriority',\n      'isCurrentUserManager',\n      'isTVShow',\n      'route',\n      'editMetadataDescriptors',\n      'taskMap',\n      'taskTypeMap',\n      'user'\n    ]),\n\n    title() {\n      if (this.currentEdit) {\n        if (this.currentEdit.episode_name) {\n          return `${this.currentEdit.episode_name} / ${this.currentEdit.name}`\n        } else {\n          return `${this.currentEdit.name}`\n        }\n      } else {\n        return 'Loading...'\n      }\n    },\n\n    editsPath() {\n      return getEntitiesPath(\n        this.currentProduction.id,\n        'edits',\n        this.currentEpisode ? this.currentEpisode.id : this.currentEpisode\n      )\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'editEdit',\n      'loadEdits',\n      'loadTaskEntityPreviewFiles',\n      'updatePreviewAnnotation'\n    ]),\n\n    init() {\n      this.resetData()\n      this.$options.scrubbing = false\n      this.isHd = Boolean(this.organisation.hd_by_default)\n      if (this.picturePlayer) {\n        this.picturePlayer.addEventListener('load', async () => {\n          const wasPlaying = this.isPlaying\n          await this.resetPictureCanvas()\n          this.isPlaying = wasPlaying\n        })\n      }\n      this.$nextTick(() => {\n        this.configureEvents()\n        this.setupFabricCanvas()\n        this.setPlayerSpeed(1)\n        this.onFrameUpdate(1)\n      })\n    },\n\n    resetPreviewFileMap() {\n      this.previewFileMap.clear()\n      if (this.previewFiles) {\n        Object.values(this.previewFiles).forEach(previewFiles => {\n          previewFiles.forEach(previewFile => {\n            this.previewFileMap.set(previewFile.id, previewFile)\n          })\n        })\n      }\n    },\n\n    resetHeight() {\n      this.$nextTick(() => {\n        let height = window.innerHeight\n        height -= this.$refs.header ? this.$refs.header.offsetHeight : 0\n        if (this.$refs['button-bar']) {\n          height -= this.$refs['button-bar'].offsetHeight\n        }\n        if (this.$refs['video-progress']) {\n          height -= this.$refs['video-progress'].$el.offsetHeight\n        }\n        if (this.$refs['info-row']) {\n          height -= this.$refs['info-row'].offsetHeight\n        }\n        if (this.$refs['schedule-row']) {\n          height -= this.$refs['schedule-row'].offsetHeight\n        }\n        if (this.$refs['page-header-row']) {\n          height -= this.$refs['page-header-row'].offsetHeight\n        }\n        height = Math.min(window.innerHeight * 0.4, Math.max(480, height))\n        if (this.$refs['video-container']) {\n          this.$refs['video-container'].style.height = `${height}px`\n        }\n        if (!this.isCommentsHidden && this.$refs['task-info']) {\n          this.$refs['task-info'].$el.style.height = `${height + 66}px`\n        }\n        if (this.rawPlayer) this.rawPlayer.resetHeight(height)\n        this.$nextTick(() => {\n          this.resetCanvas()\n          this.updateProgressBar()\n        })\n      })\n    },\n\n    initPlayer() {\n      if (!this.currentEdit) return\n\n      this.currentPreviewIndex = 0\n      // There's only one entity in this player, which is current Edit entity,\n      // so playingEntityIndex is always 0\n      this.playingEntityIndex = 0\n      this.entityList = [\n        {\n          ...this.currentEdit,\n          preview_file_id: null,\n          preview_files: this.previewFiles\n        }\n      ]\n      this.framesPerImage[0] =\n        this.currentEdit.preview_nb_frames || DEFAULT_NB_FRAMES_PICTURE\n      this.pause()\n      if (this.rawPlayer) this.rawPlayer.setCurrentFrame(1)\n      this.currentTimeRaw = 0\n      this.updateProgressBar()\n      this.updateTaskPanel()\n      this.clearCanvas()\n      this.annotations = []\n      this.resetHeight()\n      this.resetCanvas().then(() => {\n        if (this.isCurrentPreview) {\n          this.annotations = this.currentEntity.preview_file_annotations\n          this.loadAnnotation(this.getAnnotation(0))\n        }\n      })\n    },\n\n    getCurrentEdit() {\n      return editStore.cache.editMap.get(this.route.params.edit_id) || null\n    },\n\n    confirmEditEdit(form) {\n      form.id = this.currentEdit.id\n      this.isLoading = true\n      this.errors.edit = false\n      this.editEdit(form)\n        .then(() => {\n          this.isLoading = false\n          this.modals.edit = false\n        })\n        .catch(err => {\n          console.error(err)\n          this.isLoading = false\n          this.errors.edit = true\n        })\n    },\n\n    setPreviewFile(previewFile) {\n      this.playingPreviewFileId = previewFile.id\n\n      this.currentEntity.preview_file_id = previewFile.id\n      this.currentEntity.preview_file_task_id = previewFile.task_id\n      this.currentEntity.preview_file_extension = previewFile.extension\n      this.currentEntity.preview_file_annotations =\n        previewFile.annotations || []\n      this.currentEntity.preview_file_previews = previewFile.previews\n\n      this.annotations = this.currentEntity.preview_file_annotations\n\n      if (this.rawPlayer) this.rawPlayer.reloadCurrentEntity()\n      this.clearCanvas()\n      this.updateTaskPanel()\n      this.updateProgressBar()\n    },\n\n    onPreviewChanged(entity, previewFile) {\n      this.pause()\n      if (!previewFile) {\n        // TODO: handle the situation when now preview file is selected\n        // (e.g. if selected task has none)\n      }\n      const isDifferentPreviewFile =\n        this.playingPreviewFileId !== previewFile.id\n      this.setPreviewFile(previewFile)\n      if (isDifferentPreviewFile) this.sendUpdatePlayingStatus()\n    },\n\n    onAnnotationChanged({ preview, additions, deletions, updates }) {\n      const taskId = preview.task_id\n      this.updatePreviewAnnotation({\n        taskId,\n        preview,\n        additions,\n        deletions,\n        updates\n      })\n    },\n\n    onVideoLoaded() {\n      this.movieDimensions = {\n        width: this.currentPreview.width,\n        height: this.currentPreview.height\n      }\n    },\n\n    scrollToEntity() {\n      // This method in unused here, required by PlaylistPlayer that shares\n      // playerMixin.\n    },\n\n    resetData() {\n      this.$nextTick(() => {\n        this.loadEdits().then(() => {\n          this.currentEdit = this.getCurrentEdit()\n          this.room.id = this.currentEdit ? this.currentEdit.id : null\n          if (!this.currentEdit) {\n            return\n          }\n          this.loadTaskEntityPreviewFiles(this.currentEdit.id).then(\n            previewFiles => {\n              this.previewFiles = previewFiles\n              this.resetPreviewFileMap()\n              this.initPlayer()\n              this.isLoading = false\n            }\n          )\n        })\n      })\n    },\n\n    onPreviewFilesUpdate() {\n      this.loadTaskEntityPreviewFiles(this.currentEdit.id).then(\n        previewFiles => {\n          this.previewFiles = previewFiles\n          this.currentEntity.preview_files = previewFiles\n          this.resetPreviewFileMap()\n          // FIXME: combo should continue displaying currently selected task preview\n          // unless it's no longer available (e.g. was deleted along with the comment)\n          if (\n            this.currentEntity &&\n            this.currentEntity.preview_file_id &&\n            !this.previewFileMap.has(this.currentEntity.preview_file_id)\n          ) {\n            // TODO: handle deletion of currently displayed preview file\n          }\n        }\n      )\n    }\n  },\n\n  watch: {\n    currentEdit() {\n      this.room.id = this.currentEdit ? this.currentEdit.id : null\n    },\n\n    // Needed when reloading the page with F5\n    currentProduction() {\n      if (!this.isTVShow) this.resetData()\n    },\n\n    currentEpisode() {\n      if (this.isTVShow && editStore.cache.editMap.size === 0) {\n        this.resetData()\n      }\n    },\n\n    playingPreviewFileId() {\n      // In case preview was switched by someone else in the room,\n      // make sure that comboboxes reflect this change too.\n      if (!this.currentEntity || !this.playingPreviewFileId) return\n\n      const previewsCombo = this.$refs['previews-per-task-type']\n      if (!previewsCombo) return\n\n      const previews = this.currentEntity.preview_files\n      for (const taskTypeId in previews) {\n        const previewFile = previews[taskTypeId].find(\n          p => p.id === this.playingPreviewFileId\n        )\n        if (previewFile) {\n          this.setPreviewFile(previewFile)\n          if (\n            previewsCombo.taskTypeId !== taskTypeId ||\n            previewsCombo.previewFileId !== this.playingPreviewFileId\n          ) {\n            previewsCombo.taskTypeId = taskTypeId\n            previewsCombo.previewFileId = this.playingPreviewFileId\n          }\n          break\n        }\n      }\n    }\n  },\n\n  socket: {\n    events: {\n      ...previewRoomMixin.socket.events,\n      ...playerMixin.socket.events,\n\n      'preview-file:add-file'(eventData) {\n        if (eventData.project_id !== this.task.project_id) return\n        const taskId = eventData.task_id\n\n        const previews = this.currentEntity.preview_files\n        for (const taskTypeId in previews) {\n          const previewFile = previews[taskTypeId].find(\n            p => p.task_id === taskId\n          )\n          if (previewFile) {\n            // Added preview affects one of the tasks, preview files must be refreshed\n            this.onPreviewFilesUpdate()\n            break\n          }\n        }\n      },\n\n      'comment:delete'(eventData) {\n        // Deleting a comment might remove a task preview, preview files must be refreshed\n        if (eventData.project_id !== this.task.project_id) return\n        this.onPreviewFilesUpdate()\n      }\n    }\n  },\n\n  head() {\n    return {\n      title: `${this.title} - Kitsu`\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.dark .page {\n  background: $dark-grey-light;\n  height: 100%;\n  padding-bottom: 1em;\n}\n\n.dark .wrapper {\n  background: $dark-grey-2;\n}\n\n.block {\n  margin: 0;\n}\n\n.entity-title {\n  font-weight: bold;\n}\n\n.entity-thumbnail {\n  margin-bottom: 0;\n}\n\n.main-block {\n  padding: 0.5em 1.5em;\n}\n\n.edit-data {\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  margin: 0 1em 0 1em;\n  overflow: hidden;\n  min-height: 300px;\n}\n\n.edit-metadata {\n  width: 100%;\n}\n\nh2.subtitle {\n  border-bottom: 0;\n  margin-top: 0;\n  margin-bottom: 0.5em;\n  font-size: 1.5em;\n}\n\n.page {\n  background: #f9f9f9;\n  padding: 0;\n}\n\n.page-header {\n  margin-top: calc(50px + 2em);\n  margin-left: 1em;\n  margin-right: 1em;\n}\n\n.infos {\n  margin-top: 1em;\n\n  .flexrow-item {\n    align-self: flex-start;\n    flex: 1;\n  }\n}\n\n.edit-thumbnail {\n  max-width: 100px;\n}\n\n.field-label {\n  font-weight: bold;\n  width: 140px;\n}\n\n.data-list {\n  max-width: 100%;\n}\n\n.page-header .thumbnail-picture {\n  margin: 0 1em 0 0;\n  max-width: 80px;\n}\n\n.back-link {\n  padding-top: 3px;\n}\n\n.task-list {\n  width: 100%;\n}\n\n.datatable-row {\n  user-select: text;\n}\n\n.schedule {\n  position: relative;\n  height: 300px;\n  padding: 10px;\n\n  .schedule-title {\n    margin-bottom: 5px;\n  }\n\n  .wrapper {\n    height: 230px;\n    border-radius: 10px;\n  }\n}\n\n.column.main-column {\n  background: var(--background-page);\n  padding-bottom: 1em;\n}\n\n@media screen and (max-width: 768px) {\n  .task-column {\n    margin-bottom: 1em;\n  }\n\n  .column:first-child {\n    margin-right: 0;\n  }\n\n  .entity-title {\n    font-size: 1.3em;\n    line-height: 1.5em;\n  }\n}\n\n/* Player styles */\n\n.full-height {\n  height: 100%;\n}\n\n.player {\n  margin: 1em;\n\n  .player-button {\n    background: $white-grey;\n    margin: 0;\n    border: 0;\n    border-radius: 0;\n\n    &.active {\n      color: $green;\n    }\n\n    &.topbar-button {\n      border-radius: 10px;\n      margin-right: 0.5em;\n    }\n  }\n}\n\n.dark .player {\n  background: $dark-grey;\n\n  .player-button {\n    background: $dark-grey-light;\n    color: $white-grey;\n\n    &:hover {\n      background: $dark-grey-lighter;\n    }\n\n    &.active {\n      color: $green;\n    }\n\n    &.topbar-button {\n      border: 1px solid $dark-grey-strong;\n    }\n  }\n}\n\n.player-footer {\n  background: $white-grey;\n}\n\n.dark .player-footer {\n  background: $dark-grey-light;\n  color: $white-grey;\n}\n\n.loading-background {\n  width: 100%;\n  height: 100%;\n  background: black;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n}\n\n.spinner {\n  margin: auto;\n}\n\n.task-info-column {\n  min-width: 450px;\n  max-width: 450px;\n  overflow-y: auto;\n}\n\n.smaller {\n  height: 16px;\n}\n\n.right {\n  margin-left: auto;\n}\n\n.video-player {\n  display: flex;\n  flex-direction: column;\n  align-content: flex-end;\n  height: 100%;\n}\n\n.video-wrapper {\n  flex: 1;\n  display: flex;\n  background: black;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  margin: auto;\n  width: 100%;\n}\n\n.annotation-movie {\n  margin: auto;\n  width: 100%;\n}\n\n.dark .time-indicator {\n  color: $light-grey;\n  padding-left: 0.8em;\n  margin-right: 0;\n}\n\n.video-container {\n  position: relative;\n  margin: auto;\n  min-height: 480px;\n}\n\n.canvas-wrapper {\n  margin: auto;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.buttons {\n  height: 32px;\n}\n\nprogress::-moz-progress-bar {\n  background-color: #43b581;\n}\n\nprogress::-webkit-progress-value {\n  background-color: #43b581;\n}\n\nprogress {\n  width: 100%;\n  border-radius: 0;\n  margin: 0;\n  padding: 0;\n  border: 0;\n  background: $grey;\n  height: 8px;\n  display: block;\n}\n\n.progress span#progress-bar {\n  width: 100%;\n  border-radius: 0;\n  margin: 0;\n  padding: 0;\n  background-color: #43b581;\n}\n\n.mr1 {\n  margin-right: 1em;\n}\n\n.mr0 {\n  margin-right: 0;\n}\n\n.video-progress {\n  transition: opacity 0.5s ease;\n}\n\n.spinner {\n  margin-top: 80px;\n  margin-left: 1em;\n}\n\n.annotation-tools {\n  display: flex;\n  align-items: stretch;\n  height: 100%;\n}\n\n.slide-enter-active {\n  transition: all 0.3s ease;\n}\n.slide-leave-active {\n  transition: all 0.3s ease;\n}\n.slide-enter,\n.slide-leave-to {\n  transform: translateX(100%);\n}\n\n.for-client {\n  background: $dark-purple-strong;\n  border: 2px solid $dark-purple-strong;\n  color: $white;\n  padding: 0.3em;\n  margin-left: 1em;\n  margin-right: 0;\n  border-radius: 5px;\n}\n\n#edit-annotation-canvas {\n  margin: auto;\n}\n\n.picture-preview-wrapper {\n  display: flex;\n  height: inherit;\n  justify-content: center;\n  align-items: center;\n  flex: 1;\n}\n\n.picture-preview {\n  max-height: 100%;\n  max-width: 100%;\n  color: var(--text);\n}\n\n.raw-player {\n  margin: auto;\n}\n\n.disabled {\n  color: $grey-strong;\n}\n\n.loading-wrapper {\n  width: 100%;\n}\n\n.disabled {\n  color: $grey;\n}\n\n.dark .frame-per-image-input {\n  padding: 2px;\n  margin-left: 3px;\n  background-color: $dark-grey-2;\n  border: 1px solid $dark-grey-stronger;\n  color: white;\n  width: 3rem;\n}\n</style>\n"],"names":["_sfc_main","ComboboxStyled","ValidationTag","mapGetters","editStore","taskId","task","firstBy","taskType","previewFile","entity","taskTypeIds","previewFileId","taskTypeId","previewFiles","_hoisted_1","_openBlock","_createElementBlock","$options","_createBlock","_component_combobox_styled","$data","_cache","$event","_createCommentVNode","_hoisted_2","_hoisted_3","_createVNode","_component_validation_tag","annotationMixin","domMixin","entityMixin","formatListMixin","previewRoomMixin","playerMixin","ArrowUpRightIcon","ButtonSimple","ChevronLeftIcon","ChevronRightIcon","CornerLeftUpIcon","ColorPicker","ComboboxNumber","DescriptionCell","DownloadIcon","EditEditModal","EntityNews","EntityPreviewFiles","EntityTaskList","EntityTimeLogs","EntityThumbnail","ObjectViewer","PageSubtitle","PencilPicker","PreviewRoom","PreviewsPerTaskType","RawVideoPlayer","SoundViewer","Schedule","Spinner","TaskInfo","VideoProgress","getEntitiesPath","mapActions","wasPlaying","height","DEFAULT_NB_FRAMES_PICTURE","form","err","isDifferentPreviewFile","preview","additions","deletions","updates","previewsCombo","previews","p","eventData","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_9","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_20","_hoisted_23","_hoisted_24","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_49","_createElementVNode","_component_router_link","_withCtx","_component_corner_left_up_icon","_ctx","_component_entity_thumbnail","_toDisplayString","_component_previews_per_task_type","_component_preview_room","_component_chevron_left_icon","_component_chevron_right_icon","_hoisted_8","_withDirectives","_hoisted_10","_component_raw_video_player","_normalizeStyle","_vShow","_component_object_viewer","_component_sound_viewer","_hoisted_11","_component_download_icon","_hoisted_15","_component_spinner","_hoisted_16","_hoisted_17","_component_task_info","_component_video_progress","_hoisted_18","_hoisted_19","_component_button_simple","_Fragment","_createTextVNode","_vModelText","_hoisted_21","_hoisted_22","_component_arrow_up_right_icon","_hoisted_25","_hoisted_29","_Transition","_component_color_picker","_normalizeClass","_component_pencil_picker","_component_combobox_number","_hoisted_34","_component_page_subtitle","_component_entity_task_list","_hoisted_42","_component_description_cell","_renderList","descriptor","_hoisted_47","_hoisted_48","_component_schedule","_component_entity_preview_files","_component_entity_news","_component_entity_time_logs","_component_edit_edit_modal"],"mappings":"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"}