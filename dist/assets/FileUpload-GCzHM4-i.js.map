{"version":3,"file":"FileUpload-GCzHM4-i.js","sources":["../../src/components/widgets/FileUpload.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"wrapper\"\n    @drop=\"onDrop\"\n    @dragover=\"onDragover\"\n    @dragleave=\"onDragleave\"\n  >\n    <form enctype=\"multipart/form-data\" novalidate>\n      <div class=\"dropbox\">\n        <label\n          :class=\"{\n            button: true,\n            'is-primary': isPrimary\n          }\"\n        >\n          {{ label }}\n          <input\n            ref=\"uploadInput\"\n            class=\"visuallyhidden\"\n            type=\"file\"\n            :accept=\"accept\"\n            :name=\"uploadFieldName\"\n            :disabled=\"isSaving || disabled\"\n            :multiple=\"multiple\"\n            @change=\"filesChange($event.target.name, $event.target.files)\"\n          />\n        </label>\n        <span\n          class=\"file-upload-status\"\n          v-if=\"uploadedFiles.length > 1 && !hideFileNames\"\n        >\n          {{ uploadedFiles.length }} {{ $tc('main.files_selected') }}\n        </span>\n        <span\n          class=\"file-upload-status\"\n          v-if=\"uploadedFiles.length === 1 && !hideFileNames\"\n        >\n          {{ uploadedFiles[0] }}\n        </span>\n      </div>\n    </form>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'file-upload',\n\n  props: {\n    accept: {\n      default: '.csv',\n      type: String\n    },\n    isPrimary: {\n      default: true,\n      type: Boolean\n    },\n    label: {\n      type: String,\n      required: true\n    },\n    multiple: {\n      default: false,\n      type: Boolean\n    },\n    uploadFieldName: {\n      default: 'file',\n      type: String\n    },\n    disabled: {\n      type: Boolean,\n      default: false\n    },\n    hideFileNames: {\n      type: Boolean,\n      default: false\n    }\n  },\n\n  emits: ['fileselected'],\n\n  data() {\n    return {\n      isInitial: true,\n      isSaving: false,\n      uploadedFiles: []\n    }\n  },\n\n  mounted() {\n    this.reset()\n    const events = [\n      'drag',\n      'dragstart',\n      'dragend',\n      'dragover',\n      'dragenter',\n      'dragleave',\n      'drop'\n    ]\n    events.forEach(evt => {\n      this.$refs.wrapper.addEventListener(evt, e => {\n        e.preventDefault()\n        e.stopPropagation()\n      })\n    })\n  },\n\n  methods: {\n    filesChange(name, files) {\n      this.uploadedFiles = []\n      const forms = []\n      for (let i = 0, numFiles = files.length; i < numFiles; i++) {\n        const file = files[i]\n        const formData = new FormData()\n        formData.append(this.uploadFieldName, file, file.name)\n        forms.push(formData)\n        if (this.multiple) {\n          this.uploadedFiles.push(file.name)\n        } else {\n          this.uploadedFiles = [file.name]\n        }\n      }\n      if (this.multiple) {\n        this.$emit('fileselected', forms)\n      } else {\n        this.$emit('fileselected', forms[0])\n      }\n    },\n\n    reset() {\n      this.isSaving = false\n      this.isInitial = true\n      this.uploadedFiles = []\n      if (this.$refs.uploadInput) {\n        this.$refs.uploadInput.value = ''\n      }\n    },\n\n    onDragover() {\n      this.isDragging = true\n    },\n\n    onDragleave() {\n      this.isDragging = false\n    },\n\n    onDrop(event) {\n      if (event.dataTransfer.files) {\n        this.isDragging = false\n        this.isSaving = false\n        this.filesChange('file', event.dataTransfer.files)\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.dropbox {\n  display: flex;\n  align-items: center;\n}\n\n.file-upload-status {\n  margin-left: 0.5rem;\n  font-style: italic;\n}\n</style>\n"],"names":["_sfc_main","evt","name","files","forms","i","numFiles","file","formData","event","_hoisted_2","_hoisted_3","_createElementBlock","$options","args","_createElementVNode","_hoisted_1","_normalizeClass","$props","_createTextVNode","_toDisplayString","$data","_cache","$event","_hoisted_4","_ctx","_createCommentVNode","_hoisted_5"],"mappings":"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"}