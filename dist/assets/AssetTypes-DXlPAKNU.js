import{_ as g,L as C,z as E,b as v,r as d,o as r,c as n,d as l,t as p,F as k,e as b,H as A,f as m,h as u,g as w,a as D}from"./index-DF-DoQlt.js";import{c as x}from"./csv-IlynXFQz.js";import{s as $}from"./string-B0Tq569e.js";import{R as L}from"./RowActionsCell-DR7b8Q1u.js";import{T as N}from"./TableInfo-D6xnVb4C.js";import{T as B}from"./TaskTypeName-C0px4urt.js";import{D as M}from"./DeleteModal-DwXK5r5w.js";import{E as H}from"./EditAssetTypeModal-B4tNAPbN.js";import{L as I}from"./ListPageHeader-G9LHDILe.js";import{R}from"./RouteTabs-9ZMuefrE.js";import"./trash-DWKk5Pv9.js";import"./refresh-cw-CYYYI9XK.js";import"./Combobox-A6pnhVs3.js";import"./ComboboxBoolean-DT116Lfu.js";import"./ModalFooter-Chk0SGv-.js";import"./TextareaField-BVvnEY8u.js";import"./TextField-BKWlN2Ov.js";import"./PageTitle-CtScP8aV.js";const V={name:"asset-type-list",components:{HelpCircleIcon:C,RowActionsCell:L,TableInfo:N,TaskTypeName:B},props:{entries:{type:Array,default:()=>[]},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},emits:["delete-clicked","edit-clicked"],computed:{...v(["taskTypeMap"])},methods:{sortTaskTypes(e){const s=e?.map(i=>this.taskTypeMap.get(i)).filter(Boolean)||[];return E(s)}}},q={class:"data-list"},F={class:"datatable-wrapper"},j={class:"datatable"},z={class:"datatable-head"},G={scope:"col",class:"name"},K={scope:"col",class:"short-name"},P={scope:"col",class:"task-types"},Q={key:0,class:"datatable-body"},S={class:"name"},J=["title"],O={class:"short-name"},U={key:0,class:"task-types"},W={key:1,class:"task-types"},X={class:"has-text-centered nb-asset-types"};function Y(e,s,i,c,t,a){const h=d("help-circle-icon"),y=d("task-type-name"),f=d("row-actions-cell"),T=d("table-info");return r(),n("div",q,[l("div",F,[l("table",j,[l("thead",z,[l("tr",null,[l("th",G,p(e.$t("asset_types.fields.name")),1),l("th",K,p(e.$t("asset_types.fields.short_name")),1),l("th",P,p(e.$t("asset_types.fields.task_types")),1),s[0]||(s[0]=l("th",{scope:"col",class:"actions"},null,-1))])]),i.entries.length?(r(),n("tbody",Q,[(r(!0),n(k,null,b(i.entries,o=>(r(),n("tr",{class:"datatable-row",key:o.id},[l("td",S,[A(p(o.name)+" ",1),o.description?(r(),n("span",{key:0,title:o.description},[m(h,{class:"icon is-small"})],8,J)):u("",!0)]),l("td",O,p(o.short_name),1),o.task_types?.length?(r(),n("td",U,[(r(!0),n(k,null,b(a.sortTaskTypes(o.task_types),_=>(r(),n("span",{key:_.id,class:"task-type-name flexrow-item"},[_.id?(r(),w(y,{key:0,"task-type":_},null,8,["task-type"])):u("",!0)]))),128))])):(r(),n("td",W,p(e.$t("asset_types.include_all")),1)),m(f,{onEditClicked:_=>e.$emit("edit-clicked",o),onDeleteClicked:_=>e.$emit("delete-clicked",o)},null,8,["onEditClicked","onDeleteClicked"])]))),128))])):u("",!0)])]),m(T,{"is-loading":i.isLoading,"is-error":i.isError},null,8,["is-loading","is-error"]),l("p",X,p(i.entries.length)+" "+p(e.$tc("asset_types.number",i.entries.length)),1)])}const Z=g(V,[["render",Y],["__scopeId","data-v-a281132f"]]),ee={name:"asset-types",components:{AssetTypeList:Z,DeleteModal:M,EditAssetTypeModal:H,ListPageHeader:I,RouteTabs:R},data(){return{activeTab:"active",assetTypeToDelete:null,assetTypeToEdit:{},choices:[],errors:{del:!1,edit:!1,list:!1},modals:{del:!1,edit:!1},loading:{del:!1,edit:!1,list:!1},tabs:[{name:"active",label:this.$t("main.active")},{name:"archived",label:this.$t("main.archived")}]}},mounted(){this.activeTab=this.$route.query.tab||"active"},computed:{...v(["assetTypes","archivedAssetTypes","getAssetType","taskTypeMap"]),isActiveTab(){return this.activeTab==="active"},assetTypesList(){return this.isActiveTab?this.assetTypes:this.archivedAssetTypes},deleteText(){const e=this.assetTypeToDelete;return e?this.$t("asset_types.delete_text",{name:e.name}):""}},methods:{...D(["deleteAssetType","editAssetType","newAssetType"]),confirmEditAssetType(e){let s="newAssetType";this.assetTypeToEdit&&this.assetTypeToEdit.id&&(s="editAssetType",e.id=this.assetTypeToEdit.id),this.loading.edit=!0,this.errors.edit=!1,this[s](e).then(()=>{this.loading.edit=!1,this.modals.edit=!1}).catch(i=>{console.error(i),this.loading.edit=!1,this.errors.edit=!0})},confirmDeleteAssetType(){this.loading.del=!0,this.errors.del=!1,this.deleteAssetType(this.assetTypeToDelete).then(()=>{this.loading.del=!1,this.modals.del=!1}).catch(e=>{console.error(e),this.errors.del=!0,this.loading.del=!1})},onExportClicked(){const e=$.slugify(this.$t("asset_types.title")),i=[[this.$t("main.type"),this.$t("asset_types.fields.name"),this.$t("asset_types.fields.short_name"),this.$t("asset_types.fields.description"),this.$t("asset_types.fields.task_types")]].concat(this.assetTypes.map(c=>[c.type,c.name,c.short_name,c.description,c.task_types.length?c.task_types.map(t=>this.taskTypeMap.get(t)?.name).join(", "):this.$t("asset_types.include_all")]));x.buildCsvFile(e,i)},onNewClicked(){this.assetTypeToEdit={},this.errors.edit=!1,this.modals.edit=!0},onEditClicked(e){this.assetTypeToEdit=e,this.errors.edit=!1,this.modals.edit=!0},onDeleteClicked(e){this.assetTypeToDelete=e,this.errors.del=!1,this.modals.del=!0}},watch:{"$route.query.tab"(){this.activeTab=this.$route.query.tab||"active"}},head(){return{title:`${this.$t("asset_types.title")} - Kitsu`}}},te={class:"asset-types page fixed-page"};function se(e,s,i,c,t,a){const h=d("list-page-header"),y=d("route-tabs"),f=d("asset-type-list"),T=d("edit-asset-type-modal"),o=d("delete-modal");return r(),n("div",te,[m(h,{title:e.$t("asset_types.library_title"),"new-entry-label":e.$t("asset_types.new_asset_type"),"is-exportable":a.isActiveTab,onExportClicked:a.onExportClicked,onNewClicked:a.onNewClicked},null,8,["title","new-entry-label","is-exportable","onExportClicked","onNewClicked"]),m(y,{class:"mt2","active-tab":t.activeTab,tabs:t.tabs},null,8,["active-tab","tabs"]),m(f,{class:"asset-type-list",entries:a.assetTypesList,"is-loading":t.loading.list,"is-error":t.errors.list,onEditClicked:a.onEditClicked,onDeleteClicked:a.onDeleteClicked},null,8,["entries","is-loading","is-error","onEditClicked","onDeleteClicked"]),m(T,{active:t.modals.edit,"is-loading":t.loading.edit,"is-error":t.errors.edit,"asset-type-to-edit":t.assetTypeToEdit,onCancel:s[0]||(s[0]=_=>t.modals.edit=!1),onConfirm:a.confirmEditAssetType},null,8,["active","is-loading","is-error","asset-type-to-edit","onConfirm"]),m(o,{active:t.modals.del,"is-loading":t.loading.del,"is-error":t.errors.del,text:a.deleteText,"error-text":e.$t("asset_types.delete_error"),onCancel:s[1]||(s[1]=_=>t.modals.del=!1),onConfirm:a.confirmDeleteAssetType},null,8,["active","is-loading","is-error","text","error-text","onConfirm"])])}const ge=g(ee,[["render",se],["__scopeId","data-v-721ce47c"]]);export{ge as default};
//# sourceMappingURL=AssetTypes-DXlPAKNU.js.map
