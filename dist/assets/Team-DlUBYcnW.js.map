{"version":3,"file":"Team-DlUBYcnW.js","sources":["../../src/components/lists/ProductionTeamList.vue","../../src/components/pages/Team.vue"],"sourcesContent":["<template>\n  <div class=\"data-list\">\n    <div class=\"datatable-wrapper\">\n      <table class=\"datatable\">\n        <thead class=\"datatable-head\">\n          <tr>\n            <th scope=\"col\" class=\"name datatable-row-header\">\n              {{ $t('people.list.name') }}\n            </th>\n            <th scope=\"col\" class=\"email\" v-if=\"isCurrentUserManager\">\n              {{ $t('people.list.email') }}\n            </th>\n            <th scope=\"col\" class=\"contract\" v-if=\"isCurrentUserManager\">\n              {{ $t('people.list.contract') }}\n            </th>\n            <th scope=\"col\" class=\"role\">\n              {{ $t('people.list.role') }}\n            </th>\n            <th scope=\"col\">\n              {{ $t('people.list.departments') }}\n            </th>\n            <th scope=\"col\" class=\"actions\" v-if=\"isCurrentUserManager\"></th>\n          </tr>\n        </thead>\n        <tbody class=\"datatable-body\" v-if=\"!isEmpty\">\n          <tr class=\"datatable-row\" :key=\"person.id\" v-for=\"person in entries\">\n            <people-name-cell\n              class=\"name datatable-row-header\"\n              :person=\"person\"\n            />\n            <td class=\"email\" v-if=\"isCurrentUserManager\">\n              {{ person.email }}\n            </td>\n            <td class=\"contract\" v-if=\"isCurrentUserManager\">\n              {{ $t(`people.contract.${person.contract_type}`) }}\n            </td>\n            <td class=\"role\">\n              {{ $t(`people.role.${person.role}`) }}\n            </td>\n            <department-names-cell :departments=\"person.departments\" />\n            <td class=\"actions has-text-right\" v-if=\"isCurrentUserManager\">\n              <button class=\"button\" @click=\"removePerson(person)\">\n                {{ $t('main.remove') }}\n              </button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n\n    <p class=\"has-text-centered mt2\" v-if=\"isEmpty\">\n      {{ $t('people.empty_team') }}\n    </p>\n\n    <p class=\"has-text-centered footer-info\" v-else>\n      {{ entries.length }} {{ $tc('people.persons', entries.length) }}\n    </p>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\n\nimport DepartmentNamesCell from '@/components/cells/DepartmentNamesCell.vue'\nimport PeopleNameCell from '@/components/cells/PeopleNameCell.vue'\n\nexport default {\n  name: 'production-team-list',\n\n  components: {\n    DepartmentNamesCell,\n    PeopleNameCell\n  },\n\n  props: {\n    entries: {\n      type: Array,\n      default: () => []\n    }\n  },\n\n  computed: {\n    ...mapGetters(['isCurrentUserManager']),\n\n    isEmpty() {\n      return !this.entries?.length\n    }\n  },\n\n  methods: {\n    ...mapActions(['removePersonFromTeam']),\n\n    removePerson(person) {\n      this.removePersonFromTeam(person)\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.datatable-body tr:first-child th,\n.datatable-body tr:first-child td {\n  border-top: 0;\n}\n\n.name {\n  width: 230px;\n  min-width: 230px;\n}\n\n.email {\n  width: 300px;\n  min-width: 300px;\n}\n\n.phone {\n  width: 200px;\n  min-width: 200px;\n}\n\n.role {\n  width: 160px;\n  min-width: 160px;\n}\n\n.contract {\n  width: 125px;\n  min-width: 125px;\n}\n\n.actions {\n  min-width: 100px;\n}\n\n.data-list {\n  margin-top: 2em;\n}\n\n.footer-info {\n  color: var(--text);\n}\n</style>\n","<template>\n  <page-layout>\n    <template #main>\n      <div class=\"people flexcolumn\">\n        <div class=\"flexrow mt2 add-people\" v-if=\"isCurrentUserManager\">\n          <people-field\n            ref=\"people-field\"\n            class=\"flexrow-item add-people-field\"\n            :people=\"unlistedPeople\"\n            :placeholder=\"$t('people.add_member_to_team')\"\n            v-model=\"person\"\n          />\n          <button\n            class=\"button flexrow-item\"\n            @click=\"addPerson\"\n            :disabled=\"!person\"\n          >\n            {{ $t('main.add') }}\n          </button>\n        </div>\n        <production-team-list :entries=\"teamPersons\" @remove=\"removePerson\" />\n      </div>\n    </template>\n    <template #side v-if=\"isCurrentUserManager\">\n      <div class=\"importers flexcolumn\">\n        <div\n          class=\"project-import flexcolumn\"\n          v-if=\"availableProductions.length > 0\"\n        >\n          <combobox-production\n            class=\"flexrow-item\"\n            :label=\"$t('people.import_from_production')\"\n            :production-list=\"availableProductions\"\n            :with-margin=\"false\"\n            v-model=\"importProductionId\"\n          />\n          <button-simple\n            class=\"flexrow-item mt05\"\n            :disabled=\"!importProductionId\"\n            :text=\"$t('main.import')\"\n            @click=\"importTeamFromProduction\"\n          />\n        </div>\n        <div\n          :class=\"{\n            'department-import': true,\n            flexcolumn: true,\n            mt2: availableProductions.length > 0\n          }\"\n        >\n          <combobox-department\n            class=\"flexrow-item\"\n            :label=\"$t('people.import_from_department')\"\n            :with-empty-choice=\"false\"\n            v-model=\"importDepartmentId\"\n          />\n          <button-simple\n            class=\"flexrow-item mt05\"\n            :disabled=\"!importDepartmentId\"\n            :text=\"$t('main.import')\"\n            @click=\"importTeamFromDepartment\"\n          />\n        </div>\n        <p class=\"label mt2\">\n          {{ $t('people.import_from_unlisted') }}\n        </p>\n        <div class=\"import-list\">\n          <div\n            :key=\"`unlisted-person-${person.id}`\"\n            class=\"flexrow person-to-add mb05\"\n            @click=\"addPersonToTeam(person)\"\n            v-for=\"person in unlistedPeople\"\n          >\n            <people-avatar\n              class=\"flexrow-item\"\n              :font-size=\"14\"\n              :key=\"person.id\"\n              :person=\"person\"\n              :size=\"30\"\n              :is-link=\"false\"\n            />\n            <people-name class=\"flexrow-item\" :person=\"person\" />\n          </div>\n        </div>\n      </div>\n    </template>\n  </page-layout>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\n\nimport { sortPeople } from '@/lib/sorting'\n\nimport ButtonSimple from '@/components/widgets/ButtonSimple.vue'\nimport ComboboxProduction from '@/components/widgets/ComboboxProduction.vue'\nimport ComboboxDepartment from '@/components/widgets/ComboboxDepartment.vue'\nimport PageLayout from '@/components/layouts/PageLayout.vue'\nimport PeopleAvatar from '@/components/widgets/PeopleAvatar.vue'\nimport PeopleField from '@/components/widgets/PeopleField.vue'\nimport PeopleName from '@/components/widgets/PeopleName.vue'\nimport ProductionTeamList from '@/components/lists/ProductionTeamList.vue'\n\nexport default {\n  name: 'team',\n\n  components: {\n    ButtonSimple,\n    ComboboxDepartment,\n    ComboboxProduction,\n    PageLayout,\n    PeopleAvatar,\n    PeopleField,\n    PeopleName,\n    ProductionTeamList\n  },\n\n  data() {\n    return {\n      importDepartmentId: null,\n      importProductionId: null,\n      person: null\n    }\n  },\n\n  mounted() {\n    if (this.availableProductions.length > 0) {\n      this.importProductionId = this.availableProductions[0]?.id\n      this.importDepartmentId = this.departments.sort((a, b) =>\n        a.name.localeCompare(b.name, undefined, {\n          numeric: true\n        })\n      )[0]?.id\n    }\n  },\n\n  computed: {\n    ...mapGetters([\n      'activePeople',\n      'currentProduction',\n      'departments',\n      'isCurrentUserManager',\n      'openProductions',\n      'personMap',\n      'productionMap'\n    ]),\n\n    availableProductions() {\n      return this.openProductions.filter(\n        production => production.id !== this.currentProduction.id\n      )\n    },\n\n    teamPersons() {\n      return sortPeople(\n        this.currentProduction.team.map(personId =>\n          this.personMap.get(personId)\n        )\n      )\n    },\n\n    unlistedPeople() {\n      return this.activePeople.filter(\n        person =>\n          !this.currentProduction.team.includes(person.id) && person.active\n      )\n    }\n  },\n\n  methods: {\n    ...mapActions(['addPersonToTeam']),\n\n    addPerson() {\n      if (this.person) {\n        this.addPersonToTeam(this.person)\n        this.$refs['people-field'].focus()\n      }\n    },\n\n    removePerson(person) {\n      this.removePersonFromTeam(person)\n    },\n\n    importTeamFromProduction() {\n      const production = this.productionMap.get(this.importProductionId)\n      production.team.forEach(personId => {\n        this.addPersonToTeam(this.personMap.get(personId))\n      })\n    },\n\n    importTeamFromDepartment() {\n      const departmentId = this.importDepartmentId\n      this.activePeople\n        .filter(person => person.departments.includes(departmentId))\n        .forEach(person => {\n          this.addPersonToTeam(person)\n        })\n    }\n  },\n\n  head() {\n    return {\n      title: `${this.currentProduction.name} | ${this.$t(\n        'people.team'\n      )} - Kitsu`\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.people {\n  max-height: 100%;\n}\n\n.label {\n  color: var(--text-alt);\n  font-size: 0.8em;\n  letter-spacing: 1px;\n  text-transform: uppercase;\n  margin-bottom: 0;\n}\n\n.importers {\n  border-left: 1px solid var(--border);\n  height: 100%;\n  max-height: 100%;\n  padding: 1em;\n}\n\n.people {\n  padding: 1em;\n  padding-top: 60px;\n}\n\n.import-list {\n  border: 1px solid var(--border);\n  border-radius: 5px;\n  margin-top: 0.5em;\n  padding: 0.5em;\n  flex: 1;\n  overflow-y: auto;\n}\n\n.person-to-add {\n  cursor: pointer;\n}\n</style>\n"],"names":["_sfc_main","DepartmentNamesCell","PeopleNameCell","mapGetters","mapActions","person","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_9","_hoisted_14","_hoisted_16","_openBlock","_createElementBlock","_createElementVNode","_hoisted_5","_toDisplayString","_ctx","_hoisted_6","_createCommentVNode","_hoisted_7","_hoisted_8","_hoisted_10","$options","_hoisted_11","_Fragment","_renderList","$props","_createVNode","_component_people_name_cell","_hoisted_12","_hoisted_13","_component_department_names_cell","_hoisted_15","$event","_hoisted_17","_hoisted_18","ButtonSimple","ComboboxDepartment","ComboboxProduction","PageLayout","PeopleAvatar","PeopleField","PeopleName","ProductionTeamList","a","b","production","sortPeople","personId","departmentId","_createBlock","_component_page_layout","_createSlots","_component_people_field","$data","_cache","args","_component_production_team_list","_withCtx","_component_combobox_production","_component_button_simple","_normalizeClass","_component_combobox_department","_component_people_avatar","_component_people_name"],"mappings":"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"}