{"version":3,"file":"ComboboxDepartment-Cjj8YvK6.js","sources":["../../src/components/widgets/ComboboxDepartment.vue"],"sourcesContent":["<template>\n  <div>\n    <label class=\"label\" v-if=\"label.length\">\n      {{ label }}\n    </label>\n    <div\n      ref=\"combobox\"\n      class=\"department-combo\"\n      :class=\"{\n        opened: showDepartmentList,\n        rounded,\n        top\n      }\"\n      :style=\"{\n        width: `${width}px`\n      }\"\n    >\n      <div class=\"flexrow\" @click=\"toggleDepartmentList\">\n        <div\n          class=\"selected-department-line flexrow-item\"\n          v-if=\"currentDepartment\"\n        >\n          <department-name :department=\"currentDepartment\" />\n        </div>\n        <chevron-down-icon class=\"down-icon flexrow-item\" />\n      </div>\n      <div\n        class=\"select-input\"\n        ref=\"select\"\n        :style=\"listStyle\"\n        v-if=\"showDepartmentList\"\n      >\n        <div\n          class=\"department-line\"\n          :key=\"department.id\"\n          @click=\"selectDepartment(department)\"\n          v-for=\"department in departmentList.filter(\n            ({ id }) => id !== modelValue\n          )\"\n        >\n          <department-name :department=\"department\" />\n        </div>\n      </div>\n    </div>\n    <combobox-mask\n      :displayed=\"showDepartmentList\"\n      @click=\"toggleDepartmentList\"\n    />\n  </div>\n</template>\n\n<script>\nimport { ChevronDownIcon } from 'lucide-vue-next'\nimport { mapGetters } from 'vuex'\n\nimport ComboboxMask from '@/components/widgets/ComboboxMask.vue'\nimport DepartmentName from '@/components/widgets/DepartmentName.vue'\n\nexport default {\n  name: 'combobox-department',\n\n  components: {\n    ChevronDownIcon,\n    ComboboxMask,\n    DepartmentName\n  },\n\n  emits: ['update:modelValue'],\n\n  data() {\n    return {\n      showDepartmentList: false\n    }\n  },\n\n  props: {\n    displayAllAndMyDepartments: {\n      default: false,\n      type: Boolean\n    },\n    label: {\n      default: '',\n      type: String\n    },\n    maxHeightSelectInput: {\n      default: 200,\n      type: Number\n    },\n    rounded: {\n      default: false,\n      type: Boolean\n    },\n    selectableDepartments: {\n      type: Array,\n      required: false\n    },\n    modelValue: {\n      default: '',\n      type: String\n    },\n    width: {\n      default: 250,\n      type: Number\n    },\n    withEmptyChoice: {\n      default: true,\n      type: Boolean\n    },\n    top: {\n      default: false,\n      type: Boolean\n    },\n    allDepartmentsLabel: {\n      default: false,\n      type: Boolean\n    }\n  },\n\n  computed: {\n    ...mapGetters([\n      'departmentMap',\n      'departments',\n      'isCurrentUserManager',\n      'isCurrentUserSupervisor',\n      'user'\n    ]),\n\n    departmentsToTakeAccount() {\n      const departments = this.selectableDepartments\n        ? [...this.selectableDepartments]\n        : [...this.departments]\n      return departments.sort((a, b) =>\n        a.name.localeCompare(b.name, undefined, {\n          numeric: true\n        })\n      )\n    },\n\n    departmentList() {\n      if (this.displayAllAndMyDepartments) {\n        const departmentFilter = [\n          {\n            name: this.$t('tasks.combobox_departments.all_departments'),\n            id: 'ALL',\n            color: '#CCC'\n          }\n        ]\n        if (!this.isCurrentUserManager && this.user.departments.length > 0) {\n          departmentFilter.unshift({\n            name: this.$t('tasks.combobox_departments.my_departments'),\n            id: 'MY_DEPARTMENTS',\n            color: '#000000'\n          })\n        }\n        return [...departmentFilter, ...this.departmentsToTakeAccount]\n      } else if (\n        this.isCurrentUserSupervisor &&\n        this.user.departments.length > 0\n      ) {\n        return [...this.departmentsToTakeAccount]\n      } else if (this.withEmptyChoice) {\n        return [\n          {\n            color: '#AAA',\n            id: null,\n            name: this.allDepartmentsLabel\n              ? this.$t('departments.all_departments')\n              : this.$t('departments.no_department')\n          },\n          ...this.departmentsToTakeAccount\n        ]\n      } else {\n        return [...this.departmentsToTakeAccount]\n      }\n    },\n\n    currentDepartment() {\n      if (this.modelValue) {\n        const departmentMapped = this.departmentMap.get(this.modelValue)\n        if (departmentMapped) {\n          return departmentMapped\n        } else {\n          return this.departmentList.find(d => d.id === this.modelValue)\n        }\n      } else {\n        return this.departmentList[0]\n      }\n    },\n\n    listStyle() {\n      const data = {\n        'max-height': `${this.maxHeightSelectInput}px`,\n        width: `${this.width}px`,\n        top: this.rounded ? '31px' : '37px',\n        left: '0'\n      }\n      if (this.top) {\n        Object.assign(data, {\n          top: '-200px',\n          bottom: '-90px',\n          'border-top-left-radius': '10px',\n          'border-top-right-radius': '10px',\n          'border-bottom-left-radius': '0',\n          'border-bottom-right-radius': '0'\n        })\n      }\n\n      return data\n    }\n  },\n\n  methods: {\n    selectDepartment(department) {\n      this.$emit('update:modelValue', department.id)\n      this.showDepartmentList = false\n    },\n\n    toggleDepartmentList() {\n      this.showDepartmentList = !this.showDepartmentList\n    },\n\n    focus() {\n      this.$refs.combobox.focus()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.dark {\n  .select-input,\n  .selected-department-line,\n  .department-line,\n  .department-combo {\n    background: $dark-grey-light;\n    border-color: $dark-grey;\n  }\n\n  .department-line:hover {\n    background: $dark-purple;\n  }\n}\n\n.department-combo {\n  background: $white;\n  border: 1px solid $light-grey-light;\n  user-select: none;\n  cursor: pointer;\n  border-radius: 10px;\n  margin: 0;\n  padding: 0.15em;\n  position: relative;\n\n  &.opened {\n    &.top {\n      border-top-left-radius: 0;\n      border-top-right-radius: 0;\n    }\n    &:not(.top) {\n      border-bottom-left-radius: 0;\n      border-bottom-right-radius: 0;\n    }\n  }\n}\n\n.department-combo:hover {\n  border: 1px solid $green;\n}\n\n.selected-department-line {\n  background: $white;\n  padding: 0.2em;\n  flex: 1;\n}\n\n.department-line {\n  background: $white;\n  cursor: pointer;\n  padding: 0.2em;\n  margin: 0;\n\n  &:hover {\n    background: $purple;\n  }\n}\n\n.down-icon {\n  width: 15px;\n  min-width: 15px;\n  margin-right: 0.4em;\n  color: $green;\n  cursor: pointer;\n}\n\n.select-input {\n  background: $white;\n  border-bottom-left-radius: 10px;\n  border-bottom-right-radius: 10px;\n  position: absolute;\n  border: 1px solid $light-grey-light;\n  z-index: 300;\n  margin-left: -1px;\n  max-height: 200px;\n  overflow-y: auto;\n  left: 0;\n}\n\n.field .label {\n  padding-top: 5px;\n}\n\n.rounded {\n  border-radius: 10px;\n\n  &.opened {\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n  }\n\n  .selected-department-line {\n    padding-top: 0;\n    padding-bottom: 0;\n    border-radius: 50px;\n  }\n}\n</style>\n"],"names":["_sfc_main","ChevronDownIcon","ComboboxMask","DepartmentName","mapGetters","a","b","departmentFilter","departmentMapped","d","data","department","_hoisted_3","_createElementBlock","$props","_hoisted_1","_toDisplayString","_createCommentVNode","_createElementVNode","_normalizeClass","$data","_normalizeStyle","$options","args","_openBlock","_hoisted_2","_createVNode","_component_department_name","_component_chevron_down_icon","_Fragment","_renderList","id","$event","_component_combobox_mask"],"mappings":"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"}