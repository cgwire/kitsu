{"version":3,"file":"TaskType-BzlgS1S_.js","sources":["../../src/components/pages/tasktype/EstimationHelper.vue","../../src/components/widgets/TaskListNumbers.vue","../../src/components/lists/TaskList.vue","../../src/components/pages/TaskType.vue"],"sourcesContent":["<template>\n  <div class=\"estimation-wrapper\">\n    <div class=\"estimation-helper columns\">\n      <div ref=\"body\" class=\"task-list column datatable-wrapper\">\n        <table class=\"datatable\">\n          <thead class=\"datatable-head\">\n            <tr>\n              <th class=\"assignees\">\n                {{ $t('tasks.fields.assignees') }}\n              </th>\n              <th class=\"thumbnail\"></th>\n              <th class=\"asset-type\" v-if=\"isAssets\">\n                {{ $t('tasks.fields.asset_type') }}\n              </th>\n              <th class=\"sequence\" v-else-if=\"isShots\">\n                {{ $t('tasks.fields.sequence') }}\n              </th>\n              <th class=\"name\">\n                {{ $t('tasks.fields.entity_name') }}\n              </th>\n              <th class=\"frames numeric-cell\" v-if=\"isShots\">\n                {{ $t('tasks.fields.frames') }}\n              </th>\n              <th class=\"seconds numeric-cell\" v-if=\"isShots\">\n                {{ $t('tasks.fields.seconds').substring(0, 3) }}.\n              </th>\n              <th class=\"estimation numeric-cell\">\n                {{ $t('tasks.fields.estimation').substring(0, 3) }}.\n              </th>\n            </tr>\n          </thead>\n\n          <tbody class=\"datatable-body\">\n            <tr\n              :ref=\"'task-' + task.id\"\n              :key=\"task.id\"\n              :class=\"{\n                'datatable-row': true,\n                selected: selectionGrid[task.id],\n                'task-line': true\n              }\"\n              v-for=\"(task, index) in tasksByPerson\"\n            >\n              <td class=\"assignees\">\n                <span class=\"flexrow\" v-if=\"task.assignees.length\">\n                  <span\n                    class=\"flexrow\"\n                    :key=\"`${task.id}-${personId}`\"\n                    v-for=\"personId in task.assignees\"\n                  >\n                    <people-avatar\n                      class=\"flexrow-item\"\n                      :person=\"personMap.get(personId)\"\n                      :size=\"30\"\n                      :font-size=\"17\"\n                    />\n                    <people-name\n                      class=\"flexrow-item\"\n                      :person=\"personMap.get(personId)\"\n                      v-if=\"task.assignees.length === 1\"\n                    />\n                  </span>\n                </span>\n              </td>\n              <td class=\"thumbnail\">\n                <entity-thumbnail\n                  :entity=\"getEntity(task.entity.id)\"\n                  :width=\"50\"\n                  :height=\"33\"\n                  :empty-width=\"50\"\n                  :empty-height=\"31\"\n                />\n              </td>\n              <td class=\"asset-type\" v-if=\"isAssets\">\n                {{ getEntity(task.entity.id).asset_type_name }}\n              </td>\n              <td class=\"sequence\" v-else-if=\"isShots\">\n                {{ getEntity(task.entity.id).sequence_name }}\n              </td>\n              <td class=\"name\">\n                {{ getEntity(task.entity.id).name }}\n              </td>\n              <td class=\"frames numeric-cell\" v-if=\"isShots\">\n                {{ getEntity(task.entity.id).nb_frames }}\n              </td>\n              <td class=\"frames numeric-cell\" v-if=\"isShots\">\n                {{ getSeconds(task) }}\n              </td>\n              <td\n                @click=\"selectTask($event, task, index)\"\n                class=\"estimation numeric-cell\"\n              >\n                <input\n                  :ref=\"task.id + '-estimation'\"\n                  class=\"input stylehidden\"\n                  min=\"0\"\n                  step=\"any\"\n                  type=\"number\"\n                  @blur=\"onInputBlur\"\n                  @change=\"estimationUpdated($event, task, index)\"\n                  @keydown=\"onKeyDown\"\n                  @mouseout=\"onInputMouseOut\"\n                  @mouseover=\"onInputMouseOver\"\n                  :value=\"formatDuration(task.estimation, false)\"\n                  v-if=\"isInDepartment(task)\"\n                />\n                <span v-else>\n                  {{ formatDuration(task.estimation) }}\n                </span>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n\n      <div class=\"person-list column datatable-wrapper\">\n        <table class=\"datatable\">\n          <thead ref=\"thead\" class=\"datatable-head\">\n            <tr>\n              <th class=\"assignees\">\n                {{ $t('tasks.fields.assignees') }}\n              </th>\n              <th class=\"count numeric-cell\">\n                {{ $t('tasks.fields.count') }}\n              </th>\n              <th class=\"frames numeric-cell\">\n                {{ $t('tasks.fields.frames') }}\n              </th>\n              <th class=\"seconds numeric-cell\">\n                {{ $t('tasks.fields.seconds').substring(0, 3) }}.\n              </th>\n              <th class=\"estimation numeric-cell\">\n                {{ $t('tasks.fields.estimation').substring(0, 3) }}.\n              </th>\n              <th class=\"quota numeric-cell\">\n                {{\n                  $t('tasks.fields.estimated_quota') +\n                  ' ' +\n                  $t('tasks.fields.seconds').substring(0, 3)\n                }}.\n              </th>\n              <th class=\"quota numeric-cell\">\n                {{\n                  $t('tasks.fields.estimated_quota') +\n                  ' ' +\n                  $t('tasks.fields.frames').substring(0, 3)\n                }}.\n              </th>\n              <th class=\"quota numeric-cell\">\n                {{\n                  $t('tasks.fields.estimated_quota') +\n                  ' ' +\n                  $t('tasks.fields.count')\n                }}.\n              </th>\n            </tr>\n          </thead>\n\n          <tbody class=\"datatable-body\">\n            <template v-for=\"person in assignees\" :key=\"person.id\">\n              <tr class=\"datatable-row task-line\">\n                <td class=\"person flexrow\">\n                  <people-avatar\n                    class=\"flexrow-item\"\n                    :person=\"person\"\n                    :size=\"30\"\n                    :font-size=\"17\"\n                  />\n                  <people-name class=\"flexrow-item\" :person=\"person\" />\n                </td>\n                <td class=\"count numeric-cell\">\n                  {{ person.alltasks.count }}\n                </td>\n                <td class=\"frames numeric-cell\">\n                  {{ person.alltasks.frames }}\n                </td>\n                <td class=\"seconds numeric-cell\">\n                  {{ person.alltasks.seconds }}\n                </td>\n                <td class=\"estimation numeric-cell\">\n                  {{ person.alltasks.estimation }}\n                </td>\n                <td class=\"quota numeric-cell\">\n                  {{ person.alltasks.quota }}\n                </td>\n                <td class=\"quota numeric-cell\">\n                  {{ person.alltasks.quotaFrames }}\n                </td>\n                <td class=\"quota numeric-cell\">\n                  {{ person.alltasks.quotaCount }}\n                </td>\n              </tr>\n              <tr class=\"datatable-row task-line\">\n                <td class=\"person flexrow\">\n                  <corner-down-right-icon class=\"ml05 mr05\" :size=\"12\" />\n                  {{ $t('main.remaining') }}\n                </td>\n                <td class=\"count numeric-cell\">\n                  {{ person.remaining.count }}\n                </td>\n                <td class=\"frames numeric-cell\">\n                  {{ person.remaining.frames }}\n                </td>\n                <td class=\"seconds numeric-cell\">\n                  {{ person.remaining.seconds }}\n                </td>\n                <td class=\"estimation numeric-cell\">\n                  {{ person.remaining.estimation }}\n                </td>\n                <td class=\"quota numeric-cell\">\n                  {{ person.remaining.quota }}\n                </td>\n                <td class=\"quota numeric-cell\">\n                  {{ person.remaining.quotaFrames }}\n                </td>\n                <td class=\"quota numeric-cell\">\n                  {{ person.remaining.quotaCount }}\n                </td>\n              </tr>\n            </template>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { CornerDownRightIcon } from 'lucide-vue-next'\nimport { firstBy } from 'thenby'\nimport { mapGetters, mapActions } from 'vuex'\n\nimport assetsStore from '@/store/modules/assets.js'\nimport editsStore from '@/store/modules/edits.js'\nimport episodesStore from '@/store/modules/episodes.js'\nimport sequencesStore from '@/store/modules/sequences.js'\nimport shotsStore from '@/store/modules/shots.js'\n\nimport EntityThumbnail from '@/components/widgets/EntityThumbnail.vue'\nimport PeopleAvatar from '@/components/widgets/PeopleAvatar.vue'\nimport PeopleName from '@/components/widgets/PeopleName.vue'\n\nimport { domMixin } from '@/components/mixins/dom'\nimport { formatListMixin } from '@/components/mixins/format'\nimport { minutesToDays, range } from '@/lib/time'\nimport { frameToSeconds } from '@/lib/video'\n\nexport default {\n  name: 'estimation-helper',\n\n  mixins: [domMixin, formatListMixin],\n\n  components: {\n    CornerDownRightIcon,\n    EntityThumbnail,\n    PeopleAvatar,\n    PeopleName\n  },\n\n  props: {\n    entityType: {\n      type: String,\n      default: 'Asset'\n    },\n    tasks: {\n      type: Array,\n      default: () => []\n    }\n  },\n\n  emits: ['estimation-changed'],\n\n  data() {\n    return {\n      lastSelection: 0,\n      lastShiftSelection: 0,\n      selectionGrid: {}\n    }\n  },\n\n  computed: {\n    ...mapGetters([\n      'currentProduction',\n      'isCurrentUserManager',\n      'isCurrentUserSupervisor',\n      'organisation',\n      'personMap',\n      'taskStatusMap',\n      'taskTypeMap',\n      'user'\n    ]),\n\n    isAssets() {\n      return this.entityType === 'Asset'\n    },\n\n    isShots() {\n      return this.entityType === 'Shot'\n    },\n\n    tasksByPerson() {\n      return [...this.tasks].sort(this.compareFirstAssignees)\n    },\n\n    assetMap() {\n      return assetsStore.cache.assetMap\n    },\n\n    editMap() {\n      return editsStore.cache.editMap\n    },\n\n    episodeMap() {\n      return episodesStore.cache.episodeMap\n    },\n\n    sequenceMap() {\n      return sequencesStore.cache.sequenceMap\n    },\n\n    shotMap() {\n      return shotsStore.cache.shotMap\n    },\n\n    entityMap() {\n      return this[`${this.entityType.toLowerCase()}Map`]\n    },\n\n    assignees() {\n      const assigneeSet = new Set()\n      const alltasks = {\n        countMap: new Map(),\n        frameMap: new Map(),\n        estimationMap: new Map(),\n        secondMap: new Map()\n      }\n      const remaining = {\n        countMap: new Map(),\n        frameMap: new Map(),\n        estimationMap: new Map(),\n        secondMap: new Map()\n      }\n      const assignees = []\n      this.tasks.forEach(task => {\n        const entity = this.getEntity(task.entity_id)\n        task.assignees.forEach(personId => {\n          assigneeSet.add(personId)\n          this.addAssigneeStatsToMaps(alltasks, personId, task, entity)\n          const status = this.taskStatusMap.get(task.task_status_id)\n          if (!status.is_done && !status.is_feedback_request) {\n            this.addAssigneeStatsToMaps(remaining, personId, task, entity)\n          }\n        })\n      })\n      assigneeSet.forEach((val, personId) =>\n        assignees.push(this.personMap.get(personId))\n      )\n      return assignees.sort(firstBy('name')).map(person => {\n        const allTasksStats = this.getAssigneeStats(person, alltasks)\n        const remainingStats = this.getAssigneeStats(person, remaining)\n        return {\n          ...person,\n          alltasks: allTasksStats,\n          remaining: remainingStats\n        }\n      })\n    }\n  },\n\n  methods: {\n    ...mapActions(['updateTask']),\n\n    frameToSeconds,\n\n    getEntity(entityId) {\n      return this.entityMap.get(entityId)\n    },\n\n    compareFirstAssignees(a, b) {\n      if (a.assignees.length > 0 && b.assignees.length > 0) {\n        const personA = this.personMap.get(a.assignees[0])\n        const personB = this.personMap.get(b.assignees[0])\n        return personA.name.localeCompare(personB.name)\n      } else if (a.assignees.length > 0) {\n        return -1\n      } else if (b.assignees.length > 0) {\n        return 1\n      } else {\n        return -1\n      }\n    },\n\n    getSeconds(task) {\n      const shot = this.getEntity(task.entity_id)\n      return frameToSeconds(shot.nb_frames, this.currentProduction, shot)\n    },\n\n    estimationUpdated(event, task) {\n      const value = event.target.value\n      if (value && value.length > 0) {\n        const estimation = parseFloat(event.target.value)\n        this.saveEstimations(estimation, task)\n      }\n    },\n\n    saveEstimations(days, task) {\n      const selection = Object.keys(this.selectionGrid)\n      if (selection.length > 1) {\n        selection.forEach(taskId => {\n          this.$emit('estimation-changed', { taskId, days })\n        })\n      } else {\n        this.$emit('estimation-changed', { taskId: task.id, days })\n      }\n    },\n\n    onKeyDown(event) {\n      if (event.key === 'Tab') {\n        this.pauseEvent(event)\n        if (event.shiftKey) {\n          this.selectPrevious()\n        } else {\n          this.selectNext()\n        }\n      } else if (event.key === 'ArrowDown') {\n        this.pauseEvent(event)\n        this.selectNext(event.shiftKey)\n      } else if (event.key === 'ArrowUp') {\n        this.pauseEvent(event)\n        this.selectPrevious(event.shiftKey)\n      }\n    },\n\n    clearSelection() {\n      this.selectionGrid = {}\n    },\n\n    addToSelection(taskId) {\n      this.selectionGrid[taskId] = true\n    },\n\n    selectTask(event, task, index) {\n      if (event.shiftKey) {\n        if (!(event.ctrlKey || event.metaKey)) this.clearSelection()\n        this.selectTaskRange(index)\n      } else {\n        if (!(event.ctrlKey || event.metaKey)) this.clearSelection()\n        this.selectSingleTask(index)\n      }\n      if (this.isInDepartment(task)) {\n        this.focusInput(\n          this.$refs[this.tasksByPerson[index].id + '-estimation'][0]\n        )\n      }\n    },\n\n    selectPrevious(shiftKey) {\n      let index = this.lastSelection\n      index = index - 1 < 0 ? this.tasksByPerson.length - 1 : index - 1\n      this.selectTask({ shiftKey }, this.tasksByPerson[index], index)\n    },\n\n    selectNext(shiftKey) {\n      let index = this.lastSelection\n      index = index + 1 >= this.tasksByPerson.length ? 0 : index + 1\n      this.selectTask({ shiftKey }, this.tasksByPerson[index], index)\n    },\n\n    selectSingleTask(index) {\n      const task = this.tasksByPerson[index]\n      this.addToSelection(task.id)\n      this.lastSelection = index\n      this.lastShiftSelection = index\n    },\n\n    selectTaskRange(index) {\n      this.lastSelection = index\n      const taskIndices =\n        this.lastShiftSelection > index\n          ? range(index, this.lastShiftSelection)\n          : range(this.lastShiftSelection, index)\n      const selection = taskIndices.map(i => this.tasksByPerson[i].id)\n      selection.forEach(taskId => {\n        this.addToSelection(taskId)\n      })\n    },\n\n    isInDepartment(task) {\n      if (this.isCurrentUserManager) {\n        return true\n      } else if (this.isCurrentUserSupervisor) {\n        if (this.user.departments.length === 0) {\n          return true\n        } else {\n          const taskType = this.taskTypeMap.get(task.task_type_id)\n          return (\n            taskType.department_id &&\n            this.user.departments.includes(taskType.department_id)\n          )\n        }\n      } else {\n        return false\n      }\n    },\n\n    getAssigneeStats(person, maps) {\n      const estimation = maps.estimationMap.get(person.id) || 0\n      const seconds = maps.secondMap.get(person.id) || 0\n      const frames = maps.frameMap.get(person.id) || 0\n      const count = maps.countMap.get(person.id) || 0\n      const estimationDays = minutesToDays(this.organisation, estimation)\n      const quota = estimation > 0 ? seconds / estimationDays : 0\n      const quotaCount = estimation > 0 ? count / estimationDays : 0\n      const quotaFrames = estimation > 0 ? frames / estimationDays : 0\n\n      return {\n        count: maps.countMap.get(person.id) || 0,\n        estimation: this.formatDuration(estimation),\n        frames,\n        quota: quota.toFixed(2),\n        quotaFrames: quotaFrames.toFixed(2),\n        quotaCount: quotaCount.toFixed(2),\n        seconds: seconds.toFixed(2)\n      }\n    },\n\n    addAssigneeStatsToMaps(maps, personId, task, entity) {\n      maps.countMap.set(personId, (maps.countMap.get(personId) || 0) + 1)\n      maps.estimationMap.set(\n        personId,\n        (maps.estimationMap.get(personId) || 0) + task.estimation\n      )\n      if (!this.isAssets) {\n        const frames = entity.nb_frames || 0\n        const seconds = frameToSeconds(frames, this.currentProduction, entity)\n        maps.secondMap.set(\n          personId,\n          (maps.secondMap.get(personId) || 0) + seconds\n        )\n        maps.frameMap.set(personId, (maps.frameMap.get(personId) || 0) + frames)\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\nth {\n  padding: 0.4em 0;\n}\n\ntd {\n  padding: 0 0.4em;\n\n  &.thumbnail {\n    padding-top: 0.2em;\n  }\n\n  &.assignees {\n    padding-left: 0.4em;\n    padding-top: 0.2em;\n  }\n}\n\n.assignees {\n  min-width: 200px;\n  max-width: 200px;\n  width: 200px;\n\n  span {\n    margin-top: 0.2em;\n    margin-bottom: 0.2em;\n  }\n}\n\n.thumbnail {\n  vertical-align: middle;\n  min-width: 64px;\n  max-width: 64px;\n  width: 64px;\n}\n\n.asset-type {\n  min-width: 120px;\n  width: 120px;\n}\n\n.sequence {\n  min-width: 120px;\n  width: 120px;\n}\n\n.name {\n  min-width: 120px;\n  width: 100%;\n  font-weight: bold;\n}\n\n.frames,\n.estimation,\n.seconds,\n.count {\n  min-width: 60px;\n  width: 60px;\n}\n\n.number {\n  min-width: 80px;\n  width: 80px;\n  text-align: right;\n}\n\n.estimation-helper {\n  max-height: 100%;\n}\n\n.estimation-wrapper {\n  flex: 1;\n}\n\n.columns {\n  margin-top: 1em;\n}\n\n.column {\n  padding: 0 1em 1em 1em;\n}\n\n.task-list {\n  .empty {\n    border-left: 0 solid transparent;\n  }\n}\n\n.task-list .numeric-cell,\n.person-list .numeric-cell {\n  padding-right: 0.4em;\n  text-align: right;\n\n  input {\n    text-align: right;\n  }\n}\n.task-list .numeric-cell input.input {\n  padding-right: 0.5em;\n}\n\n.person-list {\n  flex: 1;\n\n  td {\n    padding: 0.2em;\n  }\n}\n\ninput[type='number']::-webkit-outer-spin-button,\ninput[type='number']::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type='number'] {\n  -moz-appearance: textfield;\n}\n</style>\n","<template>\n  <p class=\"has-text-centered nb-tasks\">\n    {{ tasks.length }} {{ $tc('tasks.number', tasks.length) }} ({{\n      formatDuration(timeEstimated)\n    }}\n    {{\n      isDurationInHours\n        ? $tc('main.hours_estimated', formatDuration(timeEstimated, false))\n        : $tc('main.days_estimated', formatDuration(timeEstimated, false))\n    }},\n    {{ formatDuration(timeSpent) }}\n    {{\n      isDurationInHours\n        ? $tc('main.hours_spent', formatDuration(timeSpent, false))\n        : $tc('main.days_spent', formatDuration(timeSpent, false))\n    }}<span v-if=\"isShots && !isPaperProduction\"\n      >, {{ nbFrames }} {{ $tc('main.nb_frames', nbFrames) }}</span\n    >\n    <span v-if=\"isShots && isPaperProduction\"\n      >, {{ nbDrawings }} {{ $tc('main.nb_drawings', nbDrawings) }}</span\n    >)\n  </p>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport { formatListMixin } from '@/components/mixins/format'\nimport shotStore from '@/store/modules/shots'\n\nexport default {\n  name: 'task-list-numbers',\n\n  mixins: [formatListMixin],\n\n  props: {\n    isShots: {\n      default: false,\n      type: Boolean\n    },\n    tasks: {\n      default: () => [],\n      type: Array\n    }\n  },\n\n  computed: {\n    ...mapGetters(['isPaperProduction']),\n\n    shotMap() {\n      return shotStore.cache.shotMap\n    },\n\n    timeSpent() {\n      return this.tasks.reduce((acc, task) => acc + task.duration, 0)\n    },\n\n    timeEstimated() {\n      return this.tasks.reduce((acc, task) => acc + task.estimation, 0)\n    },\n\n    nbFrames() {\n      return this.tasks.reduce((acc, task) => {\n        const entity = this.shotMap.get(task.entity.id)\n        if (entity && entity.nb_frames) acc += entity.nb_frames\n        return acc\n      }, 0)\n    },\n\n    nbDrawings() {\n      return this.tasks.reduce((acc, task) => acc + task.nb_drawings, 0)\n    }\n  }\n}\n</script>\n","<template>\n  <div class=\"data-list\">\n    <div\n      ref=\"body\"\n      class=\"datatable-wrapper\"\n      :class=\"{\n        'with-schedule': withSchedule\n      }\"\n      @scroll.passive=\"onBodyScroll\"\n      v-if=\"!isContactSheet\"\n    >\n      <table class=\"datatable\">\n        <thead ref=\"thead\" class=\"datatable-head\">\n          <tr class=\"row-header\">\n            <th class=\"thumbnail\" ref=\"th-thumbnail\"></th>\n            <th class=\"asset-type\" ref=\"th-type\" v-if=\"isAssets\">\n              {{ $t('tasks.fields.asset_type') }}\n            </th>\n            <th\n              class=\"sequence\"\n              ref=\"th-type\"\n              v-else-if=\"!isEpisodes && !isSequences\"\n            >\n              {{ $t('tasks.fields.sequence') }}\n            </th>\n            <th class=\"name\" ref=\"th-name\">\n              {{ $t('tasks.fields.entity_name') }}\n            </th>\n            <th class=\"status\" ref=\"th-status\">\n              {{ $t('tasks.fields.task_status') }}\n            </th>\n            <th class=\"assignees\" ref=\"th-assignees\">\n              {{ $t('tasks.fields.assignees') }}\n            </th>\n            <th\n              ref=\"th-frames\"\n              class=\"frames number-cell\"\n              v-if=\"isShots && !isPaperProduction\"\n            >\n              {{ $t('tasks.fields.frames') }}\n            </th>\n            <th\n              ref=\"th-drawings\"\n              class=\"drawings number-cell\"\n              v-if=\"isShots && isPaperProduction\"\n            >\n              {{ $t('tasks.fields.drawings') }}\n            </th>\n            <th class=\"difficulty number-cell\" ref=\"th-difficulty\">\n              {{ $t('tasks.fields.difficulty') }}\n            </th>\n            <th\n              ref=\"th-estimation\"\n              class=\"estimation number-cell\"\n              :title=\"$t('main.estimation')\"\n            >\n              {{ $t('tasks.fields.estimation').substring(0, 3) }}.\n            </th>\n            <th class=\"duration number-cell\" ref=\"th-duration\">\n              {{ $t('tasks.fields.duration').substring(0, 3) }}.\n            </th>\n            <th class=\"retake-count number-cell\" ref=\"th-retake-count\">\n              {{ $t('tasks.fields.retake_count') }}\n            </th>\n            <th class=\"start-date\" ref=\"th-estimation\" v-if=\"!withSchedule\">\n              {{ $t('tasks.fields.start_date') }}\n            </th>\n            <th class=\"due-date\" ref=\"th-estimation\" v-if=\"!withSchedule\">\n              {{ $t('tasks.fields.due_date') }}\n            </th>\n            <th class=\"real-start-date\" ref=\"th-status\" v-if=\"!withSchedule\">\n              {{ $t('tasks.fields.real_start_date') }}\n            </th>\n            <th class=\"real-end-date\" ref=\"th-status\" v-if=\"!withSchedule\">\n              {{ $t('tasks.fields.real_end_date') }}\n            </th>\n            <th class=\"done-date\" ref=\"th-status\" v-if=\"!withSchedule\">\n              {{ $t('tasks.fields.done_date') }}\n            </th>\n            <th class=\"last-comment-date\" ref=\"th-status\" v-if=\"!withSchedule\">\n              {{ $t('tasks.fields.last_comment_date') }}\n            </th>\n            <th class=\"empty\" v-if=\"!withSchedule\">&nbsp;</th>\n          </tr>\n        </thead>\n\n        <tbody class=\"datatable-body\">\n          <tr\n            :ref=\"`task-${task.id}`\"\n            :key=\"task.id\"\n            :class=\"{\n              'task-line': true,\n              'datatable-row': true,\n              selected: selectionGrid[task.id]\n            }\"\n            @click=\"selectTask($event, index, task)\"\n            v-for=\"(task, index) in tasks\"\n          >\n            <td class=\"thumbnail flexrow\">\n              <entity-thumbnail\n                class=\"flexrow-item\"\n                :entity=\"getEntity(task.entity.id)\"\n                :width=\"50\"\n                :height=\"33\"\n                :empty-width=\"50\"\n                :empty-height=\"33\"\n                v-if=\"task.entity\"\n              />\n            </td>\n            <td class=\"asset-type\" v-if=\"isAssets\">\n              {{ getEntity(task.entity.id).asset_type_name }}\n            </td>\n            <td class=\"sequence\" v-else-if=\"!isEpisodes && !isSequences\">\n              {{ getEntity(task.entity.id).sequence_name }}\n            </td>\n            <td class=\"name\">\n              <div\n                class=\"ellipsis nowrap\"\n                :title=\"getEntity(task.entity.id).name\"\n              >\n                {{ getEntity(task.entity.id).name }}\n              </div>\n            </td>\n            <validation-cell\n              class=\"status unselectable\"\n              :task-test=\"task\"\n              :is-border=\"false\"\n              :is-assignees=\"false\"\n              :selectable=\"false\"\n              :is-static=\"true\"\n            />\n            <td class=\"assignees\">\n              <div class=\"flexrow\">\n                <people-avatar-with-menu\n                  class=\"flexrow-item\"\n                  :key=\"`${task.id}-${personId}`\"\n                  :person=\"personMap.get(personId)\"\n                  :size=\"30\"\n                  :font-size=\"16\"\n                  @unassign=\"person => onUnassign(task, person)\"\n                  v-for=\"personId in task.assignees\"\n                />\n              </div>\n            </td>\n            <td class=\"frames number-cell\" v-if=\"isShots && !isPaperProduction\">\n              {{ getEntity(task.entity.id).nb_frames }}\n            </td>\n            <td\n              class=\"drawings number-cell\"\n              v-if=\"isShots && isPaperProduction\"\n            >\n              <input\n                class=\"input\"\n                min=\"0\"\n                step=\"1\"\n                type=\"number\"\n                :ref=\"`${task.id}-drawings`\"\n                :value=\"task.nb_drawings\"\n                @change=\"updateNbDrawings($event.target.value)\"\n                v-if=\"isInDepartment(task) && selectionGrid[task.id]\"\n              />\n              <template v-else>\n                {{ task.nb_drawings || 0 }}\n              </template>\n            </td>\n            <td class=\"difficulty number-cell\">\n              <combobox\n                class=\"difficulty-combobox\"\n                :options=\"difficultyOptions\"\n                :with-margin=\"false\"\n                :value=\"task.difficulty\"\n                @update:model-value=\"updateDifficulty($event)\"\n                v-if=\"isInDepartment(task) && selectionGrid[task.id]\"\n                v-model=\"task.difficulty\"\n              />\n              <template v-else>\n                <span\n                  class=\"difficulty number-cell\"\n                  v-for=\"index in task.difficulty\"\n                  :key=\"`${task.id}-difficulty-${index}`\"\n                >\n                  &bull;\n                </span>\n              </template>\n            </td>\n            <td class=\"estimation number-cell\">\n              <input\n                class=\"input\"\n                min=\"0\"\n                step=\"any\"\n                type=\"number\"\n                :ref=\"`${task.id}-estimation`\"\n                :value=\"formatDuration(task.estimation, false)\"\n                @change=\"updateEstimation($event.target.value)\"\n                v-if=\"isInDepartment(task) && selectionGrid[task.id]\"\n              />\n              <template v-else>\n                {{ formatDuration(task.estimation) }}\n              </template>\n            </td>\n            <td\n              :class=\"{\n                duration: true,\n                'number-cell': true,\n                error: isEstimationBurned(task)\n              }\"\n            >\n              {{ formatDuration(task.duration) }}\n            </td>\n            <td class=\"retake-count number-cell\">\n              <template v-for=\"index in task.retake_count\" :key=\"index\">\n                &bull;\n              </template>\n            </td>\n            <td class=\"start-date\" v-if=\"!withSchedule\">\n              <date-field\n                class=\"flexrow-item\"\n                :with-margin=\"false\"\n                :min-date=\"disabledDates.to\"\n                :model-value=\"getDate(task.start_date)\"\n                @update:model-value=\"updateStartDate\"\n                v-if=\"isInDepartment(task) && selectionGrid[task.id]\"\n              />\n              <template v-else>\n                {{ formatDate(task.start_date) }}\n              </template>\n            </td>\n            <td class=\"due-date\" v-if=\"!withSchedule\">\n              <date-field\n                class=\"flexrow-item\"\n                :with-margin=\"false\"\n                :model-value=\"getDate(task.due_date)\"\n                :max-date=\"disabledDates.from\"\n                @update:model-value=\"updateDueDate\"\n                v-if=\"isInDepartment(task) && selectionGrid[task.id]\"\n              />\n              <template v-else>\n                {{ formatDate(task.due_date) }}\n              </template>\n            </td>\n            <td class=\"real-start-date\" v-if=\"!withSchedule\">\n              {{ formatDate(task.real_start_date) }}\n            </td>\n            <td class=\"real-end-date\" v-if=\"!withSchedule\">\n              {{ formatDate(task.end_date) }}\n            </td>\n            <td class=\"done-date\" v-if=\"!withSchedule\">\n              {{ formatDate(task.done_date) }}\n            </td>\n            <td class=\"last-comment-date\" v-if=\"!withSchedule\">\n              {{ formatDate(task.last_comment_date) }}\n            </td>\n            <td v-if=\"!withSchedule\"></td>\n          </tr>\n        </tbody>\n      </table>\n      <table-info :is-loading=\"isLoading\" :is-error=\"isError\" />\n    </div>\n    <div\n      class=\"list-wrapper\"\n      v-else-if=\"tasksByParent && tasksByParent.length > 0 && isGrouped\"\n    >\n      <div :key=\"`task-section-${i}`\" v-for=\"(taskGroup, i) in tasksByParent\">\n        <h2>\n          {{ taskGroup.name }}\n        </h2>\n        <div class=\"task-grid\">\n          <div\n            :class=\"{\n              'task-card': true,\n              selected: selectionGrid[task.id]\n            }\"\n            :key=\"task.id\"\n            @click=\"selectTask($event, index, task)\"\n            v-for=\"(task, index) in taskGroup.tasks\"\n          >\n            <entity-preview\n              class=\"flexrow-item\"\n              :entity=\"getEntity(task.entity.id)\"\n              :height=\"133\"\n              :width=\"200\"\n              :empty-width=\"200\"\n              :empty-height=\"133\"\n              :show-movie=\"false\"\n              no-preview\n              v-if=\"task.entity\"\n            />\n            <span class=\"task-name\">\n              {{ getTaskName(task) }}\n            </span>\n            <div class=\"flexrow task-data\">\n              <validation-tag class=\"flexrow-item\" :task=\"task\" thin />\n              <div class=\"filler\"></div>\n              <people-avatar-with-menu\n                class=\"flexrow-item\"\n                :key=\"`${task.id}-${personId}`\"\n                :person=\"personMap.get(personId)\"\n                :size=\"20\"\n                :font-size=\"10\"\n                @unassign=\"person => onUnassign(task, person)\"\n                v-for=\"personId in task.assignees\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"task-grid list-wrapper\" v-else>\n      <div\n        :class=\"{\n          'task-card': true,\n          selected: selectionGrid[task.id]\n        }\"\n        :key=\"task.id\"\n        @click=\"selectTask($event, index, task)\"\n        v-for=\"(task, index) in displayedTasks\"\n      >\n        <entity-preview\n          class=\"flexrow-item\"\n          :entity=\"getEntity(task.entity.id)\"\n          :height=\"133\"\n          :width=\"200\"\n          :empty-width=\"200\"\n          :empty-height=\"133\"\n          :show-movie=\"false\"\n          no-preview\n          v-if=\"task.entity\"\n        />\n        <span class=\"task-name\">\n          {{ getTaskName(task) }}\n        </span>\n        <div class=\"flexrow task-data\">\n          <validation-tag class=\"flexrow-item\" :task=\"task\" thin />\n          <div class=\"filler\"></div>\n          <people-avatar-with-menu\n            class=\"flexrow-item\"\n            :key=\"`${task.id}-${personId}`\"\n            :person=\"personMap.get(personId)\"\n            :size=\"20\"\n            :font-size=\"10\"\n            @unassign=\"person => onUnassign(task, person)\"\n            v-for=\"personId in task.assignees\"\n          />\n        </div>\n      </div>\n    </div>\n    <slot></slot>\n  </div>\n  <task-list-numbers :is-shots=\"isShots\" :tasks=\"tasks\" v-if=\"!isLoading\" />\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nimport moment from 'moment-timezone'\nimport {\n  daysToMinutes,\n  formatSimpleDate,\n  getDatesFromStartDate,\n  getDatesFromEndDate,\n  parseSimpleDate,\n  minutesToDays,\n  range\n} from '@/lib/time'\nimport { formatListMixin } from '@/components/mixins/format'\nimport { domMixin } from '@/components/mixins/dom'\n\nimport Combobox from '@/components/widgets/Combobox.vue'\nimport DateField from '@/components/widgets/DateField.vue'\nimport EntityPreview from '@/components/widgets/EntityPreview.vue'\nimport EntityThumbnail from '@/components/widgets/EntityThumbnail.vue'\nimport PeopleAvatarWithMenu from '@/components/widgets/PeopleAvatarWithMenu.vue'\nimport TableInfo from '@/components/widgets/TableInfo.vue'\nimport TaskListNumbers from '@/components/widgets/TaskListNumbers.vue'\nimport ValidationCell from '@/components/cells/ValidationCell.vue'\nimport ValidationTag from '@/components/widgets/ValidationTag.vue'\n\nimport assetStore from '@/store/modules/assets'\nimport editStore from '@/store/modules/edits'\nimport episodeStore from '@/store/modules/episodes'\nimport sequenceStore from '@/store/modules/sequences'\nimport shotStore from '@/store/modules/shots'\n\nexport default {\n  name: 'task-list',\n\n  mixins: [domMixin, formatListMixin],\n\n  components: {\n    Combobox,\n    DateField,\n    EntityPreview,\n    EntityThumbnail,\n    PeopleAvatarWithMenu,\n    TableInfo,\n    TaskListNumbers,\n    ValidationCell,\n    ValidationTag\n  },\n\n  emits: ['scroll', 'task-selected'],\n\n  data() {\n    return {\n      difficultyOptions: [\n        { label: '•', value: 1 },\n        { label: '••', value: 2 },\n        { label: '•••', value: 3 },\n        { label: '••••', value: 4 },\n        { label: '•••••', value: 5 }\n      ],\n      lastSelection: null,\n      page: 1,\n      selectionGrid: {},\n      selectedDate: moment().toDate() // By default current day.\n    }\n  },\n\n  props: {\n    disabledDates: {\n      type: Object,\n      default: () => {}\n    },\n    entityType: {\n      type: String,\n      default: 'Asset'\n    },\n    isContactSheet: {\n      type: Boolean,\n      default: false\n    },\n    isError: {\n      type: Boolean,\n      default: false\n    },\n    isGrouped: {\n      type: Boolean,\n      default: false\n    },\n    isLoading: {\n      type: Boolean,\n      default: false\n    },\n    tasks: {\n      type: Array,\n      default: () => []\n    },\n    withSchedule: {\n      type: Boolean,\n      default: false\n    }\n  },\n\n  mounted() {\n    window.addEventListener('keydown', this.onKeyDown, false)\n  },\n\n  beforeUnmount() {\n    window.removeEventListener('keydown', this.onKeyDown)\n  },\n\n  computed: {\n    ...mapGetters([\n      'isCurrentUserManager',\n      'isCurrentUserSupervisor',\n      'isPaperProduction',\n      'nbSelectedTasks',\n      'personMap',\n      'user',\n      'selectedTasks',\n      'taskMap',\n      'taskTypeMap'\n    ]),\n\n    assetMap() {\n      return assetStore.cache.assetMap\n    },\n\n    editMap() {\n      return editStore.cache.editMap\n    },\n\n    episodeMap() {\n      return episodeStore.cache.episodeMap\n    },\n\n    sequenceMap() {\n      return sequenceStore.cache.sequenceMap\n    },\n\n    shotMap() {\n      return shotStore.cache.shotMap\n    },\n\n    isAssets() {\n      return this.entityType === 'Asset'\n    },\n\n    isEpisodes() {\n      return this.entityType === 'Episode'\n    },\n\n    isSequences() {\n      return this.entityType === 'Sequence'\n    },\n\n    isShots() {\n      return this.entityType === 'Shot'\n    },\n\n    displayedTasks() {\n      if (this.tasks && this.tasks.length > 0) {\n        return this.tasks.slice(0, 60 * this.page)\n      }\n      return []\n    },\n\n    tasksByParent() {\n      const result = []\n      if (this.tasks.length > 0) {\n        if (this.isShots) {\n          let currentTasks = {\n            name: this.tasks[0].sequence_name,\n            tasks: []\n          }\n          let previousTask = null\n          this.tasks.forEach(task => {\n            const entity = this.shotMap.get(task.entity.id)\n            if (previousTask) {\n              const previousEntity = this.shotMap.get(previousTask.entity.id)\n              if (previousEntity?.sequence_id !== entity?.sequence_id) {\n                result.push(currentTasks)\n                currentTasks = {\n                  name: task.sequence_name,\n                  tasks: []\n                }\n              }\n            }\n            currentTasks.tasks.push(task)\n            previousTask = task\n          })\n          result.push(currentTasks)\n        } else if (this.isAssets) {\n          let currentTasks = {\n            name: this.tasks[0].entity_type_name,\n            tasks: []\n          }\n          let previousTask = null\n          this.tasks.forEach(task => {\n            const entity = this.assetMap.get(task.entity.id)\n            if (previousTask) {\n              const previousEntity = this.assetMap.get(previousTask.entity.id)\n              if (previousEntity?.asset_type_id !== entity?.asset_type_id) {\n                result.push(currentTasks)\n                currentTasks = {\n                  name: task.entity_type_name,\n                  tasks: []\n                }\n              }\n            }\n            currentTasks.tasks.push(task)\n            previousTask = task\n          })\n          result.push(currentTasks)\n        }\n      }\n      return result\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'addSelectedTask',\n      'addSelectedTasks',\n      'clearSelectedTasks',\n      'updateTask',\n      'unassignPersonFromTask',\n      'removeSelectedTask'\n    ]),\n\n    getTaskName(task) {\n      if (this.entityType === 'Shot') {\n        return `${task.sequence_name} / ${this.getEntity(task.entity.id).name}`\n      }\n      return task.entity_name\n    },\n\n    isTaskChanged(task, data) {\n      const taskStart = task.start_date ? task.start_date.substring(0, 10) : ''\n      const taskDue = task.due_date ? task.due_date.substring(0, 10) : ''\n      return (\n        (data.start_date !== undefined && taskStart !== data.start_date) ||\n        (data.due_date !== undefined && taskDue !== data.due_date) ||\n        (data.estimation !== undefined &&\n          task.estimation !== data.estimation) ||\n        (data.difficulty !== undefined &&\n          task.difficulty !== data.difficulty) ||\n        (data.nb_drawings !== undefined &&\n          task.nb_drawings !== data.nb_drawings)\n      )\n    },\n\n    getDate(date) {\n      return date ? moment(date, 'YYYY-MM-DD').toDate() : null\n    },\n\n    updateEstimation(duration) {\n      const estimation = this.organisation.format_duration_in_hours\n        ? duration * 60\n        : daysToMinutes(this.organisation, duration)\n\n      this.updateTasksEstimation({ estimation })\n    },\n\n    onUnassign(task, person) {\n      if (this.selectedTasks.size > 0) {\n        this.selectedTasks.forEach(t => {\n          this.unassignPersonFromTask({ task: t, person })\n        })\n      }\n      this.unassignPersonFromTask({ task, person })\n    },\n\n    updateStartDate(date) {\n      Object.keys(this.selectionGrid).forEach(taskId => {\n        const task = this.taskMap.get(taskId)\n        const dueDate = task.due_date ? parseSimpleDate(task.due_date) : null\n        let data\n        if (date) {\n          const startDate = moment(date)\n          if (\n            task.start_date &&\n            task.start_date.substring(0, 10) === formatSimpleDate(startDate)\n          )\n            return\n          data = getDatesFromStartDate(\n            this.organisation,\n            startDate,\n            dueDate,\n            minutesToDays(this.organisation, task.estimation)\n          )\n        } else {\n          data = {\n            start_date: null,\n            due_date: task.due_date\n          }\n        }\n        if (task.difficulty) {\n          data.difficulty = task.difficulty\n        }\n        if (this.isTaskChanged(task, data)) {\n          this.updateTask({ taskId, data }).catch(console.error)\n        }\n      })\n    },\n\n    updateDueDate(date) {\n      Object.keys(this.selectionGrid).forEach(taskId => {\n        const task = this.taskMap.get(taskId)\n        const startDate = task.start_date\n          ? parseSimpleDate(task.start_date)\n          : null\n        let data\n        if (date) {\n          const dueDate = moment(date)\n          if (\n            task.due_date &&\n            task.due_date.substring(0, 10) === formatSimpleDate(dueDate)\n          )\n            return\n          data = getDatesFromEndDate(\n            this.organisation,\n            startDate,\n            dueDate,\n            minutesToDays(this.organisation, task.estimation)\n          )\n        } else {\n          data = {\n            start_date: task.start_date,\n            due_date: null\n          }\n        }\n        if (this.isTaskChanged(task, data)) {\n          this.updateTask({ taskId, data }).catch(console.error)\n        }\n      })\n    },\n\n    updateTasksEstimation({ estimation }) {\n      Object.keys(this.selectionGrid).forEach(taskId => {\n        const task = this.taskMap.get(taskId)\n        let data = { estimation }\n        if (task.start_date) {\n          const startDate = moment(task.start_date)\n          const dueDate = task.due_date ? moment(task.due_date) : null\n          data = getDatesFromStartDate(\n            this.organisation,\n            startDate,\n            dueDate,\n            minutesToDays(this.organisation, estimation)\n          )\n          data.estimation = estimation\n        }\n        if (this.isTaskChanged(task, data)) {\n          this.updateTask({ taskId, data }).catch(console.error)\n        }\n      })\n    },\n\n    updateDifficulty(difficulty) {\n      this.updateTasksData({ difficulty })\n    },\n\n    updateNbDrawings(nbDrawings) {\n      this.updateTasksData({ nb_drawings: nbDrawings })\n    },\n\n    updateTasksData(data) {\n      Object.keys(this.selectionGrid).forEach(taskId => {\n        const task = this.taskMap.get(taskId)\n        if (this.isTaskChanged(task, data)) {\n          this.updateTask({ taskId, data }).catch(console.error)\n        }\n      })\n    },\n\n    formatDate(date) {\n      if (date) return moment(date).format('YYYY-MM-DD')\n      return ''\n    },\n\n    isEstimationBurned(task) {\n      return (\n        task.estimation &&\n        task.estimation > 0 &&\n        task.duration > task.estimation\n      )\n    },\n\n    onBodyScroll(event) {\n      if (!this.$refs.body) return\n      const position = event.target\n      const maxHeight =\n        this.$refs.body.scrollHeight - this.$refs.body.offsetHeight\n      if (maxHeight < position.scrollTop + 100) {\n        this.page++\n      }\n\n      this.$emit('scroll', { top: position.scrollTop })\n    },\n\n    getEntity(entityId) {\n      return this[`${this.entityType.toLowerCase()}Map`].get(entityId) || {}\n    },\n\n    onKeyDown(event) {\n      if (this.tasks.length > 0 && event.altKey) {\n        let index = this.lastSelection ? this.lastSelection : 0\n        if ([37, 38].includes(event.keyCode)) {\n          index = index - 1 < 0 ? this.tasks.length - 1 : index - 1\n          this.selectTask({}, index, this.tasks[index])\n          this.pauseEvent(event)\n        } else if ([39, 40].includes(event.keyCode)) {\n          index = index + 1 >= this.tasks.length ? 0 : index + 1\n          this.selectTask({}, index, this.tasks[index])\n          this.pauseEvent(event)\n        }\n      }\n    },\n\n    selectTask(event, index, task) {\n      if (\n        event &&\n        event.target &&\n        // Dirty hack needed to make date picker and inputs work properly\n        (['INPUT'].includes(event.target.nodeName) ||\n          // Combo box should not trigger selection\n          event.target.className.indexOf('selected-line') >= 0 ||\n          event.target.className.indexOf('down-icon') >= 0 ||\n          event.target.className.indexOf('flexrow') >= 0 ||\n          event.target.className.indexOf('c-mask') >= 0 ||\n          event.target.className.indexOf('option-line') >= 0 ||\n          event.target.className.indexOf('combobox') >= 0 ||\n          event.target.className === '' ||\n          (event.target.parentNode &&\n            ['difficulty'].includes(event.target.className)) ||\n          (event.target.parentNode &&\n            ['HEADER'].includes(event.target.parentNode.nodeName)) ||\n          ['cell day selected'].includes(event.target.className))\n      )\n        return\n      const isSelected = this.selectionGrid[task.id]\n      const isManySelection = Object.keys(this.selectionGrid).length > 1\n      if (!(event.ctrlKey || event.metaKey) && !event.shiftKey) {\n        this.clearSelectedTasks()\n        this.resetSelection()\n      }\n\n      if (!event.shiftKey) {\n        if (isSelected) {\n          this.removeSelectedTask({ task })\n          this.selectionGrid[task.id] = undefined\n        } else if (!isSelected || isManySelection) {\n          this.addSelectedTask({ task })\n          this.$emit('task-selected', task)\n          this.selectionGrid[task.id] = true\n          this.lastSelection = index\n        }\n      } else {\n        this.selectionGrid = {}\n        const taskIndices =\n          this.lastSelection > index\n            ? range(index, this.lastSelection)\n            : range(this.lastSelection, index)\n        const selection = taskIndices.map(i => ({ task: this.tasks[i] }))\n        selection.forEach(task => {\n          this.selectionGrid[task.task.id] = true\n        })\n        this.addSelectedTasks(selection)\n      }\n      this.scrollToLine(task.id)\n    },\n\n    setScrollPosition(top) {\n      if (this.$refs.body) {\n        this.$refs.body.scrollTop = top\n      }\n    },\n\n    scrollToLine(taskId) {\n      const taskLine = this.$refs[`task-${taskId}`]\n      if (taskLine && this.$refs.body) {\n        const margin = 30\n        const rect = taskLine[0].getBoundingClientRect()\n        const listRect = this.$refs.body.getBoundingClientRect()\n        const isBelow = rect.bottom > listRect.bottom - margin\n        const isAbove = rect.top < listRect.top + margin\n\n        if (isBelow) {\n          const scrollingRequired = rect.bottom - listRect.bottom + margin\n          this.setScrollPosition(this.$refs.body.scrollTop + scrollingRequired)\n        } else if (isAbove) {\n          const scrollingRequired = listRect.top - rect.top + margin\n          this.setScrollPosition(this.$refs.body.scrollTop - scrollingRequired)\n        }\n      }\n    },\n\n    isInDepartment(task) {\n      if (this.isCurrentUserManager) {\n        return true\n      } else if (this.isCurrentUserSupervisor) {\n        if (this.user.departments.length === 0) {\n          return true\n        }\n        const taskType = this.taskTypeMap.get(task.task_type_id)\n        return (\n          taskType.department_id &&\n          this.user.departments.includes(taskType.department_id)\n        )\n      }\n      return false\n    },\n\n    resetSelection() {\n      this.selectionGrid = {}\n      this.lastSelection = null\n    },\n\n    getTableData() {\n      const headers = [\n        this.isAssets\n          ? this.$t('tasks.fields.asset_type')\n          : this.$t('tasks.fields.sequence'),\n        this.$t('tasks.fields.entity_name'),\n        this.$t('tasks.fields.task_status'),\n        this.$t('tasks.fields.assignees'),\n        this.$t('tasks.fields.difficulty'),\n        this.$t('tasks.fields.estimation'),\n        this.$t('tasks.fields.duration'),\n        this.$t('tasks.fields.retake_count'),\n        this.$t('tasks.fields.start_date'),\n        this.$t('tasks.fields.due_date'),\n        this.$t('tasks.fields.real_start_date'),\n        this.$t('tasks.fields.real_end_date'),\n        this.$t('tasks.fields.done_date'),\n        this.$t('tasks.fields.last_comment_date')\n      ]\n      if (this.isShots) {\n        const value = !this.isPaperProduction\n          ? this.$t('tasks.fields.frames')\n          : this.$t('tasks.fields.drawings')\n        headers.splice(4, 0, value)\n      }\n      const taskLines = [headers]\n      this.tasks.forEach(task => {\n        if (!task) return\n        const assignees = task.assignees\n          .map(personId => {\n            const person = this.personMap.get(personId)\n            if (person) return person.name\n            return ''\n          })\n          .join(', ')\n\n        const line = [\n          this.isAssets\n            ? this.getEntity(task.entity.id).asset_type_name\n            : this.getEntity(task.entity.id).sequence_name,\n          this.getEntity(task.entity.id).name,\n          task.task_status_short_name,\n          assignees,\n          task.difficulty,\n          this.formatDuration(task.estimation, false),\n          this.formatDuration(task.duration, false),\n          task.retake_count,\n          this.formatDate(task.start_date),\n          this.formatDate(task.due_date),\n          this.formatDate(task.real_start_date),\n          this.formatDate(task.end_date),\n          this.formatDate(task.done_date),\n          this.formatDate(task.last_comment_date)\n        ]\n        if (this.isShots) {\n          const value = !this.isPaperProduction\n            ? this.getEntity(task.entity.id).nb_frames\n            : task.nb_drawings || 0\n          line.splice(4, 0, value)\n        }\n        taskLines.push(line)\n      })\n      return taskLines\n    }\n  },\n\n  watch: {\n    tasks() {\n      this.page = 1\n      this.resetSelection()\n    },\n\n    nbSelectedTasks() {\n      if (this.nbSelectedTasks === 0) this.resetSelection()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.thumbnail {\n  min-width: 63px;\n  max-width: 63px;\n  width: 63px;\n}\n\n.asset-type {\n  min-width: 120px;\n  width: 120px;\n}\n\n.sequence {\n  min-width: 120px;\n  width: 120px;\n}\n\n.name {\n  min-width: 120px;\n  max-width: 300px;\n  font-weight: bold;\n}\n\n.status {\n  min-width: 140px;\n  width: 140px;\n  padding: 0;\n}\n\n.assignees {\n  min-width: 100px;\n  width: 100px;\n}\n\n.frames,\n.duration,\n.estimation {\n  min-width: 60px;\n  width: 60px;\n}\n\n.selected {\n  .estimation {\n    padding: 0;\n  }\n}\n\n.last-comment-date,\n.real-start-date,\n.real-end-date,\n.done-date {\n  min-width: 110px;\n  max-width: 110px;\n  width: 110px;\n}\n\nth.start-date,\nth.due-date {\n  min-width: 106px;\n  max-width: 106px;\n  width: 106px;\n}\n\ntd.start-date,\ntd.due-date {\n  text-align: center;\n  margin: 0;\n  padding: 0;\n}\n\n.retake-count {\n  min-width: 90px;\n  width: 90px;\n}\n\ntd.retake-count {\n  line-height: 0.5em;\n  color: $red;\n  font-weight: bold;\n  font-size: 1.6em;\n  padding-left: 2px;\n  white-space: nowrap;\n}\n\n.empty {\n  width: 100%;\n}\n\n.nb-tasks {\n  padding: 0.5em;\n}\n\n.table-header th {\n  padding: 0.5em 0;\n\n  &.retake-count {\n    padding-right: 1em;\n  }\n\n  &.status {\n    padding-left: 1em;\n  }\n}\n\n.datatable-head {\n  th {\n    padding-left: 5px;\n\n    &.retake-count {\n      padding-right: 1em;\n    }\n\n    &.status {\n      padding-left: 1em;\n      padding-right: 1em;\n    }\n  }\n}\n\n.input {\n  padding: 0.5em;\n}\n\n.data-list {\n  display: flex;\n  flex-direction: row;\n  margin-top: 0.6em;\n  min-height: 150px;\n  max-height: fit-content;\n}\n\n.datatable-wrapper {\n  min-height: calc(100% - 50px);\n  transition: margin-top 0.3s ease;\n\n  &.with-schedule {\n    margin-top: 54px;\n    margin-bottom: 0;\n    padding-bottom: 25px; // hack due to custom scrollbar\n    scrollbar-width: thin;\n\n    .datatable .datatable-row:last-child td:last-child {\n      border-bottom-right-radius: 0;\n    }\n\n    td {\n      height: 40px;\n    }\n  }\n}\n\n.list-wrapper {\n  overflow-x: auto;\n  overflow-y: auto;\n}\n\n.list-wrapper div:first-child h2 {\n  margin-top: 0;\n}\n\n.task-grid {\n  display: grid;\n  gap: 10px;\n  // grid-template-columns: repeat(auto-fill, 202px);\n  grid-template-columns: 204px 204px 204px 204px 204px 204px;\n\n  .task-card {\n    border: 2px solid transparent;\n    border-radius: 5px;\n    box-shadow: 0 0 2px var(--box-shadow);\n    background: var(--background-alt);\n    cursor: pointer;\n    display: flex;\n    font-weight: bold;\n    flex-direction: column;\n    padding: 0;\n    padding-bottom: 0.2em;\n    transition: border 0.3s ease;\n\n    &.selected {\n      border: 2px solid $dark-purple;\n    }\n\n    .task-name {\n      font-size: 0.9em;\n      margin-bottom: 0.5em;\n      margin-top: 0.3em;\n      padding: 0 0.5em;\n      word-break: break-word;\n    }\n    .task-data {\n      padding: 0 0.1em 0 0.3em;\n\n      .avatar-wrapper:last-child {\n        margin-right: 0;\n      }\n    }\n  }\n}\n\n.datatable-body {\n  overflow-x: auto;\n  overflow-y: scroll;\n  min-height: 100%;\n\n  td,\n  tr {\n    padding-bottom: 0;\n    padding-top: 0;\n\n    &.thumbnail {\n      padding: 6px;\n\n      .with-schedule & {\n        padding: 3px 6px;\n      }\n    }\n  }\n\n  td.retake-count {\n    padding-right: 0.5em;\n  }\n\n  td.name {\n    border-right: 1px solid var(--border);\n  }\n\n  tr.task-line {\n    cursor: pointer;\n  }\n}\n\n.error {\n  color: $red;\n}\n\ninput[type='number']::-webkit-outer-spin-button,\ninput[type='number']::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type='number'] {\n  -moz-appearance: textfield;\n}\n\n.datatable-row:hover {\n  background: var(--background-selectable);\n}\n\n.frames {\n  padding-right: 10px;\n}\n</style>\n","<template>\n  <div class=\"task-type columns fixed-page\">\n    <div class=\"column main-column\">\n      <div class=\"task-type page\" ref=\"page\">\n        <div class=\"task-type-header page-header flexrow-item\" ref=\"header\">\n          <div class=\"flexcolumn-item flexrow\">\n            <router-link class=\"back-link flexrow-item\" :to=\"backPath\">\n              <corner-left-up-icon />\n            </router-link>\n            <div class=\"flexrow-item\"></div>\n            <task-type-name\n              class=\"flexrow-item\"\n              style=\"font-size: 1.2em\"\n              :task-type=\"currentTaskType\"\n            />\n            <div class=\"filler\"></div>\n            <button-simple\n              class=\"flexrow-item\"\n              icon=\"grid\"\n              :is-on=\"contactSheetMode\"\n              :title=\"$t('tasks.show_contact_sheet')\"\n              @click=\"toggleContactSheetMode()\"\n              v-if=\"isActiveTab('tasks')\"\n            />\n            <div\n              class=\"flexrow-item\"\n              v-if=\"\n                !isActiveTab('schedule') &&\n                !isActiveTab('estimation') &&\n                isSupervisorInDepartment\n              \"\n            >\n              <button-simple\n                icon=\"import\"\n                :title=\"$t('main.csv.import_file')\"\n                @click=\"showImportModal\"\n              />\n            </div>\n            <div class=\"flexrow-item\">\n              <button-simple\n                icon=\"export\"\n                :title=\"$t('main.csv.export_file')\"\n                @click=\"onExportClick\"\n                v-if=\"!isActiveTab('schedule') && !isActiveTab('estimation')\"\n              />\n            </div>\n          </div>\n\n          <div class=\"tabs mt1\">\n            <ul>\n              <li :class=\"{ 'is-active': isActiveTab('tasks') }\">\n                <router-link :to=\"tasksPath\">\n                  {{ $t('tasks.tasks') }}\n                </router-link>\n              </li>\n              <li :class=\"{ 'is-active': isActiveTab('schedule') }\">\n                <router-link :to=\"schedulePath\">\n                  {{ $t('schedule.title') }}\n                </router-link>\n              </li>\n              <li :class=\"{ 'is-active': isActiveTab('estimation') }\">\n                <router-link :to=\"estimationPath\">\n                  {{ $t('estimation.title') }}\n                </router-link>\n              </li>\n            </ul>\n          </div>\n\n          <div class=\"flexcolumn-item flexrow align-end mb1\">\n            <div class=\"flexrow-item search-options\">\n              <search-field\n                ref=\"task-search-field\"\n                :can-save=\"true\"\n                :focus-options=\"{ preventScroll: true }\"\n                @change=\"onSearchChange\"\n                @save=\"saveSearchQuery\"\n                placeholder=\"ex: retake chara\"\n              />\n            </div>\n            <div\n              class=\"flexrow-item flexrow align-end\"\n              v-if=\"isActiveTab('tasks')\"\n            >\n              <combobox-status\n                class=\"flexrow-item selector\"\n                :label=\"$t('news.task_status')\"\n                :task-status-list=\"taskStatusList\"\n                :with-margin=\"false\"\n                v-model=\"taskStatusIdFilter\"\n              />\n              <combobox-styled\n                class=\"flexrow-item\"\n                :label=\"$t('tasks.fields.difficulty')\"\n                :options=\"difficultyOptions\"\n                locale-key-prefix=\"tasks.\"\n                v-model=\"difficultyFilter\"\n              />\n              <combobox-styled\n                class=\"flexrow-item\"\n                :label=\"$t('tasks.due_date')\"\n                :options=\"dueDateOptions\"\n                locale-key-prefix=\"tasks.\"\n                v-model=\"dueDateFilter\"\n              />\n              <combobox-styled\n                class=\"flexrow-item\"\n                :label=\"$t('tasks.late')\"\n                :options=\"estimationOptions\"\n                locale-key-prefix=\"tasks.\"\n                v-model=\"estimationFilter\"\n              />\n              <combobox-styled\n                class=\"flexrow-item\"\n                :label=\"$t('task_types.fields.priority')\"\n                :options=\"priorityOptions\"\n                locale-key-prefix=\"tasks.\"\n                v-model=\"priorityFilter\"\n              />\n            </div>\n\n            <div\n              class=\"flexrow-item flexrow align-end\"\n              v-if=\"\n                isActiveTab('schedule') ||\n                (isActiveTab('tasks') && isScheduleVisible)\n              \"\n            >\n              <div flexrow-item>\n                <label class=\"label\" v-if=\"isActiveTab('tasks')\">\n                  {{ $t('schedule.title') }}\n                </label>\n                <combobox-options\n                  class=\"display-options\"\n                  :options=\"dataDisplayOptions\"\n                  :title=\"$t('tasks.data_display')\"\n                  v-model=\"dataDisplay\"\n                  @change=\"onDataDisplayChange\"\n                />\n              </div>\n              <div\n                class=\"flexrow-item flexrow ml1\"\n                v-if=\"dataDisplay.beforeAfterTasks\"\n              >\n                <combobox-task-type\n                  class=\"flexrow-item\"\n                  :disabled=\"taskTypeListBeforeFilter.length < 2\"\n                  :label=\"$t('tasks.fields.tasks_before')\"\n                  :task-type-list=\"taskTypeListBeforeFilter\"\n                  :with-margin=\"false\"\n                  v-model=\"schedule.taskTypeBefore\"\n                  @change=\"resetScheduleItems()\"\n                />\n                <combobox-task-type\n                  class=\"flexrow-item\"\n                  :disabled=\"taskTypeListAfterFilter.length < 2\"\n                  :label=\"$t('tasks.fields.tasks_after')\"\n                  :task-type-list=\"taskTypeListAfterFilter\"\n                  :with-margin=\"false\"\n                  v-model=\"schedule.taskTypeAfter\"\n                  @change=\"resetScheduleItems()\"\n                />\n              </div>\n            </div>\n\n            <div class=\"filler\"></div>\n            <button-simple\n              :active=\"isScheduleVisible\"\n              class=\"flexrow-item\"\n              icon=\"calendar\"\n              is-medium\n              :text=\"$t('schedule.title')\"\n              @click=\"toggleSchedule()\"\n              v-if=\"isActiveTab('tasks') && !contactSheetMode\"\n            />\n            <div class=\"flexrow-item\" v-if=\"isActiveTab('tasks')\">\n              <combobox-styled\n                :label=\"$t('main.sorted_by')\"\n                :options=\"sortOptions\"\n                locale-key-prefix=\"tasks.fields.\"\n                v-model=\"currentSort\"\n              />\n            </div>\n\n            <div\n              class=\"flexrow-item\"\n              v-if=\"isActiveTab('schedule') && isCurrentUserManager\"\n            >\n              <date-field\n                class=\"flexrow-item\"\n                :can-delete=\"false\"\n                :min-date=\"startDisabledDates.to\"\n                :max-date=\"startDisabledDates.from\"\n                :label=\"$t('main.start_date')\"\n                utc\n                week-days-disabled\n                :with-margin=\"false\"\n                v-model=\"schedule.taskTypeStartDate\"\n              />\n            </div>\n            <div\n              class=\"flexrow-item\"\n              v-if=\"isActiveTab('schedule') && isCurrentUserManager\"\n            >\n              <date-field\n                class=\"flexrow-item\"\n                :can-delete=\"false\"\n                :min-date=\"endDisabledDates.to\"\n                :max-date=\"endDisabledDates.from\"\n                :label=\"$t('main.end_date')\"\n                utc\n                week-days-disabled\n                :with-margin=\"false\"\n                v-model=\"schedule.taskTypeEndDate\"\n              />\n            </div>\n\n            <div\n              class=\"flexrow-item color-option\"\n              v-if=\"isActiveTab('schedule')\"\n            >\n              <combobox-styled\n                class=\"flexrow-item\"\n                :label=\"$t('tasks.colors.title')\"\n                :options=\"schedule.colorOptions\"\n                locale-key-prefix=\"tasks.colors.\"\n                no-field\n                v-model=\"schedule.currentColor\"\n              />\n            </div>\n            <div class=\"flexrow-item zoom-level\" v-if=\"isActiveTab('schedule')\">\n              <combobox-number\n                class=\"mt0 nowrap\"\n                :label=\"$t('schedule.zoom_level')\"\n                :options=\"schedule.zoomOptions\"\n                no-field\n                v-model=\"schedule.zoomLevel\"\n                v-if=\"isActiveTab('schedule')\"\n              />\n            </div>\n          </div>\n        </div>\n        <div\n          class=\"query-list\"\n          v-if=\"!loading.entities && searchQueries.length\"\n        >\n          <search-query-list\n            :queries=\"searchQueries\"\n            type=\"taskType\"\n            @remove-search=\"removeSearchQuery\"\n          />\n        </div>\n\n        <task-list\n          ref=\"task-list\"\n          :disabled-dates=\"disabledDates\"\n          :entity-type=\"entityType\"\n          :is-contact-sheet=\"contactSheetMode\"\n          :is-error=\"errors.entities\"\n          :is-grouped=\"currentSort === 'entity_name'\"\n          :is-loading=\"loading.entities\"\n          :tasks=\"tasks\"\n          :with-schedule=\"isScheduleVisible\"\n          @task-selected=\"onTaskSelected\"\n          @scroll=\"onTaskListScroll\"\n          v-if=\"isActiveTab('tasks')\"\n        >\n          <schedule\n            ref=\"schedule-widget\"\n            class=\"task-schedule\"\n            :start-date=\"productionStartDate\"\n            :end-date=\"productionEndDate\"\n            :sub-start-date=\"taskTypeStartDate\"\n            :sub-end-date=\"taskTypeEndDate\"\n            hide-entities\n            hide-root\n            :hierarchy=\"schedule.scheduleItems\"\n            :zoom-level=\"schedule.zoomLevel\"\n            :is-loading=\"loading.entities\"\n            invert-lines-color\n            is-estimation-linked\n            :with-estimations=\"dataDisplay.estimations\"\n            :with-ghosts=\"dataDisplay.beforeAfterTasks\"\n            :with-statuses=\"dataDisplay.statuses\"\n            :with-timesheets=\"dataDisplay.timesheets\"\n            @item-changed=\"saveTaskScheduleItem\"\n            @root-element-expanded=\"expandPersonElement\"\n            @estimation-changed=\"updateEstimation\"\n            @scroll=\"onScheduleScroll\"\n            v-if=\"isScheduleVisible && !contactSheetMode\"\n          />\n        </task-list>\n\n        <div\n          class=\"task-type-schedule flexrow-item\"\n          v-if=\"isActiveTab('schedule')\"\n        >\n          <schedule\n            ref=\"schedule-widget\"\n            :start-date=\"productionStartDate\"\n            :end-date=\"productionEndDate\"\n            :sub-start-date=\"taskTypeStartDate\"\n            :sub-end-date=\"taskTypeEndDate\"\n            :hierarchy=\"schedule.scheduleItems\"\n            :zoom-level=\"schedule.zoomLevel\"\n            :is-loading=\"loading.entities\"\n            :is-estimation-linked=\"true\"\n            :with-estimations=\"dataDisplay.estimations\"\n            :with-ghosts=\"dataDisplay.beforeAfterTasks\"\n            :with-statuses=\"dataDisplay.statuses\"\n            :with-timesheets=\"dataDisplay.timesheets\"\n            @item-changed=\"saveTaskScheduleItem\"\n            @root-element-expanded=\"expandPersonElement\"\n            @estimation-changed=\"updateEstimation\"\n          />\n\n          <task-list-numbers\n            :is-shots=\"entityType === 'Shot'\"\n            :tasks=\"tasks\"\n            v-if=\"!loading.entities\"\n          />\n        </div>\n\n        <div\n          class=\"task-type-estimation flexrow-item\"\n          v-if=\"isActiveTab('estimation')\"\n        >\n          <estimation-helper\n            ref=\"estimation-widget\"\n            :entity-type=\"entityType\"\n            :tasks=\"tasks\"\n            @estimation-changed=\"updateEstimation\"\n          />\n        </div>\n\n        <import-render-modal\n          :active=\"modals.isImportRenderDisplayed\"\n          :is-loading=\"loading.importing\"\n          :is-error=\"errors.importing\"\n          :import-error=\"errors.importingError\"\n          :parsed-csv=\"parsedCSV\"\n          :form-data=\"importCsvFormData\"\n          :columns=\"[...dataMatchers, ...optionalColumns]\"\n          :data-matchers=\"dataMatchers\"\n          :database=\"{}\"\n          :disable-update=\"true\"\n          @reupload=\"resetImport\"\n          @cancel=\"hideImportRenderModal\"\n          @confirm=\"uploadImportFile\"\n        />\n\n        <import-modal\n          ref=\"import-modal\"\n          :active=\"modals.importing\"\n          :is-loading=\"loading.importing\"\n          :is-error=\"errors.importing\"\n          :form-data=\"importCsvFormData\"\n          :columns=\"dataMatchers\"\n          :optional-columns=\"optionalColumns\"\n          @cancel=\"hideImportModal\"\n          @confirm=\"renderImport\"\n        />\n      </div>\n    </div>\n\n    <div class=\"column side-column\" v-if=\"nbSelectedTasks >= 1\">\n      <task-info :task=\"selectedTasks.values().next().value\" with-actions />\n    </div>\n  </div>\n</template>\n\n<script>\nimport assetsStore from '@/store/modules/assets.js'\nimport editsStore from '@/store/modules/edits.js'\nimport episodesStore from '@/store/modules/episodes.js'\nimport sequencesStore from '@/store/modules/sequences.js'\nimport shotsStore from '@/store/modules/shots.js'\nimport taskStatusStore from '@/store/modules/taskstatus.js'\nimport taskTypeStore from '@/store/modules/tasktypes.js'\n\nimport { CornerLeftUpIcon } from 'lucide-vue-next'\nimport moment from 'moment'\nimport { firstBy } from 'thenby'\nimport { mapGetters, mapActions } from 'vuex'\n\nimport csv from '@/lib/csv'\nimport { buildSupervisorTaskIndex, indexSearch } from '@/lib/indexing'\nimport { getPersonPath } from '@/lib/path'\nimport { sortByName, sortPeople } from '@/lib/sorting'\nimport stringHelpers from '@/lib/string'\nimport {\n  addBusinessDays,\n  daysToMinutes,\n  formatSimpleDate,\n  getDatesFromStartDate,\n  minutesToDays,\n  parseDate\n} from '@/lib/time'\nimport {\n  applyFilters,\n  getDescFilters,\n  getExcludingKeyWords,\n  getKeyWords,\n  getTaskFilters\n} from '@/lib/filtering'\n\nimport { formatListMixin } from '@/components/mixins/format'\nimport { searchMixin } from '@/components/mixins/search'\n\nimport ButtonSimple from '@/components/widgets/ButtonSimple.vue'\nimport ComboboxNumber from '@/components/widgets/ComboboxNumber.vue'\nimport ComboboxOptions from '@/components/widgets/ComboboxOptions.vue'\nimport ComboboxStatus from '@/components/widgets/ComboboxStatus.vue'\nimport ComboboxStyled from '@/components/widgets/ComboboxStyled.vue'\nimport ComboboxTaskType from '@/components/widgets/ComboboxTaskType.vue'\nimport DateField from '@/components/widgets/DateField.vue'\nimport EstimationHelper from '@/components/pages/tasktype/EstimationHelper.vue'\nimport ImportModal from '@/components/modals/ImportModal.vue'\nimport ImportRenderModal from '@/components/modals/ImportRenderModal.vue'\nimport Schedule from '@/components/widgets/Schedule.vue'\nimport SearchField from '@/components/widgets/SearchField.vue'\nimport SearchQueryList from '@/components/widgets/SearchQueryList.vue'\nimport TaskInfo from '@/components/sides/TaskInfo.vue'\nimport TaskList from '@/components/lists/TaskList.vue'\nimport TaskListNumbers from '@/components/widgets/TaskListNumbers.vue'\nimport TaskTypeName from '@/components/widgets/TaskTypeName.vue'\n\nconst filters = {\n  all(tasks) {\n    return tasks\n  },\n\n  dueweek(tasks) {\n    const todayWeek = moment().isoWeek()\n    return tasks.filter(t => {\n      const dueDate = parseDate(t.due_date)\n      return dueDate.isoWeek() === todayWeek\n    })\n  },\n\n  duepreviousweek(tasks) {\n    const previousWeek = moment().add(-7, 'days').isoWeek()\n    return tasks.filter(t => {\n      const dueDate = parseDate(t.due_date)\n      return dueDate.isoWeek() === previousWeek\n    })\n  },\n\n  duenextweek(tasks) {\n    const nextWeek = moment().add(7, 'days').isoWeek()\n    return tasks.filter(t => {\n      const dueDate = parseDate(t.due_date)\n      return dueDate.isoWeek() === nextWeek\n    })\n  },\n\n  duebeforetoday(tasks) {\n    const today = moment()\n    return tasks.filter(t => {\n      const dueDate = parseDate(t.due_date)\n      return dueDate.isBefore(today)\n    })\n  },\n\n  duemonth(tasks) {\n    const todayMonth = moment().month()\n    return tasks.filter(t => {\n      const dueDate = parseDate(t.due_date)\n      return dueDate.month() === todayMonth\n    })\n  },\n\n  duepreviousmonth(tasks) {\n    const previousMonth = moment().add(-1, 'months').month()\n    return tasks.filter(t => {\n      const dueDate = parseDate(t.due_date)\n      return dueDate.month() === previousMonth\n    })\n  },\n\n  duenextmonth(tasks) {\n    const nextMonth = moment().add(1, 'months').month()\n    return tasks.filter(t => {\n      const dueDate = parseDate(t.due_date)\n      return dueDate.month() === nextMonth\n    })\n  },\n\n  dueaftertoday(tasks) {\n    const today = moment()\n    return tasks.filter(t => {\n      const dueDate = parseDate(t.due_date)\n      return dueDate.isAfter(today)\n    })\n  },\n\n  overestimation(tasks) {\n    return tasks.filter(t => {\n      return t.estimation && t.duration > t.estimation\n    })\n  },\n\n  approvallate(tasks, taskStatusMap) {\n    const today = moment()\n    return tasks.filter(t => {\n      const dueDate = parseDate(t.due_date)\n      return (\n        dueDate.isBefore(today) &&\n        !(\n          taskStatusMap.get(t.task_status_id).is_feedback_request ||\n          taskStatusMap.get(t.task_status_id).is_done\n        )\n      )\n    })\n  },\n\n  donelate(tasks, taskStatusMap) {\n    const today = moment()\n    return tasks.filter(t => {\n      const dueDate = parseDate(t.due_date)\n      return (\n        dueDate.isBefore(today) && !taskStatusMap.get(t.task_status_id).is_done\n      )\n    })\n  }\n}\n\nexport default {\n  name: 'task-type',\n\n  mixins: [formatListMixin, searchMixin],\n\n  components: {\n    ButtonSimple,\n    CornerLeftUpIcon,\n    ComboboxNumber,\n    ComboboxOptions,\n    ComboboxStatus,\n    ComboboxStyled,\n    ComboboxTaskType,\n    DateField,\n    EstimationHelper,\n    ImportModal,\n    ImportRenderModal,\n    Schedule,\n    SearchField,\n    SearchQueryList,\n    TaskList,\n    TaskInfo,\n    TaskListNumbers,\n    TaskTypeName\n  },\n\n  data() {\n    return {\n      activeTab: 'tasks',\n      daysOffByPerson: {},\n      timesheetByPerson: {},\n      currentSort: 'entity_name',\n      currentScheduleItem: null,\n      currentTask: null,\n      contactSheetMode: false,\n      dataDisplay: {\n        estimations: true,\n        statuses: true,\n        timesheets: false,\n        beforeAfterTasks: false\n      },\n      dataDisplayOptions: [\n        {\n          label: this.$t('tasks.fields.estimation'),\n          value: 'estimations'\n        },\n        {\n          label: this.$t('tasks.fields.task_status'),\n          value: 'statuses'\n        },\n        {\n          label: this.$t('tasks.fields.timesheets'),\n          value: 'timesheets'\n        },\n        {\n          label: this.$t('tasks.fields.before_after_tasks'),\n          value: 'beforeAfterTasks'\n        }\n      ],\n      dataMatchers: ['Parent', 'Entity'],\n      difficultyFilter: '-1',\n      dueDateFilter: 'all',\n      entityType: 'Asset',\n      estimationFilter: 'all',\n      importCsvFormData: {},\n      isScheduleVisible: false,\n      optionalColumns: ['Estimation', 'Start date', 'Due date', 'Difficulty'],\n      parsedCSV: [],\n      priorityFilter: '-1',\n      selection: {},\n      tasks: [],\n      taskStatusIdFilter: null,\n      difficultyOptions: [\n        { label: 'all_tasks', value: '-1' },\n        { label: 'difficulty.very_easy', value: '1' },\n        { label: 'difficulty.easy', value: '2' },\n        { label: 'difficulty.medium', value: '3' },\n        { label: 'difficulty.hard', value: '4' },\n        { label: 'difficulty.very_hard', value: '5' }\n      ],\n      dueDateOptions: [\n        { label: 'all_tasks', value: 'all' },\n        { label: 'due_this_week', value: 'dueweek' },\n        { label: 'due_previous_week', value: 'duepreviousweek' },\n        { label: 'due_next_week', value: 'duenextweek' },\n        { label: 'due_this_month', value: 'duemonth' },\n        { label: 'due_previous_month', value: 'duepreviousmonth' },\n        { label: 'due_next_month', value: 'duenextmonth' },\n        { label: 'due_before_today', value: 'duebeforetoday' },\n        { label: 'due_after_today', value: 'dueaftertoday' }\n      ],\n      estimationOptions: [\n        { label: 'all_tasks', value: 'all' },\n        { label: 'estimation_over', value: 'overestimation' },\n        { label: 'estimation_approval_late', value: 'approvallate' },\n        { label: 'estimation_done_late', value: 'donelate' }\n      ],\n      errors: {\n        entities: false,\n        importing: false,\n        importingError: null\n      },\n      loading: {\n        entities: false,\n        importing: false,\n        savingSearch: false\n      },\n      modals: {\n        isImportRenderDisplayed: false,\n        importing: false\n      },\n      priorityOptions: [\n        { label: 'all_tasks', value: '-1' },\n        { label: 'priority.normal', value: '0' },\n        { label: 'priority.high', value: '1' },\n        { label: 'priority.very_high', value: '2' },\n        { label: 'priority.emergency', value: '3' }\n      ],\n      schedule: {\n        currentColor: 'status',\n        startDate: null,\n        endDate: null,\n        scheduleItems: [],\n        taskTypeAfter: null,\n        taskTypeBefore: null,\n        taskTypeEndDate: null,\n        taskTypeStartDate: null,\n        zoomLevel: 1,\n        zoomOptions: [\n          { label: this.$t('main.week'), value: 0 },\n          { label: '1', value: 1 },\n          { label: '2', value: 2 },\n          { label: '3', value: 3 }\n        ],\n        colorOptions: [\n          { label: 'Neutral', value: 'neutral' },\n          { label: 'Status', value: 'status' },\n          { label: 'Late', value: 'late' }\n        ]\n      }\n    }\n  },\n\n  created() {\n    if (!this.currentProduction) {\n      this.setProduction(this.$route.params.production_id)\n    } else {\n      const options = { productionId: this.currentProduction.id }\n      if (this.currentEpisode) options.episodeId = this.currentEpisode.id\n      this.$store.commit('RESET_PRODUCTION_PATH', options)\n    }\n  },\n\n  mounted() {\n    if (!this.currentTaskType?.id) {\n      this.$router.push({ name: 'not-found' })\n      return\n    }\n\n    this.setOptionalImportColumns()\n    this.searchField?.setValue(this.$route.query.search || '')\n    this.clearSelectedTasks()\n    const isAssets = this.$route.path.includes('assets')\n    const isShots = this.$route.path.includes('shots')\n    const isEdits = this.$route.path.includes('edits')\n    const isSequences = this.$route.path.includes('sequences')\n    this.entityType = isAssets\n      ? 'Asset'\n      : isShots\n        ? 'Shot'\n        : isEdits\n          ? 'Edit'\n          : isSequences\n            ? 'Sequence'\n            : 'Episode'\n    this.updateActiveTab()\n    setTimeout(() => {\n      this.initData(false)\n      this.resetScheduleScroll()\n    }, 100)\n  },\n\n  beforeUnmount() {\n    this.clearSelectedTasks()\n  },\n\n  computed: {\n    ...mapGetters([\n      'assetsPath',\n      'assetValidationColumns',\n      'currentEpisode',\n      'currentProduction',\n      'currentTaskType',\n      'editsPath',\n      'editValidationColumns',\n      'episodesPath',\n      'episodeValidationColumns',\n      'isCurrentUserManager',\n      'isCurrentUserSupervisor',\n      'isPaperProduction',\n      'isTVShow',\n      'nbSelectedTasks',\n      'organisation',\n      'personMap',\n      'productionTaskStatuses',\n      'selectedTasks',\n      'sequenceSubscriptions',\n      'sequencesPath',\n      'sequenceValidationColumns',\n      'shotsByEpisode',\n      'shotsPath',\n      'shotValidationColumns',\n      'taskMap',\n      'taskSearchQueries',\n      'user'\n    ]),\n\n    isEpisodesSection() {\n      return this.$route.meta.section === 'episodes'\n    },\n\n    taskStatusList() {\n      return [\n        {\n          id: '',\n          color: '#999',\n          short_name: this.$t('news.all')\n        }\n      ].concat(sortByName([...this.productionTaskStatuses]))\n    },\n\n    taskTypeList() {\n      const type = this.entityType.toLowerCase()\n      return this[`${type}ValidationColumns`].map(taskTypeId =>\n        this.taskTypeMap.get(taskTypeId)\n      )\n    },\n\n    taskTypeListBeforeFilter() {\n      const currentIndex = this.taskTypeList.findIndex(\n        taskType => taskType.id === this.currentTaskType.id\n      )\n      const results = [{ id: null, name: this.$t('tasks.fields.no_task_type') }]\n      if (currentIndex !== -1) {\n        results.push(...this.taskTypeList.slice(0, currentIndex).reverse())\n      }\n      return results\n    },\n\n    taskTypeListAfterFilter() {\n      const currentIndex = this.taskTypeList.findIndex(\n        taskType => taskType.id === this.currentTaskType.id\n      )\n      const results = [{ id: null, name: this.$t('tasks.fields.no_task_type') }]\n      if (currentIndex !== -1) {\n        results.push(...this.taskTypeList.slice(currentIndex + 1))\n      }\n      return results\n    },\n\n    currentTaskTypeBefore() {\n      return this.taskTypeList.find(\n        taskType => taskType.id === this.schedule.taskTypeBefore\n      )\n    },\n\n    currentTaskTypeAfter() {\n      return this.taskTypeList.find(\n        taskType => taskType.id === this.schedule.taskTypeAfter\n      )\n    },\n\n    taskTypeStartDate() {\n      return moment(this.schedule.taskTypeStartDate).utc()\n    },\n\n    taskTypeEndDate() {\n      return moment(this.schedule.taskTypeEndDate).utc()\n    },\n\n    isSupervisorInDepartment() {\n      const departments = this.user.departments || []\n      return (\n        this.isCurrentUserManager ||\n        (this.isCurrentUserSupervisor &&\n          (!departments.length ||\n            departments.includes((this.currentTaskType || {}).department_id)))\n      )\n    },\n\n    entityMap() {\n      return this[`${this.entityType.toLowerCase()}Map`]\n    },\n\n    assetMap() {\n      return assetsStore.cache.assetMap\n    },\n\n    editMap() {\n      return editsStore.cache.editMap\n    },\n\n    episodeMap() {\n      return episodesStore.cache.episodeMap\n    },\n\n    sequenceMap() {\n      return sequencesStore.cache.sequenceMap\n    },\n\n    shotMap() {\n      return shotsStore.cache.shotMap\n    },\n\n    taskStatusMap() {\n      return taskStatusStore.cache.taskStatusMap\n    },\n\n    taskTypeMap() {\n      return taskTypeStore.cache.taskTypeMap\n    },\n\n    productionStartDate() {\n      return parseDate(this.currentProduction.start_date)\n    },\n\n    productionEndDate() {\n      return parseDate(this.currentProduction.end_date)\n    },\n\n    disabledDates() {\n      return {\n        to: parseDate(this.currentProduction.start_date).toDate(),\n        from: parseDate(this.currentProduction.end_date).toDate(),\n        days: [6, 0]\n      }\n    },\n\n    startDisabledDates() {\n      return {\n        to: parseDate(this.currentProduction.start_date).toDate(),\n        from: parseDate(this.currentProduction.end_date).toDate(),\n        days: [6, 0]\n      }\n    },\n\n    endDisabledDates() {\n      return {\n        to: parseDate(this.currentProduction.start_date).toDate(),\n        from: parseDate(this.currentProduction.end_date).toDate(),\n        days: [6, 0]\n      }\n    },\n\n    entityTasks() {\n      return this.getTasks(Array.from(this.entityMap.values()))\n    },\n\n    // Meta\n\n    title() {\n      if (this.currentProduction) {\n        if (this.isTVShow && this.currentEpisode) {\n          const episodeName =\n            this.currentEpisode.id === 'all'\n              ? this.$t('main.all_assets')\n              : this.currentEpisode.name\n          return (\n            `${this.currentProduction.name} / ` +\n            `${episodeName} / ` +\n            `${this.currentTaskType.name}`\n          )\n        }\n        return `${this.currentProduction.name} / ${this.currentTaskType.name}`\n      }\n      return this.$t('main.loading')\n    },\n\n    // Paths\n\n    backPath() {\n      let route = {}\n      if (this.isActiveTab('schedule')) {\n        route = {\n          name: 'schedule',\n          params: {\n            production_id: this.currentProduction.id\n          },\n          query: { search: '' }\n        }\n      } else {\n        if (this.currentTaskType.for_entity === 'Shot') {\n          route = this.shotsPath\n        }\n        if (this.currentTaskType.for_entity === 'Asset') {\n          route = this.assetsPath\n        }\n        if (this.currentTaskType.for_entity === 'Edit') {\n          route = this.editsPath\n        }\n        if (this.currentTaskType.for_entity === 'Episode') {\n          route = this.episodesPath\n        }\n        if (this.currentTaskType.for_entity === 'Sequence') {\n          route = this.sequencesPath\n        }\n      }\n      return {\n        ...route,\n        query: { search: '' }\n      }\n    },\n\n    tasksPath() {\n      return this.getRoute('task-type')\n    },\n\n    schedulePath() {\n      return this.getRoute('task-type-schedule')\n    },\n\n    estimationPath() {\n      return this.getRoute('task-type-estimation')\n    },\n\n    // Helpers\n\n    sortOptions() {\n      return [\n        'entity_name',\n        'task_status_short_name',\n        'priority',\n        'nb_frames',\n        'difficulty',\n        'estimation',\n        'duration',\n        'retake_count',\n        'start_date',\n        'due_date',\n        'real_start_date',\n        'end_date',\n        'last_comment_date'\n      ].map(name => ({ label: name, value: name }))\n    },\n\n    searchQueries() {\n      return this.taskSearchQueries.filter(\n        t => t.entity_type === this.entityType\n      )\n    },\n\n    team() {\n      return sortPeople(\n        this.currentProduction.team\n          .map(personId => this.personMap.get(personId))\n          .filter(person => person && !person.is_bot)\n      )\n    },\n\n    searchField() {\n      return this.$refs['task-search-field']\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'addSelectedTask',\n      'clearSelectedTasks',\n      'initTaskType',\n      'loadAggregatedPersonDaysOff',\n      'loadEpisodeScheduleItems',\n      'loadProductionDaysOff',\n      'loadProductionTimeSpents',\n      'loadScheduleItems',\n      'removeTaskSearch',\n      'saveScheduleItem',\n      'saveTaskSearch',\n      'setProduction',\n      'subscribeToSequence',\n      'updateTask',\n      'unsubscribeFromSequence',\n      'uploadTaskTypeEstimations'\n    ]),\n\n    setOptionalImportColumns() {\n      this.optionalColumns = [\n        'Estimation',\n        'Start date',\n        'Due date',\n        'Difficulty'\n      ]\n      if (this.isPaperProduction) {\n        this.optionalColumns.unshift('Drawings')\n      }\n    },\n\n    initData(force) {\n      this.resetTasks()\n      this.focusSearchField({ preventScroll: true })\n      if (this.tasks.length < 2) {\n        this.loading.entities = true\n        this.errors.entities = false\n        this.initTaskType(force)\n          .then(this.setCurrentScheduleItem)\n          .then(() => {\n            this.loading.entities = false\n            this.resetTasks()\n            this.focusSearchField({ preventScroll: true })\n            let searchQuery = this.$route.query.search\n            if (!searchQuery && this.searchField) {\n              searchQuery = this.searchField.getValue()\n            }\n            if (searchQuery) this.onSearchChange(searchQuery)\n            setTimeout(() => {\n              this.setSearchFromUrl()\n              this.resetTaskTypeDates()\n            }, 200)\n            this.resetScheduleItems(true)\n\n            this.dueDateFilter = this.$route.query.duedate || 'all'\n            this.estimationFilter = this.$route.query.late || 'all'\n            this.priorityFilter = this.$route.query.priority || '-1'\n            this.difficultyFilter = this.$route.query.difficulty || '-1'\n            this.taskStatusIdFilter = this.$route.query.task_status_id || ''\n\n            const taskId = this.$route.query.task_id\n            const task = this.taskMap.get(taskId)\n            if (task) {\n              const index = this.tasks.findIndex(t => t.id === taskId)\n              this.$nextTick(() => {\n                this.$refs['task-list']?.selectTask({}, index, task)\n              })\n            }\n          })\n          .catch(err => {\n            console.error(err)\n            this.loading.entities = false\n            this.errors.entities = true\n          })\n      } else {\n        this.loading.entities = true\n        this.setCurrentScheduleItem().then(() => {\n          this.resetTaskTypeDates()\n          this.loading.entities = false\n          let searchQuery = this.$route.query.search\n          if (!searchQuery && this.searchField) {\n            searchQuery = this.searchField.getValue()\n          }\n          if (searchQuery) this.onSearchChange(searchQuery)\n          this.resetScheduleItems(true)\n        })\n      }\n    },\n\n    setCurrentScheduleItem() {\n      if (this.isTVShow && !['all', 'main'].includes(this.currentEpisode.id)) {\n        return this.loadEpisodeScheduleItems({\n          production: this.currentProduction,\n          taskType: this.currentTaskType\n        }).then(items => {\n          this.currentScheduleItem = items.find(\n            item =>\n              item.task_type_id === this.currentTaskType.id &&\n              item.object_id === this.currentEpisode.id\n          )\n          return this.currentScheduleItem\n        })\n      }\n      return this.loadScheduleItems(this.currentProduction).then(items => {\n        this.currentScheduleItem = items.find(\n          item => item.task_type_id === this.currentTaskType.id\n        )\n        return this.currentScheduleItem\n      })\n    },\n\n    // Tabs\n\n    isActiveTab(tab) {\n      return this.activeTab === tab\n    },\n\n    updateActiveTab() {\n      if (this.$route.path.indexOf('schedule') > 0) {\n        this.activeTab = 'schedule'\n      } else if (this.$route.path.indexOf('estimation') > 0) {\n        this.activeTab = 'estimation'\n      } else {\n        this.activeTab = 'tasks'\n      }\n    },\n\n    getRoute(section) {\n      const routeTaskTypeId = this.$route.params.task_type_id\n      const taskTypeId = this.currentTaskType\n        ? this.currentTaskType.id\n        : routeTaskTypeId\n      const route = {\n        name: section,\n        params: {\n          production_id: this.currentProduction.id,\n          task_type_id: taskTypeId\n        }\n      }\n      if (this.currentTaskType.for_entity === 'Episode') {\n        route.name = `episodes-${route.name}`\n      } else if (this.isTVShow && this.currentEpisode) {\n        route.name = `episode-${route.name}`\n        route.params.episode_id = this.currentEpisode.id\n      }\n\n      return route\n    },\n\n    // Search\n\n    onSearchChange(query) {\n      if (query && query.length !== 1) {\n        query = query.toLowerCase().trim()\n        const descriptors = (this.currentProduction.descriptors || []).filter(\n          d => {\n            return d.entity_type === this.entityType\n          }\n        )\n        const keywords = getKeyWords(query) || []\n        const excludingKeyWords = getExcludingKeyWords(query) || []\n        const descFilters = getDescFilters(descriptors, [], query)\n        const taskFilters = getTaskFilters(this.$options.taskIndex, query)\n        if (\n          keywords.length > 0 ||\n          excludingKeyWords.length > 0 ||\n          descFilters.length > 0 ||\n          taskFilters.length > 0\n        ) {\n          let tasks\n          const filters = taskFilters.concat(descFilters)\n          if (keywords.length > 0) {\n            tasks = indexSearch(this.$options.taskIndex, keywords)\n          } else {\n            this.resetTasks()\n            tasks = this.tasks\n          }\n          tasks = applyFilters(tasks, filters, this.taskMap)\n          this.tasks = this.sortTasks(tasks)\n        } else {\n          this.resetTasks()\n        }\n      } else {\n        this.resetTasks()\n      }\n\n      this.resetScheduleItems()\n      this.setSearchInUrl()\n      this.clearSelectedTasks()\n\n      if (filters[this.dueDateFilter]) {\n        this.tasks = filters[this.dueDateFilter](this.tasks)\n      }\n      if (filters[this.estimationFilter]) {\n        this.tasks = filters[this.estimationFilter](\n          this.tasks,\n          this.taskStatusMap\n        )\n      }\n      if (this.priorityFilter !== '-1') {\n        this.tasks = this.tasks.filter(\n          t => t.priority === parseInt(this.priorityFilter)\n        )\n      }\n      if (this.difficultyFilter !== '-1') {\n        this.tasks = this.tasks.filter(\n          t => t.difficulty === parseInt(this.difficultyFilter)\n        )\n      }\n      if (this.taskStatusIdFilter !== null && this.taskStatusIdFilter !== '') {\n        this.tasks = this.tasks.filter(\n          t => t.task_status_id === this.taskStatusIdFilter\n        )\n      }\n    },\n\n    saveSearchQuery(searchQuery) {\n      if (this.loading.savingSearch) {\n        return\n      }\n      const entityType = this.entityType\n      this.loading.savingSearch = true\n      this.saveTaskSearch({ searchQuery, entityType })\n        .catch(console.error)\n        .finally(() => {\n          this.loading.savingSearch = false\n        })\n    },\n\n    removeSearchQuery(searchQuery) {\n      this.removeTaskSearch(searchQuery).catch(console.error)\n    },\n\n    updateUrlParams() {\n      const search = this.searchField.getValue()\n      const duedate = this.dueDateFilter\n      const late = this.estimationFilter\n      const priority = this.priorityFilter\n      const difficulty = this.difficultyFilter\n      const taskStatusId = this.taskStatusIdFilter || null\n      this.$router.push({\n        query: {\n          search,\n          duedate,\n          late,\n          priority,\n          difficulty,\n          task_status_id: taskStatusId\n        }\n      })\n    },\n\n    // Tasks\n\n    applyTaskFilters() {\n      this.onSearchChange(this.searchField.getValue())\n      this.sortTasks()\n      this.$refs['task-list']?.resetSelection()\n      this.updateUrlParams()\n      this.clearSelectedTasks()\n    },\n\n    onTaskSelected(task) {\n      this.currentTask = task\n      this.updateTaskInQuery()\n    },\n\n    onTaskListScroll({ top }) {\n      this.$refs['schedule-widget']?.setScrollPosition(top)\n    },\n\n    onScheduleScroll({ top }) {\n      this.$refs['task-list']?.setScrollPosition(top)\n    },\n\n    toggleContactSheetMode() {\n      this.contactSheetMode = !this.contactSheetMode\n      this.isScheduleVisible = false\n    },\n\n    toggleSchedule() {\n      this.isScheduleVisible = !this.isScheduleVisible\n      this.resetScheduleItems(true)\n    },\n\n    updateTaskInQuery() {\n      if (this.nbSelectedTasks === 1) {\n        const selectedTaskIds = Array.from(this.selectedTasks.keys())\n        const taskId = selectedTaskIds[0]\n        this.$router.push({\n          query: {\n            ...this.$route.query,\n            task_id: taskId\n          }\n        })\n      } else {\n        this.$router.push({\n          query: {\n            ...this.$route.query,\n            task_id: undefined\n          }\n        })\n      }\n    },\n\n    resetTasks() {\n      let tasks = this.entityTasks\n\n      if (['Episode', 'Sequence'].includes(this.entityTypes)) {\n        tasks = tasks.filter(task => {\n          const entity = this.entityMap.get(task.entity_id)\n          return !entity.canceled\n        })\n      }\n      this.tasks = this.sortTasks(tasks)\n      this.resetTaskIndex()\n    },\n\n    resetTaskIndex() {\n      if (!this.entityTasks) return\n      this.$options.taskIndex = buildSupervisorTaskIndex(\n        this.entityTasks,\n        this.personMap,\n        this.taskStatusMap\n      )\n      this.$options.taskIndex.me = indexSearch(\n        this.$options.taskIndex,\n        this.user.full_name.split(' ')\n      )\n    },\n\n    getTasks(entities) {\n      const tasks = []\n      entities.forEach(entity => {\n        if (\n          entity.canceled ||\n          !entity.tasks?.length ||\n          (this.isTVShow &&\n            !this.isEpisodesSection &&\n            !['all', entity.episode_id || 'main'].includes(\n              this.currentEpisode?.id\n            ))\n        ) {\n          return\n        }\n        entity.tasks.forEach(taskId => {\n          const task = this.taskMap.get(taskId.id || taskId)\n          if (task) {\n            // Hack to allow filtering on linked entity metadata.\n            this.$store.commit('SET_TASK_EXTRA_DATA', {\n              task,\n              data: entity.data\n            })\n            if (task.task_type_id === this.currentTaskType.id) {\n              tasks.push(task)\n            }\n          }\n        })\n      })\n      return tasks\n    },\n\n    sortTasks(tasks) {\n      if (!tasks) tasks = this.tasks\n      const isDesc = [\n        'task_status_short_name',\n        'entity_name',\n        'due_date'\n      ].includes(this.currentSort)\n      if (this.currentSort === 'nb_frames') {\n        this.tasks = tasks.sort((ta, tb) => {\n          const nbFramesA = this.getEntity(ta.entity.id)?.nb_frames || 0\n          const nbFramesB = this.getEntity(tb.entity.id)?.nb_frames || 0\n          return nbFramesB - nbFramesA\n        })\n      } else if (this.currentSort !== name) {\n        this.tasks = tasks.sort(\n          firstBy(this.currentSort, isDesc ? 1 : -1).thenBy('entity_name')\n        )\n      } else {\n        this.tasks = tasks.sort(firstBy('entity_name'))\n      }\n      return tasks\n    },\n\n    getEntity(entityId) {\n      return this[`${this.entityType.toLowerCase()}Map`].get(entityId) || {}\n    },\n\n    onExportClick() {\n      const taskLines = this.$refs['task-list'].getTableData()\n      const nameData = [\n        formatSimpleDate(moment()),\n        this.currentProduction.name,\n        this.currentTaskType.name,\n        'tasks'\n      ]\n      if (this.currentEpisode) {\n        nameData.splice(1, 0, this.currentEpisode.name)\n      }\n      const name = stringHelpers.slugify(nameData.join('_'))\n      csv.buildCsvFile(name, taskLines)\n    },\n\n    updateEstimation({ taskId, days, item, daysOff }) {\n      const estimation = daysToMinutes(this.organisation, days)\n      const task = this.taskMap.get(taskId)\n      let data = { estimation }\n      if (task.start_date) {\n        const startDate = parseDate(task.start_date)\n        const dueDate = task.due_date ? parseDate(task.due_date) : null\n        data = {\n          ...data,\n          ...getDatesFromStartDate(\n            this.organisation,\n            startDate,\n            dueDate,\n            minutesToDays(this.organisation, estimation),\n            daysOff\n          )\n        }\n        if (item) {\n          item.startDate = parseDate(data.start_date)\n          item.endDate = parseDate(data.due_date)\n\n          if (item.startDate && item.endDate) {\n            item.parentElement.startDate = this.getMinDate(item.parentElement)\n            item.parentElement.endDate = this.getMaxDate(item.parentElement)\n          }\n        }\n      }\n      this.updateTask({ taskId, data }).catch(console.error)\n    },\n\n    // Schedule\n\n    onDataDisplayChange(item) {\n      if (item.key === 'timesheets' && item.value) {\n        this.resetScheduleItems()\n        return\n      }\n\n      if (item.key === 'beforeAfterTasks' && item.value) {\n        if (!this.schedule.taskTypeBefore) {\n          this.schedule.taskTypeBefore = this.taskTypeListBeforeFilter[1]?.id\n        }\n        if (!this.schedule.taskTypeAfter) {\n          this.schedule.taskTypeAfter = this.taskTypeListAfterFilter[1]?.id\n        }\n        this.resetScheduleItems()\n      }\n    },\n\n    async resetScheduleItems(resetScroll = false) {\n      if (this.isActiveTab('schedule')) {\n        await this.resetScheduleItemsForScheduleTab()\n      } else if (this.isActiveTab('tasks') && this.isScheduleVisible) {\n        await this.resetScheduleItemsForTasksTab()\n      }\n      if (resetScroll) {\n        this.resetScheduleScroll()\n      }\n    },\n\n    async resetScheduleItemsForScheduleTab() {\n      if (!this.currentScheduleItem) return\n\n      const taskAssignationMap = this.buildAssignationMap()\n      const startDate = this.currentScheduleItem.start_date\n      const endDate = this.currentScheduleItem.end_date\n\n      this.daysOffByPerson = await this.loadProductionDaysOff({\n        startDate,\n        endDate\n      }).catch(\n        () => ({}) // fallback if not allowed to fetch days off\n      )\n\n      if (this.dataDisplay.timesheets) {\n        const assignees = Object.keys(taskAssignationMap).filter(\n          id => id !== 'unassigned' && taskAssignationMap[id].length > 0\n        )\n        this.timesheetByPerson = await this.loadTimesheets(\n          assignees,\n          startDate,\n          endDate\n        )\n      }\n\n      const scheduleItems = this.team\n        .map(person =>\n          this.buildPersonElement(\n            person,\n            taskAssignationMap,\n            this.dataDisplay.beforeAfterTasks\n          )\n        )\n        .filter(item => item?.children.length > 0)\n\n      if (taskAssignationMap.unassigned.length > 0) {\n        scheduleItems.push(\n          this.buildPersonElement(\n            { id: 'unassigned' },\n            taskAssignationMap,\n            this.dataDisplay.beforeAfterTasks\n          )\n        )\n      }\n      this.schedule.scheduleItems = scheduleItems\n    },\n\n    async resetScheduleItemsForTasksTab() {\n      if (!this.currentScheduleItem) return\n\n      const taskAssignationMap = this.buildAssignationMap()\n      const startDate = this.currentScheduleItem.start_date\n      const endDate = this.currentScheduleItem.end_date\n\n      this.daysOffByPerson = await this.loadProductionDaysOff({\n        startDate,\n        endDate\n      }).catch(\n        () => ({}) // fallback if not allowed to fetch days off\n      )\n\n      if (this.dataDisplay.timesheets) {\n        const assignees = Object.keys(taskAssignationMap).filter(\n          id => id !== 'unassigned' && taskAssignationMap[id].length > 0\n        )\n        this.timesheetByPerson = await this.loadTimesheets(\n          assignees,\n          startDate,\n          endDate\n        )\n      }\n\n      const scheduleItems = [\n        {\n          id: '',\n          color: 'transparent',\n          children: [],\n          timesheet: [],\n          expanded: true\n        }\n      ]\n      this.tasks.forEach(task => {\n        const person = this.personMap.get(task.assignees[0]) || {\n          id: 'unassigned'\n        }\n        const taskAssignationMap = { [person.id]: [task] }\n        const scheduleItem = this.buildPersonElement(\n          person,\n          taskAssignationMap,\n          this.dataDisplay.beforeAfterTasks\n        )\n        scheduleItems[0].startDate = scheduleItem.startDate\n        scheduleItems[0].endDate = scheduleItem.endDate\n        scheduleItems[0].children.push(...scheduleItem.children)\n        scheduleItems[0].timesheet.push(...scheduleItem.timesheet)\n      })\n\n      this.schedule.scheduleItems = scheduleItems\n    },\n\n    buildAssignationMap() {\n      const taskAssignationMap = { unassigned: [] }\n      this.team.forEach(person => {\n        if (person) taskAssignationMap[person.id] = []\n      })\n      this.tasks.forEach(task => {\n        if (task.assignees.length > 0) {\n          task.assignees.forEach(personId => {\n            if (!taskAssignationMap[personId]) {\n              taskAssignationMap[personId] = []\n            }\n            taskAssignationMap[personId].push(task)\n          })\n        } else {\n          taskAssignationMap.unassigned.push(task)\n        }\n      })\n      return taskAssignationMap\n    },\n\n    async loadTimesheets(personIds, startDate, endDate) {\n      const timesheets = await this.loadProductionTimeSpents({\n        taskType: this.currentTaskType,\n        startDate,\n        endDate\n      }).catch(\n        () => ({}) // fallback if not allowed to fetch timesheets\n      )\n\n      const timesheetByPerson = {}\n      for (const personId of personIds) {\n        const timesheet =\n          timesheets[personId]?.sort(firstBy('date').thenBy('task_id')) || []\n        timesheet.forEach(entry => {\n          entry.task = this.tasks.find(task => task.id === entry.task_id)\n          entry.startDate = parseDate(entry.date)\n          entry.endDate = parseDate(entry.date)\n        })\n\n        // merge consecutive timesheet entries with duration >= one organisation day\n        const mergedTimesheet = []\n        const oneDay = this.organisation.hours_by_day * 60\n        for (const entry of timesheet) {\n          const previous = mergedTimesheet.length\n            ? mergedTimesheet[mergedTimesheet.length - 1]\n            : null\n          if (\n            previous &&\n            previous.task_id === entry.task_id &&\n            (previous.date === entry.date ||\n              (previous.duration >= oneDay &&\n                entry.startDate.diff(previous.startDate, 'days') === 1))\n          ) {\n            // merge with previous\n            mergedTimesheet[mergedTimesheet.length - 1] = {\n              ...previous,\n              duration: previous.duration + entry.duration,\n              endDate: entry.endDate\n            }\n          } else {\n            mergedTimesheet.push(entry)\n          }\n        }\n\n        timesheetByPerson[personId] = mergedTimesheet\n      }\n      return timesheetByPerson\n    },\n\n    buildPersonElement(person, taskAssignationMap, withBeforeAfter = false) {\n      if (!person) return null\n\n      let manDays = 0\n      let minStartDate\n      let maxEndDate\n      const personTasks = taskAssignationMap[person.id]\n\n      let personElement\n      if (person.id === 'unassigned') {\n        personElement = {\n          avatar: false,\n          id: person.id,\n          name: this.$t('main.unassigned'),\n          color: '#888',\n          priority: 1,\n          expanded: true,\n          loading: false,\n          children: [],\n          editable: false,\n          timesheet: []\n        }\n      } else {\n        personElement = {\n          avatar: true,\n          has_avatar: person.has_avatar,\n          avatarPath: person.avatarPath,\n          initials: person.initials,\n          id: person.id,\n          name: person.full_name,\n          color: person.color,\n          priority: 1,\n          expanded: true,\n          loading: false,\n          children: [],\n          editable: false,\n          daysOff: this.daysOffByPerson[person.id],\n          timesheet: this.timesheetByPerson[person.id] ?? [],\n          route: getPersonPath(person.id, 'schedule')\n        }\n      }\n\n      const children = personTasks.map(task => {\n        const estimation = task.estimation\n        let endDate\n\n        let startDate = moment(this.schedule.taskTypeStartDate)\n        if (task.start_date) {\n          startDate = parseDate(task.start_date)\n        } else if (task.real_start_date) {\n          startDate = parseDate(task.real_start_date)\n        }\n\n        if (startDate.isAfter(this.schedule.endDate)) {\n          startDate = this.schedule.endDate.clone().add(-1, 'days')\n        }\n        if (startDate.isBefore(this.schedule.startDate)) {\n          startDate = this.schedule.startDate.clone()\n        }\n\n        if (task.due_date) {\n          endDate = parseDate(task.due_date)\n        } else if (task.end_date) {\n          endDate = parseDate(task.end_date)\n        } else {\n          endDate = addBusinessDays(\n            startDate,\n            Math.ceil(minutesToDays(this.organisation, task.estimation)) - 1,\n            personElement.daysOff\n          )\n        }\n\n        if (!endDate || endDate.isBefore(startDate)) {\n          const nbDays = startDate.isoWeekday() === 5 ? 3 : 1\n          endDate = startDate.clone().add(nbDays, 'days')\n        }\n        if (endDate.isAfter(this.schedule.endDate)) {\n          endDate = this.schedule.endDate.clone().add(-1, 'days')\n          if (startDate.isAfter(endDate)) {\n            startDate = endDate.clone().add(-1, 'days')\n          }\n        }\n\n        if (estimation) manDays += estimation\n        if (!minStartDate || minStartDate.isAfter(startDate)) {\n          minStartDate = startDate.clone()\n        }\n        if (!maxEndDate || maxEndDate.isBefore(endDate)) {\n          maxEndDate = endDate.clone()\n        }\n\n        const data = {\n          ...task,\n          name: task.entity_name,\n          startDate,\n          endDate,\n          expanded: false,\n          loading: false,\n          man_days: estimation,\n          editable: this.isSupervisorInDepartment,\n          unresizable: false,\n          parentElement: personElement,\n          color: this.getTaskElementColor(task, endDate),\n          children: []\n        }\n\n        if (withBeforeAfter) {\n          const entity = this.entityMap.get(task.entity_id)\n          const siblingElements = entity?.tasks\n            .map(taskId => this.taskMap.get(taskId))\n            .filter(Boolean)\n\n          if (this.schedule.taskTypeBefore) {\n            data.previousElement = siblingElements.find(\n              item => item.task_type_id === this.schedule.taskTypeBefore\n            )\n          }\n          if (this.schedule.taskTypeAfter) {\n            data.nextElement = siblingElements.find(\n              item => item.task_type_id === this.schedule.taskTypeAfter\n            )\n          }\n        }\n\n        if (data.previousElement) {\n          const task = data.previousElement\n          let startDate\n          if (task.start_date) {\n            startDate = parseDate(task.start_date)\n          } else if (task.real_start_date) {\n            startDate = parseDate(task.real_start_date)\n          }\n          let endDate\n          if (task.due_date) {\n            endDate = parseDate(task.due_date)\n          } else if (task.end_date) {\n            endDate = parseDate(task.end_date)\n          } else {\n            endDate = addBusinessDays(\n              startDate,\n              Math.ceil(minutesToDays(this.organisation, task.estimation)) - 1,\n              personElement.daysOff\n            )\n          }\n\n          if (startDate && endDate) {\n            data.previousElement.name = `[${this.currentTaskTypeBefore.name}] ${task.entity_name}`\n            data.previousElement.startDate = startDate\n            data.previousElement.endDate = endDate\n            data.previousElement.color = this.getTaskElementColor(task, endDate)\n          } else {\n            data.previousElement = null\n          }\n        }\n\n        if (data.nextElement) {\n          const task = data.nextElement\n          let startDate\n          if (task.start_date) {\n            startDate = parseDate(task.start_date)\n          } else if (task.real_start_date) {\n            startDate = parseDate(task.real_start_date)\n          }\n          let endDate\n          if (task.due_date) {\n            endDate = parseDate(task.due_date)\n          } else if (task.end_date) {\n            endDate = parseDate(task.end_date)\n          } else {\n            endDate = addBusinessDays(\n              startDate,\n              Math.ceil(minutesToDays(this.organisation, task.estimation)) - 1,\n              personElement.daysOff\n            )\n          }\n\n          if (startDate && endDate) {\n            data.nextElement.name = `[${this.currentTaskTypeAfter.name}] ${task.entity_name}`\n            data.nextElement.startDate = startDate\n            data.nextElement.endDate = endDate\n            data.nextElement.color = this.getTaskElementColor(task, endDate)\n          } else {\n            data.nextElement = null\n          }\n        }\n\n        return data\n      })\n\n      return {\n        ...personElement,\n        children,\n        startDate: minStartDate,\n        endDate: maxEndDate,\n        man_days: manDays\n      }\n    },\n\n    getTaskElementColor(task, endDate) {\n      if (this.schedule.currentColor === 'status') {\n        let color = this.taskStatusMap.get(task.task_status_id).color\n        if (color === '#f5f5f5') color = '#999'\n        return color\n      } else if (this.schedule.currentColor === 'late') {\n        const isLate =\n          !this.taskStatusMap.get(task.task_status_id).is_done &&\n          endDate.isBefore(moment())\n        return isLate ? '#FF3860' : '#999'\n      }\n      return null\n    },\n\n    saveTaskScheduleItem(item) {\n      if (item.estimation) {\n        item.endDate = addBusinessDays(\n          item.startDate,\n          Math.ceil(minutesToDays(this.organisation, item.estimation)) - 1,\n          item.parentElement.daysOff\n        )\n      }\n      item.man_days = item.estimation || 0\n\n      if (item.startDate && item.endDate) {\n        item.parentElement.startDate = this.getMinDate(item.parentElement)\n        item.parentElement.endDate = this.getMaxDate(item.parentElement)\n        this.updateTask({\n          taskId: item.id,\n          data: {\n            estimation: item.estimation,\n            start_date: item.startDate.format('YYYY-MM-DD'),\n            due_date: item.endDate.format('YYYY-MM-DD')\n          }\n        })\n      }\n    },\n\n    getMinDate(personElement) {\n      const endDate = this.productionEndDate\n      let minDate = endDate.clone()\n      personElement.children.forEach(item => {\n        if (item.startDate && item.startDate.isBefore(minDate)) {\n          minDate = item.startDate\n        }\n      })\n      return minDate.clone()\n    },\n\n    getMaxDate(personElement) {\n      const startDate = this.productionStartDate\n      let maxDate = startDate.clone()\n      personElement.children.forEach(item => {\n        if (item.endDate && item.endDate.isAfter(maxDate)) {\n          maxDate = item.endDate\n        }\n      })\n      return maxDate.clone()\n    },\n\n    expandPersonElement(personElement) {\n      personElement.expanded = !personElement.expanded\n    },\n\n    showImportModal() {\n      this.modals.importing = true\n    },\n\n    hideImportModal() {\n      this.modals.importing = false\n    },\n\n    showImportRenderModal() {\n      this.modals.isImportRenderDisplayed = true\n    },\n\n    hideImportRenderModal() {\n      this.modals.isImportRenderDisplayed = false\n    },\n\n    resetImport() {\n      this.errors.importing = false\n      this.errors.importingError = null\n      this.hideImportRenderModal()\n      this.importCsvFormData = undefined\n      this.$refs['import-modal'].reset()\n      this.showImportModal()\n    },\n\n    uploadImportFile(data) {\n      const formData = new FormData()\n      const filename = 'import.csv'\n      const csvContent = csv.turnEntriesToCsvString(data)\n      const file = new File([csvContent], filename, { type: 'text/csv' })\n\n      formData.append('file', file)\n\n      this.loading.importing = true\n      this.errors.importing = false\n      this.errors.importingError = null\n      this.importCsvFormData = formData\n\n      this.uploadTaskTypeEstimations(this.importCsvFormData) // to change\n        .then(() => {\n          this.hideImportRenderModal()\n        })\n        .catch(err => {\n          this.errors.importingError = err\n          this.errors.importing = true\n        })\n        .finally(() => {\n          this.loading.importing = false\n        })\n    },\n\n    renderImport(data, mode) {\n      this.loading.importing = true\n      this.errors.importing = false\n      if (mode === 'file') {\n        data = data.get('file')\n      }\n      csv.processCSV(data).then(results => {\n        this.parsedCSV = results\n        this.hideImportModal()\n        this.loading.importing = false\n        this.showImportRenderModal()\n      })\n    },\n\n    resetTaskTypeDates() {\n      if (this.currentScheduleItem) {\n        this.schedule.taskTypeStartDate = parseDate(\n          this.currentScheduleItem.start_date\n        ).toDate()\n        this.schedule.taskTypeEndDate = parseDate(\n          this.currentScheduleItem.end_date\n        ).toDate()\n      }\n    },\n\n    resetScheduleScroll() {\n      if (!this.$refs['schedule-widget']) return\n\n      const today = moment()\n      if (\n        today.isBefore(moment(this.schedule.taskTypeStartDate)) ||\n        today.isAfter(moment(this.schedule.taskTypeEndDate))\n      ) {\n        const date = moment(this.schedule.taskTypeStartDate).add(\n          this.isScheduleVisible ? 0 : 20,\n          'days'\n        )\n        this.$refs['schedule-widget'].scrollToDate(date)\n      } else {\n        this.$refs['schedule-widget'].scrollToToday()\n      }\n    }\n  },\n\n  watch: {\n    $route() {\n      this.updateActiveTab()\n    },\n\n    '$route.query.search'() {\n      const currentSearch = this.searchField.getValue()\n      const routeSearch = this.$route.query.search\n      if (routeSearch && routeSearch !== currentSearch) {\n        this.searchField.setValue(routeSearch)\n        this.onSearchChange(routeSearch)\n      }\n    },\n\n    currentProduction() {\n      this.setOptionalImportColumns()\n      this.initData(true)\n    },\n\n    nbSelectedTasks() {\n      this.updateTaskInQuery()\n    },\n\n    // Quickfix for the edge case where the backPath is not properly set\n    // because it was set when the episode was not fully loaded.\n    currentEpisode() {\n      if (this.currentEpisode && !this.backPath.params?.episode_id) {\n        this.$store.commit('RESET_PRODUCTION_PATH', {\n          productionId: this.currentProduction.id,\n          episodeId: this.currentEpisode.id\n        })\n      }\n    },\n\n    difficultyFilter() {\n      this.applyTaskFilters()\n    },\n\n    dueDateFilter() {\n      this.applyTaskFilters()\n    },\n\n    estimationFilter() {\n      this.applyTaskFilters()\n    },\n\n    priorityFilter() {\n      this.applyTaskFilters()\n    },\n\n    taskStatusIdFilter() {\n      this.applyTaskFilters()\n    },\n\n    currentSort() {\n      this.sortTasks()\n      this.$refs['task-list'].resetSelection()\n      this.resetScheduleItems()\n      this.clearSelectedTasks()\n      this.updateTaskInQuery()\n    },\n\n    'schedule.currentColor'() {\n      this.resetScheduleItems()\n    },\n\n    activeTab() {\n      this.resetScheduleItems(true)\n    },\n\n    currentScheduleItem() {\n      if (this.currentScheduleItem) {\n        this.resetTaskTypeDates()\n      }\n    },\n\n    'schedule.taskTypeStartDate'() {\n      const newDate = moment(this.schedule.taskTypeStartDate)\n        .utc()\n        .format('YYYY-MM-DD')\n      if (newDate !== this.currentScheduleItem.start_date) {\n        this.$store.commit('SET_SCHEDULE_ITEM_DATES', {\n          scheduleItem: this.currentScheduleItem,\n          dates: {\n            startDate: moment(this.schedule.taskTypeStartDate).utc(),\n            endDate: moment(this.schedule.taskTypeEndDate).utc()\n          }\n        })\n        this.saveScheduleItem(this.currentScheduleItem)\n      }\n    },\n\n    'schedule.taskTypeEndDate'() {\n      const newDate = moment(this.schedule.taskTypeEndDate)\n        .utc()\n        .format('YYYY-MM-DD')\n      if (newDate !== this.currentScheduleItem.end_date) {\n        this.$store.commit('SET_SCHEDULE_ITEM_DATES', {\n          scheduleItem: this.currentScheduleItem,\n          dates: {\n            startDate: moment(this.schedule.taskTypeStartDate).utc(),\n            endDate: moment(this.schedule.taskTypeEndDate).utc()\n          }\n        })\n        this.saveScheduleItem(this.currentScheduleItem)\n      }\n    }\n  },\n\n  socket: {\n    events: {\n      'task:update'(eventData) {\n        this.resetScheduleItems()\n        if (\n          !this.isActiveTab('schedule') &&\n          this.taskMap.get(eventData.task_id) &&\n          this.selectedTasks === 0 &&\n          this.searchField &&\n          this.searchField.getValue() === ''\n        ) {\n          this.resetTaskIndex()\n          this.$nextTick(() => {\n            this.onSearchChange(this.searchField.getValue())\n          })\n        }\n      }\n    }\n  },\n\n  head() {\n    return {\n      title: `${this.title} - Kitsu`\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.page-header {\n  margin-top: 1em;\n  margin-right: 0;\n}\n\n.align-end {\n  align-items: flex-end;\n}\n\n.search-options {\n  width: 325px;\n}\n\n.ml2 {\n  margin-left: 2em;\n}\n\n.tabs ul {\n  margin-left: 0;\n}\n\n.page {\n  flex: 1;\n  height: 100%;\n}\n\n.back-link {\n  padding-top: 5px;\n  margin-right: 5px;\n}\n\n.task-type {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.columns {\n  display: flex;\n  flex-direction: row;\n}\n\n.column {\n  overflow-y: auto;\n  padding: 0;\n}\n\n.main-column {\n  overflow: hidden;\n}\n\n.sorting-combobox {\n  padding-top: 3px;\n}\n\n.field {\n  margin-bottom: 0;\n}\n\n.query-list {\n  margin-bottom: 0;\n  margin-top: 0.5em;\n}\n\n.push-right {\n  flex: 1;\n  text-align: right;\n}\n\n.task-type-schedule {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n}\n\n.zoom-level {\n  margin-bottom: 6px;\n}\n\n.task-type-estimation {\n  display: flex;\n  max-height: calc(100% - 200px);\n}\n\n.task-schedule {\n  flex-grow: 1;\n  min-width: 200px;\n  height: auto;\n}\n</style>\n"],"names":["_sfc_main","domMixin","formatListMixin","CornerDownRightIcon","EntityThumbnail","PeopleAvatar","PeopleName","mapGetters","assetsStore","editsStore","episodesStore","sequencesStore","shotsStore","assigneeSet","alltasks","remaining","assignees","task","entity","personId","status","val","firstBy","person","allTasksStats","remainingStats","mapActions","frameToSeconds","entityId","a","b","personA","personB","shot","event","value","estimation","days","selection","taskId","index","shiftKey","range","i","taskType","maps","seconds","frames","count","estimationDays","minutesToDays","quota","quotaCount","quotaFrames","_hoisted_1","_hoisted_2","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_9","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_16","_hoisted_19","_hoisted_22","_hoisted_23","_hoisted_25","_hoisted_26","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_openBlock","_createElementBlock","_createElementVNode","_hoisted_3","_toDisplayString","_ctx","$options","_hoisted_7","_hoisted_8","_createCommentVNode","_hoisted_10","_hoisted_11","_Fragment","_renderList","_normalizeClass","$data","_hoisted_15","_createVNode","_component_people_avatar","_createBlock","_component_people_name","_component_entity_thumbnail","_hoisted_17","_hoisted_18","_hoisted_20","_hoisted_21","$event","args","_hoisted_24","_hoisted_27","_component_corner_down_right_icon","_createTextVNode","shotStore","acc","$props","_cache","Combobox","DateField","EntityPreview","PeopleAvatarWithMenu","TableInfo","TaskListNumbers","ValidationCell","ValidationTag","moment","assetStore","editStore","episodeStore","sequenceStore","result","currentTasks","previousTask","data","taskStart","taskDue","date","duration","daysToMinutes","t","dueDate","parseSimpleDate","startDate","formatSimpleDate","getDatesFromStartDate","getDatesFromEndDate","difficulty","nbDrawings","position","isSelected","isManySelection","top","taskLine","rect","listRect","isBelow","isAbove","scrollingRequired","headers","taskLines","line","taskGroup","_component_entity_preview","_component_validation_tag","_component_people_avatar_with_menu","_component_validation_cell","_component_combobox","_component_date_field","_component_table_info","_renderSlot","_component_task_list_numbers","filters","tasks","todayWeek","parseDate","previousWeek","nextWeek","today","todayMonth","previousMonth","nextMonth","taskStatusMap","searchMixin","ButtonSimple","CornerLeftUpIcon","ComboboxNumber","ComboboxOptions","ComboboxStatus","ComboboxStyled","ComboboxTaskType","EstimationHelper","ImportModal","ImportRenderModal","Schedule","SearchField","SearchQueryList","TaskList","TaskInfo","TaskTypeName","options","isAssets","isShots","isEdits","isSequences","sortByName","type","taskTypeId","currentIndex","results","departments","taskStatusStore","taskTypeStore","episodeName","route","name","sortPeople","force","searchQuery","err","items","item","tab","section","routeTaskTypeId","query","descriptors","d","keywords","getKeyWords","excludingKeyWords","getExcludingKeyWords","descFilters","getDescFilters","taskFilters","getTaskFilters","indexSearch","applyFilters","entityType","search","duedate","late","priority","taskStatusId","buildSupervisorTaskIndex","entities","isDesc","ta","tb","nbFramesA","nameData","stringHelpers","csv","daysOff","resetScroll","taskAssignationMap","endDate","id","scheduleItems","scheduleItem","personIds","timesheets","timesheetByPerson","timesheet","entry","mergedTimesheet","oneDay","previous","withBeforeAfter","manDays","minStartDate","maxEndDate","personTasks","personElement","getPersonPath","children","addBusinessDays","nbDays","siblingElements","color","minDate","maxDate","formData","filename","csvContent","file","mode","currentSearch","routeSearch","eventData","_component_router_link","_withCtx","_component_corner_left_up_icon","_component_task_type_name","_component_button_simple","_component_search_field","_component_combobox_status","_component_combobox_styled","_component_combobox_options","_component_combobox_task_type","_component_combobox_number","_component_search_query_list","_component_task_list","_component_schedule","_component_estimation_helper","_component_import_render_modal","_component_import_modal","_component_task_info"],"mappings":"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"}