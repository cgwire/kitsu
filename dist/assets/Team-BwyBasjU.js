import{_ as v,m as k,a as y,r as d,c as s,o as t,e as n,d as p,t as a,F as C,g,f as c,aG as U,I as D,aF as V,C as F,L as x,B,k as P,d6 as E,w as b,n as N,M as L}from"./index-DU1Cj_JV.js";import{P as z}from"./PageLayout-MxhgkZxN.js";import{D as A}from"./DepartmentNamesCell-D9CzoIf8.js";import{P as S}from"./PeopleNameCell-BuqTZpQl.js";const G={name:"production-team-list",components:{DepartmentNamesCell:A,PeopleNameCell:S},props:{entries:{type:Array,default:()=>[]}},computed:{...y(["isCurrentUserManager"]),isEmpty(){return!this.entries?.length}},methods:{...k(["removePersonFromTeam"]),removePerson(e){this.removePersonFromTeam(e)}}},R={class:"data-list"},j={class:"datatable-wrapper"},K={class:"datatable"},q={class:"datatable-head"},H={scope:"col",class:"name datatable-row-header"},J={key:0,scope:"col",class:"email"},O={key:1,scope:"col",class:"contract"},Q={scope:"col",class:"role"},W={scope:"col"},X={key:2,scope:"col",class:"actions"},Y={key:0,class:"datatable-body"},Z={key:0,class:"email"},ee={key:1,class:"contract"},te={class:"role"},oe={key:2,class:"actions has-text-right"},se=["onClick"],re={key:0,class:"has-text-centered mt2"},ne={key:1,class:"has-text-centered footer-info"};function ae(e,o,u,T,i,r){const _=d("people-name-cell"),h=d("department-names-cell");return t(),s("div",R,[n("div",j,[n("table",K,[n("thead",q,[n("tr",null,[n("th",H,a(e.$t("people.list.name")),1),e.isCurrentUserManager?(t(),s("th",J,a(e.$t("people.list.email")),1)):p("",!0),e.isCurrentUserManager?(t(),s("th",O,a(e.$t("people.list.contract")),1)):p("",!0),n("th",Q,a(e.$t("people.list.role")),1),n("th",W,a(e.$t("people.list.departments")),1),e.isCurrentUserManager?(t(),s("th",X)):p("",!0)])]),r.isEmpty?p("",!0):(t(),s("tbody",Y,[(t(!0),s(C,null,g(u.entries,m=>(t(),s("tr",{class:"datatable-row",key:m.id},[c(_,{class:"name datatable-row-header",person:m},null,8,["person"]),e.isCurrentUserManager?(t(),s("td",Z,a(m.email),1)):p("",!0),e.isCurrentUserManager?(t(),s("td",ee,a(e.$t(`people.contract.${m.contract_type}`)),1)):p("",!0),n("td",te,a(e.$t(`people.role.${m.role}`)),1),c(h,{departments:m.departments},null,8,["departments"]),e.isCurrentUserManager?(t(),s("td",oe,[n("button",{class:"button",onClick:f=>r.removePerson(m)},a(e.$t("main.remove")),9,se)])):p("",!0)]))),128))]))])]),r.isEmpty?(t(),s("p",re,a(e.$t("people.empty_team")),1)):(t(),s("p",ne,a(u.entries.length)+" "+a(e.$tc("people.persons",u.entries.length)),1))])}const le=v(G,[["render",ae],["__scopeId","data-v-daa79d16"]]),ie={name:"team",components:{ButtonSimple:B,ComboboxDepartment:x,ComboboxProduction:F,PageLayout:z,PeopleAvatar:V,PeopleField:D,PeopleName:U,ProductionTeamList:le},data(){return{importDepartmentId:null,importProductionId:null,person:null}},mounted(){this.availableProductions.length>0&&(this.importProductionId=this.availableProductions[0]?.id,this.importDepartmentId=this.departments.sort((e,o)=>e.name.localeCompare(o.name,void 0,{numeric:!0}))[0]?.id)},computed:{...y(["activePeople","currentProduction","departments","isCurrentUserManager","openProductions","personMap","productionMap"]),availableProductions(){return this.openProductions.filter(e=>e.id!==this.currentProduction.id)},teamPersons(){return L(this.currentProduction.team.map(e=>this.personMap.get(e)))},unlistedPeople(){return this.activePeople.filter(e=>!this.currentProduction.team.includes(e.id)&&e.active)}},methods:{...k(["addPersonToTeam"]),addPerson(){this.person&&(this.addPersonToTeam(this.person),this.$refs["people-field"].focus())},removePerson(e){this.removePersonFromTeam(e)},importTeamFromProduction(){this.productionMap.get(this.importProductionId).team.forEach(o=>{this.addPersonToTeam(this.personMap.get(o))})},importTeamFromDepartment(){const e=this.importDepartmentId;this.activePeople.filter(o=>o.departments.includes(e)).forEach(o=>{this.addPersonToTeam(o)})}},head(){return{title:`${this.currentProduction.name} | ${this.$t("people.team")} - Kitsu`}}},de={class:"people flexcolumn"},me={key:0,class:"flexrow mt2 add-people"},pe=["disabled"],ce={class:"importers flexcolumn"},ue={key:0,class:"project-import flexcolumn"},_e={class:"label mt2"},he={class:"import-list"},fe=["onClick"];function Pe(e,o,u,T,i,r){const _=d("people-field"),h=d("production-team-list"),m=d("combobox-production"),f=d("button-simple"),w=d("combobox-department"),$=d("people-avatar"),I=d("people-name"),M=d("page-layout");return t(),P(M,null,E({main:b(()=>[n("div",de,[e.isCurrentUserManager?(t(),s("div",me,[c(_,{ref:"people-field",class:"flexrow-item add-people-field",people:r.unlistedPeople,placeholder:e.$t("people.add_member_to_team"),modelValue:i.person,"onUpdate:modelValue":o[0]||(o[0]=l=>i.person=l)},null,8,["people","placeholder","modelValue"]),n("button",{class:"button flexrow-item",onClick:o[1]||(o[1]=(...l)=>r.addPerson&&r.addPerson(...l)),disabled:!i.person},a(e.$t("main.add")),9,pe)])):p("",!0),c(h,{entries:r.teamPersons,onRemove:r.removePerson},null,8,["entries","onRemove"])])]),_:2},[e.isCurrentUserManager?{name:"side",fn:b(()=>[n("div",ce,[r.availableProductions.length>0?(t(),s("div",ue,[c(m,{class:"flexrow-item",label:e.$t("people.import_from_production"),"production-list":r.availableProductions,"with-margin":!1,modelValue:i.importProductionId,"onUpdate:modelValue":o[2]||(o[2]=l=>i.importProductionId=l)},null,8,["label","production-list","modelValue"]),c(f,{class:"flexrow-item mt05",disabled:!i.importProductionId,text:e.$t("main.import"),onClick:r.importTeamFromProduction},null,8,["disabled","text","onClick"])])):p("",!0),n("div",{class:N({"department-import":!0,flexcolumn:!0,mt2:r.availableProductions.length>0})},[c(w,{class:"flexrow-item",label:e.$t("people.import_from_department"),"with-empty-choice":!1,modelValue:i.importDepartmentId,"onUpdate:modelValue":o[3]||(o[3]=l=>i.importDepartmentId=l)},null,8,["label","modelValue"]),c(f,{class:"flexrow-item mt05",disabled:!i.importDepartmentId,text:e.$t("main.import"),onClick:r.importTeamFromDepartment},null,8,["disabled","text","onClick"])],2),n("p",_e,a(e.$t("people.import_from_unlisted")),1),n("div",he,[(t(!0),s(C,null,g(r.unlistedPeople,l=>(t(),s("div",{key:`unlisted-person-${l.id}`,class:"flexrow person-to-add mb05",onClick:be=>e.addPersonToTeam(l)},[(t(),P($,{class:"flexrow-item","font-size":14,key:l.id,person:l,size:30,"is-link":!1},null,8,["person"])),c(I,{class:"flexrow-item",person:l},null,8,["person"])],8,fe))),128))])])]),key:"0"}:void 0]),1024)}const ge=v(ie,[["render",Pe],["__scopeId","data-v-629eab9d"]]);export{ge as default};
//# sourceMappingURL=Team-BwyBasjU.js.map
