import{a as q,_ as C,r as p,c as a,o as i,e as l,d as m,t as d,f as b,u as $,B as _,aq as Q,F as v,g as x,aF as B,n as M,k as D,aG as X,aH as Z,a5 as ee,G as S,aI as N,a0 as te,aJ as ne,m as R,y as se,aB as V,ad as F,ae as H,b as U,aK as K,ai as G,j as z,w as T,aj as W,l as J,$ as re,aC as Y,aE as oe,I as ie,M as ae,aL as P,aM as de,ap as le,aa as ue,ac as ce}from"./index-BAEgV7eE.js";import{g as ge}from"./grablist-Da7oVI-6.js";import{P as me}from"./PageLayout-D5zeaQFn.js";const he={computed:{...q(["currentProduction, currentEpisode, isTVShow"])},methods:{},head(){return this.currentProduction?this.isTVSHow&&this.currentEpisode?{title:`${this.currentProduction.name} - ${this.currentEpisode.name} | {this.pageTitle} - Kitsu`}:{title:`${this.currentProduction.name} | ${this.pageTitle} - Kitsu`}:{title:`${this.pageTitle} - Kitsu`}}},ye={class:"flexcolumn analytics-container"},be={class:"has-text-centered strong mt1"},we={key:0},pe={class:"has-text-centered mt1 strong total"},fe={class:"has-text-centered mt1"},Ee={key:1},ve={class:"has-text-centered mt2"},Be={key:2,class:"mt1 flexcolumn"},xe={__name:"BudgetAnalytics",props:{amount:{type:Number,default:0},currency:{type:String,default:"USD"},budgets:{type:Array,required:!0},budgetDepartments:{type:Array,required:!0},budgetEntries:{type:Array,required:!0},monthsBetweenProductionDates:{type:Array,required:!0},pieChartData:{type:Array,required:!0},pieChartColors:{type:Array,required:!0},columnChartData:{type:Array,required:!0}},setup(e){return(t,n)=>{const o=p("pie-chart"),s=p("column-chart");return i(),a("div",ye,[l("h3",be,d(t.$t("budget.analytics")),1),e.budgets.length>0&&e.budgetDepartments.length>0?(i(),a("div",we,[l("p",pe,d(e.amount.toLocaleString())+" "+d(e.currency||"USD"),1),l("p",fe,d(e.budgetDepartments.length)+" "+d(t.$t("budget.departments"))+" - "+d(e.budgetEntries.length)+" "+d(t.$t("budget.entries"))+" - "+d(e.monthsBetweenProductionDates.length)+" "+d(t.$t("budget.months")),1)])):m("",!0),e.budgets.length===0||e.budgetDepartments.length===0?(i(),a("div",Ee,[l("p",ve,d(t.$t("budget.no_analytics_to_show")),1)])):(i(),a("div",Be,[l("h4",null,d(t.$t("budget.cash_repartition")),1),b(o,{class:"mb1",legend:!1,data:e.pieChartData,colors:e.pieChartColors,height:"240px"},null,8,["data","colors"]),l("h4",null,d(t.$t("budget.cash_evolution")),1),b(s,{legend:!1,data:e.columnChartData},null,8,["data"])]))])}}},Se=C(xe,[["__scopeId","data-v-43441958"]]),Ce={class:"budget-header"},De={key:0,class:"has-text-centered"},Pe={key:1,class:"flexrow mt2"},Me={class:"list-error"},ke={key:2,class:"no-budget has-text-centered mt2"},_e={class:"mt1 has-text-centered create-budget-button"},Ye={key:3,class:"flexrow mt1"},Ae={class:"selected-budget flexrow-item"},Le={key:0,class:"error"},je={__name:"BudgetHeader",props:{budgetOptions:{type:Array,default:()=>[]},budget:{type:Object},isLoading:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},isErrorExpenses:{type:Boolean,default:!0},isLoadingExpenses:{type:Boolean,default:!1},isShowingExpenses:{type:Boolean,default:!1},isShowingItems:{type:Boolean,default:!1}},emits:["change-budget","delete-budget","edit-budget","export-budget","new-version","toggle-expenses","toggle-items"],setup(e){return(t,n)=>(i(),a("div",Ce,[e.isLoading?(i(),a("div",De,[b($)])):e.isError?(i(),a("div",Pe,[l("p",Me,d(t.$t("budget.budgets_error")),1)])):!e.budget||!e.budget.id?(i(),a("div",ke,[l("p",null,d(t.$t("budget.no_budget_found")),1),l("p",_e,[b(_,{text:t.$t("budget.create_budget"),"is-big":"",onClick:n[0]||(n[0]=o=>t.$emit("new-version"))},null,8,["text"])])])):(i(),a("div",Ye,[l("h3",Ae,[b(Q,{options:e.budgetOptions,"model-value":e.budget,onChange:n[1]||(n[1]=o=>t.$emit("change-budget",o))},null,8,["options","model-value"])]),b(_,{class:"mr05",title:t.$t("budget.edit_budget"),icon:"pencil",onClick:n[2]||(n[2]=o=>t.$emit("edit-budget"))},null,8,["title"]),b(_,{class:"mr05",title:t.$t("budget.delete_budget"),icon:"trash",onClick:n[3]||(n[3]=o=>t.$emit("delete-budget"))},null,8,["title"]),b(_,{class:"mr05",active:e.isShowingExpenses,"is-loading":e.isLoadingExpenses,text:t.$t("budget.show_expenses"),onClick:n[4]||(n[4]=o=>t.$emit("toggle-expenses"))},null,8,["active","is-loading","text"]),b(_,{class:"mr05",active:e.isShowingItems,text:t.$t("budget.show_items"),onClick:n[5]||(n[5]=o=>t.$emit("toggle-items"))},null,8,["active","text"]),e.isErrorExpenses?(i(),a("span",Le,d(t.$t("budget.expenses_error")),1)):m("",!0),n[8]||(n[8]=l("div",{class:"filler"},null,-1)),b(_,{class:"flexrow-item",icon:"export",title:t.$t("main.csv.export_file"),onClick:n[6]||(n[6]=o=>t.$emit("export-budget"))},null,8,["title"]),b(_,{text:t.$t("budget.new_version"),icon:"plus",onClick:n[7]||(n[7]=o=>t.$emit("new-version"))},null,8,["text"])]))]))}},Te=C(je,[["__scopeId","data-v-47819efe"]]),qe={class:"datatable-head"},Ie={class:"datatable-row-header department-header-header",colspan:"3"},Oe={class:"flexrow"},Ne={class:"flexrow-item"},Ve={class:"datatable-row-header base-salary-header month"},$e={class:"datatable-row-header duration-header month"},Re={class:"datatable-row-header has-text-right cost-column total-column"},Fe={class:"datatable-row-header has-text-right cost-column total-column"},He={class:"datatable-row-header has-text-right cost-column total-column"},Ue={key:1,class:"datatable-row-header has-text-right cost-column total-column"},Ke={key:2,class:"datatable-row-header has-text-right cost-column total-column"},Ge={class:"datatable-row-header has-text-right cost-column total-column"},ze={key:3,class:"datatable-row-header has-text-right total-column"},We={__name:"BudgetListHeader",props:{isShowingExpenses:{type:Boolean,required:!0},monthsBetweenStartAndNow:{type:Array,required:!0},monthsBetweenNowAndEnd:{type:Array,required:!0},monthsBetweenProductionDates:{type:Array,required:!0}},emits:["add-budget-entry"],setup(e){return(t,n)=>(i(),a("thead",qe,[l("tr",null,[l("th",Ie,[l("div",Oe,[l("div",Ne,d(t.$t("budget.fields.department")),1),n[1]||(n[1]=l("div",{class:"filler"},null,-1)),b(_,{"is-thin":"",text:t.$t("budget.add_entry"),onClick:n[0]||(n[0]=o=>t.$emit("add-budget-entry"))},null,8,["text"])])]),l("th",Ve,d(t.$t("budget.fields.base_salary")),1),l("th",$e,d(t.$t("budget.fields.duration")),1),e.isShowingExpenses?(i(),a(v,{key:0},[(i(!0),a(v,null,x(e.monthsBetweenStartAndNow,o=>(i(),a("th",{class:"month datatable-row-header cost-column",key:o},d(o.month()===0?o.format("MMM / YY"):o.format("MMM")),1))),128)),l("th",Re,d(t.$t("budget.costs")),1),l("th",Fe,d(t.$t("budget.previsional_costs")),1),l("th",He,d(t.$t("budget.difference")),1)],64)):m("",!0),(i(!0),a(v,null,x(e.isShowingExpenses?e.monthsBetweenNowAndEnd:e.monthsBetweenProductionDates,o=>(i(),a("th",{key:o,class:"month datatable-row-header"},d(o.month()===0?o.format("MMM / YY"):o.format("MMM")),1))),128)),e.isShowingExpenses?(i(),a("th",Ue,d(t.$t("budget.remaining")),1)):m("",!0),e.isShowingExpenses?(i(),a("th",Ke,d(t.$t("budget.remaining_and_costs")),1)):m("",!0),l("th",Ge,d(t.$t("budget.previsional_costs")),1),e.isShowingExpenses?(i(),a("th",ze,d(t.$t("budget.difference")),1)):m("",!0),n[2]||(n[2]=l("th",{class:"actions datatable-row-header"},null,-1))])]))}},Je=C(We,[["__scopeId","data-v-2e2d6e23"]]),Qe={class:"datatable-row"},Xe={class:"datatable-row-header",colspan:"3"},Ze={key:0,class:"total-cost remaining-previsional"},et={key:1,class:"total-cost"},tt={key:1,class:"total-cost remaining-previsional"},nt={key:2,class:"total-cost expense-and-remaining"},st={class:"total-cost"},rt={__name:"BudgetHardwareItemRow",props:{departmentEntry:{type:Object,required:!0},donePrevisional:{type:Object,required:!0},remainingPrevisional:{type:Object,required:!0},isShowingExpenses:{type:Boolean,required:!0},monthsBetweenStartAndNow:{type:Array,required:!0},monthsBetweenNowAndEnd:{type:Array,required:!0},monthsBetweenProductionDates:{type:Array,required:!0},convertedExpenses:{type:Object,required:!0},hardwareItemsCosts:{type:Object,required:!0}},setup(e){const t=e,n=B(()=>t.convertedExpenses[t.departmentEntry.id]?.["hardware-items"]?.total||0),o=B(()=>t.donePrevisional[t.departmentEntry.id]?.["hardware-items"]||0),s=B(()=>t.remainingPrevisional[t.departmentEntry.id]?.["hardware-items"]||0),r=B(()=>t.isShowingExpenses?(t.hardwareItemsCosts[t.departmentEntry.id]?.total||0)-(n.value+s.value):0);return(u,c)=>(i(),a("tr",Qe,[l("td",Xe,d(u.$t("hardware_items.title")),1),c[0]||(c[0]=l("td",null,null,-1)),c[1]||(c[1]=l("td",null,null,-1)),e.isShowingExpenses?(i(),a(v,{key:0},[(i(!0),a(v,null,x(e.monthsBetweenStartAndNow,h=>(i(),a("td",{key:"hardware-"+e.departmentEntry.id+"-"+h,class:"costs"},d(e.convertedExpenses[e.departmentEntry.id]?.["hardware-items"]?.[h.format("YYYY-MM")]?.toLocaleString()),1))),128)),e.isShowingExpenses?(i(),a("td",Ze,d(n.value.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",et,d(o.value.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",{key:2,class:M(["total-cost gap",{positive:o.value>n.value,negative:o.value<n.value}])},d((o.value-n.value).toLocaleString()),3)):m("",!0)],64)):m("",!0),(i(!0),a(v,null,x(e.isShowingExpenses?e.monthsBetweenNowAndEnd:e.monthsBetweenProductionDates,h=>(i(),a("td",{key:"hardware-"+e.departmentEntry.id+"-"+h,class:"costs"},d(e.hardwareItemsCosts[e.departmentEntry.id]?.[h.format("YYYY-MM")]||""),1))),128)),e.isShowingExpenses?(i(),a("td",tt,d(s.value.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",nt,d((n.value+s.value).toLocaleString()),1)):m("",!0),l("td",st,d(e.hardwareItemsCosts[e.departmentEntry.id]?.total),1),e.isShowingExpenses?(i(),a("td",{key:3,class:M(["total-cost gap",{positive:r.value>0,negative:r.value<0}])},d(r.value.toLocaleString()),3)):m("",!0),c[2]||(c[2]=l("td",{class:"actions"},null,-1))]))}},ot=C(rt,[["__scopeId","data-v-45b31d6a"]]),it={class:"datatable-row"},at={class:"datatable-row-header",colspan:"3"},dt={key:0,class:"total-cost remaining-previsional"},lt={key:1,class:"total-cost"},ut={key:1,class:"total-cost remaining-previsional"},ct={key:2,class:"total-cost expense-and-remaining"},gt={class:"total-cost"},mt={__name:"BudgetSoftwareLicenseRow",props:{departmentEntry:{type:Object,required:!0},isShowingExpenses:{type:Boolean,required:!0},donePrevisional:{type:Object,required:!0},remainingPrevisional:{type:Object,required:!0},monthsBetweenStartAndNow:{type:Array,required:!0},monthsBetweenNowAndEnd:{type:Array,required:!0},monthsBetweenProductionDates:{type:Array,required:!0},convertedExpenses:{type:Object,required:!0},softwareLicensesCosts:{type:Object,required:!0}},setup(e){const t=e,n=B(()=>t.convertedExpenses[t.departmentEntry.id]?.["software-licenses"]?.total||0),o=B(()=>t.remainingPrevisional[t.departmentEntry.id]?.["software-licenses"]||0),s=B(()=>t.donePrevisional[t.departmentEntry.id]?.["software-licenses"]||0),r=B(()=>t.isShowingExpenses?(t.softwareLicensesCosts[t.departmentEntry.id]?.total||0)-(n.value+o.value):0);return(u,c)=>(i(),a("tr",it,[l("td",at,d(u.$t("software_licenses.title")),1),c[0]||(c[0]=l("td",null,null,-1)),c[1]||(c[1]=l("td",null,null,-1)),e.isShowingExpenses?(i(),a(v,{key:0},[(i(!0),a(v,null,x(e.monthsBetweenStartAndNow,h=>(i(),a("td",{key:"software-"+e.departmentEntry.id+"-"+h,class:"costs"},d(e.convertedExpenses[e.departmentEntry.id]?.["software-licenses"]?.[h.format("YYYY-MM")]?.toLocaleString()),1))),128)),e.isShowingExpenses?(i(),a("td",dt,d(n.value.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",lt,d(s.value.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",{key:2,class:M(["total-cost gap",{positive:s.value>n.value,negative:s.value<n.value}])},d((s.value-n.value).toLocaleString()),3)):m("",!0)],64)):m("",!0),(i(!0),a(v,null,x(e.isShowingExpenses?e.monthsBetweenNowAndEnd:e.monthsBetweenProductionDates,h=>(i(),a("td",{key:"software-"+e.departmentEntry.id+"-"+h,class:"costs"},d(e.softwareLicensesCosts[e.departmentEntry.id]?.[h.format("YYYY-MM")]||""),1))),128)),e.isShowingExpenses?(i(),a("td",ut,d(o.value.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",ct,d((n.value+o.value).toLocaleString()),1)):m("",!0),l("td",gt,d(e.softwareLicensesCosts[e.departmentEntry.id]?.total||""),1),e.isShowingExpenses?(i(),a("td",{key:3,class:M(["total-cost gap",{positive:r.value>0,negative:r.value<0}])},d(r.value.toLocaleString()),3)):m("",!0),c[2]||(c[2]=l("td",{class:"actions"},null,-1))]))}},ht=C(mt,[["__scopeId","data-v-71da098f"]]),yt={class:"position datatable-row-header"},bt={class:"seniority datatable-row-header"},wt={class:"name datatable-row-header"},pt={class:"flexrow"},ft={key:2,class:"new-hiring"},Et={class:"base-salary-header text-right entry-data"},vt={class:"duration-header text-right entry-data"},Bt={key:0,class:"total-cost remaining-previsional"},xt={key:1,class:"total-cost"},St=["value","onChange"],Ct={key:1},Dt={key:1,class:"total-cost remaining-previsional"},Pt={key:2,class:"total-cost expense-and-remaining"},Mt={class:"total-cost"},kt={__name:"BudgetPersonRow",props:{personEntry:{type:Object,required:!0},departmentEntry:{type:Object,required:!0},isShowingExpenses:{type:Boolean,required:!0},monthsBetweenStartAndNow:{type:Array,required:!0},monthsBetweenNowAndEnd:{type:Array,required:!0},monthsBetweenProductionDates:{type:Array,required:!0},convertedExpenses:{type:Object,required:!0},personMap:{type:Map,required:!0},donePrevisional:{type:Object,required:!0},remainingPrevisional:{type:Object,required:!0}},emits:["delete-budget-entry","edit-budget-entry","add-person-exception"],setup(e){const t=e,n=B(()=>t.donePrevisional[t.departmentEntry.id]?.[t.personEntry.budget_entry_id]||0),o=B(()=>t.remainingPrevisional[t.departmentEntry.id]?.[t.personEntry.budget_entry_id]||0),s=B(()=>t.convertedExpenses[t.personEntry.department_id]?.[t.personEntry.budget_entry_id]||{total:0}),r=B(()=>t.isShowingExpenses?t.personEntry.total-(s.value.total+o.value):0),u=(c,h)=>{let g="";return typeof h=="string"?g=h:g=h.format("YYYY-MM"),c.exceptions=c.exceptions||{},parseInt(c.exceptions[g])||parseInt(c.monthCosts[g])||0};return(c,h)=>(i(),a("tr",{class:"datatable-row",key:e.personEntry.id},[l("td",yt,d(c.$t("budget.positions."+(e.personEntry.position||"artist"))),1),l("td",bt,d(c.$t("budget.seniorities."+(e.personEntry.seniority||"junior"))),1),l("td",wt,[l("div",pt,[e.personEntry.person_id?(i(),D(X,{key:0,class:"flexrow-item",person:e.personMap.get(e.personEntry.person_id),"is-link":!1,"font-size":12,size:20},null,8,["person"])):m("",!0),e.personEntry.person_id?(i(),D(Z,{key:1,person:e.personMap.get(e.personEntry.person_id)},null,8,["person"])):(i(),a("span",ft,d(c.$t("budget.new_hiring")),1))])]),l("td",Et,d((e.personEntry.monthly_salary||0).toLocaleString()),1),l("td",vt,d(e.personEntry.months_duration),1),e.isShowingExpenses?(i(),a(v,{key:0},[(i(!0),a(v,null,x(e.monthsBetweenStartAndNow,g=>(i(),a("td",{key:e.personEntry.id+"-"+g,class:"costs"},d(s.value?.[g.format("YYYY-MM")]?.toLocaleString()),1))),128)),e.isShowingExpenses?(i(),a("td",Bt,d(s.value.total.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",xt,d(n.value.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",{key:2,class:M(["total-cost gap",{positive:n.value>s.value.total,negative:n.value<s.value.total}])},d((n.value-s.value.total).toLocaleString()),3)):m("",!0)],64)):m("",!0),(i(!0),a(v,null,x(e.isShowingExpenses?e.monthsBetweenNowAndEnd:e.monthsBetweenProductionDates,g=>(i(),a("td",{key:e.personEntry.id+"-"+g,class:"month value-cell"},[e.personEntry.monthCosts[g.format("YYYY-MM")]?(i(),a("input",{key:0,class:"input-editor",type:"number",min:"0",step:"1",value:u(e.personEntry,g),onChange:w=>c.$emit("add-person-exception",{personEntry:e.personEntry,month:g,value:w.target.value})},null,40,St)):(i(),a("span",Ct," "))]))),128)),e.isShowingExpenses?(i(),a("td",Dt,d(o.value.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",Pt,d((s.value.total+o.value).toLocaleString()),1)):m("",!0),l("td",Mt,d(e.personEntry.total.toLocaleString()),1),e.isShowingExpenses?(i(),a("td",{key:3,class:M(["total-cost gap",{positive:r.value>0,negative:r.value<0}])},d(r.value.toLocaleString()),3)):m("",!0),b(ee,{onDeleteClicked:h[0]||(h[0]=g=>c.$emit("delete-budget-entry",e.personEntry)),onEditClicked:h[1]||(h[1]=g=>c.$emit("edit-budget-entry",e.personEntry))})]))}},_t=C(kt,[["__scopeId","data-v-6084e87c"]]),Yt={class:"datatable-row"},At={class:"datatable-row-header total-header",colspan:"3"},Lt={class:"pa05"},jt={key:0,class:"total-cost costs expenses"},Tt={key:1,class:"total-cost"},qt={key:1,class:"total-cost remaining-previsional"},It={key:2,class:"total-cost expense-and-remaining"},Ot={class:"total-cost"},Nt={__name:"BudgetTotalRow",props:{budgetDepartments:{type:Array,default:()=>[]},totalEntry:{type:Object,required:!0},isShowingExpenses:{type:Boolean,required:!0},isShowingItems:{type:Boolean,required:!0},monthsBetweenStartAndNow:{type:Array,required:!0},monthsBetweenNowAndEnd:{type:Array,required:!0},monthsBetweenProductionDates:{type:Array,required:!0},hardwareItemsCosts:{type:Object,required:!0},softwareLicensesCosts:{type:Object,required:!0},convertedExpenses:{type:Object,required:!0},donePrevisional:{type:Object,required:!0},remainingPrevisional:{type:Object,required:!0}},setup(e){const t=e,n=B(()=>t.isShowingExpenses?t.totalEntry.total-(t.convertedExpenses.total+t.remainingPrevisional.total):0),o=s=>{const r=s==="total"?s:s.format("YYYY-MM"),u=s==="total"?t.totalEntry.total:t.totalEntry.monthCosts[r]||0;return u?u.toLocaleString():""};return(s,r)=>(i(),a("tr",Yt,[l("td",At,[l("div",Lt,d(s.$t("main.total")),1)]),r[0]||(r[0]=l("td",{class:"month"},null,-1)),r[1]||(r[1]=l("td",{class:"month"},null,-1)),e.isShowingExpenses?(i(),a(v,{key:0},[(i(!0),a(v,null,x(e.monthsBetweenStartAndNow,u=>(i(),a("td",{key:u,class:"month"},d(e.convertedExpenses[u.format("YYYY-MM")]?.toLocaleString()),1))),128)),e.isShowingExpenses?(i(),a("td",jt,d(e.convertedExpenses.total?.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",Tt,d(e.donePrevisional.total?.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",{key:2,class:M(["total-cost gap",{positive:e.donePrevisional.total>e.convertedExpenses.total,negative:e.donePrevisional.total<e.convertedExpenses.total}])},d((e.donePrevisional.total-e.convertedExpenses.total).toLocaleString()),3)):m("",!0)],64)):m("",!0),(i(!0),a(v,null,x(e.isShowingExpenses?e.monthsBetweenNowAndEnd:e.monthsBetweenProductionDates,u=>(i(),a("td",{class:"month",key:u},d(o(u)),1))),128)),e.isShowingExpenses?(i(),a("td",qt,d(e.remainingPrevisional.total?.toLocaleString()),1)):m("",!0),e.isShowingExpenses?(i(),a("td",It,d((e.convertedExpenses.total+e.remainingPrevisional.total).toLocaleString()),1)):m("",!0),l("td",Ot,d(o("total")),1),e.isShowingExpenses?(i(),a("td",{key:3,class:M(["total-cost gap",{positive:n.value>0,negative:n.value<0}])},d(n.value.toLocaleString()),3)):m("",!0),r[2]||(r[2]=l("td",{class:"actions"},null,-1))]))}},Vt=C(Nt,[["__scopeId","data-v-a8b6c1bf"]]),$t={class:"datatable-row-header strong department-header",colspan:"3"},Rt={class:"flexrow-item"},Ft={__name:"BudgetDepartmentRow",props:{departmentEntry:{type:Object,required:!0},isShowingExpenses:{type:Boolean,required:!0},isShowingItems:{type:Boolean,required:!0},donePrevisional:{type:Object,required:!0},remainingPrevisional:{type:Object,required:!0},monthsBetweenStartAndNow:{type:Array,required:!0},monthsBetweenNowAndEnd:{type:Array,required:!0},monthsBetweenProductionDates:{type:Array,required:!0},convertedExpenses:{type:Object,required:!0},hardwareItemsCosts:{type:Object,required:!0},softwareLicensesCosts:{type:Object,required:!0},collapsedDepartments:{type:Object,required:!0},departmentMap:{type:Object,required:!0},toggleDepartment:{type:Function,required:!0}},setup(e){const t=e,n=B(()=>t.convertedExpenses[t.departmentEntry.id]||{total:0}),o=B(()=>t.donePrevisional[t.departmentEntry.id]?.total||0),s=B(()=>t.remainingPrevisional[t.departmentEntry.id]?.total||0),r=B(()=>t.isShowingExpenses?t.departmentEntry.total-(n.value.total+s.value):0),u=(h,g)=>({backgroundColor:t.departmentMap.get(h).color+g}),c=(h,g)=>{const w=g==="total"?g:g.format("YYYY-MM");let E=g==="total"?h.total:h.monthCosts[w]||0;return t.isShowingItems&&(E+=t.hardwareItemsCosts[h.id]?.[w]||0,E+=t.softwareLicensesCosts[h.id]?.[w]||0),E?E.toLocaleString():""};return(h,g)=>(i(),a("tr",{class:"datatable-row department-row pointer",onClick:g[0]||(g[0]=w=>e.toggleDepartment(e.departmentEntry.id))},[l("td",$t,[l("div",{class:"flexrow department-header-content",style:S(u(e.departmentEntry.id,"99"))},[e.collapsedDepartments[e.departmentEntry.id]?(i(),D(N(te),{key:0,class:"flexrow-item"})):(i(),D(N(ne),{key:1,class:"flexrow-item"})),l("div",Rt,d(e.departmentMap.get(e.departmentEntry.id).name),1)],4)]),l("td",{class:"base-salary-header text-right month",style:S(u(e.departmentEntry.id,"33"))},null,4),l("td",{class:"duration-header text-right month",style:S(u(e.departmentEntry.id,"33"))},null,4),e.isShowingExpenses?(i(),a(v,{key:0},[(i(!0),a(v,null,x(e.monthsBetweenStartAndNow,w=>(i(),a("td",{key:w,class:"month",style:S(u(e.departmentEntry.id,"33"))},d(n.value?.[w.format("YYYY-MM")]?.toLocaleString()),5))),128)),e.isShowingExpenses?(i(),a("td",{key:0,class:"total-cost remaining-previsional",style:S(u(e.departmentEntry.id,"33"))},d(n.value.total.toLocaleString()),5)):m("",!0),e.isShowingExpenses?(i(),a("td",{key:1,class:"total-cost",style:S(u(e.departmentEntry.id,"33"))},d(o.value.toLocaleString()),5)):m("",!0),e.isShowingExpenses?(i(),a("td",{key:2,class:M(["total-cost gap",{positive:o.value>n.value.total,negative:o.value<n.value.total}]),style:S(u(e.departmentEntry.id,"33"))},d((o.value-n.value.total).toLocaleString()),7)):m("",!0)],64)):m("",!0),(i(!0),a(v,null,x(e.isShowingExpenses?e.monthsBetweenNowAndEnd:e.monthsBetweenProductionDates,w=>(i(),a("td",{key:e.departmentEntry.id+"-"+w,class:"month",style:S(u(e.departmentEntry.id,"33"))},d(c(e.departmentEntry,w)||""),5))),128)),e.isShowingExpenses?(i(),a("td",{key:1,class:"total-cost remaining-previsional",style:S(u(e.departmentEntry.id,"33"))},d(s.value.toLocaleString()),5)):m("",!0),e.isShowingExpenses?(i(),a("td",{key:2,style:S(u(e.departmentEntry.id,"33")),class:"total-cost expense-and-remaining"},d((n.value.total+s.value).toLocaleString()),5)):m("",!0),l("td",{class:"total-cost",style:S(u(e.departmentEntry.id,"33"))},d(c(e.departmentEntry,"total")||""),5),e.isShowingExpenses?(i(),a("td",{key:3,class:M(["total-cost gap",{positive:r.value>0,negative:r.value<0}]),style:S(u(e.departmentEntry.id,"33"))},d(r.value.toLocaleString()),7)):m("",!0),l("td",{class:"actions",style:S(u(e.departmentEntry.id,"33"))},null,4)]))}},Ht=C(Ft,[["__scopeId","data-v-14d8d335"]]),Ut={name:"budget-list",mixins:[se,ge],emits:["add-budget-entry","delete-budget-entry","edit-budget-entry"],components:{BudgetListHeader:Je,BudgetPersonRow:_t,BudgetHardwareItemRow:ot,BudgetSoftwareLicenseRow:ht,BudgetTotalRow:Vt,BudgetDepartmentRow:Ht,ButtonSimple:_,Spinner:$},props:{budgetDepartments:{type:Array,default:()=>[]},currentBudget:{type:Object,default:()=>{}},expenses:{type:Object,default:()=>{}},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},isShowingExpenses:{type:Boolean,default:!1},isShowingItems:{type:Boolean,default:!1},linkedHardwareItems:{type:Object,required:!0},linkedSoftwareLicenses:{type:Object,required:!0},hardwareItemsCosts:{type:Object,required:!0},softwareLicensesCosts:{type:Object,required:!0},monthsBetweenStartAndNow:{type:Array,default:()=>[]},monthsBetweenNowAndEnd:{type:Array,default:()=>[]},monthsBetweenProductionDates:{type:Array,default:()=>[]},salaryScale:{type:Object,default:()=>{}},totalEntry:{type:Object,default:()=>({})}},data(){return{collapsedDepartments:{},domEvents:[["mousemove",this.onMouseMove],["touchmove",this.onMouseMove],["mouseup",this.stopBrowsing],["mouseleave",this.stopBrowsing],["touchend",this.stopBrowsing],["touchcancel",this.stopBrowsing],["keyup",this.stopBrowsing]]}},mounted(){const e=`budget:collapsed-departments-${this.currentProduction.id}`;this.addEvents(this.domEvents),this.collapsedDepartments=V.getObjectPreference(e)||{}},beforeUnmount(){this.removeEvents(this.domEvents),document.body.style.cursor="default"},computed:{...q(["currentProduction","departmentMap","personMap","organisation"]),convertedExpenses(){const e={},t=this.expenses||{};let n=0;return Object.keys(t).forEach(o=>{let s=0;e[o]={"software-licenses":{total:0},"hardware-items":{total:0}};const r=this.linkedSoftwareLicenses[o]||[],u=this.linkedHardwareItems[o]||[],c=r.reduce((g,w)=>g+w.monthly_cost,0),h=u.reduce((g,w)=>g+w.monthly_cost,0);Object.keys(t[o]).forEach(g=>{let w=0,E=0;const A=this.getDailyRate(o,g);e[o][g]={},Object.keys(t[o][g]).forEach(f=>{if(f==="total")return;const y=t[o][g][f],{cost:k,ratio:L}=this.convertTimeSpentToCost(A,y);e[o][g][f]=k,e[o][f]||(e[o][f]=0);let j=k;if(this.isShowingItems&&k>0){e[o]["software-licenses"][f]||(e[o]["software-licenses"][f]=0),e[o]["hardware-items"][f]||(e[o]["hardware-items"][f]=0);const I=Math.round(c*L),O=Math.round(h*L);e[o]["software-licenses"][f]+=I,e[o]["software-licenses"].total+=I,e[o]["hardware-items"][f]+=O,e[o]["hardware-items"].total+=O,j+=I+O}e[o][f]+=j,e[f]||(e[f]=0),e[f]+=j,w+=k,E+=j}),e[o][g].total=w,s+=E}),e[o].total=s,n+=s}),e.total=n,e},extendedBudgetDepartments(){if(!this.isShowingExpenses)return this.budgetDepartments;const e=this.budgetDepartments.reduce((s,r)=>(s[r.id]=!0,s),{}),t=Object.keys(this.expenses).filter(s=>!e[s]).map(s=>({id:s,monthCosts:{},total:0,duration:0,persons:[],start_date:null})),n=[...this.budgetDepartments,...t],o=n.reduce((s,r)=>(r.persons.forEach(u=>{s[r.id]||(s[r.id]={}),s[r.id][u.person_id]=!0}),s),{});return Object.keys(this.expenses).forEach(s=>{s!=="total"&&Object.keys(this.expenses[s]).forEach(r=>{if(r!=="total"&&!o[s]?.[r]){const u=this.personMap.get(r);n.find(c=>c.id===s).persons.push({id:null,person_id:r,budget_entry_id:null,department_id:s,monthCosts:{},position:u.position,seniority:u.seniority,total:0,months_duration:0,monthly_salary:0,daily_salary:u.daily_salary,start_date:null,exceptions:{}})}})}),n},remainingPrevisional(){return this.getPrevisionalSubset(this.monthsBetweenNowAndEnd)},doneSubset(){return this.getPrevisionalSubset(this.monthsBetweenStartAndNow)}},methods:{...R(["updateProductionBudgetEntry"]),getPrevisionalSubset(e){const t={total:0};return this.budgetDepartments.forEach(n=>{if(t[n.id]||(t[n.id]={total:0}),n.persons.forEach(o=>{if(!o.budget_entry_id)return;t[n.id][o.budget_entry_id]||(t[n.id][o.budget_entry_id]=0);let s=0;e.forEach(r=>{s+=this.getMonthCost(o,r)}),t[n.id][o.budget_entry_id]=s,t[n.id].total+=s}),this.isShowingItems){let o=0,s=0;e.forEach(r=>{o+=this.softwareLicensesCosts[n.id][r.format("YYYY-MM")]||0,s+=this.hardwareItemsCosts[n.id][r.format("YYYY-MM")]||0}),t[n.id]["software-licenses"]=o,t[n.id]["hardware-items"]=s,t[n.id].total+=o+s}t.total+=t[n.id].total}),t},getDailyRate(e,t){const n=this.personMap.get(t);if(!n)return 0;const o=n.seniority&&n.position?this.salaryScale[e][n.position][n.seniority]:0;return n.daily_salary||o},convertTimeSpentToCost(e,t){const n=t/60/this.organisation.hours_by_day,o=n/20;return{cost:Math.round(n*e),ratio:o}},getMonthCost(e,t){let n="";return typeof t=="string"?n=t:n=t.format("YYYY-MM"),e.exceptions=e.exceptions||{},parseInt(e.exceptions[n])||parseInt(e.monthCosts[n])||0},toggleDepartment(e){this.collapsedDepartments[e]=!this.collapsedDepartments[e];const t=`budget:collapsed-departments-${this.currentProduction.id}`;V.setObjectPreference(t,this.collapsedDepartments)},addPersonException({personEntry:e,month:t,value:n}){n=parseInt(n);const o=e.exceptions||{};o[t.format("YYYY-MM")]=n;const s={id:e.budget_entry_id,...e,exceptions:o};this.updateProductionBudgetEntry({productionId:this.currentProduction.id,budgetId:this.currentBudget.id,budgetEntryId:e.budget_entry_id,budgetEntry:s})}}},Kt={class:"budget-data"},Gt={key:0,class:"has-text-centered mt2"},zt={key:1,class:"flexrow mt2"},Wt={class:"list-error"},Jt={key:2,class:"mt2"},Qt={class:"has-text-centered mt1"},Xt={class:"has-text-centered mt1"},Zt={key:3,class:"data-list filler"},en={ref:"body",class:"datatable-wrapper flexcolumn filler"},tn={class:"datatable"};function nn(e,t,n,o,s,r){const u=p("spinner"),c=p("button-simple"),h=p("budget-list-header"),g=p("budget-total-row"),w=p("budget-department-row"),E=p("budget-hardware-item-row"),A=p("budget-software-license-row"),f=p("budget-person-row");return i(),a("div",Kt,[n.isLoading?(i(),a("div",Gt,[b(u)])):n.isError?(i(),a("div",zt,[l("p",Wt,d(e.$t("budget.budget_entries_error")),1)])):n.budgetDepartments.length===0?(i(),a("div",Jt,[l("p",Qt,d(e.$t("budget.no_budget_entries_found")),1),l("p",Xt,[b(c,{text:e.$t("budget.add_entry"),onClick:t[0]||(t[0]=y=>e.$emit("add-budget-entry"))},null,8,["text"])])])):(i(),a("div",Zt,[l("div",en,[l("table",tn,[b(h,{"is-showing-expenses":n.isShowingExpenses,"months-between-start-and-now":n.monthsBetweenStartAndNow,"months-between-now-and-end":n.monthsBetweenNowAndEnd,"months-between-production-dates":n.monthsBetweenProductionDates,onAddBudgetEntry:t[1]||(t[1]=y=>e.$emit("add-budget-entry"))},null,8,["is-showing-expenses","months-between-start-and-now","months-between-now-and-end","months-between-production-dates"]),l("tbody",{class:"datatable-body",onMousedown:t[3]||(t[3]=(...y)=>e.startBrowsing&&e.startBrowsing(...y)),onTouchstart:t[4]||(t[4]=(...y)=>e.startBrowsing&&e.startBrowsing(...y))},[b(g,{"budget-departments":n.budgetDepartments,"total-entry":n.totalEntry,"is-showing-expenses":n.isShowingExpenses,"is-showing-items":n.isShowingItems,"months-between-start-and-now":n.monthsBetweenStartAndNow,"months-between-now-and-end":n.monthsBetweenNowAndEnd,"months-between-production-dates":n.monthsBetweenProductionDates,"converted-expenses":r.convertedExpenses,"hardware-items-costs":n.hardwareItemsCosts,"software-licenses-costs":n.softwareLicensesCosts,"done-previsional":r.doneSubset,"remaining-previsional":r.remainingPrevisional},null,8,["budget-departments","total-entry","is-showing-expenses","is-showing-items","months-between-start-and-now","months-between-now-and-end","months-between-production-dates","converted-expenses","hardware-items-costs","software-licenses-costs","done-previsional","remaining-previsional"]),(i(!0),a(v,null,x(r.extendedBudgetDepartments,y=>(i(),a(v,{key:y.id},[b(w,{"department-entry":y,"is-showing-expenses":n.isShowingExpenses,"is-showing-items":n.isShowingItems,"months-between-start-and-now":n.monthsBetweenStartAndNow,"months-between-now-and-end":n.monthsBetweenNowAndEnd,"months-between-production-dates":n.monthsBetweenProductionDates,"converted-expenses":r.convertedExpenses,"hardware-items-costs":n.hardwareItemsCosts,"software-licenses-costs":n.softwareLicensesCosts,"collapsed-departments":s.collapsedDepartments,"department-map":e.departmentMap,"done-previsional":r.doneSubset,"remaining-previsional":r.remainingPrevisional,"toggle-department":r.toggleDepartment},null,8,["department-entry","is-showing-expenses","is-showing-items","months-between-start-and-now","months-between-now-and-end","months-between-production-dates","converted-expenses","hardware-items-costs","software-licenses-costs","collapsed-departments","department-map","done-previsional","remaining-previsional","toggle-department"]),s.collapsedDepartments[y.id]?m("",!0):(i(),a(v,{key:0},[n.isShowingItems?(i(),D(E,{key:y.id,"department-entry":y,"is-showing-expenses":n.isShowingExpenses,"months-between-start-and-now":n.monthsBetweenStartAndNow,"months-between-now-and-end":n.monthsBetweenNowAndEnd,"months-between-production-dates":n.monthsBetweenProductionDates,"converted-expenses":r.convertedExpenses,"hardware-items-costs":n.hardwareItemsCosts,"done-previsional":r.doneSubset,"remaining-previsional":r.remainingPrevisional},null,8,["department-entry","is-showing-expenses","months-between-start-and-now","months-between-now-and-end","months-between-production-dates","converted-expenses","hardware-items-costs","done-previsional","remaining-previsional"])):m("",!0),n.isShowingItems?(i(),D(A,{key:y.id,"department-entry":y,"is-showing-expenses":n.isShowingExpenses,"months-between-start-and-now":n.monthsBetweenStartAndNow,"months-between-now-and-end":n.monthsBetweenNowAndEnd,"months-between-production-dates":n.monthsBetweenProductionDates,"converted-expenses":r.convertedExpenses,"software-licenses-costs":n.softwareLicensesCosts,"done-previsional":r.doneSubset,"remaining-previsional":r.remainingPrevisional},null,8,["department-entry","is-showing-expenses","months-between-start-and-now","months-between-now-and-end","months-between-production-dates","converted-expenses","software-licenses-costs","done-previsional","remaining-previsional"])):m("",!0),(i(!0),a(v,null,x(y.persons,k=>(i(),D(f,{key:k.id,"department-entry":y,"person-entry":k,"is-showing-expenses":n.isShowingExpenses,"months-between-start-and-now":n.monthsBetweenStartAndNow,"months-between-now-and-end":n.monthsBetweenNowAndEnd,"months-between-production-dates":n.monthsBetweenProductionDates,"converted-expenses":r.convertedExpenses,"person-map":e.personMap,"done-previsional":r.doneSubset,"remaining-previsional":r.remainingPrevisional,onDeleteBudgetEntry:L=>e.$emit("delete-budget-entry",k),onEditBudgetEntry:L=>e.$emit("edit-budget-entry",k),onAddPersonException:t[2]||(t[2]=L=>r.addPersonException(L))},null,8,["department-entry","person-entry","is-showing-expenses","months-between-start-and-now","months-between-now-and-end","months-between-production-dates","converted-expenses","person-map","done-previsional","remaining-previsional","onDeleteBudgetEntry","onEditBudgetEntry"]))),128))],64))],64))),128))],32)])],512)]))])}const sn=C(Ut,[["render",nn]]),rn={name:"edit-budget-modal",mixins:[G],components:{BaseModal:K,Combobox:U,ModalFooter:H,TextField:F},props:{active:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},budgetToEdit:{type:Object,default:()=>{}},lastRevision:{type:Number,default:0}},emits:["cancel","confirm"],data(){return{form:{name:"",currency:"USD"},currencieOptions:[{label:"USD",value:"USD"},{label:"EUR",value:"EUR"},{label:"GBP",value:"GBP"},{label:"CAD",value:"CAD"},{label:"AUD",value:"AUD"},{label:"CHF",value:"CHF"},{label:"JPY",value:"JPY"},{label:"CNY",value:"CNY"},{label:"INR",value:"INR"}]}},computed:{isDisabled(){return this.form.name.length===0},isEditing(){return this.budgetToEdit&&this.budgetToEdit.id},modalTitle(){return this.isEditing?this.$t("budget.edit_budget"):this.$t("budget.create_budget")}},methods:{runConfirmation(){this.$emit("confirm",this.form)}},watch:{active(){this.active&&setTimeout(()=>{this.$refs.nameField.focus()},100)},budgetToEdit(){this.budgetToEdit.id?this.form={id:this.budgetToEdit.id,name:this.budgetToEdit.name,currency:this.budgetToEdit.currency||"USD"}:this.form={id:null,name:"",currency:"USD"}}}},on={class:"field"},an={class:"label"},dn={class:"revision-number"};function ln(e,t,n,o,s,r){const u=p("text-field"),c=p("combobox"),h=p("modal-footer"),g=p("base-modal"),w=z("focus");return i(),D(g,{active:n.active,title:r.modalTitle,onCancel:t[4]||(t[4]=E=>e.$emit("cancel"))},{default:T(()=>[l("form",{onSubmit:t[2]||(t[2]=W(()=>{},["prevent"]))},[l("div",on,[l("label",an,d(e.$t("budget.fields.revision")),1),l("p",dn," v"+d(r.isEditing?n.budgetToEdit.revision:n.lastRevision+1),1)]),J(b(u,{ref:"nameField",label:e.$t("budget.fields.name"),maxlength:30,modelValue:s.form.name,"onUpdate:modelValue":t[0]||(t[0]=E=>s.form.name=E),onEnter:r.runConfirmation},null,8,["label","modelValue","onEnter"]),[[w]]),b(c,{label:e.$t("budget.fields.currency"),options:s.currencieOptions,modelValue:s.form.currency,"onUpdate:modelValue":t[1]||(t[1]=E=>s.form.currency=E)},null,8,["label","options","modelValue"])],32),b(h,{"error-text":e.$t("budget.create_budget_error"),"is-error":n.isError,"is-loading":n.isLoading,"is-disabled":r.isDisabled,onConfirm:r.runConfirmation,onCancel:t[3]||(t[3]=E=>e.$emit("cancel"))},null,8,["error-text","is-error","is-loading","is-disabled","onConfirm"])]),_:1},8,["active","title"])}const un=C(rn,[["render",ln],["__scopeId","data-v-24a2d62d"]]),cn={name:"month-field",emits:["update:modelValue"],components:{ComboboxNumber:re},props:{label:{type:String,default:""},minDate:{type:Date,required:!0},maxDate:{type:Date,required:!0},modelValue:{}},data(){return{selectedMonth:null,selectedYear:null,months:[]}},mounted(){this.months=oe(1,12).map(e=>({value:e-1,label:Y().month(e-1).format("MMMM")})),this.modelValue&&this.modelValue.getMonth&&(this.selectedMonth=this.modelValue.getMonth(),this.selectedYear=this.modelValue.getFullYear())},computed:{availableYears(){const e=[],t=this.minDate.getFullYear(),n=this.maxDate.getFullYear();for(let o=t;o<=n;o++)e.push(o);return e.map(o=>({value:o,label:o}))},availableMonths(){const e=this.selectedYear||this.availableYears[0].value,t=this.minDate.getFullYear(),n=this.maxDate.getFullYear(),o=this.minDate.getMonth(),s=this.maxDate.getMonth();return this.months.filter(r=>e===t&&e===n?r.value>=o&&r.value<=s:e===t?r.value>=o:e===n?r.value<=s:!0).map(r=>({value:r.value,label:r.label}))}},watch:{modelValue(){this.$options.silent=!0,this.modelValue&&this.modelValue.getMonth&&(this.selectedMonth=this.modelValue.getMonth(),this.selectedYear=this.modelValue.getFullYear()),this.$nextTick(()=>{this.$options.silent=!1})},selectedMonth(e){if(this.$options.silent)return;const t=Y(new Date(this.selectedYear,e,1,0,0,0,0));this.$emit("update:modelValue",t.startOf("month").toDate())},selectedYear(e){this.$options.silent||this.$nextTick(()=>{this.selectedMonth=this.availableMonths[0].value;const t=Y(new Date(e,this.selectedMonth,1,0,0,0,0));this.$emit("update:modelValue",t.startOf("month").toDate())})}}},gn={class:"month-field flexcolumn"},mn={key:0,class:"label"},hn={class:"date-selector"};function yn(e,t,n,o,s,r){const u=p("combobox-number");return i(),a("div",gn,[n.label.length>0?(i(),a("label",mn,d(n.label),1)):m("",!0),l("div",hn,[b(u,{options:r.availableYears,modelValue:s.selectedYear,"onUpdate:modelValue":t[0]||(t[0]=c=>s.selectedYear=c)},null,8,["options","modelValue"]),b(u,{options:r.availableMonths,modelValue:s.selectedMonth,"onUpdate:modelValue":t[1]||(t[1]=c=>s.selectedMonth=c)},null,8,["options","modelValue"])])])}const bn=C(cn,[["render",yn],["__scopeId","data-v-962e2d9d"]]),wn={name:"edit-budget-entry-modal",mixins:[G],components:{BaseModal:K,Combobox:U,ComboboxDepartment:ae,ModalFooter:H,MonthField:bn,PeopleField:ie,TextField:F},props:{active:{type:Boolean,default:!1},budgetEntryToEdit:{type:Object,default:()=>{}},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},salaryScale:{type:Object,default:()=>{}}},emits:["cancel","confirm"],data(){return{form:{department_id:"",person:null,position:"artist",seniority:"junior",start_date:null,months_duration:1},positionOptions:[{label:"artist",value:"artist"},{label:"supervisor",value:"supervisor"},{label:"lead",value:"lead"}],refreshKeys:{endMonth:0},seniorityOptions:[{label:"junior",value:"junior"},{label:"mid",value:"mid"},{label:"senior",value:"senior"}]}},mounted(){this.resetForm()},computed:{...q(["activePeople","currentProduction","personMap"]),isDisabled(){return!this.form.department_id||this.form.months_duration<1},isEditing(){return this.budgetEntryToEdit&&this.budgetEntryToEdit.id},projectStartDate(){return P(this.currentProduction.start_date).toDate()},projectEndDate(){return P(this.currentProduction.end_date).toDate()},endMonth(){this.refreshKeys.endMonth;const e=P(this.form.start_date),t=P(this.currentProduction.end_date);let n=e.add(this.form.months_duration,"months");return n=Y.min(n,t),n.format("YYYY-MM")},dailySalary(){return this.form.department_id?!this.form.person||!this.form.person.daily_salary?this.salaryScale[this.form.department_id][this.form.position||"artist"][this.form.seniority||"junior"].salary:this.form.person.daily_salary:0},monthlySalary(){return this.dailySalary*20},totalSalary(){if(this.form.department_id){const e=Math.min(this.form.months_duration,this.maxDuration);return this.monthlySalary*e}else return 0},maxDuration(){const e=P(this.form.start_date),n=P(this.currentProduction.end_date).endOf("month").diff(e,"months");return n>0?n:1},departmentPeople(){return this.form.department_id?this.activePeople.filter(e=>e.departments.includes(this.form.department_id)):this.activePeople}},methods:{runConfirmation(){this.$emit("confirm",{...this.form,person_id:this.form.person?.id,duration:Math.min(this.form.months_duration,this.maxDuration),salary:this.monthlySalary,total_salary:this.totalSalary})},onPersonChanged(e){this.form.position=e?.position||"artist",this.form.seniority=e?.seniority||"junior"},formatDate(e){return de(e)},resetForm(){if(this.isEditing){const e=this.personMap.get(this.budgetEntryToEdit.person_id);Object.assign(this.form,{id:this.budgetEntryToEdit.id,department_id:this.budgetEntryToEdit.department_id,person:e,position:this.budgetEntryToEdit.position||"artist",seniority:this.budgetEntryToEdit.seniority||"junior",start_date:P(this.budgetEntryToEdit.start_date).toDate(),months_duration:this.budgetEntryToEdit.months_duration,daily_salary:this.budgetEntryToEdit.daily_salary}),this.form.person=e,this.$nextTick(()=>{this.form.daily_salary=this.budgetEntryToEdit.daily_salary})}else this.form={id:null,department_id:"",person:null,position:"artist",seniority:"junior",start_date:P(this.currentProduction.start_date).startOf("month").toDate(),months_duration:1,daily_salary:0}}},watch:{active(){this.active&&(this.resetForm(),setTimeout(()=>{this.$refs.departmentField.focus()},100))},dailySalary(){this.form.daily_salary=this.dailySalary},budgetEntryToEdit(){this.resetForm()}}},pn={class:"flexrow"},fn={class:"mt0"},En={class:"salary-label"},vn={class:"salary-value"},Bn={class:"salary-label"},xn={class:"salary-value"},Sn={class:"salary-label"},Cn={class:"salary-value"},Dn={class:"salary-label"},Pn={class:"salary-value"};function Mn(e,t,n,o,s,r){const u=p("combobox-department"),c=p("people-field"),h=p("combobox"),g=p("month-field"),w=p("text-field"),E=p("modal-footer"),A=p("base-modal"),f=z("focus");return i(),D(A,{active:n.active,title:r.isEditing?e.$t("budget.edit_budget_entry"):e.$t("budget.add_entry"),onCancel:t[9]||(t[9]=y=>e.$emit("cancel"))},{default:T(()=>[l("form",{onSubmit:t[7]||(t[7]=W(()=>{},["prevent"]))},[J(b(u,{ref:"departmentField",label:e.$t("budget.fields.department"),modelValue:s.form.department_id,"onUpdate:modelValue":t[0]||(t[0]=y=>s.form.department_id=y),onEnter:r.runConfirmation},null,8,["label","modelValue","onEnter"]),[[f]]),b(c,{class:"mt2",label:e.$t("budget.fields.person"),people:r.departmentPeople,onSelect:r.onPersonChanged,onEnter:r.runConfirmation,modelValue:s.form.person,"onUpdate:modelValue":t[1]||(t[1]=y=>s.form.person=y)},null,8,["label","people","onSelect","onEnter","modelValue"]),b(h,{class:"mt2",label:e.$t("budget.fields.position"),options:s.positionOptions,"locale-key-prefix":"people.position.",modelValue:s.form.position,"onUpdate:modelValue":t[2]||(t[2]=y=>s.form.position=y),onEnter:r.runConfirmation},null,8,["label","options","modelValue","onEnter"]),b(h,{class:"mt2",label:e.$t("budget.fields.seniority"),options:s.seniorityOptions,"locale-key-prefix":"people.seniority.",modelValue:s.form.seniority,"onUpdate:modelValue":t[3]||(t[3]=y=>s.form.seniority=y),onEnter:r.runConfirmation},null,8,["label","options","modelValue","onEnter"]),l("div",pn,[b(g,{class:"mr1",label:e.$t("budget.fields.start_date"),"min-date":r.projectStartDate,"max-date":r.projectEndDate,modelValue:s.form.start_date,"onUpdate:modelValue":t[4]||(t[4]=y=>s.form.start_date=y)},null,8,["label","min-date","max-date","modelValue"]),b(w,{class:"month-duration",type:"number",min:1,max:r.maxDuration,label:e.$t("budget.fields.months_duration"),modelValue:s.form.months_duration,"onUpdate:modelValue":t[5]||(t[5]=y=>s.form.months_duration=y),onEnter:r.runConfirmation},null,8,["max","label","modelValue","onEnter"]),b(w,{class:"month-duration",type:"number",min:0,label:e.$t("budget.fields.daily_salary"),modelValue:s.form.daily_salary,"onUpdate:modelValue":t[6]||(t[6]=y=>s.form.daily_salary=y),onEnter:r.runConfirmation},null,8,["label","modelValue","onEnter"])]),l("div",fn,[l("span",En,d(e.$t("budget.fields.start_date")),1),l("span",vn,d(r.formatDate(s.form.start_date).substring(0,7)),1),t[10]||(t[10]=l("br",null,null,-1)),l("span",Bn,d(e.$t("budget.fields.end_date")),1),l("span",xn,d(r.endMonth),1),t[11]||(t[11]=l("br",null,null,-1)),l("span",Sn,d(e.$t("budget.fields.monthly_salary")),1),l("span",Cn,d(r.monthlySalary),1),t[12]||(t[12]=l("br",null,null,-1)),l("span",Dn,d(e.$t("budget.fields.total_salary")),1),l("span",Pn,d(r.totalSalary),1)])],32),b(E,{"error-text":e.$t("budget.create_budget_error"),"is-error":n.isError,"is-loading":n.isLoading,"is-disabled":r.isDisabled,onConfirm:r.runConfirmation,onCancel:t[8]||(t[8]=y=>e.$emit("cancel"))},null,8,["error-text","is-error","is-loading","is-disabled","onConfirm"])]),_:1},8,["active","title"])}const kn=C(wn,[["render",Mn],["__scopeId","data-v-8339aaac"]]),_n={resetDepartmentTotals(e){e.total=e.persons.reduce((t,n)=>t+n.total,0),e.monthCosts=e.persons.reduce((t,n)=>(Object.keys(n.monthCosts).forEach(o=>{t[o]=(t[o]||0)+n.monthCosts[o]}),t),{})}},Yn={name:"budget",mixins:[he],components:{BudgetAnalytics:Se,BudgetHeader:Te,BudgetList:sn,DeleteModal:ue,EditBudgetEntryModal:kn,EditBudgetModal:un,HardDeleteModal:le,PageLayout:me},data(){return{budgets:[],budgetEntries:[],budgetEntryToEdit:{},budgetToEdit:{},currentBudget:{},linkedHardwareItems:{},linkedSoftwareLicenses:{},errors:{budgets:!1,createBudget:!1,deleteBudget:!1,deleteBudgetEntry:!1,editBudget:!1,editBudgetEntry:!1,entries:!1,expenses:!1},items:{showing:!1},expenses:{data:{},showing:!1},loading:{budgets:!0,createBudget:!1,deleteBudget:!1,deleteBudgetEntry:!1,editBudget:!1,editBudgetEntry:!1,entries:!0,expenses:!1},modals:{createBudget:!1,createBudgetEntry:!1,deleteBudget:!1,deleteBudgetEntry:!1},monthsBetweenProductionDates:[],salaryScale:{}}},async mounted(){this.pageTitle=this.$t("budget.title"),await this.setSalaryScale(),await this.loadBudgets(),await this.loadBudgetEntries(),this.linkedHardwareItems=await this.loadLinkedHardwareItems(),this.linkedSoftwareLicenses=await this.loadLinkedSoftwareLicenses(),this.resetMonths()},computed:{...q(["currentProduction","departmentMap","personMap"]),monthsBetweenStartAndNow(){return this.getMonthsBetweenDates(this.currentProduction.start_date,Y().format("YYYY-MM-DD"))},monthsBetweenNowAndEnd(){return this.getMonthsBetweenDates(Y().add(1,"month").format("YYYY-MM-DD"),this.currentProduction.end_date)},budgetOptions(){return this.budgets.map(e=>({label:`v${e.revision} - ${e.name}`,value:e}))},lastRevision(){return this.budgets?.[0]?.revision||0},budgetDepartments(){const e=new Set(this.budgetEntries.map(n=>n.department_id)),t=[];return Array.from(e).map(n=>{const o=this.budgetEntries.filter(r=>r.department_id===n),s={id:n,monthCosts:{},total:0,duration:0,persons:[],start_date:null};o.forEach(r=>{const u=r.daily_salary*20,c={};let h=0;r.exceptions=r.exceptions||{};for(let E=0;E<r.months_duration;E++){const f=Y(r.start_date).add(E,"month").format("YYYY-MM"),y=r.exceptions[f]||u;c[f]=y,h+=y}s.persons.push({id:r.id,person_id:r.person_id,budget_entry_id:r.id,department_id:r.department_id,monthCosts:c,position:r.position,seniority:r.seniority,total:h,months_duration:r.months_duration,monthly_salary:u,daily_salary:r.daily_salary,start_date:r.start_date,exceptions:r.exceptions});const g=Y(r.start_date),w=Y(s.start_date);(!s.start_date||g.isBefore(w))&&(s.start_date=r.start_date),s.persons.sort(this.sortDepartmentPersons)}),_n.resetDepartmentTotals(s),t.push(s)}),t.sort((n,o)=>{const s=this.departmentMap.get(n.id),r=this.departmentMap.get(o.id);return s.name.localeCompare(r.name)}),t},totalEntry(){let e=this.budgetDepartments.reduce((n,o)=>n+o.total,0);this.items.showing&&(e+=this.hardwareItemsCosts.total+this.softwareLicensesCosts.total);const t=this.budgetDepartments.reduce((n,o)=>(Object.keys(o.monthCosts).forEach(s=>{n[s]=(n[s]||0)+o.monthCosts[s],this.items.showing&&(n[s]+=this.hardwareItemsCosts[o.id]?.[s]||0,n[s]+=this.softwareLicensesCosts[o.id]?.[s]||0)}),n),{});return{total:e,monthCosts:t}},hardwareItemsCosts(){return this.getItemCosts(this.linkedHardwareItems)},softwareLicensesCosts(){return this.getItemCosts(this.linkedSoftwareLicenses)},pieChartData(){return this.budgetDepartments.map(e=>[this.departmentMap.get(e.id).name,e.total])},pieChartColors(){return this.budgetDepartments.map(e=>this.departmentMap.get(e.id).color)},columnChartData(){return this.monthsBetweenProductionDates.map(e=>{const t=e.format("YYYY-MM"),[n,o]=t.split("-");return[`${o}/${n.slice(2)}`,this.totalEntry.monthCosts[t]||0]})}},methods:{...R(["createProductionBudgetEntry","createProductionBudget","deleteProductionBudget","deleteProductionBudgetEntry","loadExpenses","loadLinkedHardwareItems","loadLinkedSoftwareLicenses","loadProductionBudget","loadProductionBudgets","loadProductionBudgetEntry","loadProductionBudgetEntries","loadSalaryScale","updateProductionBudget","updateProductionBudgetEntry"]),getItemCosts(e){const t={total:0};return this.budgetDepartments.forEach(n=>{const s=(e[n.id]||[]).reduce((r,u)=>r+u.monthly_cost,0);t[n.id]||(t[n.id]={total:0}),this.monthsBetweenProductionDates.forEach(r=>{t[n.id][r.format("YYYY-MM")]=0,n.persons.forEach(u=>{this.getMonthCost(u,r)>0&&(t[n.id][r.format("YYYY-MM")]+=s,t[n.id].total+=s,t.total+=s)})})}),t},getMonthCost(e,t){let n="";return typeof t=="string"?n=t:n=t.format("YYYY-MM"),e.exceptions=e.exceptions||{},parseInt(e.exceptions[n])||parseInt(e.monthCosts[n])||0},resetMonths(){this.monthsBetweenProductionDates=this.getMonthsBetweenDates(this.currentProduction.start_date,this.currentProduction.end_date)},sortDepartmentPersons(e,t){const n={junior:1,mid:2,senior:3},o={artist:1,lead:2,supervisor:3},s=n[e.seniority],r=n[t.seniority],u=o[e.position],c=o[t.position];if(e.person_id===null&&t.person_id===null)return u===c?r-s:c-u;if(e.person_id===null)return 1;if(t.person_id===null)return-1;{const h=this.personMap.get(e.person_id),g=this.personMap.get(t.person_id);return h.name===g.name?u===c?r-s:c-u:h.name.localeCompare(g.name)}},async setSalaryScale(){this.salaryScale=await this.loadSalaryScale()},onChangeBudget(e){this.currentBudget=e},onEditBudgetClicked(){this.budgetToEdit=this.currentBudget,this.modals.createBudget=!0},onExportBudgetClicked(){const e=[this.$t("budget.title").toLowerCase(),this.currentProduction.name,`v${this.currentBudget.revision}`,this.currentBudget.name,this.currentBudget.currency];ce.generateBudget(this.$t,this.departmentMap,this.personMap,e,this.currentBudget.currency,this.monthsBetweenProductionDates,this.totalEntry,this.budgetDepartments)},onNewBudgetVersionClicked(){this.budgetToEdit={},this.modals.createBudget=!0},async createBudget(e){try{if(this.loading.createBudget=!0,this.errors.createBudget=!1,e.id){await this.updateProductionBudget({productionId:this.currentProduction.id,budget:{id:this.currentBudget.id,name:e.name,currency:e.currency}});const t=this.budgets.find(n=>n.id===this.currentBudget.id);t&&Object.assign(t,{name:e.name,currency:e.currency})}else{this.loading.createBudget=!0;const t=await this.createProductionBudget({productionId:this.currentProduction.id,budget:e});this.budgets.unshift(t),this.currentBudget=t}this.modals.createBudget=!1}catch(t){console.error(t),this.errors.createBudget=!0}finally{this.loading.createBudget=!1}},onDeleteBudgetClicked(){this.errors.deleteBudget=!1,this.modals.deleteBudget=!0},async deleteBudget(){this.loading.deleteBudget=!0;try{const e=this.currentBudget;await this.deleteProductionBudget({productionId:this.currentProduction.id,budgetId:e.id}),this.budgets=this.budgets.filter(t=>t.id!==e.id),this.currentBudget=this.budgets?.[0]||{},this.modals.deleteBudget=!1}catch(e){console.error(e),this.errors.deleteBudget=!0}finally{this.loading.deleteBudget=!1}},onAddBudgetEntry(){this.budgetEntryToEdit={},this.modals.createBudgetEntry=!0},async confirmCreateBudgetEntry(e){e.id?await this.runRemoteBudgetEntryEdition(e):await this.runRemoteBudgetEntryCreation(e)},async runRemoteBudgetEntryCreation(e){try{this.loading.createBudgetEntry=!0,this.errors.createBudgetEntry=!1,await this.createProductionBudgetEntry({productionId:this.currentProduction.id,budgetId:this.currentBudget.id,budgetEntry:{...e,person_id:e.person?e.person.id:null}}),this.modals.createBudgetEntry=!1}catch(t){console.error(t),this.errors.createBudgetEntry=!0}finally{this.loading.createBudgetEntry=!1}},editBudgetEntry(e){this.budgetEntryToEdit=e,this.modals.createBudgetEntry=!0},async runRemoteBudgetEntryEdition(e){try{this.loading.editBudgetEntry=!0,this.errors.editBudgetEntry=!1,await this.updateProductionBudgetEntry({productionId:this.currentProduction.id,budgetId:this.currentBudget.id,budgetEntryId:e.id,budgetEntry:{id:e.id,department_id:e.department_id,person_id:e.person?e.person.id:null,position:e.position,seniority:e.seniority,start_date:e.start_date,months_duration:e.duration,daily_salary:e.daily_salary}}),this.modals.createBudgetEntry=!1}catch(t){console.error(t),this.errors.editBudgetEntry=!0}finally{this.loading.editBudgetEntry=!1}},afterEditBudgetEntry(e){const t=this.budgetEntries.find(n=>n.id===e.id);t&&Object.assign(t,e)},async deleteBudgetEntry(e){this.loading.deleteBudgetEntry=!1,this.errors.deleteBudgetEntry=!1,this.modals.deleteBudgetEntry=!0,this.budgetEntryToDelete=e},async confirmDeleteBudgetEntry(){this.loading.deleteBudgetEntry=!0;try{await this.deleteProductionBudgetEntry({productionId:this.currentProduction.id,budgetId:this.currentBudget.id,budgetEntryId:this.budgetEntryToDelete.budget_entry_id}),this.postDeleteBudgetEntry(this.budgetEntryToDelete),this.modals.deleteBudgetEntry=!1}catch(e){console.error(e),this.errors.deleteBudgetEntry=!0}finally{this.loading.deleteBudgetEntry=!1}},postDeleteBudgetEntry(e){this.budgetEntries=this.budgetEntries.filter(t=>t.id!==e.id)},async loadBudgets(){try{this.loading.budgets=!0,this.errors.budgets=!1,this.budgets=await this.loadProductionBudgets(this.currentProduction.id),this.budgets.sort((e,t)=>t.revision-e.revision),this.currentBudget=this.budgets?.[0]||{}}catch(e){console.error(e),this.errors.budgets=!0}finally{this.loading.budgets=!1}},async loadBudgetEntries(){if(!(!this.currentBudget||!this.currentBudget.id))try{this.loading.entries=!0,this.errors.entries=!1,this.budgetEntries=await this.loadProductionBudgetEntries({productionId:this.currentProduction.id,budgetId:this.currentBudget.id})}catch(e){console.error(e),this.errors.entries=!0}finally{this.loading.entries=!1}},getMonthsBetweenDates(e,t){const n=[],o=P(e),s=P(t);for(;o<=s;)n.push(o.clone()),o.add(1,"month");return n},async onToggleExpenses(){if(!this.expenses.showing)try{this.loading.expenses=!0,this.errors.expenses=!1,this.expenses.data=await this.loadExpenses(this.currentProduction.id)}catch(e){console.error(e),this.errors.expenses=!0}finally{this.loading.expenses=!1}this.expenses.showing=!this.expenses.showing},onToggleItems(){this.items.showing=!this.items.showing}},watch:{currentProduction(){this.loadBudgets(),this.resetMonths()},currentBudget(){this.loadBudgetEntries()}},socket:{events:{async"budget:create"(e){if(e.project_id!==this.currentProduction.id)return;const t=await this.loadProductionBudget({productionId:this.currentProduction.id,budgetId:e.budget_id}),n=this.budgets.find(o=>o.id===t.id);t&&!n&&this.budgets.unshift(t)},async"budget:update"(e){if(e.project_id!==this.currentProduction.id)return;const t=await this.loadProductionBudget({productionId:this.currentProduction.id,budgetId:e.budget_id});if(t){const n=this.budgets.find(o=>o.id===t.id);n&&Object.assign(n,{name:t.name,currency:t.currency})}},async"budget:delete"(e){if(e.project_id!==this.currentProduction.id)return;const t=this.budgets.find(o=>o.id===e.budget_id),n=this.currentBudget.id===e.budget_id;t&&(this.budgets=this.budgets.filter(o=>o.id!==e.budget_id),n&&(this.currentBudget=this.budgets?.[0]||{}))},async"budget-entry:create"(e){if(e.project_id!==this.currentProduction.id||e.budget_id!==this.currentBudget.id||this.budgetEntries.find(o=>o.id===e.budget_entry_id))return;const n=await this.loadProductionBudgetEntry({productionId:this.currentProduction.id,budgetId:this.currentBudget.id,budgetEntryId:e.budget_entry_id});this.budgetEntries.push(n)},async"budget-entry:update"(e){if(e.project_id!==this.currentProduction.id||e.budget_id!==this.currentBudget.id||!this.budgetEntries.find(o=>o.id===e.budget_entry_id))return;const n=await this.loadProductionBudgetEntry({productionId:this.currentProduction.id,budgetId:this.currentBudget.id,budgetEntryId:e.budget_entry_id});this.afterEditBudgetEntry(n)},async"budget-entry:delete"(e){e.project_id!==this.currentProduction.id||e.budget_id!==this.currentBudget.id||!this.budgetEntries.find(n=>n.id===e.budget_entry_id)||this.postDeleteBudgetEntry({id:e.budget_entry_id})}}}},An={class:"flexcolumn page"};function Ln(e,t,n,o,s,r){const u=p("budget-header"),c=p("budget-list"),h=p("edit-budget-modal"),g=p("edit-budget-entry-modal"),w=p("hard-delete-modal"),E=p("delete-modal"),A=p("budget-analytics"),f=p("page-layout");return i(),D(f,null,{main:T(()=>[l("div",An,[b(u,{"budget-options":r.budgetOptions,budget:s.currentBudget,"is-loading":s.loading.budgets,"is-error":s.errors.budgets,"is-error-expenses":s.errors.expenses,"is-loading-expenses":s.loading.expenses,"is-showing-expenses":s.expenses.showing,"is-showing-items":s.items.showing,onChangeBudget:r.onChangeBudget,onDeleteBudget:r.onDeleteBudgetClicked,onEditBudget:r.onEditBudgetClicked,onExportBudget:r.onExportBudgetClicked,onNewVersion:r.onNewBudgetVersionClicked,onToggleExpenses:r.onToggleExpenses,onToggleItems:r.onToggleItems},null,8,["budget-options","budget","is-loading","is-error","is-error-expenses","is-loading-expenses","is-showing-expenses","is-showing-items","onChangeBudget","onDeleteBudget","onEditBudget","onExportBudget","onNewVersion","onToggleExpenses","onToggleItems"]),s.currentBudget.id?(i(),D(c,{key:0,"budget-departments":r.budgetDepartments,"current-budget":s.currentBudget,expenses:s.expenses.data,"is-error":s.errors.entries,"is-loading":s.loading.entries,"is-showing-expenses":s.expenses.showing,"is-showing-items":s.items.showing,"linked-hardware-items":s.linkedHardwareItems,"linked-software-licenses":s.linkedSoftwareLicenses,"hardware-items-costs":r.hardwareItemsCosts,"software-licenses-costs":r.softwareLicensesCosts,"months-between-start-and-now":r.monthsBetweenStartAndNow,"months-between-now-and-end":r.monthsBetweenNowAndEnd,"months-between-production-dates":s.monthsBetweenProductionDates,"salary-scale":s.salaryScale,"total-entry":r.totalEntry,onAddBudgetEntry:r.onAddBudgetEntry,onDeleteBudgetEntry:r.deleteBudgetEntry,onEditBudgetEntry:r.editBudgetEntry},null,8,["budget-departments","current-budget","expenses","is-error","is-loading","is-showing-expenses","is-showing-items","linked-hardware-items","linked-software-licenses","hardware-items-costs","software-licenses-costs","months-between-start-and-now","months-between-now-and-end","months-between-production-dates","salary-scale","total-entry","onAddBudgetEntry","onDeleteBudgetEntry","onEditBudgetEntry"])):m("",!0),b(h,{active:s.modals.createBudget,"budget-to-edit":s.budgetToEdit,"last-revision":r.lastRevision,"is-loading":s.loading.createBudget||s.loading.editBudget,"is-error":s.errors.createBudget||s.errors.editBudget,onCancel:t[0]||(t[0]=y=>s.modals.createBudget=!1),onConfirm:r.createBudget},null,8,["active","budget-to-edit","last-revision","is-loading","is-error","onConfirm"]),b(g,{active:s.modals.createBudgetEntry,"budget-entry-to-edit":s.budgetEntryToEdit,"is-loading":s.loading.createBudgetEntry,"is-error":s.errors.createBudgetEntry||s.errors.editBudgetEntry,"salary-scale":s.salaryScale,onCancel:t[1]||(t[1]=y=>s.modals.createBudgetEntry=!1),onConfirm:r.confirmCreateBudgetEntry},null,8,["active","budget-entry-to-edit","is-loading","is-error","salary-scale","onConfirm"]),b(w,{active:s.modals.deleteBudget,"error-text":e.$t("budget.delete_budget_error"),"is-loading":s.loading.del,"is-error":s.errors.deleteBudget,"lock-text":s.currentBudget?.name,text:e.$t("budget.delete_budget_message",{name:s.currentBudget?.name}),onCancel:t[2]||(t[2]=y=>s.modals.deleteBudget=!1),onConfirm:r.deleteBudget},null,8,["active","error-text","is-loading","is-error","lock-text","text","onConfirm"]),b(E,{active:s.modals.deleteBudgetEntry,"error-text":e.$t("budget.delete_budget_entry_error"),"is-loading":s.loading.deleteBudgetEntry,"is-error":s.errors.deleteBudgetEntry,text:e.$t("budget.delete_budget_entry_message"),onCancel:t[3]||(t[3]=y=>s.modals.deleteBudgetEntry=!1),onConfirm:r.confirmDeleteBudgetEntry},null,8,["active","error-text","is-loading","is-error","text","onConfirm"])])]),side:T(()=>[b(A,{amount:r.totalEntry.total,currency:s.currentBudget.currency,budgets:s.budgets,"budget-departments":r.budgetDepartments,"budget-entries":s.budgetEntries,"months-between-production-dates":s.monthsBetweenProductionDates,"hardware-items":r.hardwareItemsCosts,"software-licenses":r.softwareLicensesCosts,"pie-chart-data":r.pieChartData,"pie-chart-colors":r.pieChartColors,"column-chart-data":r.columnChartData},null,8,["amount","currency","budgets","budget-departments","budget-entries","months-between-production-dates","hardware-items","software-licenses","pie-chart-data","pie-chart-colors","column-chart-data"])]),_:1})}const In=C(Yn,[["render",Ln],["__scopeId","data-v-bd10e0ee"]]);export{In as default};
//# sourceMappingURL=Budget-Bfkphv8_.js.map
