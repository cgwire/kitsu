import{_ as L,a1 as P,u as se,b as D,r as o,o as n,c as p,g as u,h as l,t as f,S as ne,E as re,a2 as oe,C as le,j as ae,B as de,a3 as pe,d as s,f as r,w as g,k as h,v,i as b,F as T,H as ue,a4 as ce,T as F,n as I,e as me,a5 as he,a as fe,a6 as ve}from"./index-Dw-uod2x.js";import{p as S,a as M,V as we,_ as ye,S as ke,R as ge,P as Pe,b as Ce,O as be,C as _e,c as Ee}from"./PlaylistPlayer-B4BWqUJa.js";import{d as Te}from"./dom-tO7tlkHV.js";import{E as Fe,a as Ie,b as Se,c as Me,e as Le}from"./EntityTaskList-BqEFl7QB.js";import{f as De}from"./format-fMWuo47O.js";import{C as Ve}from"./ComboboxNumber-CFsoz7te.js";import{D as Re}from"./DescriptionCell-Cm2KfHAo.js";import{E as $e}from"./EditEditModal-D4aFEf3N.js";import{C as V}from"./ComboboxStyled-DrFBZe-s.js";import{P as Ue}from"./PageSubtitle-D3eHk89H.js";import{V as He}from"./ValidationTag-Dmpl-p74.js";import{S as Oe}from"./Schedule-BRfI1kcB.js";import Ae from"./TaskInfo-r8aZr1NT.js";import{C as ze}from"./corner-left-up-fFhAVEyq.js";import"./ComboboxSimple-Vf48mrbl.js";import"./ComboboxTaskType-DmSe2PuZ.js";import"./TaskTypeName-CzX-aVdj.js";import"./ModalFooter-Dmgqo0ae.js";import"./TextField-EpYNDuEI.js";import"./video-Yn96Kb74.js";import"./clipboard-CQqgyZ_h.js";import"./Combobox-Z_ENhFXj.js";import"./DeleteModal-D5nitPJZ.js";import"./index-C15PprjC.js";import"./BaseModal-CUMx-WEe.js";import"./ComboboxDepartment-DQ8ZI2WM.js";import"./DepartmentName-kmEXEkam.js";import"./ComboboxStudio-D4rrWH2h.js";import"./play-qfd1WDm6.js";import"./string-B0Tq569e.js";import"./render-GdzifLjz.js";import"./EntityPreview-B9hRFvM0.js";import"./VideoViewer-C7DK8vtH.js";import"./eye-ByTwqQRj.js";import"./PeopleNameCell-Dv-eSJK5.js";import"./TaskTypeCell-QjnVLvVl.js";import"./TableInfo-BOYXFWEz.js";import"./BuildFilterModal-AsQyG_6U.js";import"./ComboboxStatus-DknHLATL.js";import"./ComboboxBoolean-DeubScUy.js";import"./PeopleField-Dk8dxPgh.js";import"./TextareaField-Cu9GLtzh.js";import"./list-chevrons-up-down-CP19ULh5.js";import"./briefcase-RN42S3yy.js";import"./csv-Dt0ViJ8m.js";import"./PreviewPlayer-Dm_ANgjQ.js";import"./EmojiButton-BTNSPSu1.js";import"./FileUpload-Cng9V_As.js";import"./ConfirmModal-DnlSFX-8.js";import"./triangle-alert-D6jyW-fK.js";import"./thumbs-up-Dziai4S2.js";import"./copy-C1lXCnZO.js";import"./vue.esm-bundler-44hZGVEk.js";import"./DeleteEntities-DujJJYkA.js";import"./HardDeleteModal-BWVmHjcR.js";import"./SearchField-B9agWdMK.js";import"./corner-right-up-ZAfxlICJ.js";const Be={name:"previews-per-task-type",components:{ComboboxStyled:V,ValidationTag:He},emits:["preview-changed"],data(){return{taskTypeId:null,previewFileId:this.entity.preview_file_id}},props:{entity:{default:()=>{},type:Object}},mounted(){this.setCurrentParameters()},computed:{...D(["taskMap","taskTypeMap","taskStatusMap"]),taskTypeOptions(){return P.cache.editMap.get(this.entity.id).tasks.map(t=>this.taskMap.get(t)).map(t=>this.taskTypeMap.get(t.task_type_id)).sort(se.firstBy("priority",1).thenBy("name")).map(t=>({label:t.name,value:t.id}))},previewFileOptions(){return(this.entity.preview_files[this.taskTypeId]||[]).map(t=>({label:`v${t.revision}`,value:t.id}))},taskStatus(){if(!P.cache.editMap)return"";const e=P.cache.editMap.get(this.entity.id);if(!e)return"";const t=e.validations.get(this.taskTypeId);if(t){const a=this.taskMap.get(t);return a?this.taskStatusMap.get(a.task_status_id):""}else return""}},methods:{getTaskTypeIdForPreviewFile(e,t){return e.find(a=>this.entity.preview_files[a].some(i=>i.id===t))},setCurrentParameters(){const e=Object.keys(this.entity.preview_files);e.length&&(this.entity.preview_file_id&&(this.taskTypeId=this.getTaskTypeIdForPreviewFile(e,this.entity.preview_file_id)),this.taskTypeId||(this.taskTypeId=e[0]))}},watch:{taskTypeId(){const e=this.entity.preview_files[this.taskTypeId];e?.length?e.some(a=>a.id===this.entity.preview_file_id)?this.previewFileId=this.entity.preview_file_id:this.previewFileId=e[0].id:this.previewFileId=null},previewFileId(){let e=null;const t=this.entity.preview_files[this.taskTypeId];t?.length&&(e=t.find(a=>a.id===this.previewFileId)),this.$emit("preview-changed",this.entity,e)},"entity.preview_file_id"(){this.previewFileId!==this.entity.preview_file_id&&(this.previewFileId=this.entity.preview_file_id)}}},je={class:"flexrow"},Ne={key:2,class:"flexrow-item"};function Ze(e,t,a,w,i,c){const C=o("combobox-styled"),y=o("validation-tag");return n(),p("div",je,[c.taskTypeOptions.length?(n(),u(C,{key:0,ref:"task-type-combobox",class:"flexrow-item",options:c.taskTypeOptions,modelValue:i.taskTypeId,"onUpdate:modelValue":t[0]||(t[0]=k=>i.taskTypeId=k)},null,8,["options","modelValue"])):l("",!0),c.previewFileOptions.length?(n(),u(C,{key:1,class:"flexrow-item",options:c.previewFileOptions,modelValue:i.previewFileId,"onUpdate:modelValue":t[1]||(t[1]=k=>i.previewFileId=k)},null,8,["options","modelValue"])):(n(),p("span",Ne,f(e.$t("tasks.no_preview")),1)),c.taskStatus?(n(),u(y,{key:3,class:"flexrow-item",task:{task_status_id:c.taskStatus.id},"is-static":!0,thin:!1},null,8,["task"])):l("",!0)])}const Je=L(Be,[["render",Ze]]),We={name:"edit",mixins:[Ee,Te,Le,De,M,S],components:{ArrowUpRightIcon:pe,ButtonSimple:de,ChevronLeftIcon:ae,ChevronRightIcon:le,CornerLeftUpIcon:ze,ColorPicker:_e,ComboboxStyled:V,ComboboxNumber:Ve,DescriptionCell:Re,DownloadIcon:oe,EditEditModal:$e,EntityNews:Me,EntityPreviewFiles:Se,EntityTaskList:Ie,EntityTimeLogs:Fe,EntityThumbnail:re,ObjectViewer:be,PageSubtitle:Ue,PencilPicker:Ce,PreviewRoom:Pe,PreviewsPerTaskType:Je,RawVideoPlayer:ge,SoundViewer:ke,Schedule:Oe,SpeedButton:ye,Spinner:ne,TaskInfo:Ae,VideoProgress:we},data(){return{type:"edit",currentEdit:null,currentSection:"infos",isAnnotationsDisplayed:!0,isLoading:!0,isError:!1,movieDimensions:{width:0,height:0},previewRoomRef:"edits-preview-room",previewFileMap:new Map,room:{id:null,people:[],newComer:!0},tempMode:!1,errors:{edit:!1},entityNavOptions:[{label:this.$t("main.label.info"),value:"infos"},{label:this.$t("main.label.schedule"),value:"schedule"},{label:this.$t("main.label.preview_files"),value:"preview-files"},{label:this.$t("main.activity"),value:"activity"},{label:this.$t("main.label.timelog"),value:"time-logs"}],modals:{edit:!1}}},mounted(){this.init()},computed:{...D(["currentEpisode","currentProduction","getTaskPreviews","getTaskTypePriority","isCurrentUserManager","isTVShow","route","editMetadataDescriptors","taskMap","taskTypeMap","user"]),title(){return this.currentEdit?this.currentEdit.episode_name?`${this.currentEdit.episode_name} / ${this.currentEdit.name}`:`${this.currentEdit.name}`:this.$t("main.loading")},editsPath(){return ve(this.currentProduction.id,"edits",this.currentEpisode?this.currentEpisode.id:this.currentEpisode)}},methods:{...fe(["editEdit","loadEdits","loadTaskEntityPreviewFiles","updatePreviewAnnotation"]),init(){this.resetData(),this.$options.scrubbing=!1,this.isHd=!!this.organisation.hd_by_default,this.picturePlayer&&this.picturePlayer.addEventListener("load",async()=>{const e=this.isPlaying;await this.resetPictureCanvas(),this.isPlaying=e}),this.$nextTick(()=>{this.configureEvents(),this.setupFabricCanvas(),this.setPlayerSpeed(1),this.onFrameUpdate(1)})},resetPreviewFileMap(){this.previewFileMap.clear(),this.previewFiles&&Object.values(this.previewFiles).forEach(e=>{e.forEach(t=>{this.previewFileMap.set(t.id,t)})})},resetHeight(){this.$nextTick(()=>{let e=window.innerHeight;e-=this.$refs.header?this.$refs.header.offsetHeight:0,this.$refs["button-bar"]&&(e-=this.$refs["button-bar"].offsetHeight),this.$refs["video-progress"]&&(e-=this.$refs["video-progress"].$el.offsetHeight),this.$refs["info-row"]&&(e-=this.$refs["info-row"].offsetHeight),this.$refs["schedule-row"]&&(e-=this.$refs["schedule-row"].offsetHeight),this.$refs["page-header-row"]&&(e-=this.$refs["page-header-row"].offsetHeight),e=Math.min(window.innerHeight*.4,Math.max(480,e)),this.$refs["video-container"]&&(this.$refs["video-container"].style.height=`${e}px`),!this.isCommentsHidden&&this.$refs["task-info"]&&(this.$refs["task-info"].$el.style.height=`${e+66}px`),this.rawPlayer&&this.rawPlayer.resetHeight(e),this.$nextTick(()=>{this.resetCanvas(),this.updateProgressBar()})})},initPlayer(){this.currentEdit&&(this.currentPreviewIndex=0,this.playingEntityIndex=0,this.entityList=[{...this.currentEdit,preview_file_id:null,preview_files:this.previewFiles}],this.framesPerImage[0]=this.currentEdit.preview_nb_frames||he,this.pause(),this.rawPlayer&&this.rawPlayer.setCurrentFrame(1),this.currentTimeRaw=0,this.updateProgressBar(),this.updateTaskPanel(),this.clearCanvas(),this.annotations=[],this.resetHeight(),this.resetCanvas().then(()=>{this.isCurrentPreview&&(this.annotations=this.currentEntity.preview_file_annotations,this.loadAnnotation(this.getAnnotation(0)))}))},getCurrentEdit(){return P.cache.editMap.get(this.route.params.edit_id)||null},confirmEditEdit(e){e.id=this.currentEdit.id,this.isLoading=!0,this.errors.edit=!1,this.editEdit(e).then(()=>{this.isLoading=!1,this.modals.edit=!1}).catch(t=>{console.error(t),this.isLoading=!1,this.errors.edit=!0})},setPreviewFile(e){this.playingPreviewFileId=e.id,this.currentEntity.preview_file_id=e.id,this.currentEntity.preview_file_task_id=e.task_id,this.currentEntity.preview_file_extension=e.extension,this.currentEntity.preview_file_annotations=e.annotations||[],this.currentEntity.preview_file_previews=e.previews,this.annotations=this.currentEntity.preview_file_annotations,this.rawPlayer&&this.rawPlayer.reloadCurrentEntity(),this.clearCanvas(),this.updateTaskPanel(),this.updateProgressBar()},onPreviousPreviewClicked(){const e=this.currentPreviewIndex-1;this.currentPreviewIndex=e<0?this.currentEntityPreviewLength-1:e},onNextPreviewClicked(){const e=this.currentPreviewIndex+1;this.currentPreviewIndex=e>this.currentEntityPreviewLength-1?0:e},onPreviewChanged(e,t){this.pause();const a=this.playingPreviewFileId!==t.id;this.setPreviewFile(t),a&&this.sendUpdatePlayingStatus()},onAnnotationChanged({preview:e,additions:t,deletions:a,updates:w}){const i=e.task_id;this.updatePreviewAnnotation({taskId:i,preview:e,additions:t,deletions:a,updates:w})},onVideoLoaded(){this.movieDimensions={width:this.currentPreview.width,height:this.currentPreview.height}},scrollToEntity(){},resetData(){this.$nextTick(()=>{this.loadEdits().then(()=>{this.currentEdit=this.getCurrentEdit(),this.room.id=this.currentEdit?this.currentEdit.id:null,this.currentEdit&&this.loadTaskEntityPreviewFiles(this.currentEdit.id).then(e=>{this.previewFiles=e,this.resetPreviewFileMap(),this.initPlayer(),this.isLoading=!1})})})},onPreviewFilesUpdate(){this.loadTaskEntityPreviewFiles(this.currentEdit.id).then(e=>{this.previewFiles=e,this.currentEntity.preview_files=e,this.resetPreviewFileMap(),this.currentEntity&&this.currentEntity.preview_file_id&&this.previewFileMap.has(this.currentEntity.preview_file_id)})},resetPanZoom(){this.isCurrentPreviewMovie?this.rawPlayer.resetPanZoom():this.isCurrentPreviewPicture&&this.picturePlayer.resetPanZoom()}},watch:{currentEdit(){this.room.id=this.currentEdit?this.currentEdit.id:null},currentProduction(){this.isTVShow||this.resetData()},currentEpisode(){this.isTVShow&&P.cache.editMap.size===0&&this.resetData()},playingPreviewFileId(){if(!this.currentEntity||!this.playingPreviewFileId)return;const e=this.$refs["previews-per-task-type"];if(!e)return;const t=this.currentEntity.preview_files;for(const a in t){const w=t[a].find(i=>i.id===this.playingPreviewFileId);if(w){this.setPreviewFile(w),(e.taskTypeId!==a||e.previewFileId!==this.playingPreviewFileId)&&(e.taskTypeId=a,e.previewFileId=this.playingPreviewFileId);break}}}},socket:{events:{...M.socket.events,...S.socket.events,"preview-file:add-file"(e){if(e.project_id!==this.task.project_id)return;const t=e.task_id,a=this.currentEntity.preview_files;for(const w in a)if(a[w].find(c=>c.task_id===t)){this.onPreviewFilesUpdate();break}},"comment:delete"(e){e.project_id===this.task.project_id&&this.onPreviewFilesUpdate()}}},head(){return{title:`${this.title} - Kitsu`}}},Ge={class:"columns fixed-page edit xyz-in",xyz:"fade"},Ke={class:"column main-column"},qe={class:"page-header flexrow flexrow-item",ref:"page-header-row"},Qe={class:"flexrow block mb0 main-block"},Xe={class:"flexrow-item"},Ye={class:"entity-title flexrow-item mr1"},xe={class:"flexrow-item block mt0"},et={ref:"container",class:"edit player block"},tt={class:"flexrow filler"},it={class:"flexrow filler video-container",ref:"video-container"},st={style:{width:"100%"},class:"preview-standard-file has-text-centered"},nt=["href"],rt={class:"text"},ot=["src"],lt={key:2,class:"loading-wrapper"},at={class:"canvas-wrapper",ref:"canvas-wrapper",oncontextmenu:"return false"},dt={id:"edit-annotation-canvas",ref:"annotation-canvas",class:"canvas"},pt={key:0,class:"player-footer flexrow",ref:"button-bar"},ut={key:0,class:"flexrow flexrow-item mr0"},ct=["title"],mt={key:2,class:"separator"},ht={key:3,class:"flexrow flexrow-item"},ft=["title"],vt=["href","title"],wt={key:4,class:"flexrow flexrow-item"},yt=["title"],kt=["title"],gt=["title"],Pt={key:5,class:"flexrow"},Ct={class:"annotation-tools"},bt={class:"annotation-tools"},_t={class:"edit-data block"},Et={class:"flexrow"},Tt={key:0,ref:"info-row",class:"infos flexrow pa0"},Ft={class:"flexrow-item"},It={class:"flexrow"},St={class:"flexcolumn flexrow-item"},Mt={class:"flexcolumn flexrow-item"},Lt={class:"flexrow"},Dt={class:"flexrow-item has-text-right"},Vt={class:"table-body edit-metadata flexrow-item"},Rt={key:0,class:"datatable no-header"},$t={class:"datatable-body"},Ut={class:"datatable-row"},Ht={class:"field-label"},Ot={class:"field-label"},At={key:1,ref:"schedule-row",class:"infos schedule"},zt={key:0,class:"schedule mt1"},Bt={class:"wrapper"};function jt(e,t,a,w,i,c){const C=o("corner-left-up-icon"),y=o("router-link"),k=o("entity-thumbnail"),R=o("previews-per-task-type"),$=o("preview-room"),U=o("chevron-left-icon"),H=o("chevron-right-icon"),O=o("raw-video-player"),A=o("object-viewer"),z=o("sound-viewer"),B=o("download-icon"),j=o("spinner"),N=o("task-info"),Z=o("video-progress"),d=o("button-simple"),J=o("arrow-up-right-icon"),W=o("speed-button"),_=o("color-picker"),G=o("pencil-picker"),K=o("combobox-styled"),q=o("combobox-number"),E=o("page-subtitle"),Q=o("entity-task-list"),X=o("description-cell"),Y=o("schedule"),x=o("entity-preview-files"),ee=o("entity-news"),te=o("entity-time-logs"),ie=o("edit-edit-modal");return n(),p("div",Ge,[s("div",Ke,[s("div",qe,[s("div",Qe,[r(y,{class:"flexrow-item has-text-centered back-link",to:c.editsPath},{default:g(()=>[r(C)]),_:1},8,["to"]),s("span",Xe,[e.currentEntity?(n(),u(k,{key:0,class:"entity-thumbnail",entity:e.currentEntity,"empty-height":60,"empty-width":100,height:60,width:100},null,8,["entity"])):l("",!0)]),s("div",Ye,f(c.title),1),!i.isLoading&&e.currentEntity?(n(),p("div",{class:"flexrow-item has-text-centered",key:e.currentEntity.id},[r(R,{ref:"previews-per-task-type",entity:e.currentEntity,onPreviewChanged:c.onPreviewChanged},null,8,["entity","onPreviewChanged"])])):l("",!0)]),t[8]||(t[8]=s("div",{class:"filler"},null,-1)),s("div",xe,[e.isValidRoomId(i.currentEdit)&&e.currentPreview?.id?(n(),u($,{key:0,ref:i.previewRoomRef,room:i.room,onOpenRoom:e.openRoom,onJoinRoom:e.joinRoom,onLeaveRoom:e.leaveRoom},null,8,["room","onOpenRoom","onJoinRoom","onLeaveRoom"])):l("",!0)]),e.previousEntityPath&&e.entityList.length>1?(n(),u(y,{key:0,class:"flexrow-item has-text-centered back-link ml1",to:e.previousEntityPath},{default:g(()=>[r(U)]),_:1},8,["to"])):l("",!0),e.nextEntityPath&&e.entityList.length>1?(n(),u(y,{key:1,class:"flexrow-item has-text-centered back-link",to:e.nextEntityPath},{default:g(()=>[r(H)]),_:1},8,["to"])):l("",!0)],512),s("div",et,[h(s("div",tt,[s("div",it,[h(r(O,{ref:"raw-player",class:"raw-player",style:b({position:"static",opacity:e.overlayOpacity}),entities:e.entityList,"full-screen":e.fullScreen,"is-hd":e.isHd,"is-repeating":e.isRepeating,"current-preview-index":e.currentPreviewIndex,muted:e.isMuted,onMaxDurationUpdate:e.onMaxDurationUpdate,onFrameUpdate:e.onFrameUpdate,onMetadataLoaded:e.onMetadataLoaded,onRepeat:e.onVideoRepeated,onVideoLoaded:c.onVideoLoaded},null,8,["style","entities","full-screen","is-hd","is-repeating","current-preview-index","muted","onMaxDurationUpdate","onFrameUpdate","onMetadataLoaded","onRepeat","onVideoLoaded"]),[[v,e.isCurrentPreviewMovie&&!i.isLoading]]),e.isCurrentPreviewModel&&!i.isLoading?(n(),u(A,{key:0,ref:"object-player",class:"object-player","preview-url":e.currentPreviewDlPath,style:b({position:"static",opacity:e.overlayOpacity}),"full-screen":e.fullScreen},null,8,["preview-url","style","full-screen"])):l("",!0),e.isCurrentPreviewSound&&!i.isLoading?(n(),u(z,{key:1,ref:"sound-player",class:"sound-player","preview-url":e.currentPreviewDlPath,"full-screen":e.fullScreen,onPlayEnded:e.pause},null,8,["preview-url","full-screen","onPlayEnded"])):l("",!0),h(s("p",st,[e.extension&&e.extension.length>0?(n(),p("a",{key:0,class:"button",ref:"preview-file",href:e.currentPreviewDlPath},[r(B,{class:"icon"}),s("span",rt,f(e.$t("tasks.download_pdf_file",{extension:e.extension})),1)],8,nt)):l("",!0)],512),[[v,e.isCurrentPreviewFile&&!i.isLoading]]),h(s("div",{class:"picture-preview-wrapper flexrow",ref:"picture-player-wrapper",style:b({position:"static",opacity:e.overlayOpacity,left:0,right:0})},[h(s("img",{ref:"picture-player",id:"picture-player",class:"picture-preview",src:e.isCurrentPreviewPicture?e.currentPreviewPath:null},null,8,ot),[[v,e.isCurrentPreviewPicture]])],4),[[v,e.isCurrentPreviewPicture&&!i.isLoading]]),i.isLoading?(n(),p("div",lt,[r(j)])):l("",!0),h(s("div",at,[s("canvas",dt,null,512)],512),[[v,!e.isCurrentPreviewFile&&i.isAnnotationsDisplayed&&!e.isCurrentPreviewModel]])],512),h(r(N,{ref:"task-info",class:"flexrow-item task-info-column",task:e.task,"is-preview":!1,silent:e.isCommentsHidden,"current-frame":parseInt(e.currentFrame)-1,"current-parent-preview":e.currentPreview,onTimeCodeClicked:e.onTimeCodeClicked},null,8,["task","silent","current-frame","current-parent-preview","onTimeCodeClicked"]),[[v,!e.isCommentsHidden]])],512),[[v,!i.isLoading]]),h(r(Z,{ref:"video-progress",class:"video-progress pull-bottom",annotations:e.annotations,"frame-duration":e.frameDuration,"movie-dimensions":i.movieDimensions,"nb-frames":e.nbFrames,"handle-in":-1,"handle-out":-1,"preview-id":e.currentPreview?e.currentPreview.id:"",onStartScrub:e.onScrubStart,onEndScrub:e.onScrubEnd,onProgressChanged:e.onProgressChanged},null,8,["annotations","frame-duration","movie-dimensions","nb-frames","preview-id","onStartScrub","onEndScrub","onProgressChanged"]),[[v,e.isCurrentPreviewMovie&&e.currentPreview.id]]),e.currentEntity&&e.currentEntity.id?(n(),p("div",pt,[e.isCurrentPreviewMovie||e.isCurrentPreviewPicture||e.isCurrentPreviewSound?(n(),p("div",ut,[e.isPlaying?(n(),u(d,{key:1,class:"player-button flexrow-item",onClick:e.pauseClicked,title:e.$t("playlists.actions.pause"),icon:"pause"},null,8,["onClick","title"])):(n(),u(d,{key:0,class:"player-button flexrow-item",onClick:e.playClicked,title:e.$t("playlists.actions.play"),icon:"play"},null,8,["onClick","title"]))])):l("",!0),t[10]||(t[10]=s("div",{class:"separator"},null,-1)),e.isCurrentPreviewPicture?(n(),p(T,{key:1},[ue(f(e.framesSeenOfPicture)+" / ",1),h(s("input",{type:"number",min:"0",class:"frame-per-image-input",title:e.$t("playlists.actions.frames_per_picture"),"onUpdate:modelValue":t[0]||(t[0]=m=>e.framesPerImage[e.playingEntityIndex]=m)},null,8,ct),[[ce,e.framesPerImage[e.playingEntityIndex]]])],64)):l("",!0),e.isCurrentPreviewPicture?(n(),p("div",mt)):l("",!0),e.currentEntityPreviewLength>1?(n(),p("div",ht,[r(d,{class:"player-button flexrow-item",icon:"left",title:e.$t("playlists.actions.files_previous"),disabled:e.isPlaying,onClick:c.onPreviousPreviewClicked},null,8,["title","disabled","onClick"]),s("span",{class:"ml05 mr05 nowrap",title:e.$t("playlists.actions.files_position")},f(e.currentPreviewIndex+1)+" / "+f(e.currentEntityPreviewLength),9,ft),r(d,{class:"player-button flexrow-item",icon:"right",title:e.$t("playlists.actions.files_next"),disabled:e.isPlaying,onClick:c.onNextPreviewClicked},null,8,["title","disabled","onClick"]),s("a",{class:"button player-button flexrow-item",href:e.currentPreviewPath,title:e.$t("playlists.actions.see_original_file"),target:"blank"},[r(J,{class:"icon"})],8,vt)])):l("",!0),e.isCurrentPreviewMovie?(n(),p("div",wt,[r(W,{class:"player-button flexrow-item",modelValue:e.speed,"onUpdate:modelValue":t[1]||(t[1]=m=>e.speed=m)},null,8,["modelValue"]),e.isMuted?(n(),u(d,{key:0,class:"flexrow-item player-button",title:e.$t("playlists.actions.unmute"),icon:"soundoff",onClick:e.onToggleSoundClicked},null,8,["title","onClick"])):(n(),u(d,{key:1,class:"flexrow-item player-button",title:e.$t("playlists.actions.mute"),icon:"soundon",onClick:e.onToggleSoundClicked},null,8,["title","onClick"])),r(d,{class:"player-button flexrow-item",active:e.isRepeating,title:e.$t("playlists.actions.looping"),icon:"repeat",onClick:e.onRepeatClicked},null,8,["active","title","onClick"]),s("span",{class:"flexrow-item time-indicator",title:e.$t("playlists.actions.current_time")},f(e.currentTime),9,yt),t[9]||(t[9]=s("span",{class:"flexrow-item time-indicator"}," / ",-1)),s("span",{class:"flexrow-item time-indicator",title:e.$t("playlists.actions.max_duration")},f(e.maxDuration),9,kt),s("span",{class:"flexrow-item time-indicator mr1",title:e.$t("playlists.actions.frame_number")}," ("+f(e.currentFrame)+" / "+f((e.nbFrames+"").padStart(3,"0"))+") ",9,gt),r(d,{class:"player-button flexrow-item",onClick:e.onPreviousFrameClicked,title:e.$t("playlists.actions.previous_frame"),icon:"left"},null,8,["onClick","title"]),r(d,{class:"player-button flexrow-item",onClick:e.onNextFrameClicked,title:e.$t("playlists.actions.next_frame"),icon:"right"},null,8,["onClick","title"])])):l("",!0),t[11]||(t[11]=s("span",{class:"filler"},null,-1)),!e.isCurrentUserArtist&&(e.isCurrentPreviewMovie||e.isCurrentPreviewPicture)?(n(),p("div",Pt,[r(d,{class:"player-button flexrow-item",icon:"undo",title:e.$t("playlists.actions.annotation_undo"),onClick:e.undoLastAction},null,8,["title","onClick"]),r(d,{class:"player-button flexrow-item",title:e.$t("playlists.actions.annotation_redo"),icon:"redo",onClick:e.redoLastAction},null,8,["title","onClick"]),r(F,{name:"slide"},{default:g(()=>[h(s("div",Ct,[r(_,{color:e.textColor,onTogglePalette:e.onPickTextColor,onChange:e.onChangeTextColor},null,8,["color","onTogglePalette","onChange"])],512),[[v,e.isTyping]])]),_:1}),r(d,{class:I({"player-button":!0,"flexrow-item":!0,active:e.isTyping}),title:e.$t("playlists.actions.annotation_text"),onClick:e.onTypeClicked,icon:"type"},null,8,["class","title","onClick"]),r(F,{name:"slide"},{default:g(()=>[h(s("div",bt,[r(G,{pencil:e.pencil,sizes:e.pencilPalette,onTogglePalette:e.onPickPencilWidth,onChange:e.onChangePencilWidth},null,8,["pencil","sizes","onTogglePalette","onChange"]),r(_,{color:e.color,onTogglePalette:e.onPickPencilColor,onChange:e.onChangePencilColor},null,8,["color","onTogglePalette","onChange"])],512),[[v,e.isDrawing]])]),_:1}),r(d,{class:I({"player-button":!0,"flexrow-item":!0,active:e.isDrawing}),title:e.$t("playlists.actions.annotation_draw"),onClick:e.onAnnotateClicked,icon:"pencil"},null,8,["class","title","onClick"]),r(d,{class:"player-button flexrow-item",icon:"remove",title:e.$t("playlists.actions.annotation_delete"),onClick:e.onDeleteClicked},null,8,["title","onClick"]),r(d,{class:"player-button flexrow-item",active:i.isAnnotationsDisplayed,icon:"pen",title:e.$t("playlists.actions.toggle_annotations"),onClick:t[2]||(t[2]=m=>i.isAnnotationsDisplayed=!i.isAnnotationsDisplayed)},null,8,["active","title"])])):l("",!0),t[12]||(t[12]=s("div",{class:"separator"},null,-1)),r(d,{class:"player-button flexrow-item",active:!e.isCommentsHidden,title:e.$t("playlists.actions.comments"),onClick:e.onCommentClicked,icon:"comment"},null,8,["active","title","onClick"]),e.isCurrentPreviewMovie?(n(),u(d,{key:6,class:"player-button flexrow-item",title:e.$t("playlists.actions."+(e.isHd?"switch_ld":"switch_hd")),text:e.isHd?"HD":"LD",onClick:t[3]||(t[3]=m=>e.isHd=!e.isHd)},null,8,["title","text"])):l("",!0),e.isFullScreenEnabled?(n(),u(d,{key:7,class:"player-button flexrow-item",title:e.$t("playlists.actions.fullscreen"),onClick:e.onFullscreenClicked,icon:"maximize"},null,8,["title","onClick"])):l("",!0)],512)):l("",!0)],512),s("div",_t,[s("div",Et,[r(K,{class:"section-combo flexrow-item",options:i.entityNavOptions,modelValue:i.currentSection,"onUpdate:modelValue":t[4]||(t[4]=m=>i.currentSection=m)},null,8,["options","modelValue"]),t[13]||(t[13]=s("div",{class:"filler"},null,-1)),h(s("span",{class:"flexrow-item mt05"},f(e.$t("schedule.zoom_level"))+": ",513),[[v,i.currentSection==="schedule"]]),h(r(q,{class:"zoom-level flexrow-item",options:e.zoomOptions,"is-simple":"",modelValue:e.zoomLevel,"onUpdate:modelValue":t[5]||(t[5]=m=>e.zoomLevel=m)},null,8,["options","modelValue"]),[[v,i.currentSection==="schedule"]])]),i.currentSection==="infos"?(n(),p("div",Tt,[s("div",Ft,[s("div",It,[s("div",St,[r(E,{class:"flerow-item",text:e.$t("edits.tasks")},null,8,["text"]),r(Q,{class:"task-list flexrow-item",entries:e.currentTasks,"is-loading":!i.currentEdit,"is-error":!1},null,8,["entries","is-loading"])]),s("div",Mt,[s("div",Lt,[r(E,{class:"flerow-item",text:e.$t("main.info")},null,8,["text"]),s("div",Dt,[e.isCurrentUserManager?(n(),u(d,{key:0,icon:"edit",title:e.$t("edits.edit_title"),onClick:t[6]||(t[6]=m=>i.modals.edit=!0)},null,8,["title"])):l("",!0)])]),s("div",Vt,[i.currentEdit?(n(),p("table",Rt,[s("tbody",$t,[s("tr",Ut,[s("td",Ht,f(e.$t("edits.fields.description")),1),r(X,{entry:i.currentEdit,full:!0},null,8,["entry"])]),(n(!0),p(T,null,me(e.editMetadataDescriptors,m=>(n(),p("tr",{key:m.id,class:"datatable-row"},[s("td",Ot,f(m.name),1),s("td",null,f(i.currentEdit.data?i.currentEdit.data[m.field_name]:""),1)]))),128))])])):l("",!0)])])])])],512)):l("",!0),i.currentSection==="schedule"&&e.scheduleItems.length>0?(n(),p("div",At,[e.scheduleItems[0].children.length>0?h((n(),p("div",zt,[s("div",Bt,[r(Y,{ref:"schedule-widget","start-date":e.tasksStartDate,"end-date":e.tasksEndDate,hierarchy:e.scheduleItems,"zoom-level":e.zoomLevel,"is-loading":!1,"is-estimation-linked":!0,"hide-root":!0,"with-milestones":!1},null,8,["start-date","end-date","hierarchy","zoom-level"])])],512)),[[v,i.currentSection==="schedule"]]):l("",!0)],512)):l("",!0),i.currentSection==="preview-files"?(n(),u(x,{key:2,entity:i.currentEdit},null,8,["entity"])):l("",!0),i.currentSection==="activity"?(n(),u(ee,{key:3,entity:i.currentEdit},null,8,["entity"])):l("",!0),i.currentSection==="time-logs"?(n(),u(te,{key:4,entity:i.currentEdit},null,8,["entity"])):l("",!0)])]),r(ie,{ref:"edit-edit-modal",active:i.modals.edit,"is-loading":i.isLoading,"is-error":i.errors.edit,"edit-to-edit":i.currentEdit,onCancel:t[7]||(t[7]=m=>i.modals.edit=!1),onConfirm:c.confirmEditEdit},null,8,["active","is-loading","is-error","edit-to-edit","onConfirm"])])}const Wi=L(We,[["render",jt],["__scopeId","data-v-aaa0d5f1"]]);export{Wi as default};
//# sourceMappingURL=Edit-B0SACiUM.js.map
