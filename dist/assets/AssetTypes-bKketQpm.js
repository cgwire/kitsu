import{_ as g,a as v,O as C,T as E,a4 as A,a5 as w,a6 as D,r as d,c as r,o as n,e as o,f as _,d as f,t as p,F as k,g as b,a7 as x,k as $,m as N,a8 as L,a9 as M,aa as B,ab as I}from"./index-CmgLRkor.js";import{L as V}from"./ListPageHeader-BfMqEf5B.js";import{R as q}from"./RouteTabs-3oaeSbYh.js";const F={name:"asset-type-list",components:{HelpCircleIcon:w,RowActionsCell:A,TableInfo:E,TaskTypeName:C},props:{entries:{type:Array,default:()=>[]},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},emits:["delete-clicked","edit-clicked"],computed:{...v(["taskTypeMap"])},methods:{sortTaskTypes(e=[]){const s=e.map(a=>this.taskTypeMap.get(a));return D(s)}}},H={class:"data-list"},R={class:"datatable-wrapper"},j={class:"datatable"},G={class:"datatable-head"},K={scope:"col",class:"name"},O={scope:"col",class:"short-name"},P={scope:"col",class:"task-types"},Q={key:0,class:"datatable-body"},S={class:"name"},z=["title"],J={class:"short-name"},U={key:0,class:"task-types"},W={key:1,class:"task-types"},X={class:"has-text-centered nb-asset-types"};function Y(e,s,a,c,t,i){const y=d("help-circle-icon"),m=d("task-type-name"),T=d("row-actions-cell"),u=d("table-info");return n(),r("div",H,[o("div",R,[o("table",j,[o("thead",G,[o("tr",null,[o("th",K,p(e.$t("asset_types.fields.name")),1),o("th",O,p(e.$t("asset_types.fields.short_name")),1),o("th",P,p(e.$t("asset_types.fields.task_types")),1),s[0]||(s[0]=o("th",{scope:"col",class:"actions"},null,-1))])]),a.entries.length>0?(n(),r("tbody",Q,[(n(!0),r(k,null,b(a.entries,l=>(n(),r("tr",{class:"datatable-row",key:l.id},[o("td",S,[x(p(l.name)+" ",1),l.description?(n(),r("span",{key:0,title:l.description},[_(y,{class:"icon is-small"})],8,z)):f("",!0)]),o("td",J,p(l.short_name),1),(l.task_types||[]).length>0?(n(),r("td",U,[(n(!0),r(k,null,b(i.sortTaskTypes(l.task_types),h=>(n(),r("span",{key:h.id,class:"task-type-name flexrow-item"},[h.id?(n(),$(m,{key:0,"task-type":h},null,8,["task-type"])):f("",!0)]))),128))])):(n(),r("td",W,p(e.$t("asset_types.include_all")),1)),_(T,{onEditClicked:h=>e.$emit("edit-clicked",l),onDeleteClicked:h=>e.$emit("delete-clicked",l)},null,8,["onEditClicked","onDeleteClicked"])]))),128))])):f("",!0)])]),_(u,{"is-loading":a.isLoading,"is-error":a.isError},null,8,["is-loading","is-error"]),o("p",X,p(a.entries.length)+" "+p(e.$tc("asset_types.number",a.entries.length)),1)])}const Z=g(F,[["render",Y],["__scopeId","data-v-2007f051"]]),ee={name:"asset-types",components:{AssetTypeList:Z,DeleteModal:M,EditAssetTypeModal:L,ListPageHeader:V,RouteTabs:q},data(){return{activeTab:"active",assetTypeToDelete:null,assetTypeToEdit:{},choices:[],errors:{del:!1,edit:!1,list:!1},modals:{del:!1,edit:!1},loading:{del:!1,edit:!1,list:!1},tabs:[{name:"active",label:this.$t("main.active")},{name:"archived",label:this.$t("main.archived")}]}},mounted(){this.activeTab=this.$route.query.tab||"active"},computed:{...v(["assetTypes","archivedAssetTypes","getAssetType","taskTypeMap"]),isActiveTab(){return this.activeTab==="active"},assetTypesList(){return this.isActiveTab?this.assetTypes:this.archivedAssetTypes},deleteText(){const e=this.assetTypeToDelete;return e?this.$t("asset_types.delete_text",{name:e.name}):""}},methods:{...N(["deleteAssetType","editAssetType","newAssetType"]),confirmEditAssetType(e){let s="newAssetType";this.assetTypeToEdit&&this.assetTypeToEdit.id&&(s="editAssetType",e.id=this.assetTypeToEdit.id),this.loading.edit=!0,this.errors.edit=!1,this[s](e).then(()=>{this.loading.edit=!1,this.modals.edit=!1}).catch(a=>{console.error(a),this.loading.edit=!1,this.errors.edit=!0})},confirmDeleteAssetType(){this.loading.del=!0,this.errors.del=!1,this.deleteAssetType(this.assetTypeToDelete).then(()=>{this.loading.del=!1,this.modals.del=!1}).catch(e=>{console.error(e),this.errors.del=!0,this.loading.del=!1})},onExportClicked(){const e=B.slugify(this.$t("asset_types.title")),a=[[this.$t("main.type"),this.$t("asset_types.fields.name"),this.$t("asset_types.fields.short_name"),this.$t("asset_types.fields.description"),this.$t("asset_types.fields.task_types")]].concat(this.assetTypes.map(c=>[c.type,c.name,c.short_name,c.description,c.task_types.length?c.task_types.map(t=>this.taskTypeMap.get(t)?.name).join(", "):this.$t("asset_types.include_all")]));I.buildCsvFile(e,a)},onNewClicked(){this.assetTypeToEdit={},this.errors.edit=!1,this.modals.edit=!0},onEditClicked(e){this.assetTypeToEdit=e,this.errors.edit=!1,this.modals.edit=!0},onDeleteClicked(e){this.assetTypeToDelete=e,this.errors.del=!1,this.modals.del=!0}},watch:{"$route.query.tab"(){this.activeTab=this.$route.query.tab||"active"}},head(){return{title:`${this.$t("asset_types.title")} - Kitsu`}}},te={class:"asset-types page fixed-page"};function se(e,s,a,c,t,i){const y=d("list-page-header"),m=d("route-tabs"),T=d("asset-type-list"),u=d("edit-asset-type-modal"),l=d("delete-modal");return n(),r("div",te,[_(y,{title:e.$t("asset_types.library_title"),"new-entry-label":e.$t("asset_types.new_asset_type"),"is-exportable":i.isActiveTab,onExportClicked:i.onExportClicked,onNewClicked:i.onNewClicked},null,8,["title","new-entry-label","is-exportable","onExportClicked","onNewClicked"]),_(m,{class:"mt2","active-tab":t.activeTab,tabs:t.tabs},null,8,["active-tab","tabs"]),_(T,{class:"asset-type-list",entries:i.assetTypesList,"is-loading":t.loading.list,"is-error":t.errors.list,onEditClicked:i.onEditClicked,onDeleteClicked:i.onDeleteClicked},null,8,["entries","is-loading","is-error","onEditClicked","onDeleteClicked"]),_(u,{active:t.modals.edit,"is-loading":t.loading.edit,"is-error":t.errors.edit,"asset-type-to-edit":t.assetTypeToEdit,onCancel:s[0]||(s[0]=h=>t.modals.edit=!1),onConfirm:i.confirmEditAssetType},null,8,["active","is-loading","is-error","asset-type-to-edit","onConfirm"]),_(l,{active:t.modals.del,"is-loading":t.loading.del,"is-error":t.errors.del,text:i.deleteText,"error-text":e.$t("asset_types.delete_error"),onCancel:s[1]||(s[1]=h=>t.modals.del=!1),onConfirm:i.confirmDeleteAssetType},null,8,["active","is-loading","is-error","text","error-text","onConfirm"])])}const oe=g(ee,[["render",se],["__scopeId","data-v-721ce47c"]]);export{oe as default};
//# sourceMappingURL=AssetTypes-bKketQpm.js.map
