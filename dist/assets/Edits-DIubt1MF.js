import{_ as O,M as Y,a7 as G,a as N,b as z,r as h,o as l,c as r,d as n,t as c,F as S,e as T,h as m,f as u,n as M,E as J,B as q,x as K,y as X,q as Z,k as B,g as C,v as W,H as L,w as j,I as x,i as ee,J as te,p as ie,K as se}from"./index-Dw-uod2x.js";import{c as R}from"./csv-Dt0ViJ8m.js";import{s as ae}from"./string-B0Tq569e.js";import{s as oe}from"./search-CWIHq9c3.js";import{V as le,T as de,a as ne,M as re,S as me,C as he,_ as ce,A as ue,b as pe,e as fe}from"./SortingInfo-IpI7epo0.js";import{d as ye,B as ge}from"./BuildFilterModal-AsQyG_6U.js";import{C as ke}from"./ComboboxDepartment-DQ8ZI2WM.js";import{D as Ce}from"./DeleteModal-D5nitPJZ.js";import{E as Ee}from"./EditEditModal-D4aFEf3N.js";import{I as Se,a as Te}from"./ImportRenderModal-DOvk26U4.js";import{H as Me}from"./HardDeleteModal-BWVmHjcR.js";import{S as De}from"./SearchField-B9agWdMK.js";import{S as ve}from"./SearchQueryList-eqDHREjk.js";import{T as $}from"./TableInfo-BOYXFWEz.js";import{d as be}from"./dom-tO7tlkHV.js";import{e as we}from"./entity_list-4DDYrVPE.js";import{f as _e}from"./format-fMWuo47O.js";import{M as Le,s as Ae}from"./MetadataHeader-BsMptUuX.js";import{D as Ie}from"./DescriptionCell-Cm2KfHAo.js";import{R as Ve}from"./RowActionsCell-C9aLugox.js";import{T as He}from"./TableMetadataSelectorMenu-D6tnIEf6.js";import{V as Pe}from"./ValidationCell-C4EqjcEB.js";import Fe from"./TaskInfo-r8aZr1NT.js";import"./DepartmentName-kmEXEkam.js";import"./PreviewPlayer-Dm_ANgjQ.js";import"./PlaylistPlayer-B4BWqUJa.js";import"./ComboboxSimple-Vf48mrbl.js";import"./ComboboxTaskType-DmSe2PuZ.js";import"./TaskTypeName-CzX-aVdj.js";import"./ModalFooter-Dmgqo0ae.js";import"./TextField-EpYNDuEI.js";import"./video-Yn96Kb74.js";import"./clipboard-CQqgyZ_h.js";import"./Combobox-Z_ENhFXj.js";import"./ComboboxStyled-DrFBZe-s.js";import"./index-C15PprjC.js";import"./BaseModal-CUMx-WEe.js";import"./ComboboxStudio-D4rrWH2h.js";import"./play-qfd1WDm6.js";import"./render-GdzifLjz.js";import"./EmojiButton-BTNSPSu1.js";import"./FileUpload-Cng9V_As.js";import"./ComboboxStatus-DknHLATL.js";import"./ConfirmModal-DnlSFX-8.js";import"./triangle-alert-D6jyW-fK.js";import"./ValidationTag-Dmpl-p74.js";import"./thumbs-up-Dziai4S2.js";import"./copy-C1lXCnZO.js";import"./vue.esm-bundler-44hZGVEk.js";import"./VideoViewer-C7DK8vtH.js";import"./ComboboxBoolean-DeubScUy.js";import"./check-B15weKo7.js";import"./ComboboxOptions-Cj6TJfKz.js";import"./PageTitle-CBcleFeD.js";import"./PeopleField-Dk8dxPgh.js";import"./TextareaField-Cu9GLtzh.js";import"./Checkbox-in6UcoC-.js";import"./BooleanField-DWHGtZOu.js";import"./ColorField-COd1sznp.js";import"./trash-2-B6whY4z4.js";import"./chevron-up-DrIzzrNn.js";import"./trash-gURpboxh.js";import"./refresh-cw-D3rKtSvX.js";import"./vuedraggable.umd-DphOE8B6.js";import"./grip-vertical-Ds04I29U.js";import"./eye-ByTwqQRj.js";import"./DeleteEntities-DujJJYkA.js";import"./corner-right-up-ZAfxlICJ.js";const Ue={name:"edit-history-modal",mixins:[Y],components:{TableInfo:$},props:{active:{type:Boolean,default:!1},edit:{type:Object,default:()=>{}}},emits:["cancel"],data(){return{isError:!1,isLoading:!1,versions:[]}},mounted(){this.reset()},computed:{...z(["personMap"])},methods:{...N(["loadEditHistory"]),formatDate(e){return G(e)},getPersonFullName(e){const t=this.personMap.get(e);return t?t.full_name:""},loadData(){return this.isError=!1,this.isLoading=!0,this.loadEditHistory(this.edit.id).then(e=>{this.versions=e,this.isLoading=!1}).catch(e=>{console.error(e),this.isLoading=!1,this.isError=!0})},reset(){this.versions=[],this.isError=!1,this.isLoading=!1}},watch:{active(){this.active&&(this.reset(),this.loadData())}}},Re={class:"modal-content"},Be={class:"box content"},Oe={class:"title"},Ne={class:"table",ref:"headerWrapper"},ze={class:"table-header"},Ke={class:"date"},Qe={class:"name"},qe={class:"person table-filler"},We={key:0,class:"table-body"},$e={class:"table"},Ye={class:"table-body"},Ge={class:"date"},Je={class:"name"},Xe={class:"person table-filler"},Ze={class:"has-text-right modal-footer"};function je(e,t,s,f,i,o){const E=h("table-info");return l(),r("div",{class:M({modal:!0,"is-active":s.active})},[n("div",{class:"modal-background",onClick:t[0]||(t[0]=y=>e.$emit("cancel"))}),n("div",Re,[n("div",Be,[n("h1",Oe,c(e.$t("edits.history")),1),n("table",Ne,[n("thead",ze,[n("tr",null,[n("th",Ke,c(e.$t("main.date")),1),n("th",Qe,c(e.$t("edits.fields.name")),1),n("th",qe,c(e.$t("edits.fields.person")),1)])])],512),i.isLoading?m("",!0):(l(),r("div",We,[n("table",$e,[n("tbody",Ye,[(l(!0),r(S,null,T(i.versions,y=>(l(),r("tr",{class:"edit-version",key:y.id},[n("td",Ge,c(o.formatDate(y.created_at)),1),n("td",Je,c(y.name),1),n("td",Xe,c(o.getPersonFullName(y.person_id)),1)]))),128))])])])),u(E,{"is-loading":i.isLoading,"is-error":i.isError},null,8,["is-loading","is-error"]),n("div",Ze,[n("button",{onClick:t[1]||(t[1]=y=>e.$emit("cancel")),class:"button is-link"},c(e.$t("main.cancel")),1)])])])],2)}const xe=O(Ue,[["render",je],["__scopeId","data-v-ec5b3235"]]),Q="/assets/empty_edit-CyxBzV9u.png",et={name:"edit-list",mixins:[ye,be,_e,we,Ae],props:{displayedEdits:{type:Array,default:()=>[]},displaySettings:{type:Object,default:()=>{}},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},validationColumns:{type:Array,default:()=>[]},departmentFilter:{type:Array,default:()=>[]}},emits:["add-edits","create-tasks","delete-clicked","edit-clicked","edit-history","metadata-changed","restore-clicked","scroll"],data(){return{type:"edit",hiddenColumns:{},lastHeaderMenuDisplayed:null,lastMetadaDataHeaderMenuDisplayed:null,lastHeaderMenuDisplayedIndexInGrid:null,lastSelectedEdit:null,lastSelection:null,metadataDisplayHeaders:{estimation:!0,timeSpent:!0},offsets:{},stickedColumns:{}}},components:{ButtonSimple:q,DescriptionCell:Ie,EntityThumbnail:J,MetadataHeader:Le,MetadataInput:re,RowActionsCell:Ve,TableHeaderMenu:ne,TableMetadataHeaderMenu:de,TableMetadataSelectorMenu:He,TableInfo:$,ValidationCell:Pe,ValidationHeader:le},computed:{...z(["edits","episodes","currentProduction","episodeMap","currentEpisode","displayedEditsEstimation","displayedEditsCount","displayedEditsLength","displayedEditsTimeSpent","isCurrentUserAdmin","isCurrentUserManager","isCurrentUserSupervisor","isCurrentUserClient","isSingleEpisode","isEditDescription","isEditEstimation","isEditTime","isTVShow","nbSelectedTasks","selectedEdits","edits","editFilledColumns","editMap","editMetadataDescriptors","editSearchText","editSelectionGrid","selectedTasks","taskMap","taskTypeMap","user"]),isEmptyList(){return this.displayedEdits.length&&this.displayedEdits[0].length===0&&!this.isLoading&&!this.isError&&(!this.editSearchText||this.editSearchText.length===0)},isEmptyTask(){return!this.isEmptyList&&!this.isLoading&&this.validationColumns&&this.validationColumns.length===0},isListVisible(){return!this.isLoading&&!this.isError&&this.displayedEditsCount>0},visibleColumns(){let e=2;return e+=!this.isCurrentUserClient&&this.displaySettings.showInfos&&this.isEditDescription?1:0,e+=this.visibleMetadataDescriptors.length,e+=!this.isCurrentUserClient&&this.displaySettings.showInfos&&this.isEditTime&&this.metadataDisplayHeaders.timeSpent?1:0,e+=!this.isCurrentUserClient&&this.displaySettings.showInfos&&this.isEditEstimation&&this.metadataDisplayHeaders.estimation?1:0,e+=this.displayedValidationColumns.length,e},displayedValidationColumns(){return this.validationColumns.filter(e=>this.editFilledColumns[e]&&(!this.hiddenColumns[e]||this.displaySettings.showInfos))},metadataDescriptors(){return this.editMetadataDescriptors},localStorageStickKey(){return`stick-edits-${this.currentProduction?.id}`}},methods:{...N(["displayMoreEdits","setEditSelection"]),isSelected(e,t){return this.editSelectionGrid[e][t]},toggleLine(e,t){const s=t.target.checked,f=[e];if(s&&this.shiftKeyPressed&&this.lastSelectedEdit){const i=this.displayedEdits.flat();let o=i.findIndex(y=>y.id===this.lastSelectedEdit.id),E=i.findIndex(y=>y.id===e.id);o>E&&([o,E]=[E,o]),o>=0&&E>=0&&X(o,E).forEach(y=>{f.push(i[y])})}s&&(this.lastSelectedEdit=e),f.forEach(i=>{this.setEditSelection({edit:i,selected:s})})},onBodyScroll(e){if(!this.$refs.body)return;const t=e.target;this.$emit("scroll",t.scrollTop),this.$refs.body.scrollHeight-this.$refs.body.offsetHeight<t.scrollTop+100&&this.loadMoreEdits()},loadMoreEdits(){this.displayMoreEdits()},editPath(e){return this.getPath("edit",e)},getPath(e,t){const s={name:e,params:{production_id:this.currentProduction?.id}};return this.isTVShow&&this.currentEpisode&&(s.name=`episode-${e}`,s.params.episode_id=this.currentEpisode.id),t&&(s.params.edit_id=t),s},onInputKeyUp(e,t,s){const f=this.visibleMetadataDescriptors.length+4,i=this.displayedEditsCount;return this.keyMetadataNavigation(f,i,t,s,e.key),this.pauseEvent(e)},toggleStickedColumns(e){const t=!this.stickedColumns[e];this.stickedColumns={...this.stickedColumns,[e]:t},K.setObjectPreference(this.localStorageStickKey,this.stickedColumns)},stickColumnClicked(){this.toggleStickedColumns(this.lastHeaderMenuDisplayed),this.showHeaderMenu()},metadataStickColumnClicked(e){this.toggleStickedColumns(this.lastMetadaDataHeaderMenuDisplayed),this.showMetadataHeaderMenu(this.lastMetadaDataHeaderMenuDisplayed,e)},updateOffsets(){this.isLoading||this.$nextTick(()=>{let e=this.$refs["th-edit"].clientWidth;if(this.offsets={},this.displaySettings.showInfos)for(let t=0;t<this.stickedVisibleMetadataDescriptors.length;t++)this.offsets[`editor-${t}`]=e,e+=this.$refs[`editor-${t}`][0].$el.clientWidth;for(let t=0;t<this.stickedDisplayedValidationColumns.length;t++)this.offsets[`validation-${t}`]=e,e+=this.$refs[`validation-${t}`][0].$el.clientWidth})}},watch:{displayedEdits(){this.$options.lineIndex={}},validationColumns(){this.initHiddenColumns(this.validationColumns,this.hiddenColumns)},stickedColumns(){this.updateOffsets()},isLoading(){this.updateOffsets()}},mounted(){this.stickedColumns=K.getObjectPreference(this.localStorageStickKey)||{}}},tt={class:"data-list"},it={class:"datatable"},st={class:"datatable-head",id:"datatable-edit"},at={scope:"col",class:"name edit-name datatable-row-header",ref:"th-edit"},ot={class:"flexrow"},lt={class:"flexrow-item"},dt={key:1,scope:"col",class:"resolution"},nt={key:4,scope:"col",class:"description selectable"},rt=["title"],mt={scope:"col",class:"actions",ref:"actionsSection"},ht={class:"datatable-body"},ct={key:0,class:"episode"},ut={class:"flexrow"},pt=["checked","onInput"],ft={class:"flexrow"},yt=["checked","onInput"],gt={key:1,class:"resolution"},kt=["value","onInput","onKeyup"],Ct={key:1,class:"metadata-value selectable"},Et=["title"],St=["title"],Tt={key:5,class:"time-spent selectable"},Mt={key:6,class:"estimation selectable"},Dt={key:9,class:"actions"},vt={key:0,class:"has-text-centered"},bt={class:"info"},wt={key:1,class:"has-text-centered"},_t={class:"info"},Lt={key:2,class:"has-text-centered nb-edits"},At={key:0};function It(e,t,s,f,i,o){const E=h("table-header-menu"),y=h("table-metadata-header-menu"),D=h("button-simple"),b=h("metadata-header"),w=h("validation-header"),A=h("table-metadata-selector-menu"),I=h("entity-thumbnail"),V=h("router-link"),_=h("metadata-input"),v=h("validation-cell"),H=h("description-cell"),P=h("row-actions-cell"),F=h("table-info"),U=Z("columns-resizable");return l(),r("div",tt,[n("div",{class:"datatable-wrapper",ref:"body",onScrollPassive:t[15]||(t[15]=(...a)=>o.onBodyScroll&&o.onBodyScroll(...a))},[u(E,{ref:"headerMenu","is-minimized":i.hiddenColumns[i.lastHeaderMenuDisplayed],"is-edit-allowed":e.isCurrentUserManager,"is-sticked":i.stickedColumns[i.lastHeaderMenuDisplayed],onMinimizeClicked:t[0]||(t[0]=a=>e.onMinimizeColumnToggled()),onDeleteAllClicked:t[1]||(t[1]=a=>e.onDeleteAllTasksClicked()),onSortByClicked:t[2]||(t[2]=a=>e.onSortByTaskTypeClicked()),onSelectColumn:t[3]||(t[3]=a=>e.onSelectColumn("edit")),onToggleStick:t[4]||(t[4]=a=>o.stickColumnClicked())},null,8,["is-minimized","is-edit-allowed","is-sticked"]),u(y,{ref:"headerMetadataMenu","is-edit-allowed":e.isMetadataColumnEditAllowed(i.lastMetadaDataHeaderMenuDisplayed),"is-sticked":i.stickedColumns[i.lastMetadaDataHeaderMenuDisplayed],onEditClicked:t[5]||(t[5]=a=>e.onEditMetadataClicked()),onDeleteClicked:t[6]||(t[6]=a=>e.onDeleteMetadataClicked()),onSortByClicked:t[7]||(t[7]=a=>e.onSortByMetadataClicked()),onToggleStick:t[8]||(t[8]=a=>o.metadataStickColumnClicked(a))},null,8,["is-edit-allowed","is-sticked"]),n("table",it,[B((l(),r("thead",st,[n("tr",null,[e.isTVShow?(l(),r("th",{key:0,scope:"col",class:"episode",ref:"th-episode"},c(e.$t("edits.fields.episode")),513)):m("",!0),n("th",at,[n("div",ot,[n("span",lt,c(e.$t("edits.fields.name")),1),(e.isCurrentUserManager||e.isCurrentUserSupervisor)&&!s.isLoading?(l(),C(D,{key:0,class:"is-small flexrow-item",icon:"plus",text:"",onClick:e.onAddMetadataClicked},null,8,["onClick"])):m("",!0)])],512),s.displaySettings.showInfos?(l(),r("th",dt,c(e.$t("shots.fields.resolution")),1)):m("",!0),s.displaySettings.showInfos?(l(!0),r(S,{key:2},T(e.stickedVisibleMetadataDescriptors,(a,p)=>(l(),C(b,{ref_for:!0,ref:`editor-${p}`,key:a.id,descriptor:a,left:i.offsets["editor-"+p]?`${i.offsets["editor-"+p]}px`:"0","is-stick":"",style:{"z-index":1001},onShowMetadataHeaderMenu:d=>e.showMetadataHeaderMenu(a.id,d)},null,8,["descriptor","left","onShowMetadataHeaderMenu"]))),128)):m("",!0),s.isLoading?m("",!0):(l(!0),r(S,{key:3},T(e.stickedDisplayedValidationColumns,(a,p)=>(l(),C(w,{ref_for:!0,ref:`validation-${p}`,key:a,"hidden-columns":i.hiddenColumns,"column-id":a,"validation-style":e.getValidationStyle(a),left:i.offsets["validation-"+p]?`${i.offsets["validation-"+p]}px`:"0",type:"edits","is-stick":"",onShowHeaderMenu:d=>e.showHeaderMenu(a,p,d)},null,8,["hidden-columns","column-id","validation-style","left","onShowHeaderMenu"]))),128)),!e.isCurrentUserClient&&s.displaySettings.showInfos&&e.isEditDescription?(l(),r("th",nt,c(e.$t("edits.fields.description")),1)):m("",!0),s.displaySettings.showInfos?(l(!0),r(S,{key:5},T(e.nonStickedVisibleMetadataDescriptors,a=>(l(),C(b,{key:a.id,descriptor:a,onShowMetadataHeaderMenu:p=>e.showMetadataHeaderMenu(a.id,p)},null,8,["descriptor","onShowMetadataHeaderMenu"]))),128)):m("",!0),!e.isCurrentUserClient&&s.displaySettings.showInfos&&e.isEditTime&&i.metadataDisplayHeaders.timeSpent?(l(),r("th",{key:6,scope:"col",class:"time-spent",ref:"th-spent"},c(e.$t("edits.fields.time_spent")),513)):m("",!0),!e.isCurrentUserClient&&s.displaySettings.showInfos&&e.isEditEstimation&&i.metadataDisplayHeaders.estimation?(l(),r("th",{key:7,scope:"col",class:"estimation",title:e.$t("main.estimation"),ref:"th-spent"},c(e.$t("main.estimation_short")),9,rt)):m("",!0),s.isLoading?m("",!0):(l(!0),r(S,{key:8},T(e.nonStickedDisplayedValidationColumns,(a,p)=>(l(),C(w,{key:a,"hidden-columns":i.hiddenColumns,"column-id":a,"validation-style":e.getValidationStyle(a),type:"edits",onShowHeaderMenu:d=>{e.showHeaderMenu(a,p,d)}},null,8,["hidden-columns","column-id","validation-style","onShowHeaderMenu"]))),128)),n("th",mt,[e.isCurrentUserManager&&s.displayedEdits.length>0&&!s.isLoading?(l(),C(D,{key:0,class:M({"is-small":!0,highlighted:o.isEmptyTask}),icon:"plus",text:e.$t("tasks.create_tasks"),onClick:t[9]||(t[9]=a=>e.$emit("create-tasks"))},null,8,["class","text"])):m("",!0),s.displaySettings.showInfos?B((l(),C(A,{key:1,descriptors:e.editMetadataDescriptors,exclude:{timeSpent:!e.isEditTime,estimation:!e.isEditEstimation},namespace:"edits",modelValue:i.metadataDisplayHeaders,"onUpdate:modelValue":t[10]||(t[10]=a=>i.metadataDisplayHeaders=a)},null,8,["descriptors","exclude","modelValue"])),[[W,e.columnSelectorDisplayed]]):m("",!0),e.editMetadataDescriptors.length>0&&s.displaySettings.showInfos?(l(),C(D,{key:2,class:"is-small is-pulled-right mr05",icon:"down",onClick:e.toggleColumnSelector},null,8,["onClick"])):m("",!0)],512)])])),[[U]]),n("tbody",ht,[!s.isLoading&&o.isListVisible?(l(!0),r(S,{key:0},T(s.displayedEdits,(a,p)=>(l(),r("tr",{class:M(["datatable-row",{canceled:a.canceled}]),scope:"row",key:a.id},[e.isTVShow?(l(),r("td",ct,[n("div",ut,[e.isCurrentUserManager?(l(),r("input",{key:0,type:"checkbox",class:"mr1",checked:e.selectedEdits.has(a.id)||null,onInput:d=>o.toggleLine(a,d)},null,40,pt)):m("",!0),L(" "+c(e.episodeMap.get(a.parent_id)?e.episodeMap.get(a.parent_id).name:"-"),1)])])):m("",!0),n("th",{class:M({"datatable-row-header":!0,"edit-name":!0,name:!0,bold:!a.canceled})},[n("div",ft,[!e.isTVShow&&e.isCurrentUserManager?(l(),r("input",{key:0,type:"checkbox",class:"mr1",checked:e.selectedEdits.has(a.id)||null,onInput:d=>o.toggleLine(a,d)},null,40,yt)):m("",!0),u(I,{entity:a,width:s.displaySettings.bigThumbnails?150:50,height:s.displaySettings.bigThumbnails?100:33,"empty-width":s.displaySettings.bigThumbnails?150:50,"empty-height":s.displaySettings.bigThumbnails?100:34},null,8,["entity","width","height","empty-width","empty-height"]),e.isCurrentUserClient?(l(),r(S,{key:2},[L(c(a.name),1)],64)):(l(),C(V,{key:1,tabindex:"-1",title:a.full_name,to:o.editPath(a.id)},{default:j(()=>[L(c(a.name),1)]),_:2},1032,["title","to"]))])],2),s.displaySettings.showInfos?(l(),r("td",gt,[e.isCurrentUserManager?(l(),r("input",{key:0,class:M({"input-editor":!0,error:!e.isValidResolution(a)}),value:e.getMetadataFieldValue({field_name:"resolution"},a),onInput:d=>e.onMetadataFieldChanged(a,{field_name:"resolution"},d),onKeyup:x(d=>o.onInputKeyUp(d,e.getIndex(p,e.k),e.descriptorLength),["ctrl"])},null,42,kt)):(l(),r("span",Ct,c(e.getMetadataFieldValue({field_name:"resolution"},a)),1))])):m("",!0),(l(!0),r(S,null,T(e.stickedVisibleMetadataDescriptors,(d,k)=>(l(),r("td",{ref_for:!0,ref:`editor-${p}-${k}`,class:"metadata-descriptor datatable-row-header",title:a.data?a.data[d.field_name]:"",style:ee({"z-index":1e3-p,left:i.offsets["editor-"+k]?`${i.offsets["editor-"+k]}px`:"0"}),key:a.id+"-"+d.id},[u(_,{entity:a,descriptor:d,indexes:{i:p,j:k},onMetadataChanged:t[11]||(t[11]=g=>e.$emit("metadata-changed",g))},null,8,["entity","descriptor","indexes"])],12,Et))),128)),s.isLoading?m("",!0):(l(!0),r(S,{key:2},T(e.stickedDisplayedValidationColumns,(d,k)=>(l(),C(v,{ref_for:!0,ref:`validation-${p}-${k}`,key:d+"-"+a.id,class:M({"validation-cell":!i.hiddenColumns[d],"hidden-validation-cell":i.hiddenColumns[d],"datatable-row-header":!0}),"contact-sheet":s.displaySettings.contactSheetMode,column:e.taskTypeMap.get(d),"column-y":k,entity:a,"is-assignees":s.displaySettings.showAssignations,"is-static":!0,left:i.offsets["validation-"+k]?`${i.offsets["validation-"+k]}px`:"0",minimized:i.hiddenColumns[d],"row-x":p,selected:o.isSelected(p,k),sticked:!0,"task-test":e.taskMap.get(a.validations.get(d)),onSelect:t[12]||(t[12]=g=>e.onTaskSelected(g,!0)),onUnselect:t[13]||(t[13]=g=>e.onTaskUnselected(g,!0))},null,8,["class","contact-sheet","column","column-y","entity","is-assignees","left","minimized","row-x","selected","task-test"]))),128)),!e.isCurrentUserClient&&s.displaySettings.showInfos&&e.isEditDescription?(l(),C(H,{key:3,class:"description",entry:a,editable:e.isCurrentUserManager,onDescriptionChanged:d=>e.onDescriptionChanged(a,d)},null,8,["entry","editable","onDescriptionChanged"])):m("",!0),s.displaySettings.showInfos?(l(!0),r(S,{key:4},T(e.nonStickedVisibleMetadataDescriptors,(d,k)=>(l(),r("td",{class:"metadata-descriptor",title:a.data?a.data[d.field_name]:"",key:a.id+"-"+d.id},[u(_,{entity:a,descriptor:d,indexes:{i:p,j:k},onMetadataChanged:t[14]||(t[14]=g=>e.$emit("metadata-changed",g))},null,8,["entity","descriptor","indexes"])],8,St))),128)):m("",!0),!e.isCurrentUserClient&&s.displaySettings.showInfos&&e.isEditTime&&i.metadataDisplayHeaders.timeSpent?(l(),r("td",Tt,c(e.formatDuration(a.timeSpent)),1)):m("",!0),!e.isCurrentUserClient&&s.displaySettings.showInfos&&e.isEditEstimation&&i.metadataDisplayHeaders.estimation?(l(),r("td",Mt,c(e.formatDuration(a.estimation)),1)):m("",!0),s.isLoading?m("",!0):(l(!0),r(S,{key:7},T(e.nonStickedDisplayedValidationColumns,(d,k)=>(l(),C(v,{ref_for:!0,ref:`validation-${p}-${k+e.stickedDisplayedValidationColumns.length}`,class:M({"validation-cell":!i.hiddenColumns[d],"hidden-validation-cell":i.hiddenColumns[d]}),"contact-sheet":s.displaySettings.contactSheetMode,key:`${d}-${a.id}`,column:e.taskTypeMap.get(d),entity:a,"task-test":e.taskMap.get(a.validations?a.validations.get(d):null),minimized:i.hiddenColumns[d],selected:o.isSelected(p,k+e.stickedDisplayedValidationColumns.length),"row-x":p,"column-y":k,"is-assignees":s.displaySettings.showAssignations,onSelect:e.onTaskSelected,onUnselect:e.onTaskUnselected},null,8,["class","contact-sheet","column","entity","task-test","minimized","selected","row-x","column-y","is-assignees","onSelect","onUnselect"]))),128)),e.isCurrentUserManager?(l(),C(P,{key:8,entry:a,"hide-history":!1,onDeleteClicked:d=>e.$emit("delete-clicked",a),onEditClicked:d=>e.$emit("edit-clicked",a),onHistoryClicked:d=>e.$emit("edit-history",a),onRestoreClicked:d=>e.$emit("restore-clicked",a)},null,8,["entry","onDeleteClicked","onEditClicked","onHistoryClicked","onRestoreClicked"])):(l(),r("td",Dt))],2))),128)):m("",!0)])])],544),u(F,{"is-loading":s.isLoading,"is-error":s.isError},null,8,["is-loading","is-error"]),o.isEmptyList&&!e.isCurrentUserClient&&!s.isLoading?(l(),r("div",vt,[t[17]||(t[17]=n("p",{class:"info"},[n("img",{src:Q})],-1)),n("p",bt,c(e.$t("edits.empty_list")),1),u(D,{class:"level-item big-button",text:e.$t("edits.new_edits"),onClick:t[16]||(t[16]=a=>e.$emit("add-edits"))},null,8,["text"])])):m("",!0),o.isEmptyList&&e.isCurrentUserClient&&!s.isLoading?(l(),r("div",wt,[t[18]||(t[18]=n("p",{class:"info"},[n("img",{src:Q})],-1)),n("p",_t,c(e.$t("edits.empty_list_client")),1)])):m("",!0),!o.isEmptyList&&!s.isLoading?(l(),r("p",Lt,[L(c(e.displayedEditsLength)+" "+c(e.$tc("edits.number",e.displayedEditsLength))+" ",1),e.displayedEditsTimeSpent>0||e.displayedEditsEstimation>0?(l(),r("span",At," ("+c(e.formatDuration(e.displayedEditsTimeSpent))+" "+c(e.isDurationInHours?e.$tc("main.hours_spent",e.formatDuration(e.displayedEditsTimeSpent,!1)):e.$tc("main.days_spent",e.formatDuration(e.displayedEditsTimeSpent,!1)))+", "+c(e.formatDuration(e.displayedEditsEstimation))+" "+c(e.isDurationInHours?e.$tc("main.hours_estimated",e.formatDuration(e.displayedEditsEstimation,!1)):e.$tc("main.man_days",e.formatDuration(e.displayedEditsEstimation,!1)))+") ",1)):m("",!0)])):m("",!0)])}const Vt=O(et,[["render",It],["__scopeId","data-v-84ff5903"]]),Ht={name:"edits",mixins:[oe,fe],components:{AddMetadataModal:pe,AddThumbnailsModal:ue,BuildFilterModal:ge,ButtonSimple:q,ComboboxDepartment:ke,ComboboxDisplayOptions:ce,CreateTasksModal:he,DeleteModal:Ce,EditEditModal:Ee,ImportModal:Te,HardDeleteModal:Me,ImportRenderModal:Se,SearchField:De,SearchQueryList:ve,SortingInfo:me,EditHistoryModal:xe,EditList:Vt,TaskInfo:Fe},data(){return{type:"edit",contactSheetMode:!1,deleteAllTasksLockText:null,descriptorToEdit:{},departmentFilter:[],editToDelete:null,editToEdit:null,editToRestore:null,formData:null,genericColumns:["Metadata column name (text value)","Task type name (task status name value)","Task type name + comment (text value)"],historyEdit:{},initialLoading:!0,optionalColumns:["Description"],pageName:"Edits",parsedCSV:[],selectedDepartment:"ALL",taskTypeForTaskDeletion:null,modals:{isAddMetadataDisplayed:!1,isAddThumbnailsDisplayed:!1,isBuildFilterDisplayed:!1,isCreateTasksDisplayed:!1,isDeleteDisplayed:!1,isDeleteMetadataDisplayed:!1,isDeleteAllTasksDisplayed:!1,isImportRenderDisplayed:!1,isImportDisplayed:!1,isNewDisplayed:!1,isRestoreDisplayed:!1,isEditHistoryDisplayed:!1},loading:{addMetadata:!1,addThumbnails:!1,creatingTasks:!1,creatingTasksStay:!1,deleteAllTasks:!1,deleteMetadata:!1,edit:!1,del:!1,importing:!1,restore:!1,savingSearch:!1,stay:!1},errors:{addMetadata:!1,deleteMetadata:!1,creatingTasks:!1,deleteAllTasks:!1,importing:!1,importingError:null}}},beforeUnmount(){this.clearSelectedEdits()},created(){this.setLastProductionScreen("edits")},mounted(){this.editSearchText.length>0&&this.$refs["edit-search-field"]?.setValue(this.editSearchText),this.$refs["edit-list"]?.setScrollPosition(this.editListScrollPosition);const e=()=>{this.$refs["edit-list"]&&(this.applySearchFromUrl(),this.$refs["edit-list"].setScrollPosition(this.editListScrollPosition),this.$refs["edit-list"].selectTaskFromQuery())};this.editMap.size<2||this.editValidationColumns.length>0&&!this.editMap.get(this.editMap.keys().next().value).validations?setTimeout(()=>{this.loadEdits().then(()=>{setTimeout(()=>{this.initialLoading=!1,e()},200)})},0):(this.isEditsLoading||(this.initialLoading=!1),e())},computed:{...z(["currentEpisode","currentProduction","displayedEdits","departmentMap","departments","editMap","editFilledColumns","editsCsvFormData","editSearchQueries","editSearchText","editValidationColumns","editListScrollPosition","editSorting","episodeMap","episodes","openProductions","isCurrentUserClient","isCurrentUserManager","isEditDescription","isEditEstimation","isEditTime","isEditsLoading","isEditsLoadingError","isLongEditList","isShowAssignations","isTVShow","productionEditTaskTypes","selectedEdits","taskTypeMap","user"]),searchField(){return this.$refs["edit-search-field"]},addThumbnailsModal(){return this.$refs["add-thumbnails-modal"]},renderColumns(){const e=[...this.dataMatchers,...this.optionalColumns];return this.productionEditTaskTypes.forEach(t=>{e.push(t.name),e.push(`${t.name} comment`)}),e},dataMatchers(){return this.isTVShow?["Episode","Name"]:["Name"]},filteredEdits(){const e={};return this.displayedEdits.forEach(t=>{let s="";this.isTVShow&&t.episode_id&&this.episodeMap.has(t.episode_id)&&(s+=this.episodeMap.get(t.episode_id).name),s+=`${t.name}`,e[s]=!0}),e},metadataDescriptors(){return this.editMetadataDescriptors}},methods:{...N(["addMetadataDescriptor","createTasks","changeEditSort","clearSelectedEdits","commentTaskWithPreview","deleteAllEditTasks","deleteEdit","deleteMetadataDescriptor","editEdit","getEditsCsvLines","hideAssignations","loadEpisodes","loadEdits","newEdit","removeEditSearch","restoreEdit","saveEditSearch","setLastProductionScreen","setPreview","setEditSearch","showAssignations","uploadEditFile"]),confirmAddMetadata(e){this.loading.addMetadata=!0,e.entity_type="Edit",this.addMetadataDescriptor(e).then(()=>{this.loading.addMetadata=!1,this.modals.isAddMetadataDisplayed=!1}).catch(t=>{console.error(t),this.loading.addMetadata=!1,this.errors.addMetadata=!0})},closeMetadataModal(){this.modals.isAddMetadataDisplayed=!1},confirmDeleteMetadata(){this.errors.deleteMetadata=!1,this.loading.deleteMetadata=!0,this.deleteMetadataDescriptor(this.descriptorIdToDelete).then(()=>{this.errors.deleteMetadata=!1,this.loading.deleteMetadata=!1,this.modals.isDeleteMetadataDisplayed=!1}).catch(e=>{console.error(e),this.errors.deleteMetadata=!0,this.loading.deleteMetadata=!1})},onAddMetadataClicked(){this.descriptorToEdit={},this.modals.isAddMetadataDisplayed=!0},onDeleteMetadataClicked(e){this.descriptorIdToDelete=e,this.modals.isDeleteMetadataDisplayed=!0},onDeleteClicked(e){this.editToDelete=e,this.modals.isDeleteDisplayed=!0},showNewModal(){this.editToEdit={},this.modals.isNewDisplayed=!0},onEditClicked(e){this.editToEdit=e,this.modals.isNewDisplayed=!0},onRestoreClicked(e){this.editToRestore=e,this.modals.isRestoreDisplayed=!0},onEditMetadataClicked(e){this.descriptorToEdit=this.currentProduction.descriptors.find(t=>t.id===e),this.modals.isAddMetadataDisplayed=!0},confirmEditEdit(e){let t="newEdit";this.loading.edit=!0,this.errors.edit=!1,this.editToEdit&&this.editToEdit.id&&(t="editEdit",e.id=this.editToEdit.id),this[t](e).then(s=>{this.loading.edit=!1,this.modals.isNewDisplayed=!1,this.applySearchFromUrl(!1)}).catch(s=>{console.error(s),this.loading.edit=!1,this.errors.edit=!0})},confirmDeleteAllTasks(e){const t=this.taskTypeForTaskDeletion.id,s=this.currentProduction.id;this.errors.deleteAllTasks=!1,this.loading.deleteAllTasks=!0,this.deleteAllEditTasks({projectId:s,taskTypeId:t,selectionOnly:e}).then(()=>{this.loading.deleteAllTasks=!1,this.modals.isDeleteAllTasksDisplayed=!1}).catch(f=>{console.error(f),this.loading.deleteAllTasks=!1,this.errors.deleteAllTasks=!0})},confirmDeleteEdit(){this.loading.del=!0,this.errors.del=!1,this.deleteEdit(this.editToDelete).then(()=>{this.loading.del=!1,this.modals.isDeleteDisplayed=!1}).catch(e=>{console.error(e),this.loading.del=!1,this.errors.del=!0})},confirmRestoreEdit(){this.loading.restore=!0,this.errors.restore=!1,this.restoreEdit(this.editToRestore).then(()=>{this.loading.restore=!1,this.modals.isRestoreDisplayed=!1}).catch(e=>{console.error(e),this.loading.restore=!1,this.errors.restore=!0})},confirmAddThumbnails(e){const t=s=>(this.addThumbnailsModal?.markLoading(s.task.entity_id),this.commentTaskWithPreview({taskId:s.task.id,commentText:"",taskStatusId:s.task.task_status_id,form:s}).then(({newComment:f,preview:i})=>this.setPreview({taskId:s.task.id,entityId:s.task.entity_id,previewId:i.id})).then(()=>{this.addThumbnailsModal?.markUploaded(s.task.entity_id)}));this.loading.addThumbnails=!0,se.runPromiseMapAsSeries(e,t).then(()=>{this.loading.addThumbnails=!1,this.modals.isAddThumbnailsDisplayed=!1})},confirmCreateTasks({form:e,selectionOnly:t}){this.loading.creatingTasks=!0,this.runTasksCreation(e,t).then(()=>{this.reset(),this.hideCreateTasksModal(),this.loading.creatingTasks=!1}).catch(s=>{this.errors.creatingTasks=!0,console.error(s)})},confirmCreateTasksAndStay({form:e,selectionOnly:t}){this.loading.creatingTasksStay=!0,this.runTasksCreation(e,t).then(()=>{this.reset(),this.loading.creatingTasksStay=!1}).catch(s=>{this.errors.creatingTasks=!0,console.error(s)})},runTasksCreation(e,t){return this.errors.creatingTasks=!1,this.createTasks({type:"edits",task_type_id:e.task_type_id,project_id:this.currentProduction.id,selectionOnly:t})},reset(){this.initialLoading=!0,this.loadEdits(e=>{e&&console.error(e),this.initialLoading=!1})},resetEditModal(){const e={name:""};this.openProductions.length>0&&(e.production_id=this.openProductions[0].id),this.editToEdit=e},deleteText(){const e=this.editToDelete;return e&&(e.canceled||!e.tasks||e.tasks.length===0)?this.$t("edits.delete_text",{name:e.name}):e?this.$t("edits.cancel_text",{name:e.name}):""},deleteAllTasksText(){const e=this.taskTypeForTaskDeletion;return e?this.$t("tasks.delete_all_text",{name:e.name}):""},restoreText(){const e=this.editToRestore;return e?this.$t("edits.restore_text",{name:e.name}):""},renderImport(e,t){this.loading.importing=!0,this.errors.importing=!1,this.formData=e,t==="file"&&(e=e.get("file")),R.processCSV(e).then(s=>{this.parsedCSV=s,this.hideImportModal(),this.loading.importing=!1,this.showImportRenderModal()})},uploadImportFile(e,t){const s=new FormData,f="import.csv",i=R.turnEntriesToCsvString(e),o=new File([i],f,{type:"text/csv"});s.append("file",o),this.loading.importing=!0,this.errors.importing=!1,this.$store.commit("EDIT_CSV_FILE_SELECTED",s),this.uploadEditFile(t).then(()=>{this.loadEpisodes().catch(console.error),this.hideImportRenderModal(),this.loadEdits()}).catch(E=>{console.error(E),this.loading.importingError=E,this.errors.importing=!0}).finally(()=>{this.loading.importing=!1})},resetImport(){this.errors.importing=!1,this.hideImportRenderModal(),this.$store.commit("EDIT_CSV_FILE_SELECTED",null),this.$refs["import-modal"].reset(),this.showImportModal()},onDeleteAllTasksClicked(e){const t=this.taskTypeMap.get(e);this.taskTypeForTaskDeletion=t,this.deleteAllTasksLockText=t.name,this.modals.isDeleteAllTasksDisplayed=!0},onSearchChange(e=!0){if(!this.searchField)return;const t=this.searchField.getValue()||"";this.setSearchInUrl(),t.length!==1&&!this.isLongEditList&&this.applySearch(t),e&&this.clearSelection()},saveScrollPosition(e){this.$store.commit("SET_EDIT_LIST_SCROLL_POSITION",e)},saveSearchQuery(e){this.loading.savingSearch||(this.loading.savingSearch=!0,this.saveEditSearch(e).catch(console.error).finally(()=>{this.loading.savingSearch=!1}))},removeSearchQuery(e){this.removeEditSearch(e).catch(console.error)},getPath(e){const t={name:e,params:{production_id:this.currentProduction.id}};return this.isTVShow&&this.currentEpisode&&(t.name=`episode-${e}`,t.params.episode_id=this.currentEpisode.id),t},showEditHistoryModal(e){this.historyEdit=e,this.modals.isEditHistoryDisplayed=!0},hideEditHistoryModal(){this.modals.isEditHistoryDisplayed=!1},onExportClick(){this.getEditsCsvLines().then(e=>{const t=[te().format("YYYY-MM-DD"),"kitsu",this.currentProduction.name,this.$t("edits.title")];this.currentEpisode&&t.splice(3,0,this.currentEpisode.name);const s=ae.slugify(t.join("_")),f=[this.$t("edits.fields.name"),this.$t("edits.fields.description")];this.currentEpisode&&f.splice(0,0,"Episode"),ie([...this.currentProduction.descriptors]).filter(i=>i.entity_type==="Edit").forEach(i=>{f.push(i.name)}),this.isEditTime&&f.push(this.$t("edits.fields.time_spent")),this.isEditEstimation&&f.push(this.$t("main.estimation_short")),this.editValidationColumns.forEach(i=>{f.push(this.taskTypeMap.get(i).name),f.push("Assignations")}),R.buildCsvFile(s,[f].concat(e))})},onChangeSortClicked(e){this.changeEditSort(e)},async onFieldChanged({entry:e,fieldName:t,value:s}){const f={id:e.id,description:e.description,[t]:s};await this.editEdit(f),this.applySearchFromUrl(!1)},async onMetadataChanged({entry:e,descriptor:t,value:s}){const f={id:e.id,data:{[t.field_name]:s}};await this.editEdit(f),this.applySearchFromUrl(!1)}},watch:{currentProduction(){this.$refs["edit-search-field"]?.setValue(""),this.$store.commit("SET_EDIT_LIST_SCROLL_POSITION",0),this.initialLoading=!0,this.isTVShow||this.reset()},currentEpisode(){this.$refs["edit-search-field"]?.setValue(""),this.$store.commit("SET_EDIT_LIST_SCROLL_POSITION",0),this.isTVShow&&this.currentEpisode&&this.reset()},currentSection(){(this.isTVShow&&this.edits.length===0||this.edits[0].episode_id!==this.currentEpisode.id)&&(this.$refs["edit-search-field"].setValue(""),this.$store.commit("SET_EDIT_LIST_SCROLL_POSITION",0),this.reset())},isEditsLoading(){if(!this.isEditsLoading){let e="";this.$route.query.search&&this.$route.query.search.length>0&&(e=`${this.$route.query.search}`),this.initialLoading=!1,this.$refs["edit-search-field"].setValue(e),this.$nextTick(()=>{this.applySearch(e)}),this.$refs["edit-list"]&&this.$refs["edit-list"].setScrollPosition(this.editListScrollPosition)}}},head(){return this.isTVShow?{title:`${this.currentProduction?this.currentProduction.name:""} - ${this.currentEpisode?this.currentEpisode.name||this.$t("main.all"):""} | ${this.$t("edits.title")} - Kitsu`}:{title:`${this.currentProduction.name} ${this.$t("edits.title")} - Kitsu`}}},Pt={class:"columns fixed-page"},Ft={class:"column main-column"},Ut={class:"edits page"},Rt={class:"edit-list-header page-header"},Bt={class:"flexrow mb1"},Ot={key:1,class:"flexrow flexrow-item"},Nt={key:2,class:"flexrow"},zt={class:"query-list"},Kt={id:"side-column",class:"column side-column"};function Qt(e,t,s,f,i,o){const E=h("search-field"),y=h("button-simple"),D=h("combobox-department"),b=h("combobox-display-options"),w=h("search-query-list"),A=h("sorting-info"),I=h("edit-list"),V=h("task-info"),_=h("edit-edit-modal"),v=h("delete-modal"),H=h("hard-delete-modal"),P=h("import-render-modal"),F=h("import-modal"),U=h("create-tasks-modal"),a=h("add-metadata-modal"),p=h("add-thumbnails-modal"),d=h("edit-history-modal"),k=h("build-filter-modal");return l(),r("div",Pt,[n("div",Ft,[n("div",Ut,[n("div",Rt,[n("div",Bt,[u(E,{ref:"edit-search-field","can-save":!0,onChange:o.onSearchChange,onEnter:t[0]||(t[0]=g=>e.applySearch(o.searchField.getValue())),onSave:o.saveSearchQuery,placeholder:"ex: e01 edit=wip"},null,8,["onChange","onSave"]),u(y,{class:"flexrow-item",title:e.$t("entities.build_filter.title"),icon:"filter",onClick:t[1]||(t[1]=()=>i.modals.isBuildFilterDisplayed=!0)},null,8,["title"]),t[11]||(t[11]=n("div",{class:"filler"},null,-1)),e.departments.length>0?(l(),C(D,{key:0,class:"combobox-department flexrow-item","selectable-departments":e.selectableDepartments("Edit"),"display-all-and-my-departments":!0,width:230,rounded:"",modelValue:i.selectedDepartment,"onUpdate:modelValue":t[2]||(t[2]=g=>i.selectedDepartment=g)},null,8,["selectable-departments","modelValue"])):m("",!0),e.isCurrentUserClient?m("",!0):(l(),r("div",Ot,[u(b,{class:"flexrow-item",type:i.type,modelValue:e.displaySettings,"onUpdate:modelValue":t[3]||(t[3]=g=>e.displaySettings=g)},null,8,["type","modelValue"])])),e.isCurrentUserManager?(l(),r("div",Nt,[u(y,{class:"flexrow-item",title:e.$t("entities.thumbnails.title"),icon:"import-files",onClick:e.showAddThumbnailsModal},null,8,["title","onClick"]),u(y,{class:"flexrow-item",title:e.$t("main.csv.import_file"),icon:"import",onClick:e.showImportModal},null,8,["title","onClick"]),u(y,{class:"flexrow-item",icon:"export",title:e.$t("main.csv.export_file"),onClick:o.onExportClick},null,8,["title","onClick"]),u(y,{class:"flexrow-item",text:e.$t("edits.new_edit"),icon:"plus",onClick:o.showNewModal},null,8,["text","onClick"])])):m("",!0)]),n("div",zt,[!e.isEditsLoading&&!i.initialLoading?(l(),C(w,{key:0,queries:e.editSearchQueries,type:"edit",onRemoveSearch:o.removeSearchQuery},null,8,["queries","onRemoveSearch"])):m("",!0)])]),e.editSorting?.length?(l(),C(A,{key:0,sorting:e.editSorting,onClearSorting:t[4]||(t[4]=g=>o.onChangeSortClicked(null))},null,8,["sorting"])):m("",!0),u(I,{ref:"edit-list","displayed-edits":e.displayedEdits,"is-loading":e.isEditsLoading||i.initialLoading,"is-error":e.isEditsLoadingError,"validation-columns":e.editValidationColumns,"department-filter":i.departmentFilter,"display-settings":e.displaySettings,onAddMetadata:o.onAddMetadataClicked,onChangeSort:o.onChangeSortClicked,onCreateTasks:e.showCreateTasksModal,onDeleteAllTasks:o.onDeleteAllTasksClicked,onDeleteClicked:o.onDeleteClicked,onDeleteMetadata:o.onDeleteMetadataClicked,onEditClicked:o.onEditClicked,onEditMetadata:o.onEditMetadataClicked,onFieldChanged:o.onFieldChanged,onMetadataChanged:o.onMetadataChanged,onRestoreClicked:o.onRestoreClicked,onScroll:o.saveScrollPosition,onEditHistory:o.showEditHistoryModal,onKeepTaskPanelOpen:e.onKeepTaskPanelOpenChanged},null,8,["displayed-edits","is-loading","is-error","validation-columns","department-filter","display-settings","onAddMetadata","onChangeSort","onCreateTasks","onDeleteAllTasks","onDeleteClicked","onDeleteMetadata","onEditClicked","onEditMetadata","onFieldChanged","onMetadataChanged","onRestoreClicked","onScroll","onEditHistory","onKeepTaskPanelOpen"])])]),B(n("div",Kt,[u(V,{task:e.selectedTasks.values().next().value,"entity-type":"Edit","with-actions":""},null,8,["task"])],512),[[W,e.isTaskSidePanelOpen]]),u(_,{active:i.modals.isNewDisplayed,"is-loading":i.loading.edit,"is-error":i.errors.edit,"edit-to-edit":i.editToEdit,onCancel:t[5]||(t[5]=g=>i.modals.isNewDisplayed=!1),onConfirm:o.confirmEditEdit},null,8,["active","is-loading","is-error","edit-to-edit","onConfirm"]),u(v,{ref:"delete-edit-modal",active:i.modals.isDeleteDisplayed,"is-loading":i.loading.del,"is-error":i.errors.del,text:o.deleteText(),"error-text":e.$t("edits.delete_error"),onCancel:t[6]||(t[6]=g=>i.modals.isDeleteDisplayed=!1),onConfirm:o.confirmDeleteEdit},null,8,["active","is-loading","is-error","text","error-text","onConfirm"]),u(v,{ref:"restore-edit-modal",active:i.modals.isRestoreDisplayed,"is-loading":i.loading.restore,"is-error":i.errors.restore,text:o.restoreText(),"error-text":e.$t("edits.restore_error"),onCancel:t[7]||(t[7]=g=>i.modals.isRestoreDisplayed=!1),onConfirm:o.confirmRestoreEdit},null,8,["active","is-loading","is-error","text","error-text","onConfirm"]),u(v,{ref:"delete-metadata-modal",active:i.modals.isDeleteMetadataDisplayed,"is-loading":i.loading.deleteMetadata,"is-error":i.errors.deleteMetadata,onCancel:t[8]||(t[8]=g=>i.modals.isDeleteMetadataDisplayed=!1),text:e.$t("productions.metadata.delete_text"),"error-text":e.$t("productions.metadata.delete_error"),onConfirm:o.confirmDeleteMetadata},null,8,["active","is-loading","is-error","text","error-text","onConfirm"]),u(H,{ref:"delete-all-tasks-modal",active:i.modals.isDeleteAllTasksDisplayed,"is-loading":i.loading.deleteAllTasks,"is-error":i.errors.deleteAllTasks,text:o.deleteAllTasksText(),"error-text":e.$t("tasks.delete_all_error"),"lock-text":i.deleteAllTasksLockText,"selection-option":!0,onCancel:t[9]||(t[9]=g=>i.modals.isDeleteAllTasksDisplayed=!1),onConfirm:o.confirmDeleteAllTasks},null,8,["active","is-loading","is-error","text","error-text","lock-text","onConfirm"]),u(P,{active:i.modals.isImportRenderDisplayed,"is-loading":i.loading.importing,"is-error":i.errors.importing,"import-error":i.errors.importingError,"parsed-csv":i.parsedCSV,"form-data":e.editsCsvFormData,columns:o.renderColumns,"data-matchers":o.dataMatchers,database:o.filteredEdits,onReupload:o.resetImport,onCancel:e.hideImportRenderModal,onConfirm:o.uploadImportFile},null,8,["active","is-loading","is-error","import-error","parsed-csv","form-data","columns","data-matchers","database","onReupload","onCancel","onConfirm"]),u(F,{ref:"import-modal",active:i.modals.isImportDisplayed,"is-loading":i.loading.importing,"is-error":i.errors.importing,"form-data":e.editsCsvFormData,columns:o.dataMatchers,"optional-columns":i.optionalColumns,"generic-columns":i.genericColumns,onCancel:e.hideImportModal,onConfirm:o.renderImport},null,8,["active","is-loading","is-error","form-data","columns","optional-columns","generic-columns","onCancel","onConfirm"]),u(U,{active:i.modals.isCreateTasksDisplayed,"is-loading":i.loading.creatingTasks,"is-loading-stay":i.loading.creatingTasksStay,"is-error":i.errors.creatingTasks,title:e.$t("tasks.create_tasks_edit"),text:e.$t("tasks.create_tasks_edit_explaination"),"error-text":e.$t("tasks.create_tasks_edit_failed"),onCancel:e.hideCreateTasksModal,onConfirm:o.confirmCreateTasks,onConfirmAndStay:o.confirmCreateTasksAndStay},null,8,["active","is-loading","is-loading-stay","is-error","title","text","error-text","onCancel","onConfirm","onConfirmAndStay"]),u(a,{active:i.modals.isAddMetadataDisplayed,"is-loading":i.loading.addMetadata,"is-error":i.errors.addMetadata,"descriptor-to-edit":i.descriptorToEdit,"entity-type":"Edit",onCancel:o.closeMetadataModal,onConfirm:o.confirmAddMetadata},null,8,["active","is-loading","is-error","descriptor-to-edit","onCancel","onConfirm"]),i.modals.isAddThumbnailsDisplayed?(l(),C(p,{key:0,ref:"add-thumbnails-modal",active:"","entity-type":"Edit",parent:e.isTVShow?"edits_tvshow":"edits","is-loading":i.loading.addThumbnails,"is-error":i.errors.addThumbnails,onCancel:e.hideAddThumbnailsModal,onConfirm:o.confirmAddThumbnails},null,8,["parent","is-loading","is-error","onCancel","onConfirm"])):m("",!0),u(d,{active:i.modals.isEditHistoryDisplayed,edit:i.historyEdit,onCancel:o.hideEditHistoryModal},null,8,["active","edit","onCancel"]),u(k,{ref:"build-filter-modal",active:i.modals.isBuildFilterDisplayed,"entity-type":"edit",onCancel:t[10]||(t[10]=g=>i.modals.isBuildFilterDisplayed=!1),onConfirm:e.confirmBuildFilter},null,8,["active","onConfirm"])])}const as=O(Ht,[["render",Qt],["__scopeId","data-v-ea00a35d"]]);export{as as default};
//# sourceMappingURL=Edits-DIubt1MF.js.map
