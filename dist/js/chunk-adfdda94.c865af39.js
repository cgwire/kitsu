(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-adfdda94"],{"028a":function(t,e,s){},"099d":function(t,e,s){"use strict";s("c8a3")},"2a5f":function(t,e,s){"use strict";s("028a")},"459c":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"level page-header"},[s("div",{staticClass:"level-left"},[s("page-title",{attrs:{text:t.title}})],1),s("div",{staticClass:"level-right"},[s("button-simple",{staticClass:"level-item",attrs:{icon:"plus",text:t.newEntryLabel},on:{click:function(e){return t.$emit("new-clicked")}}})],1)])},r=[],i=s("2f62"),n=s("de40"),o=s("8d07");function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function c(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){d(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function d(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var p={name:"list-page-header",components:{ButtonSimple:n["a"],PageTitle:o["a"]},props:{title:{type:String,default:""},newEntryLabel:{type:String,default:""}},computed:c({},Object(i["c"])([])),methods:c({},Object(i["b"])([])),watch:{}},u=p,f=s("0c7c"),m=Object(f["a"])(u,a,r,!1,null,"bf4864ae",null);e["a"]=m.exports},"56b8":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-types page fixed-page"},[s("list-page-header",{attrs:{title:t.$t("task_types.title"),"new-entry-label":t.$t("task_types.new_task_type")},on:{"new-clicked":t.onNewClicked}}),s("task-type-list",{attrs:{entries:t.taskTypes,"is-loading":t.loading.taskTypes||t.loading.departments,"is-error":t.errors.taskTypes||t.errors.departments},on:{"update-priorities":t.updatePriorities,"edit-clicked":t.onEditClicked,"delete-clicked":t.onDeleteClicked}}),s("edit-task-type-modal",{attrs:{active:t.modals.edit,"is-loading":t.loading.edit,"is-error":t.errors.edit,entries:t.taskTypes,"task-type-to-edit":t.taskTypeToEdit},on:{cancel:function(e){t.modals.edit=!1},confirm:t.confirmEditTaskType}}),s("delete-modal",{attrs:{active:t.modals.del,"is-loading":t.loading.del,"is-error":t.errors.del,text:t.deleteText(),"error-text":t.$t("task_types.delete_error")},on:{cancel:function(e){t.modals.del=!1},confirm:t.confirmDeleteTaskType}})],1)},r=[],i=s("2f62"),n=s("d359"),o=s("5f48"),l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{modal:!0,"is-active":t.active}},[s("div",{staticClass:"modal-background",on:{click:function(e){return t.$emit("cancel")}}}),s("div",{staticClass:"modal-content"},[s("div",{staticClass:"box"},[t.isEditing?s("h1",{staticClass:"title"},[t._v(" "+t._s(t.$t("task_types.edit_title"))+" "+t._s(t.taskTypeToEdit.name)+" ")]):s("h1",{staticClass:"title"},[t._v(" "+t._s(t.$t("task_types.new_task_type"))+" ")]),s("form",{on:{submit:function(t){t.preventDefault()}}},[s("text-field",{directives:[{name:"focus",rawName:"v-focus"}],ref:"nameField",attrs:{label:t.$t("task_types.fields.name")},on:{enter:t.confirmClicked},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t.isEditing?t._e():s("combobox",{attrs:{label:t.$t("task_types.fields.dedicated_to"),options:t.dedicatedToOptions},on:{enter:t.confirmClicked},model:{value:t.form.for_entity,callback:function(e){t.$set(t.form,"for_entity",e)},expression:"form.for_entity"}}),s("combobox-boolean",{attrs:{label:t.$t("task_types.fields.allow_timelog")},on:{enter:t.confirmClicked},model:{value:t.form.allow_timelog,callback:function(e){t.$set(t.form,"allow_timelog",e)},expression:"form.allow_timelog"}}),s("combobox-department",{attrs:{label:t.$t("task_types.fields.department")},on:{enter:t.confirmClicked},model:{value:t.form.department_id,callback:function(e){t.$set(t.form,"department_id",e)},expression:"form.department_id"}}),s("color-field",{ref:"colorField",attrs:{label:t.$t("task_types.fields.color")},model:{value:t.form.color,callback:function(e){t.$set(t.form,"color",e)},expression:"form.color"}})],1),s("modal-footer",{attrs:{"error-text":t.$t("task_types.create_error"),"is-loading":t.isLoading,"is-error":t.isError},on:{confirm:t.confirmClicked,cancel:function(e){return t.$emit("cancel")}}})],1)])])},c=[],d=s("d065"),p=s("992f"),u=s("4636"),f=s("5cf5"),m=s("f865"),y=s("d5c9"),b=s("7bf8");function h(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function k(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?h(Object(s),!0).forEach((function(e){g(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function g(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var T={name:"edit-task-type-modal",mixins:[d["a"]],components:{Combobox:p["a"],ComboboxBoolean:u["a"],ComboboxDepartment:f["a"],ColorField:m["a"],ModalFooter:y["a"],TextField:b["a"]},props:["active","onConfirmClicked","entries","isLoading","isError","taskTypeToEdit","text"],watch:{taskTypeToEdit:function(){this.taskTypeToEdit&&(this.form={name:this.taskTypeToEdit.name,color:this.taskTypeToEdit.color,for_entity:this.taskTypeToEdit.for_entity,allow_timelog:String(!0===this.taskTypeToEdit.allow_timelog),department_id:this.taskTypeToEdit.department_id})}},data:function(){return{form:{name:"",color:"$grey",for_entity:"Asset",allow_timelog:"false",department_id:null},dedicatedToOptions:[{label:this.$t("assets.title"),value:"Asset"},{label:this.$t("shots.title"),value:"Shot"},{label:this.$t("edits.title"),value:"Edit"}]}},computed:k(k({},Object(i["c"])(["taskTypes","taskTypeStatusOptions","departments"])),{},{isEditing:function(){return this.taskTypeToEdit&&this.taskTypeToEdit.id}}),methods:k(k({},Object(i["b"])([])),{},{newPriority:function(t){return this.entries.filter((function(e){return e.for_entity===t})).length+1},confirmClicked:function(){this.isEditing||(this.form.priority=this.newPriority(this.form.for_entity)),this.$emit("confirm",this.form)}})},O=T,v=(s("6d8f"),s("0c7c")),_=Object(v["a"])(O,l,c,!1,null,"236f9ea1",null),w=_.exports,C=s("459c"),j=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"data-list"},[s("div",{staticClass:"datatable-wrapper"},[s("table",{staticClass:"datatable"},[s("thead",{staticClass:"datatable-head"},[s("tr",[s("th",{staticClass:"department",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("task_types.fields.department"))+" ")]),s("th",{staticClass:"name",attrs:{scope:"col"}},[t._v(t._s(t.$t("task_types.fields.name")))]),s("th",{staticClass:"allow-timelog",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("task_types.fields.allow_timelog"))+" ")]),s("th",{staticClass:"actions",attrs:{scope:"col"}})])]),s("draggable",{staticClass:"datatable-body",attrs:{draggable:".tasktype-item",tag:"tbody",sort:!0},on:{end:t.updatePriorityAssets},model:{value:t.assetsItems,callback:function(e){t.assetsItems=e},expression:"assetsItems"}},[s("tr",{staticClass:"datatable-type-header",attrs:{slot:"header"},slot:"header"},[s("th",{attrs:{scope:"rowgroup",colspan:"4"}},[s("span",{staticClass:"datatable-row-header"},[t._v(" "+t._s(t.$t("assets.title"))+" ")])])]),t._l(t.assetsItems,(function(e){return s("tr",{key:e.id,staticClass:"datatable-row tasktype-item"},[s("td",{staticClass:"department"},[t.isEmpty(e.department_id)?t._e():s("department-name",{attrs:{department:t.getDepartments(e.department_id)}})],1),s("task-type-cell",{staticClass:"name",attrs:{"task-type":e}}),s("td",{staticClass:"allow-timelog"},[t._v(" "+t._s(e.allow_timelog?t.$t("main.yes"):t.$t("main.no"))+" ")]),s("row-actions-cell",{attrs:{"taskType-id":e.id},on:{"delete-clicked":function(s){return t.$emit("delete-clicked",e)},"edit-clicked":function(s){return t.$emit("edit-clicked",e)}}})],1)}))],2),s("draggable",{staticClass:"datatable-body",attrs:{draggable:".tasktype-item",tag:"tbody",sort:!0},on:{end:t.updatePriorityShots},model:{value:t.shotsItems,callback:function(e){t.shotsItems=e},expression:"shotsItems"}},[s("tr",{staticClass:"datatable-type-header",attrs:{slot:"header"},slot:"header"},[s("th",{attrs:{scope:"rowgroup",colspan:"4"}},[s("span",{staticClass:"datatable-row-header"},[t._v(" "+t._s(t.$t("shots.title"))+" ")])])]),t._l(t.shotsItems,(function(e){return s("tr",{key:e.id,staticClass:"datatable-row tasktype-item"},[s("td",{staticClass:"department"},[t.isEmpty(e.department_id)?t._e():s("department-name",{attrs:{department:t.getDepartments(e.department_id)}})],1),s("task-type-cell",{staticClass:"name",attrs:{"task-type":e}}),s("td",{staticClass:"allow-timelog"},[t._v(" "+t._s(e.allow_timelog?t.$t("main.yes"):t.$t("main.no"))+" ")]),s("row-actions-cell",{attrs:{"taskType-id":e.id},on:{"delete-clicked":function(s){return t.$emit("delete-clicked",e)},"edit-clicked":function(s){return t.$emit("edit-clicked",e)}}})],1)}))],2),s("draggable",{staticClass:"datatable-body",attrs:{draggable:".tasktype-item",tag:"tbody",sort:!0},on:{end:t.updatePriorityEdits},model:{value:t.editsItems,callback:function(e){t.editsItems=e},expression:"editsItems"}},[s("tr",{staticClass:"datatable-type-header",attrs:{slot:"header"},slot:"header"},[s("th",{attrs:{scope:"rowgroup",colspan:"4"}},[s("span",{staticClass:"datatable-row-header"},[t._v(" "+t._s(t.$t("edits.title"))+" ")])])]),t._l(t.editsItems,(function(e){return s("tr",{key:e.id,staticClass:"datatable-row tasktype-item"},[s("td",{staticClass:"department"},[t.isEmpty(e.department_id)?t._e():s("department-name",{attrs:{department:t.getDepartments(e.department_id)}})],1),s("task-type-cell",{staticClass:"name",attrs:{"task-type":e}}),s("td",{staticClass:"allow-timelog"},[t._v(" "+t._s(e.allow_timelog?t.$t("main.yes"):t.$t("main.no"))+" ")]),s("row-actions-cell",{attrs:{"taskType-id":e.id},on:{"delete-clicked":function(s){return t.$emit("delete-clicked",e)},"edit-clicked":function(s){return t.$emit("edit-clicked",e)}}})],1)}))],2)],1)]),s("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}}),s("p",{staticClass:"has-text-centered nb-task-types"},[t._v(" "+t._s(t.entries.length)+" "+t._s(t.$tc("task_types.number",t.entries.length))+" ")])],1)},E=[],P=s("b76a"),$=s.n(P),D=s("14b2"),S=s("e60b"),x=s("58f5"),I=s("5af2");function F(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function A(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?F(Object(s),!0).forEach((function(e){B(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):F(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function B(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var N={name:"task-type-list",props:["entries","isLoading","isError"],data:function(){return{assetsItems:[],shotsItems:[],editsItems:[]}},components:{draggable:$.a,DepartmentName:I["a"],RowActionsCell:D["a"],TableInfo:S["a"],TaskTypeCell:x["a"]},mounted:function(){},computed:A(A({},Object(i["c"])(["getDepartments"])),{},{assetTaskTypes:function(){return this.getTaskTypesForEntity("Asset")},shotTaskTypes:function(){return this.getTaskTypesForEntity("Shot")},editTaskTypes:function(){return this.getTaskTypesForEntity("Edit")}}),methods:A(A({},Object(i["b"])([])),{},{getTaskTypesForEntity:function(t){return this.entries.filter((function(e){return e.for_entity===t}))},updatePriority:function(t){var e=[];t.forEach((function(t,s){s+=1;var a={id:t.id,name:t.name,priority:String(s)};t.priority=s,e.push(a)})),this.$emit("update-priorities",e)},updatePriorityAssets:function(){this.updatePriority(this.assetsItems)},updatePriorityShots:function(){this.updatePriority(this.shotsItems)},updatePriorityEdits:function(){this.updatePriority(this.editsItems)},isEmpty:function(t){return void 0===t||null===t||""===t}}),watch:{entries:{immediate:!0,handler:function(){var t=this;setTimeout((function(){t.assetsItems=JSON.parse(JSON.stringify(t.assetTaskTypes)),t.shotsItems=JSON.parse(JSON.stringify(t.shotTaskTypes)),t.editsItems=JSON.parse(JSON.stringify(t.editTaskTypes))}),100)}}}},J=N,L=(s("2a5f"),Object(v["a"])(J,j,E,!1,null,"7e57fe96",null)),M=L.exports;function K(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function H(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?K(Object(s),!0).forEach((function(e){R(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):K(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function R(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var Y={name:"task-types",components:{DeleteModal:o["a"],EditTaskTypeModal:w,ListPageHeader:C["a"],TaskTypeList:M},data:function(){return{errors:{taskTypes:!1,departments:!1,edit:!1,del:!1},loading:{taskTypes:!1,departments:!1,edit:!1,del:!1},modals:{del:!1,edit:!1},taskTypeToDelete:{color:"#999999"},taskTypeToEdit:null}},computed:H({},Object(i["c"])(["getTaskType","taskTypes"])),mounted:function(){var t=this;this.loading.taskTypes=!0,this.errors.taskTypes=!1,this.loading.departments=!0,this.errors.departments=!1,this.loadDepartments().then((function(){t.loading.departments=!1})).catch((function(e){console.error(e),t.loading.departments=!1,t.errors.departments=!0})),this.loadTaskTypes().then((function(){t.loading.taskTypes=!1})).catch((function(e){console.error(e),t.loading.taskTypes=!1,t.errors.taskTypes=!0}))},methods:H(H({},Object(i["b"])(["editTaskType","deleteTaskType","loadTaskTypes","loadDepartments"])),{},{confirmEditTaskType:function(t){var e=this,s="newTaskType";this.taskTypeToEdit&&this.taskTypeToEdit.id&&(s="editTaskType",t.id=this.taskTypeToEdit.id),this.loading.edit=!0,this.errors.edit=!1,this.$store.dispatch(s,t).then((function(){e.loading.edit=!1,e.modals.edit=!1})).catch((function(t){console.error(t),e.loading.edit=!1,e.errors.edit=!0}))},updatePriorities:function(t){var e=this;t.forEach((function(t){e.$store.commit("EDIT_TASK_TYPE_END",t)})),this.savePriorities(t)},savePriorities:function(t){var e=this,s=(new Date).getTime();this.lastCall=this.lastCall||0,s-this.lastCall>1e3&&!this.isSaving?(this.lastCall=s,this.isSaving=!0,n["a"].runPromiseMapAsSeries(t,this.editTaskType).then((function(){e.isSaving=!1,e.newSaveCall&&e.savePriorities(t)}))):this.newSaveCall=!0},confirmDeleteTaskType:function(){var t=this;this.loading.del=!0,this.errors.del=!1,this.deleteTaskType(this.taskTypeToDelete).then((function(){t.loading.del=!1,t.modals.del=!1})).catch((function(e){console.error(e),t.loading.del=!1,t.errors.del=!0}))},deleteText:function(){var t=this.taskTypeToDelete;return t?this.$t("task_types.delete_text",{name:t.name}):""},onDeleteClicked:function(t){this.taskTypeToDelete=t,this.modals.del=!0},onEditClicked:function(t){this.taskTypeToEdit=t,this.modals.edit=!0},onNewClicked:function(){this.taskTypeToEdit={color:"#999999"},this.modals.edit=!0}}),watch:{},metaInfo:function(){return{title:"".concat(this.$t("task_types.title")," - Kitsu")}}},q=Y,z=Object(v["a"])(q,a,r,!1,null,"68f688be",null);e["default"]=z.exports},"6d8f":function(t,e,s){"use strict";s("f34c")},c8a3:function(t,e,s){},f34c:function(t,e,s){},f865:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v(t._s(t.label))]),s("div",{staticClass:"control colors"},t._l(t.colors,(function(e,a){return s("div",{key:"color-"+a,ref:"color-"+a,refInFor:!0,class:{color:!0,selected:t.value===e},on:{click:function(s){return t.colorChanged(e)}}},[s("span",{style:{background:e}})])})),0)])},r=[],i=s("2f62");function n(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function o(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?n(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var c={name:"text-field",props:{label:{default:"",type:String},value:{default:"$grey999",type:String},placeholder:{default:"",type:String},type:{default:"text",type:String},colors:{default:function(){return["#999999","#8D6E63","#43A047","#7CB342","#009688","#9CCC65","#AFB42B","#DCE775","#FFF176","#FFEB3B","#F9A825","#F57C00","#ff5252","#F06292","#AB47BC","#5C6BC0","#1976D2","#039BE5","#42A5F5","#64B5F6","#26C6DA","#78909C"]}}},data:function(){return{selectedColor:"$grey999"}},computed:o({},Object(i["c"])([])),methods:o(o({},Object(i["b"])([])),{},{colorChanged:function(t,e){this.$emit("input",t)}})},d=c,p=(s("099d"),s("0c7c")),u=Object(p["a"])(d,a,r,!1,null,"562b3c5e",null);e["a"]=u.exports}}]);
//# sourceMappingURL=chunk-adfdda94.c865af39.js.map