(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-09dd0ec8"],{"0024":function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"data-list"},[e("div",{staticStyle:{overflow:"hidden"}},[e("table",{ref:"headerWrapper",staticClass:"datatable"},[e("thead",{staticClass:"datatable-head"},[e("tr",{staticClass:"datatable-row-header"},[e("th",{staticClass:"type"},[t._v(" "+t._s(t.$t("tasks.fields.task_type"))+" ")]),e("th",{staticClass:"status"},[t._v(" "+t._s(t.$t("tasks.fields.task_status"))+" ")]),e("th",{staticClass:"assignees"},[t._v(" "+t._s(t.$t("tasks.fields.assignees"))+" ")]),e("th",{staticClass:"end-cell"})])])])]),e("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}}),t.entries.length>0?e("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.onBodyScroll,expression:"onBodyScroll"}]},[e("table",{staticClass:"datatable"},[e("tbody",{staticClass:"datatable-body"},t._l(t.sortedEntries,(function(s){return e("tr",{key:"string"===typeof s?s:s.id,class:{selected:t.currentTask&&t.currentTask.id===s,"datatable-row":!0,"datatable-row--selectable":!0},on:{click:function(e){t.selectTask(t.getTask(s))}}},[t.getTaskType(s)?e("task-type-cell",{staticClass:"type",attrs:{"task-type":t.getTaskType(s),"production-id":t.currentProduction.id}}):t._e(),e("td",{staticClass:"status"},[t.getTask(s)?e("validation-tag",{attrs:{task:t.getTask(s),"is-static":!0}}):t._e()],1),e("td",{staticClass:"assignees"},[t.isCurrentUserClient||t.isCurrentUserVendor?t._e():e("div",{staticClass:"flexrow"},t._l(t.getAssignees(s),(function(a){return e("div",{key:a,staticClass:"avatar-wrapper"},[e("people-avatar",{key:s+"-"+a,staticClass:"person-avatar flexrow-item",attrs:{person:t.personMap[a],size:30,"font-size":15}})],1)})),0)]),e("td",{staticClass:"end-cell"})],1)})),0)])]):t._e()],1)},i=[],r=(e("b0c0"),e("d3b7"),e("ddb0"),e("2909")),n=e("5530"),o=e("2f62"),c=e("58f5"),l=e("e60b"),d=e("fe13"),u=e("eb8c"),h={name:"entity-task-list",components:{TableInfo:l["a"],TaskTypeCell:c["a"],PeopleAvatar:u["a"],ValidationTag:d["a"]},props:{entries:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1},isError:{type:Boolean,default:!1}},data:function(){return{currentTask:null}},computed:Object(n["a"])(Object(n["a"])({},Object(o["c"])(["currentProduction","isCurrentUserClient","isCurrentUserVendor","personMap","taskMap","taskTypeMap"])),{},{sortedEntries:function(){var t=this;return Object(r["a"])(this.entries).sort((function(s,e){var a=t.getTask(s),i=t.getTask(e),r=t.getTask(t.taskTypeMap[a.task_type_id]),n=t.getTask(t.taskTypeMap[i.task_type_id]);return r.priority===n.priority?t.taskTypeA.localeCompare(t.taskTypeB.name):r.priority-n.priority}))}}),methods:Object(n["a"])(Object(n["a"])({},Object(o["b"])([])),{},{onBodyScroll:function(t,s){this.$refs.headerWrapper.style.left="-".concat(s.scrollLeft,"px")},getTask:function(t){return"string"===typeof t?this.taskMap[t]:t},getTaskType:function(t){var s=this.getTask(t);return s?this.taskTypeMap[s.task_type_id]:null},getAssignees:function(t){var s=this.getTask(t);return s?s.assignees:[]},selectTask:function(t){this.currentTask=t,this.$emit("task-selected",t)}})},f=h,p=(e("fbf0"),e("2877")),_=Object(p["a"])(f,a,i,!1,null,"643efec3",null);s["a"]=_.exports},"06f0":function(t,s,e){},"244d":function(t,s,e){"use strict";e("06f0")},"46dd":function(t,s,e){},de06:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"columns fixed-page shot"},[e("div",{staticClass:"column main-column"},[e("div",{staticClass:"page-header flexrow"},[e("router-link",{staticClass:"flexrow-item has-text-centered back-link",attrs:{to:t.shotsPath}},[e("chevron-left-icon")],1),t.currentShot?e("entity-thumbnail",{staticClass:"shot-thumbnail flexrow-item",attrs:{entity:t.currentShot,"with-link":!1}}):t._e(),e("div",{staticClass:"flexrow-item"},[e("page-title",{staticClass:"entity-title",attrs:{text:t.title}})],1),e("div",{staticClass:"flexrow-item"},[t.isCurrentUserManager?e("button-simple",{attrs:{icon:"edit"},on:{click:function(s){t.modals.edit=!0}}}):t._e()],1)],1),e("div",{staticClass:"flexrow infos"},[e("div",{staticClass:"flexrow-item"},[e("page-subtitle",{attrs:{text:t.$t("shots.tasks")}}),e("entity-task-list",{staticClass:"task-list",attrs:{entries:t.currentTasks,"is-loading":!t.currentShot,"is-error":!1},on:{"task-selected":t.onTaskSelected}})],1),e("div",{staticClass:"flexrow-item"},[e("page-subtitle",{attrs:{text:t.$t("main.info")}}),e("div",{staticClass:"table-body"},[t.currentShot?e("table",{staticClass:"datatable"},[e("tbody",{staticClass:"datatable-body"},[t.currentShot.data&&t.currentShot.data.fps?e("tr",{staticClass:"datatable-row"},[e("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.fps")))]),e("td",[t._v(" "+t._s(t.currentShot?t.currentShot.data.fps:"")+" ")])]):t._e(),t.currentShot.data&&t.currentShot.data.frame_in?e("tr",{staticClass:"datatable-row"},[e("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.frame_in")))]),e("td",[t._v(" "+t._s(t.currentShot?t.currentShot.data.frame_in:"")+" ")])]):t._e(),t.currentShot.data&&t.currentShot.data.frame_out?e("tr",{staticClass:"datatable-row"},[e("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.frame_out")))]),e("td",[t._v(" "+t._s(t.currentShot?t.currentShot.data.frame_out:"")+" ")])]):t._e(),e("tr",{staticClass:"datatable-row"},[e("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.description")))]),e("description-cell",{attrs:{entry:t.currentShot,full:!0}})],1),e("tr",{staticClass:"datatable-row"},[e("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.nb_frames")))]),e("td",[t._v(" "+t._s(t.currentShot?t.currentShot.nb_frames:"")+" ")])]),t._l(t.shotMetadataDescriptors,(function(s){return e("tr",{key:s.id,staticClass:"datatable-row"},[e("td",{staticClass:"field-label"},[t._v(t._s(s.name))]),e("td",[t._v(" "+t._s(t.currentShot.data?t.currentShot.data[s.field_name]:"")+" ")])])}))],2)]):t._e()])],1)]),e("div",{staticClass:"shot-casting"},[e("page-subtitle",{attrs:{text:t.$t("shots.casting")}}),t.currentShot?e("div",[t.currentShot.castingAssetsByType&&t.currentShot.castingAssetsByType[0].length>0?e("div",t._l(t.currentShot.castingAssetsByType,(function(s){return e("div",{key:s.length>0?s[0].asset_type_name:"",staticClass:"type-assets"},[e("div",{staticClass:"asset-type"},[t._v(" "+t._s(s.length>0?s[0].asset_type_name:"")+" ("+t._s(s.length)+") ")]),e("div",{staticClass:"asset-list"},t._l(s,(function(s){return e("router-link",{key:s.id,staticClass:"asset-link",attrs:{to:t.buildAssetRoute(s)}},[e("entity-thumbnail",{attrs:{entity:s,square:!0,"empty-width":103,"empty-height":103,"with-link":!1}}),e("div",[e("span",[t._v(t._s(s.asset_name))]),s.nb_occurences>1?e("span",[t._v(" ("+t._s(s.nb_occurences)+") ")]):t._e()])],1)})),1)])})),0):e("div",[t._v(" "+t._s(t.$t("shots.no_casting"))+" ")])]):e("table-info",{attrs:{"is-loading":t.casting.isLoading,"is-error":t.casting.isError}})],1)]),t.currentTask?e("div",{staticClass:"column side-column"},[e("task-info",{attrs:{task:t.currentTask}})],1):t._e(),e("edit-shot-modal",{ref:"edit-shot-modal",attrs:{active:t.modals.edit,"is-loading":t.loading.edit,"is-error":t.errors.edit,"shot-to-edit":t.currentShot},on:{cancel:function(s){t.modals.edit=!1},confirm:t.confirmEditShot}})],1)},i=[],r=(e("b0c0"),e("b64b"),e("5530")),n=e("2f62"),o=e("0a35"),c=e("9d8b"),l=e("de40"),d=e("0fcb"),u=e("162b"),h=e("bb21"),f=e("0024"),p=e("8d07"),_=e("8751"),b=e("e60b"),g=e("9d94"),k={name:"shot",components:{ButtonSimple:l["a"],ChevronLeftIcon:o["j"],DescriptionCell:d["a"],EditShotModal:u["a"],EntityThumbnail:h["a"],EntityTaskList:f["a"],PageSubtitle:_["a"],PageTitle:p["a"],TableInfo:b["a"],TaskInfo:g["a"]},data:function(){return{currentShot:null,currentTask:null,casting:{isLoading:!1,isError:!1},errors:{edit:!1},loading:{edit:!1},modals:{edit:!1}}},mounted:function(){var t=this;this.clearSelectedTasks(),this.currentShot=this.getCurrentShot(),this.casting.isLoading=!0,this.casting.isError=!1,this.currentShot?this.loadShotCasting(this.currentShot).then((function(){t.casting.isLoading=!1})).catch((function(s){t.casting.isError=!0,console.error(s)})):this.resetData()},computed:Object(r["a"])(Object(r["a"])({},Object(n["c"])(["currentEpisode","currentProduction","isCurrentUserManager","isTVShow","route","taskMap","shotMap","shotMetadataDescriptors","shotsPath"])),{},{currentTasks:function(){return this.currentShot?this.currentShot.tasks:[]},title:function(){return this.currentShot?this.currentShot.episode_name?"".concat(this.currentShot.episode_name," / ")+"".concat(this.currentShot.sequence_name," / ")+"".concat(this.currentShot.name):"".concat(this.currentShot.sequence_name," / ")+"".concat(this.currentShot.name):"Loading..."},shotThumbnailPath:function(){var t=this.currentShot.preview_file_id;return"/api/pictures/originals/preview-files/".concat(t,".png")},isPreview:function(){return this.currentShot&&this.currentShot.preview_file_id&&this.currentShot.preview_file_id.length>0}}),methods:Object(r["a"])(Object(r["a"])({},Object(n["b"])(["clearSelectedTasks","editShot","loadAssets","loadShots","loadShotCasting"])),{},{changeTab:function(t){this.selectedTab=t},getCurrentShot:function(){return this.shotMap[this.route.params.shot_id]||null},onEditClicked:function(){this.modals.edit=!0},confirmEditShot:function(t){var s=this;t.id=this.currentShot.id,this.loading.edit=!0,this.errors.edit=!1,this.editShot(t).then((function(){s.loading.edit=!1,s.modals.edit=!1})).catch((function(t){console.error(t),s.loading.edit=!1,s.errors.edit=!0}))},onTaskSelected:function(t){this.currentTask=t},buildAssetRoute:function(t){var s=t.episode_id;this.isTVShow&&!s&&(s="main");var e={name:"asset",params:{production_id:this.currentProduction.id,asset_id:t.asset_id}};return Object(c["a"])(e,s)},resetData:function(){var t=this;this.$nextTick((function(){t.loadShots((function(){t.loadAssets().then((function(){return t.currentShot=t.getCurrentShot(),t.loadShotCasting(t.currentShot).then((function(){t.casting.isLoading=!1})).catch((function(s){console.error(s),t.casting.isError=!0}))}))}))}))}}),watch:{currentProduction:function(){this.isTVShow||this.resetData()},currentEpisode:function(){this.isTVShow&&0===Object.keys(this.shotMap).length&&this.resetData()}},metaInfo:function(){return{title:"".concat(this.title," - Kitsu")}}},m=k,S=(e("244d"),e("2877")),v=Object(S["a"])(m,a,i,!1,null,"70595599",null);s["default"]=v.exports},fbf0:function(t,s,e){"use strict";e("46dd")}}]);
//# sourceMappingURL=chunk-09dd0ec8.9989653d.js.map